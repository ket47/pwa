"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[251],{7327:function(e,t,i){i.d(t,{Z:function(){return c}});var o=i(6252),a=i(3577);const n=(0,o.Uk)("Просмотр фотографии");function s(e,t,i,s,l,r){const d=(0,o.up)("ion-title"),u=(0,o.up)("ion-icon"),m=(0,o.up)("ion-toolbar"),c=(0,o.up)("ion-header"),p=(0,o.up)("ion-button"),h=(0,o.up)("ion-col"),g=(0,o.up)("ion-row"),_=(0,o.up)("ion-grid"),w=(0,o.up)("ion-img"),f=(0,o.up)("ion-content");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m,{color:"secondary"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[n])),_:1}),(0,o.Wm)(u,{icon:s.closeOutline,onClick:t[0]||(t[0]=e=>{s.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,o.Wm)(f,null,{default:(0,o.w5)((()=>[i.actions?((0,o.wg)(),(0,o.j4)(_,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.actions,((e,t)=>((0,o.wg)(),(0,o.j4)(h,{key:t},{default:(0,o.w5)((()=>[e[0]?((0,o.wg)(),(0,o.j4)(p,{key:0,onClick:i=>r.actionCreate(t,e[1]),expand:"block",color:e[1]??"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e[0]),1)])),_:2},1032,["onClick","color"])):(0,o.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(w,{src:e.$heap.state.hostname+"image/get.php/"+i.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var l=i(8903),r=i(3741),d={props:["image_hash","actions"],components:{IonIcon:r.gu,IonToolbar:r.sr,IonHeader:r.Gu,IonImg:r.Xz,IonContent:r.W2,IonTitle:r.wd,IonButton:r.YG,IonCol:r.wI,IonRow:r.Nd,IonGrid:r.jY},setup(){const e=function(){r.Fy.dismiss()};return{closeModal:e,closeOutline:l.fID}},methods:{actionCreate(e,t){("danger"!=t||confirm("Вы уверены?"))&&r.Fy.dismiss(null,e)}}},u=i(3744);const m=(0,u.Z)(d,[["render",s]]);var c=m},2251:function(e,t,i){i.r(t),i.d(t,{default:function(){return w}});var o=i(6252),a=i(3577);const n=(0,o.Uk)(" Картинки "),s=(0,o.Uk)(" Магазины "),l=(0,o.Uk)(" Курьеры "),r=(0,o.Uk)(" Ничего не найдено ");function d(e,t,i,d,u,m){const c=(0,o.up)("ion-segment-button"),p=(0,o.up)("ion-segment"),h=(0,o.up)("ion-searchbar"),g=(0,o.up)("ion-img"),_=(0,o.up)("ion-thumbnail"),w=(0,o.up)("ion-text"),f=(0,o.up)("ion-label"),y=(0,o.up)("ion-item"),I=(0,o.up)("ion-list"),k=(0,o.up)("ion-skeleton-text"),b=(0,o.up)("ion-card-content"),C=(0,o.up)("ion-card"),W=(0,o.up)("ion-infinite-scroll-content"),D=(0,o.up)("ion-infinite-scroll"),T=(0,o.up)("ion-content"),$=(0,o.up)("base-layout");return(0,o.wg)(),(0,o.j4)($,{pageDefaultBackLink:"/home","page-title":"Модерация"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{"swipe-gesture":"true",modelValue:u.moderationType,"onUpdate:modelValue":t[0]||(t[0]=e=>u.moderationType=e),onIonChange:t[1]||(t[1]=e=>m.listTypeChanged(e))},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{value:"images"},{default:(0,o.w5)((()=>[n])),_:1}),(0,o.Wm)(c,{value:"stores"},{default:(0,o.w5)((()=>[s])),_:1}),(0,o.Wm)(c,{value:"couriers"},{default:(0,o.w5)((()=>[l])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(T,null,{default:(0,o.w5)((()=>["stores"==u.moderationType||"couriers"==u.moderationType?((0,o.wg)(),(0,o.j4)(h,{key:0,placeholder:"Фильтр",modelValue:u.filter,"onUpdate:modelValue":t[2]||(t[2]=e=>u.filter=e)},null,8,["modelValue"])):(0,o.kq)("",!0),m.listComputed.length>0?((0,o.wg)(),(0,o.j4)(I,{key:1},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.listComputed,(t=>((0,o.wg)(),(0,o.j4)(y,{key:t.item_id,button:"",detail:"",onClick:e=>m.itemEdit(t)},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{slot:"start",class:(0,a.C_)(t.class)},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.50.50.webp`},null,8,["src"])])),_:2},1032,["class"]),(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.item_name),1)])),_:2},1024),(0,o.Wm)(f,{slot:"end"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(t.date_time),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):1==u.is_loading?((0,o.wg)(),(0,o.j4)(I,{key:2},{default:(0,o.w5)((()=>[((0,o.wg)(),(0,o.iD)(o.HY,null,(0,o.Ko)([1,2,3],(e=>(0,o.Wm)(y,{key:e,button:"",detail:""},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{slot:"start",style:{"background-color":"lightgray"}}),(0,o.Wm)(k,{animated:""})])),_:2},1024))),64))])),_:1})):((0,o.wg)(),(0,o.j4)(C,{key:3,color:"light"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[r])),_:1})])),_:1})),(0,o.Wm)(D,{onIonInfinite:t[3]||(t[3]=e=>m.listLoadMore(e)),id:"moderation-infinite-scroll"},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{"loading-spinner":"bubbles","loading-text":"Loading more data..."})])),_:1})])),_:1})])),_:1})}var u=i(3741),m=i(9755),c=i.n(m),p=i(7327),h={components:{IonContent:u.W2,IonInfiniteScroll:u.ju,IonInfiniteScrollContent:u.MB,IonItem:u.Ie,IonLabel:u.Q$,IonList:u.q_,IonSegmentButton:u.GO,IonSegment:u.cJ,IonImg:u.Xz,IonThumbnail:u.Bs,IonText:u.yW,IonSkeletonText:u.CK,IonCard:u.PM,IonCardContent:u.FN,IonSearchbar:u.VI},data(){return{items:[],filter:"",is_loading:0,moderationType:"images",holders:{store:"Поставщик",courier:"Курьер",product:"Товар",order:"Заказ",product_group_list:"Категория товара",location_group_list:"Категория местоп.",store_group_list:"Категория поставщ.",user_group_list:"Категория пользователя"}}},computed:{listComputed(){for(let e of this.items)e.image_hash=e.image_hash||e.courier_photo_image_hash,e.item_id=e.image_id||e.store_id||e.courier_id,e.item_name=this.holders[e.image_holder]||e.store_name||e.user_name,e.date_time=this.toLocDateTime(e.updated_at),e.class=e.deleted_at?"deleted":"";return this.items}},methods:{async listLoadMore(e){await this.listLoad(),e.target.complete()},async listReload(){this.items=[],this.listLoad()},async listLoad(){let e={is_disabled:1,is_active:0,name_query:this.filter,offset:this.items.length,limit:15,order:"updated_at"};try{let t;this.is_loading=1,"images"==this.moderationType&&(t=await c().post(`${this.$heap.state.hostname}Image/listGet`,e)),"stores"==this.moderationType&&(e.name_query_fields="store_name,store_description",e.reverse="validity",t=await c().post(`${this.$heap.state.hostname}Store/listGet`,e)),"couriers"==this.moderationType&&(e.name_query_fields="courier_vehicle,user_phone,user_name",e.order="courier_list.updated_at",t=await c().post(`${this.$heap.state.hostname}Courier/listGet`,e)),this.is_loading=0,this.items=this.items.concat(t)}catch(t){console.log(t)}},listTypeChanged(e){e.target.value;this.items=[],this.listLoad()},listFilter(){clearTimeout(this.clock);const e=this;this.clock=setTimeout((()=>{e.listReload()}),300)},toLocDate(e){const t=new Date(Date.parse(e)),i={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,i)},toLocDateTime(e){const t=new Date(Date.parse(e)),i={month:"short",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleDateString(void 0,i)},itemEdit(e){"images"==this.moderationType&&this.imageEdit(e),"stores"==this.moderationType&&this.$router.push("store-edit-"+e.store_id),"couriers"==this.moderationType&&this.$router.push("courier-dashboard?courier_id="+e.courier_id)},async imageEdit(e){const t={delete:["Удалить","danger"],postpone:["Потом","primary"],enable:["Ок","success"]},i=await u.Fy.create({component:p.Z,componentProps:{image_hash:e.image_hash,actions:t},initialBreakpoint:.75,breakpoints:[.75,1]});this.$topic.on("dismissModal",(()=>{i.dismiss()})),i.present();const o=await i.onDidDismiss();"delete"==o.role&&await this.imageDelete(e),"enable"==o.role&&await this.imageEnable(e),"postpone"==o.role&&await this.imagePostpone(e),this.listReload()},async imageEnable(e){await c().post(`${this.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:0})},async imagePostpone(e){await c().post(`${this.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:0}),await c().post(`${this.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:1})},async imageDelete(e){await c().post(`${this.$heap.state.hostname}Image/itemDelete`,{image_id:e.image_id})}},mounted(){this.listLoad()},watch:{filter:function(){this.listFilter()}}},g=i(3744);const _=(0,g.Z)(h,[["render",d],["__scopeId","data-v-130d9025"]]);var w=_}}]);
//# sourceMappingURL=251.f012492e.js.map