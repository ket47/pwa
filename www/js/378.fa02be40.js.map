{"version":3,"file":"js/378.fa02be40.js","mappings":"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","sources":["webpack://blank/./src/views/UserSignIn.vue","webpack://blank/./src/components/ModalUsernameConfirm.vue","webpack://blank/./src/components/ModalUsernameConfirm.vue?1481","webpack://blank/./src/views/UserSignIn.vue?f790"],"sourcesContent":["<style scoped>\r\n  ion-input,ion-select{\r\n    border-bottom: 1px solid var(--ion-color-primary-tint);\r\n  }\r\n</style>\r\n<template>\r\n  <base-layout page-title=\"Вход в систему\"  page-default-back-link=\"/home\" :errorMessage=\"error\">\r\n      <form novalidate>\r\n\r\n      <ion-grid>\r\n        <ion-row>\r\n          <ion-col size=\"4\">\r\n            <ion-label position=\"stacked\" color=\"primary\">Код</ion-label>\r\n            <ion-select \r\n              :value=\"fields.phonePrefix\" \r\n              @ionChange=\"fields.phonePrefix = $event.target.value\" \r\n            >\r\n              <ion-select-option value=\"+7\" >+7 </ion-select-option>\r\n            </ion-select>\r\n          </ion-col>\r\n          <ion-col size=\"8\">\r\n            <ion-label position=\"stacked\" color=\"primary\">Телефон</ion-label>\r\n            <ion-input\r\n              v-model=\"fields.phoneBody\"\r\n              name=\"phone\"\r\n              type=\"numeric\"\r\n              inputmode=\"tel\"\r\n              :value=\"fields.phoneBody\"\r\n              @input=\"$event.target.value = phoneValidate($event);\"\r\n              placeholder=\"(900)-000-00-00\"\r\n              spellcheck=\"false\"\r\n              autocapitalize=\"off\"\r\n              required\r\n            ></ion-input>\r\n          </ion-col>\r\n        </ion-row>\r\n\r\n        <ion-row>\r\n          <ion-col>\r\n            <ion-text color=\"danger\">\r\n              <p v-show=\"!phoneValid && submitted == true\" padding-left>Неверный номер телефона</p>\r\n            </ion-text>\r\n          </ion-col>\r\n        </ion-row>\r\n\r\n        <ion-row>\r\n          <ion-col>\r\n            <ion-label position=\"stacked\" color=\"primary\">Пароль (Минимум 6 символов)</ion-label>\r\n            <ion-input \r\n              v-model=\"password\" \r\n              name=\"password\" \r\n              type=\"password\" \r\n              :value=\"fields.password\"\r\n              autocorrect=\"off\"\r\n              @ionInput=\"fields.password = $event.target.value\" \r\n              placeholder=\"Пароль (Минимум 6 символов)\"\r\n              required\r\n            ></ion-input>\r\n          </ion-col>\r\n        </ion-row>\r\n\r\n        <ion-row>\r\n          <ion-col>\r\n          <ion-text color=\"danger\">\r\n            <p v-show=\"!passwordValid && submitted == true\" padding-left>Пароль должен содержать не менее 6 символов.</p>\r\n          </ion-text>\r\n          </ion-col>\r\n        </ion-row>\r\n\r\n        <ion-row responsive-sm>\r\n          <ion-col>\r\n            <ion-button @click=\"onSubmit\" expand=\"block\">Войти</ion-button>\r\n          </ion-col>\r\n        </ion-row>\r\n        \r\n        <ion-row responsive-sm>\r\n          <ion-col>\r\n            <ion-button color=\"light\" expand=\"block\" @click=\"router.push({path: `/sign-up`})\">Зарегистрироваться</ion-button>\r\n          </ion-col>\r\n        </ion-row>\r\n        \r\n        <ion-row responsive-sm>\r\n          <ion-col>\r\n              <ion-button @click=\"openModal\" color=\"light\" expand=\"block\">Забыли пароль?</ion-button>\r\n          </ion-col>\r\n        </ion-row>\r\n      </ion-grid>\r\n      </form>\r\n  </base-layout>\r\n</template>\r\n\r\n<script>\r\nimport { modalController, onIonViewDidEnter } from '@ionic/vue';\r\nimport ModalUsernameConfirm from '../components/ModalUsernameConfirm.vue'\r\n\r\nimport User from '../scripts/User.js'\r\n\r\nimport router from '../router';\r\nimport jQuery from \"jquery\";\r\nimport heap from '../heap';\r\n\r\n\r\nexport default{\r\n  inject:['$Order'],\r\n  setup() {\r\n    onIonViewDidEnter(() => {\r\n      // if(heap.state.user.user_id && heap.state.user.user_id > -1){\r\n      //   return router.go(-1);\r\n      // } \r\n    });\r\n  },\r\n  name: 'UserSignIn',\r\n  data(){\r\n    return {\r\n      error: '',\r\n      submitted: false,\r\n      config: {\r\n        phoneMask: '(000)-000-00-00'\r\n      },\r\n      fields: {\r\n        phonePrefix: '+7',\r\n        phone: '9785141948',\r\n        phoneBody: '9785141948',\r\n        password: '123456'\r\n      },\r\n      modalOpen: false\r\n    }\r\n  },\r\n  computed: {\r\n    phoneValid() {\r\n      return this.fields.phoneBody.replace(/\\D/g,\"\").length == 10;\r\n    },\r\n    passwordValid() {\r\n      return this.fields.password.length >= 6;\r\n    }\r\n  },\r\n  methods:{\r\n    async onSubmit() {\r\n      var self = this;\r\n      this.submitted = true;\r\n      if(!this.phoneValid || !this.passwordValid){\r\n        return false;\r\n      }\r\n      let requestData = {\r\n        user_phone: this.fields.phonePrefix + this.fields.phoneBody.replace(/\\D/g,\"\"),\r\n        user_pass: this.fields.password,\r\n        user_pass_confirm: this.fields.password\r\n      }\r\n      try{\r\n        await User.signIn(requestData);\r\n        this.getUserData();\r\n      } catch(err){\r\n        const exception=err.responseJSON;\r\n        const exception_code=exception.messages.error;\r\n        switch(exception_code){\r\n          case 'user_not_found':\r\n            this.$flash(\"Пользователь не найден. Пройдите регистрацию.\");\r\n            break;\r\n          case 'user_pass_wrong':\r\n            this.$flash(\"Неверный пароль\");\r\n            break;\r\n          case 'user_is_disabled':\r\n            this.$flash(\"Пользователь отключен. Обратитесь к администратору\");\r\n            break;\r\n          case 'user_is_deleted':\r\n            this.$flash(\"Пользователь удален. Обратитесь к администратору\");\r\n            break;\r\n          case 'user_phone_unverified':\r\n            this.$flash(\"Номер телефона не подтвержден\");\r\n            this.phoneVerify();\r\n            break;\r\n        }\r\n      }\r\n    },\r\n    async getUserData(){\r\n      const userData=await User.get();\r\n      heap.commit('setUser', userData);\r\n      router.go(-1);\r\n    },\r\n    phoneVerify(){\r\n      var self = this;\r\n      jQuery.post( heap.state.hostname + \"User/phoneVerificationSend\", {user_phone: '7' + this.fields.phoneBody.replace(/\\D/g,\"\")})\r\n        .done(function() {\r\n            router.push({name: 'UserVerifyPhone', params: {phone: self.fields.phonePrefix + self.fields.phoneBody.replace(/\\D/g,\"\"), password: self.fields.password}});\r\n        })\r\n        .fail(function(err) {\r\n            self.error = err.responseJSON.messages.error;\r\n        });\r\n    },\r\n    phoneValidate(ev) {\r\n      this.fields.phoneBody = ev.target.value;\r\n      this.fields.phoneBody = this.fields.phoneBody.replace(/\\D/g,\"\");\r\n      if(this.fields.phoneBody.length > 10){\r\n        this.fields.phoneBody = this.fields.phoneBody.substring(0, 10);\r\n      }\r\n      let result = '';\r\n      let numberIndex = 0; \r\n      for(let index in this.config.phoneMask){\r\n        if(!this.fields.phoneBody[numberIndex]){\r\n          break;\r\n        }\r\n        let character = this.config.phoneMask[index];\r\n        if(character == '0'){\r\n          result += this.fields.phoneBody[numberIndex];\r\n          numberIndex++;\r\n        } else {\r\n          result += character\r\n        }\r\n      }\r\n      this.fields.phoneBody = result;\r\n      return this.fields.phoneBody;\r\n    },\r\n    async openModal() {\r\n      this.modalOpen = true;\r\n      var self = this;\r\n      const modal = await modalController\r\n        .create({\r\n          component: ModalUsernameConfirm,\r\n          cssClass: 'my-custom-class',\r\n          componentProps: {\r\n            phone: self.fields.phonePrefix + self.fields.phoneBody.replace(/\\D/g,\"\")\r\n          }\r\n        })\r\n      return modal.present();\r\n    } \r\n  }\r\n}\r\n</script>","<template>\r\n  <ion-header>\r\n    <ion-toolbar>\r\n      <ion-title>{{ title }}</ion-title>\r\n      <ion-button slot=\"end\" @click=\"closeModal\">Закрыть</ion-button>\r\n    </ion-toolbar>\r\n  </ion-header>\r\n  <ion-content >\r\n      <form novalidate>\r\n        <ion-list>\r\n          <ion-item>\r\n            <ion-row>\r\n              <ion-col>\r\n                <ion-label position=\"stacked\" color=\"primary\">Имя пользователя</ion-label>\r\n                <ion-input\r\n                  v-model=\"username\"\r\n                  name=\"username\"\r\n                  type=\"text\"\r\n                  inputmode=\"text\"\r\n                  :value=\"username\"\r\n                  @input=\"username = $event.target.value\"\r\n                  placeholder=\"Введите имя пользователя...\"\r\n                  required\r\n                ></ion-input>\r\n              </ion-col>\r\n            </ion-row>\r\n          </ion-item>\r\n        </ion-list>\r\n\r\n        <ion-row responsive-sm>\r\n          <ion-col>\r\n            <ion-button @click=\"passwordReset\" expand=\"block\">Подтвердить</ion-button>\r\n          </ion-col>\r\n        </ion-row>\r\n      </form>\r\n  </ion-content>\r\n</template>\r\n\r\n<script>\r\nimport { modalController } from '@ionic/vue';\r\nimport { IonContent, IonHeader, IonTitle, IonToolbar, IonList, IonItem } from '@ionic/vue';\r\n\r\nimport jQuery from \"jquery\";\r\n\r\nexport default {\r\n  name: 'ModalUsernameConfirm',\r\n  props: [ 'phone' ],\r\n  data() {\r\n    return {\r\n      username: '',\r\n    }\r\n  },\r\n  components: { IonContent, IonHeader, IonTitle, IonToolbar, IonList, IonItem },\r\n  methods: {\r\n    closeModal(){\r\n      return modalController.dismiss();\r\n    },\r\n    async passwordReset(){\r\n      let requestData = {\r\n        user_phone: '+'+this.phone.replace(/\\D/g,\"\"),\r\n        user_name:  this.username\r\n      }\r\n      try{\r\n        await jQuery.post( \"https://api.tezkel.com/User/passwordReset\", requestData)\r\n      } catch{/** */}\r\n      this.closeModal()\r\n    },\r\n  }\r\n};\r\n</script>","import { render } from \"./ModalUsernameConfirm.vue?vue&type=template&id=1dcb4535\"\nimport script from \"./ModalUsernameConfirm.vue?vue&type=script&lang=js\"\nexport * from \"./ModalUsernameConfirm.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./UserSignIn.vue?vue&type=template&id=1703f8c9&scoped=true\"\nimport script from \"./UserSignIn.vue?vue&type=script&lang=js\"\nexport * from \"./UserSignIn.vue?vue&type=script&lang=js\"\n\nimport \"./UserSignIn.vue?vue&type=style&index=0&id=1703f8c9&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1703f8c9\"]])\n\nexport default __exports__"],"names":["novalidate","errorMessage","error","size","position","color","value","fields","phonePrefix","$event","target","phoneBody","name","type","inputmode","phoneValidate","placeholder","spellcheck","autocapitalize","required","phoneValid","submitted","password","autocorrect","passwordValid","onSubmit","expand","router","push","openModal","title","slot","closeModal","username","passwordReset","props","data","components","IonContent","IonHeader","IonTitle","IonToolbar","IonList","IonItem","methods","async","requestData","user_phone","this","phone","replace","user_name","__exports__","inject","setup","config","phoneMask","modalOpen","computed","length","user_pass","user_pass_confirm","User","getUserData","err","exception","responseJSON","exception_code","messages","$flash","phoneVerify","userData","heap","self","done","params","fail","ev","substring","result","numberIndex","index","character","modal","component","ModalUsernameConfirm","cssClass","componentProps","present","render"],"sourceRoot":""}