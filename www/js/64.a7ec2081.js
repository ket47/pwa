"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[64],{2126:function(e,t,o){o.d(t,{Z:function(){return V}});var s=o(6252),l=o(3577);const i=(0,s.Uk)("Фотографии"),a={key:0,class:"image_grid"},r=["onClick"],n={key:0},m={key:1},_={key:0,class:"image_controls"};function d(e,t,o,d,u,c){const p=(0,s.up)("ion-label"),h=(0,s.up)("ion-icon"),w=(0,s.up)("ion-item"),I=(0,s.up)("ion-img"),k=(0,s.up)("ion-avatar");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s._)("div",null,[(0,s.Wm)(w,{lines:"none"},{default:(0,s.w5)((()=>[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[i])),_:1}),u.editMode?((0,s.wg)(),(0,s.j4)(h,{key:0,slot:"end",icon:d.settingsSharp,color:"primary",onClick:t[0]||(t[0]=e=>u.editMode=0)},null,8,["icon"])):((0,s.wg)(),(0,s.j4)(h,{key:1,slot:"end",icon:d.settingsOutline,onClick:t[1]||(t[1]=e=>{u.editMode=1,c.load()})},null,8,["icon"]))])),_:1}),c.imageList?.length?((0,s.wg)(),(0,s.iD)("div",a,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(c.imageList,(t=>((0,s.wg)(),(0,s.iD)("div",{key:t.image_id,style:{position:"relative"}},[(0,s._)("div",{style:{position:"absolute",top:"0px","background-color":"#fffc","font-size":"0.75em"},onClick:e=>c.imagePreview(t.image_hash)},[t.deleted_at?((0,s.wg)(),(0,s.iD)("div",n,"будет удалено")):1==t.is_disabled?((0,s.wg)(),(0,s.iD)("div",m,"на модерации")):(0,s.kq)("",!0)],8,r),(0,s.Wm)(k,{onClick:e=>c.imagePreview(t.image_hash),class:(0,l.C_)(t.class)},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),u.editMode?((0,s.wg)(),(0,s.iD)("div",_,[(0,s.Wm)(h,{icon:d.chevronBackCircleOutline,onClick:e=>c.back(t)},null,8,["icon","onClick"]),c.isAdmin&&1==t.is_disabled?((0,s.wg)(),(0,s.j4)(h,{key:0,icon:d.checkmarkCircle,color:"success",onClick:e=>c.enable(t)},null,8,["icon","onClick"])):(0,s.kq)("",!0),t.deleted_at?((0,s.wg)(),(0,s.j4)(h,{key:1,icon:d.trash,color:"success",onClick:e=>c.restore(t)},null,8,["icon","onClick"])):((0,s.wg)(),(0,s.j4)(h,{key:2,icon:d.trashBin,color:"danger",onClick:e=>c.remove(t)},null,8,["icon","onClick"])),(0,s.Wm)(h,{icon:d.chevronForwardCircleOutline,onClick:e=>c.forward(t)},null,8,["icon","onClick"])])):(0,s.kq)("",!0)])))),128))])):(0,s.kq)("",!0)]),(0,s._)("input",{type:"file",id:"foto_upload",accept:"image/*",onChange:t[2]||(t[2]=e=>c.uploadImage(e)),style:{display:"none"}},null,32)],64)}var u=o(8903),c=o(4508);const p=(0,s.Uk)("Просмотр фотографии");function h(e,t,o,l,i,a){const r=(0,s.up)("ion-title"),n=(0,s.up)("ion-icon"),m=(0,s.up)("ion-toolbar"),_=(0,s.up)("ion-header"),d=(0,s.up)("ion-img"),u=(0,s.up)("ion-content");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(r,null,{default:(0,s.w5)((()=>[p])),_:1}),(0,s.Wm)(n,{icon:l.closeOutline,onClick:t[0]||(t[0]=e=>{l.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{src:e.$heap.state.hostname+"image/get.php/"+o.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var w={props:["image_hash"],components:{IonLabel:c.Q$,IonIcon:c.gu,IonToolbar:c.sr,IonHeader:c.Gu,IonImg:c.Xz,IonContent:c.W2,IonTitle:c.wd},setup(){const e=function(){c.Fy.dismiss()};return{closeModal:e,closeOutline:u.fID}}},I=o(3744);const k=(0,I.Z)(w,[["render",h]]);var g=k,f=o(9755),y=o.n(f),W=o(9042),U=o(351),C={props:["images","image_holder_id","controller"],components:{IonLabel:c.Q$,IonIcon:c.gu,IonItem:c.Ie,IonImg:c.Xz,IonAvatar:c.BJ},setup(){return{settingsOutline:u.C$N,settingsSharp:u.kiF,chevronBackCircleOutline:u.CK0,chevronForwardCircleOutline:u.esm,trashBin:u.UQi,trash:u._Ij,checkmarkCircle:u.I1A}},data(){return{images_loaded:null,editMode:!1}},computed:{imageList(){let e=this.images_loaded||this.images,t=[];for(let o in e)e[o].deleted_at?(e[o].class=" deleted",this.editMode&&t.push(e[o])):1==e[o].is_disabled?(e[o].class=" disabled",this.editMode&&t.push(e[o])):t.push(e[o]);return t},isAdmin(){return U.Z.isAdmin()}},methods:{async back(e){try{await y().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),this.load()}catch{}},async forward(e){try{await y().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),this.load()}catch{}},async remove(e){try{await y().post(this.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено в корзину и будет удалено")}catch{}},async restore(e){try{await y().post(this.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено извлечено из корзины")}catch{}},async enable(e){try{await y().post(this.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),this.load()}catch{}},async load(){const e={image_holder_id:this.image_holder_id,image_holder:this.controller,is_disabled:1,is_deleted:1,is_active:1};this.images_loaded=await y().post(this.$heap.state.hostname+"Image/listGet",e)},async imagePreview(e){const t=await c.Fy.create({component:g,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[.5,1]}),o=function(){t.dismiss()};return W.Z.on("dismissModal",o),t.present()},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.image_holder_id);const o={url:this.$heap.state.hostname+this.controller+"/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await y().ajax(o),this.load()}catch(s){if("limit_exeeded"==s?.responseJSON?.messages?.error)return void this.$flash("Уже загружено максимальное количество фото");this.$flash("Не удалось загрузить фото")}},take_photo(){y()("#foto_upload").trigger("click"),this.editMode=!0}}};const v=(0,I.Z)(C,[["render",d],["__scopeId","data-v-4609f3b7"]]);var V=v},7064:function(e,t,o){o.r(t),o.d(t,{default:function(){return ne}});var s=o(6252),l=o(3577),i=o(9963);const a=(0,s.Uk)(" Готово к заказам "),r=(0,s.Uk)(" Удалено "),n=(0,s.Uk)(" Опорное "),m=(0,s.Uk)(" На модерации "),_=(0,s.Uk)("Добавление товара"),d=(0,s.Uk)(" Добавить товар "),u=(0,s.Uk)("Основные настройки"),c=(0,s.Uk)("Название"),p=(0,s.Uk)("Изменить"),h=(0,s.Uk)("Название непроверенное *"),w=(0,s.Uk)("Описание"),I=(0,s.Uk)("Изменить"),k=(0,s.Uk)("Описание непроверенное *"),g=(0,s.Uk)("ИНН *"),f=(0,s.Uk)("Название предприятия (ООО, ИП и т.д.)"),y=(0,s.Uk)("Изменить"),W=(0,s.Uk)("Название предприятия непроверенное *"),U=(0,s.Uk)("Телефон *"),C=(0,s.Uk)("Электронная почта"),v=(0,s.Uk)("Подготовка (минут) *"),V=(0,s.Uk)("Категории товаров и услуг *"),b=(0,s.Uk)("Адрес *"),$=(0,s.Uk)("Пока адреса не добавлены"),O=(0,s.Uk)(" Добавить "),D=(0,s.Uk)("Изображения магазина в приложении *"),G=(0,s.Uk)(" Добавить "),S=(0,s.Uk)("Время работы *"),F=(0,s.Uk)(" Понедельник "),j=(0,s.Uk)("(выходной)"),x=(0,s.Uk)(" Вторник "),Z=(0,s.Uk)("(выходной)"),q=(0,s.Uk)(" Среда "),L=(0,s.Uk)("(выходной)"),z=(0,s.Uk)(" Четверг "),A=(0,s.Uk)("(выходной)"),M=(0,s.Uk)(" Пятница "),P=(0,s.Uk)("(выходной)"),B=(0,s.Uk)(" Суббота "),N=(0,s.Uk)("(выходной)"),T=(0,s.Uk)(" Воскресенье "),H=(0,s.Uk)("(выходной)"),J=(0,s.Uk)("Адинистраторы"),Y=(0,s.Uk)("Вы (Суперадмин)"),K=(0,s.Uk)("Добавить администратора");function Q(e,t,o,Q,X,R){const E=(0,s.up)("ion-label"),ee=(0,s.up)("ion-progress-bar"),te=(0,s.up)("ion-card-header"),oe=(0,s.up)("ion-text"),se=(0,s.up)("ion-card-content"),le=(0,s.up)("ion-card"),ie=(0,s.up)("ion-icon"),ae=(0,s.up)("ion-toggle"),re=(0,s.up)("ion-item"),ne=(0,s.up)("ion-item-divider"),me=(0,s.up)("ion-list"),_e=(0,s.up)("ion-button"),de=(0,s.up)("ion-input"),ue=(0,s.up)("ion-textarea"),ce=(0,s.up)("ion-col"),pe=(0,s.up)("ion-row"),he=(0,s.up)("ion-item-group"),we=(0,s.up)("ion-img"),Ie=(0,s.up)("ion-avatar"),ke=(0,s.up)("ion-checkbox"),ge=(0,s.up)("image-tile-comp"),fe=(0,s.up)("base-layout");return(0,s.wg)(),(0,s.j4)(fe,{"page-title":"Мой магазин","page-default-back-link":"/store-"+this.storeId},{default:(0,s.w5)((()=>[(0,s.Wm)(le,{color:X.validity_perc<X.validity_min?"danger":""},{default:(0,s.w5)((()=>[(0,s.Wm)(te,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Анкета заполнена на "+(0,l.zw)(X.validity_perc)+"%",1)])),_:1}),(0,s.Wm)(ee,{value:X.validity},null,8,["value"])])),_:1}),X.validity_perc<X.validity_min?((0,s.wg)(),(0,s.j4)(se,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(oe,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Вам необходимо заполнить анкету не меньше чем на "+(0,l.zw)(X.validity_min)+"% для рассмотрения модератором ",1)])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1},8,["color"]),R.message&&X.validity_perc>X.validity_min?((0,s.wg)(),(0,s.j4)(le,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(se,{class:(0,l.C_)(R.messageClass)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(R.message),1)])),_:1},8,["class"])])),_:1})):(0,s.kq)("",!0),X.storeItem?((0,s.wg)(),(0,s.j4)(me,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.storefrontOutline,color:"primary",slot:"start"},null,8,["src"]),a,(0,s.Wm)(ae,{slot:"end",modelValue:X.is_working,"onUpdate:modelValue":t[0]||(t[0]=e=>X.is_working=e),onIonChange:t[1]||(t[1]=e=>R.save("is_working",e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.trashOutline,color:"primary",slot:"start"},null,8,["src"]),r,(0,s.Wm)(ae,{slot:"end",modelValue:X.is_deleted,"onUpdate:modelValue":t[2]||(t[2]=e=>X.is_deleted=e),color:"danger",onIonChange:t[3]||(t[3]=e=>R.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.flagOutline,color:"primary",slot:"start"},null,8,["src"]),n,(0,s.Wm)(ae,{slot:"end",modelValue:X.is_primary,"onUpdate:modelValue":t[4]||(t[4]=e=>X.is_primary=e),onIonChange:t[5]||(t[5]=e=>R.save("is_primary",e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.searchOutline,color:"primary",slot:"start"},null,8,["src"]),m,(0,s.Wm)(ae,{slot:"end",modelValue:X.is_disabled,"onUpdate:modelValue":t[6]||(t[6]=e=>X.is_disabled=e),onIonChange:t[7]||(t[7]=e=>R.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[_])),_:1}),(0,s.Wm)(re,{onClick:t[8]||(t[8]=e=>R.productItemCreate()),button:""},{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.addOutline,slot:"start"},null,8,["src"]),d])),_:1})])),_:1})):(0,s.kq)("",!0),X.storeItem?((0,s.wg)(),(0,s.iD)("form",{key:2,onChange:t[47]||(t[47]=(...e)=>R.saveForm&&R.saveForm(...e))},[(0,s.Wm)(me,{lines:"full"},{default:(0,s.w5)((()=>[(0,s.Wm)(he,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[u])),_:1})])),_:1}),X.storeItem.store_name?((0,s.wg)(),(0,s.j4)(re,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[c])),_:1}),(0,s.Wm)(oe,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(X.storeItem.store_name)+" ",1),(0,s._)("div",null,[(0,s.Wm)(_e,{onClick:t[9]||(t[9]=e=>X.storeItem.store_name_new=X.storeItem.store_name)},{default:(0,s.w5)((()=>[p])),_:1})])])),_:1})])),_:1})):(0,s.kq)("",!0),X.storeItem.store_name_new||!X.storeItem.store_name?((0,s.wg)(),(0,s.j4)(re,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[h])),_:1}),(0,s.Wm)(de,{modelValue:X.storeItem.store_name_new,"onUpdate:modelValue":t[10]||(t[10]=e=>X.storeItem.store_name_new=e),name:"store_name_new"},null,8,["modelValue"]),R.isAdmin?((0,s.wg)(),(0,s.j4)(ie,{key:0,icon:Q.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[11]||(t[11]=e=>R.fieldApprove("store_name"))},null,8,["icon"])):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),X.storeItem.store_description?((0,s.wg)(),(0,s.j4)(re,{key:2},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[w])),_:1}),(0,s.Wm)(oe,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(X.storeItem.store_description)+" ",1),(0,s._)("div",null,[(0,s.Wm)(_e,{onClick:t[12]||(t[12]=e=>X.storeItem.store_description_new=X.storeItem.store_description)},{default:(0,s.w5)((()=>[I])),_:1})])])),_:1})])),_:1})):(0,s.kq)("",!0),X.storeItem.store_description_new||!X.storeItem.store_description?((0,s.wg)(),(0,s.j4)(re,{key:3},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[k])),_:1}),(0,s.Wm)(ue,{modelValue:X.storeItem.store_description_new,"onUpdate:modelValue":t[13]||(t[13]=e=>X.storeItem.store_description_new=e),name:"store_description_new",rows:"6"},null,8,["modelValue"]),R.isAdmin?((0,s.wg)(),(0,s.j4)(ie,{key:0,icon:Q.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[14]||(t[14]=e=>R.fieldApprove("store_description"))},null,8,["icon"])):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[g])),_:1}),(0,s.Wm)(de,{modelValue:X.storeItem.store_tax_num,"onUpdate:modelValue":t[15]||(t[15]=e=>X.storeItem.store_tax_num=e),name:"store_tax_num"},null,8,["modelValue"])])),_:1}),X.storeItem.store_company_name?((0,s.wg)(),(0,s.j4)(re,{key:4},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[f])),_:1}),(0,s.Wm)(oe,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(X.storeItem.store_company_name)+" ",1),(0,s._)("div",null,[(0,s.Wm)(_e,{onClick:t[16]||(t[16]=e=>X.storeItem.store_company_name_new=X.storeItem.store_company_name)},{default:(0,s.w5)((()=>[y])),_:1})])])),_:1})])),_:1})):(0,s.kq)("",!0),X.storeItem.store_company_name_new||!X.storeItem.store_company_name?((0,s.wg)(),(0,s.j4)(re,{key:5},{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[W])),_:1}),(0,s.Wm)(ue,{modelValue:X.storeItem.store_company_name_new,"onUpdate:modelValue":t[17]||(t[17]=e=>X.storeItem.store_company_name_new=e),name:"store_company_name_new"},null,8,["modelValue"]),R.isAdmin?((0,s.wg)(),(0,s.j4)(ie,{key:0,icon:Q.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[18]||(t[18]=e=>R.fieldApprove("store_company_name"))},null,8,["icon"])):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[U])),_:1}),(0,s.Wm)(de,{modelValue:X.storeItem.store_phone,"onUpdate:modelValue":t[19]||(t[19]=e=>X.storeItem.store_phone=e),name:"store_phone",type:"tel",inputmode:"tel",placeholder:"x(xxx)-xxx-xx-xx",onIonChange:t[20]||(t[20]=e=>R.phoneFormat()),spellcheck:"false",autocapitalize:"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[C])),_:1}),(0,s.Wm)(de,{modelValue:X.storeItem.store_email,"onUpdate:modelValue":t[21]||(t[21]=e=>X.storeItem.store_email=e),name:"store_email"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(pe,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ce,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Мин. заказ ("+(0,l.zw)(e.$heap.state.currencySign)+") *",1)])),_:1}),(0,s.Wm)(de,{modelValue:X.storeItem.store_minimal_order,"onUpdate:modelValue":t[22]||(t[22]=e=>X.storeItem.store_minimal_order=e),name:"store_minimal_order"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(ce,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[v])),_:1}),(0,s.Wm)(de,{modelValue:X.storeItem.store_time_preparation,"onUpdate:modelValue":t[23]||(t[23]=e=>X.storeItem.store_time_preparation=e),name:"store_time_preparation"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[V])),_:1})])),_:1}),(0,s.Wm)(me,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(X.storeGroupList,(t=>((0,s.wg)(),(0,s.j4)(re,{key:t.group_id},{default:(0,s.w5)((()=>[(0,s.Wm)(Ie,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Wm)(we,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.50.50.webp`},null,8,["src"])])),_:2},1024),(0,s.Uk)(" "+(0,l.zw)(t.group_name)+" ",1),(0,s.Wm)(ke,{color:"primary",slot:"end",checked:t.is_marked,onIonChange:e=>R.itemUpdateGroup(e.target.checked?1:0,t.group_id)},null,8,["checked","onIonChange"])])),_:2},1024)))),128))])),_:1}),(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[b])),_:1})])),_:1}),X.storeItem?.locations?.length?((0,s.wg)(),(0,s.j4)(me,{key:0},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(X.storeItem.locations,(t=>((0,s.wg)(),(0,s.j4)(re,{key:t.location_id},{default:(0,s.w5)((()=>[(0,s.Wm)(we,{slot:"start",src:`${e.$heap.state.hostname}/image/get.php/${t.image_hash}.32.32.png`},null,8,["src"]),(0,s.Wm)(E,{style:{"white-space":"normal",cursor:"pointer"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(t.location_address),1)])),_:2},1024),(0,s.Wm)(ie,{slot:"end",icon:Q.trash,onClick:e=>R.locationDelete(`${t.location_id}`)},null,8,["icon","onClick"])])),_:2},1024)))),128))])),_:1})):((0,s.wg)(),(0,s.j4)(me,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(oe,null,{default:(0,s.w5)((()=>[$])),_:1})])),_:1}),(0,s.Wm)(_e,{onClick:t[24]||(t[24]=e=>R.modalLocationCreate()),size:"small",expand:"full",color:"medium"},{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.locationOutline},null,8,["src"]),O])),_:1})])),_:1})),(0,s.Wm)(me,null,{default:(0,s.w5)((()=>[(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[D])),_:1})])),_:1}),(0,s.Wm)(ge,{images:X.storeItem.images,image_holder_id:X.storeItem.store_id,controller:"Store",ref:"storeImgs"},null,8,["images","image_holder_id"]),(0,s.Wm)(_e,{onClick:t[25]||(t[25]=t=>e.$refs.storeImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.cameraOutline},null,8,["src"]),G])),_:1})])),_:1}),(0,s.Wm)(me,null,{default:(0,s.w5)((()=>[(0,s.Wm)(he,{class:"schedule"},{default:(0,s.w5)((()=>[(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[S])),_:1})])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[F,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[j])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_0&&!X.storeItem.store_time_closes_0]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_0,"onUpdate:modelValue":t[26]||(t[26]=e=>X.storeItem.store_time_opens_0=e),name:"store_time_opens_0"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_0,"onUpdate:modelValue":t[27]||(t[27]=e=>X.storeItem.store_time_closes_0=e),name:"store_time_closes_0"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[28]||(t[28]=e=>{X.storeItem.store_time_opens_0=X.storeItem.store_time_closes_0=null,R.saveSchedule("0")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_0]])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[x,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[Z])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_1&&!X.storeItem.store_time_closes_1]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_1,"onUpdate:modelValue":t[29]||(t[29]=e=>X.storeItem.store_time_opens_1=e),name:"store_time_opens_1"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_1,"onUpdate:modelValue":t[30]||(t[30]=e=>X.storeItem.store_time_closes_1=e),name:"store_time_closes_1"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[31]||(t[31]=e=>{X.storeItem.store_time_opens_1=X.storeItem.store_time_closes_1=null,R.saveSchedule("1")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_1]])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[q,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[L])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_2&&!X.storeItem.store_time_closes_2]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_2,"onUpdate:modelValue":t[32]||(t[32]=e=>X.storeItem.store_time_opens_2=e),name:"store_time_opens_2"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_2,"onUpdate:modelValue":t[33]||(t[33]=e=>X.storeItem.store_time_closes_2=e),name:"store_time_closes_2"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[34]||(t[34]=e=>{X.storeItem.store_time_opens_2=X.storeItem.store_time_closes_2=null,R.saveSchedule("2")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_2]])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[z,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[A])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_3&&!X.storeItem.store_time_closes_3]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_3,"onUpdate:modelValue":t[35]||(t[35]=e=>X.storeItem.store_time_opens_3=e),name:"store_time_opens_3"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_3,"onUpdate:modelValue":t[36]||(t[36]=e=>X.storeItem.store_time_closes_3=e),name:"store_time_closes_3"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[37]||(t[37]=e=>{X.storeItem.store_time_opens_3=X.storeItem.store_time_closes_3=null,R.saveSchedule("3")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_3]])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[M,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[P])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_4&&!X.storeItem.store_time_closes_4]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_4,"onUpdate:modelValue":t[38]||(t[38]=e=>X.storeItem.store_time_opens_4=e),name:"store_time_opens_4"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_4,"onUpdate:modelValue":t[39]||(t[39]=e=>X.storeItem.store_time_closes_4=e),name:"store_time_closes_4"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[40]||(t[40]=e=>{X.storeItem.store_time_opens_4=X.storeItem.store_time_closes_4=null,R.saveSchedule("4")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_4]])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[B,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[N])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_5&&!X.storeItem.store_time_closes_5]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_5,"onUpdate:modelValue":t[41]||(t[41]=e=>X.storeItem.store_time_opens_5=e),name:"store_time_opens_5"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_5,"onUpdate:modelValue":t[42]||(t[42]=e=>X.storeItem.store_time_closes_5=e),name:"store_time_closes_5"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[43]||(t[43]=e=>{X.storeItem.store_time_opens_5=X.storeItem.store_time_closes_5=null,R.saveSchedule("5")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_5]])])),_:1}),(0,s.Wm)(re,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,{slot:"start"},{default:(0,s.w5)((()=>[T,(0,s.wy)((0,s.Wm)(E,null,{default:(0,s.w5)((()=>[H])),_:1},512),[[i.F8,!X.storeItem.store_time_opens_6&&!X.storeItem.store_time_closes_6]])])),_:1}),(0,s.Wm)(de,{placeholder:"от",modelValue:X.storeItem.store_time_opens_6,"onUpdate:modelValue":t[44]||(t[44]=e=>X.storeItem.store_time_opens_6=e),name:"store_time_opens_6"},null,8,["modelValue"]),(0,s.Wm)(de,{placeholder:"до",modelValue:X.storeItem.store_time_closes_6,"onUpdate:modelValue":t[45]||(t[45]=e=>X.storeItem.store_time_closes_6=e),name:"store_time_closes_6"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(ie,{src:Q.closeCircle,onClick:t[46]||(t[46]=e=>{X.storeItem.store_time_opens_6=X.storeItem.store_time_closes_6=null,R.saveSchedule("6")})},null,8,["src"]),[[i.F8,X.storeItem.store_time_closes_6]])])),_:1})])),_:1})])),_:1})],32)):(0,s.kq)("",!0),X.storeItem?((0,s.wg)(),(0,s.j4)(me,{key:3},{default:(0,s.w5)((()=>[(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[J])),_:1})])),_:1}),(e.$heap.state.user.user_id=X.storeItem.owner_id)?((0,s.wg)(),(0,s.j4)(re,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.personOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[Y])),_:1})])),_:1})):(0,s.kq)("",!0),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(X.ownerList,(e=>((0,s.wg)(),(0,s.j4)(re,{key:e.user_id},{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.personOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.user_phone),1)])),_:2},1024),(0,s.Wm)(ie,{src:Q.trashOutline,slot:"end",onClick:t=>R.ownerDelete(e.user_id)},null,8,["src","onClick"])])),_:2},1024)))),128)),(0,s.Wm)(re,{button:"",onClick:t[48]||(t[48]=e=>R.ownerAdd())},{default:(0,s.w5)((()=>[(0,s.Wm)(ie,{src:Q.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.Wm)(E,null,{default:(0,s.w5)((()=>[K])),_:1})])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1},8,["page-default-back-link"])}var X=o(4508),R=o(8903),E=o(2126),ee=o(8883),te=o(2008),oe=o(9755),se=o.n(oe),le=o(351),ie={components:{IonInput:X.pK,IonTextarea:X.g2,IonToggle:X.ho,IonCard:X.PM,IonCardContent:X.FN,IonCardHeader:X.Zi,IonCheckbox:X.nz,IonIcon:X.gu,IonItem:X.Ie,IonList:X.q_,IonLabel:X.Q$,IonItemDivider:X.rH,IonText:X.yW,IonCol:X.wI,IonRow:X.Nd,IonItemGroup:X.Ub,IonImg:X.Xz,IonAvatar:X.BJ,IonButton:X.YG,IonProgressBar:X.X7,imageTileComp:E.Z},setup(){return{cameraOutline:R.kuq,trash:R._Ij,trashOutline:R.gtu,locationOutline:R.Iv7,storefrontOutline:R.qRG,flagOutline:R.FMn,searchOutline:R.W6I,personOutline:R.QJ7,addOutline:R.s6O,checkmarkCircleOutline:R.Nwd,chevronBack:R.Mny,closeCircle:R.XZx}},data(){return{storeId:this.$route.params.id,storeItem:null,storeGroupList:null,ownerList:null,is_deleted:0,is_disabled:0,is_working:0,is_primary:0,validity:0,validity_perc:100,validity_min:90}},computed:{isPhoneValid(){return[11,12].includes(this.storeItem.user_phone.replace(/\D/g,"").length)},isAdmin(){return le.Z.isAdmin()},message(){return this.storeItem?this.storeItem?.deleted_at?"Предприятие не активно и будет удалено. Вы еще можете отменить удаление":1==this.storeItem?.is_disabled?"Предприятие не активно и находится на рассмотрении у администратора":0==this.storeItem?.is_working?"Предприятие отмечено вами как времено не готовое к заказам. Например, в связи с праздниками":1==this.storeItem?.is_primary?"Предприятие активно и готово принимать заказы в рабочее время. Является опорным":"Предприятие активно и готово принимать заказы в рабочее время.":null},messageClass(){return this.storeItem?.deleted_at?"deleted":1==this.storeItem?.is_disabled?"disabled":1==this.storeItem?.is_primary?"primary":1!=this.storeItem?.is_working?"notworking":"active"}},created(){this.listGroupGet(),this.itemGet(),this.ownerListGet()},methods:{async itemGet(){try{this.storeItem=await se().post(te.Z.state.hostname+"Store/itemGet",{store_id:this.storeId}),this.itemParseFlags(),this.itemMarkGroups(),this.itemValidityCalc()}catch{}},itemMarkGroups(){if(this.storeItem&&this.storeGroupList)try{const e=this.storeItem.member_of_groups.group_ids.split(",");for(let t of this.storeGroupList)t.is_marked=e.includes(t.group_id);this.is_groups_marked=1}catch{}else this.is_groups_marked=0},itemParseFlags(){this.is_deleted=null==this.storeItem.deleted_at?0:1,this.is_disabled=0==this.storeItem.is_disabled?0:1,this.is_working=0==this.storeItem.is_working?0:1,this.is_primary=1==this.storeItem.is_primary?1:0},itemValidityCalc(){const e=["store_name|store_name_new","store_description|store_description_new","store_company_name|store_company_name_new","store_phone","store_tax_num","store_minimal_order","store_time_preparation","store_time_opens_0|store_time_opens_1|store_time_opens_2|store_time_opens_3|store_time_opens_4|store_time_opens_5|store_time_opens_6|store_time_closes_0|store_time_closes_1|store_time_closes_2|store_time_closes_3|store_time_closes_4|store_time_closes_5|store_time_closes_6","images","locations","member_of_groups.group_ids"],t=e.length;let o=0;for(const s of e){let e=0;for(const t of s.split("|")){let o=null;const s=t.split(".");if(o=s[1]?this.storeItem[s[0]][s[1]]:this.storeItem[s[0]],o?.length>0){e=1;break}}o+=e}this.validity=o/t,this.validity_perc=Math.round(100*this.validity)},async itemDelete(e){const t=e?"itemDelete":"itemUnDelete";try{await se().post(te.Z.state.hostname+"Store/"+t,{store_id:this.storeId}),this.storeItem.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.storeItem.is_disabled!=e)try{await se().post(te.Z.state.hostname+"Store/itemDisable",{store_id:this.storeId,is_disabled:e}),this.storeItem.is_disabled=e}catch{this.itemGet()}},async productItemCreate(){try{const e={store_id:this.storeId,product_name:"Новый товар",product_price:1e3,product_promo_price:1e3},t=await se().post(`${te.Z.state.hostname}Product/itemCreate`,e);this.$router.push(`product-edit-${t}`)}catch{this.$flash("Не удалось создать товар")}},saveForm(e){const t=e.target.name,o=this.storeItem[t];t.indexOf("store_time")>-1?this.saveSchedule(t):this.save(t,o)},saveSchedule(e){const t=e.split("_").pop();let o=this.storeItem["store_time_opens_"+t],s=this.storeItem["store_time_closes_"+t];o=""==o||null==o?null:Number(o),s=""==s||null==s?null:Number(s),o>24&&(o=0),s>24&&(s=0),(o>=s&&null!=s||0==s)&&(s=o+1,this.$flash("Время закрытия должно быть позже открытия"));const l={store_id:this.storeId,["store_time_opens_"+t]:o,["store_time_closes_"+t]:s};this.storeItem["store_time_opens_"+t]!=o&&(this.storeItem["store_time_opens_"+t]=o),this.storeItem["store_time_closes_"+t]!=s&&(this.storeItem["store_time_closes_"+t]=s),this.itemValidityCalc(),this.itemUpdate(l)},async save(e,t){if("user_phone"==e){if(!this.isPhoneValid)return!1;t=t.replace(/\D/g,"")}if(!e)return;let o={store_id:this.storeId,[e]:t};this.storeItem[e]=t,this.itemValidityCalc(),this.itemUpdate(o),this.itemParseFlags()},async itemUpdate(e){try{e["validity"]=this.validity_perc,await se().post(te.Z.state.hostname+"Store/itemUpdate",JSON.stringify(e))}catch(t){this.$flash("Не удалось сохранить изменение"),this.itemGet()}},phoneFormat(){this.storeItem.store_phone||(this.storeItem.store_phone="");try{let e=this.storeItem.store_phone.replace(/\D/g,"");e.length>10&&(e=e.substring(e.length-10)),this.storeItem.store_phone=e}catch{}},async fieldApprove(e){let t={store_id:this.storeId,field_name:e};try{await se().post(te.Z.state.hostname+"Store/fieldApprove",t)}catch(o){const e=o.responseJSON.messages.error;e?.includes("store_description")?this.$flash("Описание слишком короткое"):e?.includes("store_name")?this.$flash("Название слишком короткое"):this.$flash("Не удалось сохранить изменение")}this.itemGet()},async itemUpdateGroup(e,t){const o={store_id:this.storeId,is_joined:e,group_id:t};try{await se().post(te.Z.state.hostname+"Store/itemUpdateGroup",o)}catch(s){this.$flash("Не удалось сохранить изменение")}this.itemGet()},async listGroupGet(){try{this.storeGroupList=await se().get(te.Z.state.hostname+"Store/listGroupGet"),this.itemMarkGroups()}catch{}},async ownerListGet(){try{this.ownerList=await se().post(te.Z.state.hostname+"Store/ownerListGet",{store_id:this.storeId})}catch{}},async ownerAdd(){let e=prompt("Введите номер телефона нового администратора");if(e)if(e=e.replace(/\D/g,""),[11,12].includes(e.length))try{await se().post(te.Z.state.hostname+"Store/ownerSave",{store_id:this.storeId,action:"add",owner_phone:e}),this.ownerListGet()}catch{this.$flash("Не удалось добавить администратора")}else this.$flash("Проверьте правильность телефона")},async ownerDelete(e){if(confirm("Удалить этого пользователя из администраторов магазина?"))try{await se().post(te.Z.state.hostname+"Store/ownerSave",{store_id:this.storeId,action:"delete",owner_id:e}),this.ownerListGet()}catch{this.$flash("Не удалось удалить администратора")}},async modalLocationCreate(){if(!te.Z.state.user.user_id)return this.$flash("Чтобы добавленные адреса сохранились, пожалуйста войдите в систему"),void this.$router.push({name:"UserSignIn"});var e="рабочий";const t=await X.Fy.create({component:ee.Z,showBackdrop:!0,backdropDismiss:!0,componentProps:{location_group_name_low:e}});return t.onDidDismiss().then((e=>{this.locationCreate(e.data)})),t.present()},async locationCreate(e){if(!e)return;const t={location_holder:"store",location_holder_id:this.storeId,location_group_type:"address_work",location_address:e.location_address,location_latitude:e.location_latitude,location_longitude:e.location_longitude};try{await se().post(te.Z.state.hostname+"Store/locationCreate",t),this.itemGet()}catch(o){const e=o.responseJSON?.messages?.error;"limit_exeeded"==e&&this.$flash("Больше адресов добавить нельзя")}},async locationDelete(e){try{await se().post(te.Z.state.hostname+"Store/locationDelete",{location_id:e}),this.itemGet()}catch{}}}},ae=o(3744);const re=(0,ae.Z)(ie,[["render",Q],["__scopeId","data-v-79afb97b"]]);var ne=re}}]);
//# sourceMappingURL=64.a7ec2081.js.map