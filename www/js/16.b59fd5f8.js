"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[16],{5016:function(t,e,i){i.r(e),i.d(e,{default:function(){return M}});var o=i(6252),r=i(3577);const a={key:0,style:{"background-color":"var(--ion-color-light-tint)",padding:"10px"}},l=(0,o.Uk)("Найденные товары"),n={style:{display:"grid","grid-template-columns":"1fr 1fr 1fr",width:"100%"}},s={style:{"text-align":"right"}},u={style:{"text-align":"right"}},d={style:{"grid-column":"1/-1"}},c={style:{margin:"10px",display:"grid","grid-template-columns":"repeat(auto-fit, 150px)"}},p={key:1};function m(t,e,i,m,_,h){const y=(0,o.up)("ion-searchbar"),g=(0,o.up)("ion-title"),v=(0,o.up)("ion-img"),w=(0,o.up)("ion-thumbnail"),f=(0,o.up)("ion-chip"),k=(0,o.up)("ion-note"),I=(0,o.up)("ion-item"),$=(0,o.up)("product-item"),b=(0,o.up)("ion-list"),z=(0,o.up)("base-layout");return(0,o.wg)(),(0,o.j4)(z,{"page-title":"Поиск товаров",pageDefaultBackLink:"/home"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{class:"search-container",modelValue:_.query,"onUpdate:modelValue":e[0]||(e[0]=t=>_.query=t),onInput:e[1]||(e[1]=t=>h.delayedListGet()),placeholder:"начните искать"},null,8,["modelValue"]),_.found?((0,o.wg)(),(0,o.iD)("div",a,[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[l])),_:1}),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.found.product_matches,(e=>((0,o.wg)(),(0,o.j4)(b,{key:e.store_id,style:{"border-radius":"10px","margin-top":"30px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(I,{detail:"",button:"",onClick:i=>t.$router.push(`store-${e.store_id}`),lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{slot:"start"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{style:{"border-radius":"10px"},src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.150.150.webp`},null,8,["src"])])),_:2},1024),(0,o._)("div",n,[(0,o._)("div",null,[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e?.store_name),1)])),_:2},1024)]),(0,o._)("div",s,[e.is_opened?((0,o.wg)(),(0,o.j4)(f,{key:0,color:"success"},{default:(0,o.w5)((()=>[(0,o.Uk)("Открыт до "+(0,r.zw)(e.store_time_closes)+":00",1)])),_:2},1024)):((0,o.wg)(),(0,o.j4)(f,{key:1,color:"danger"},{default:(0,o.w5)((()=>[(0,o.Uk)("Закрыт до "+(0,r.zw)(e.store_time_opens)+":00",1)])),_:2},1024))]),(0,o._)("div",u,[e.deliveryTime.timeMin?((0,o.wg)(),(0,o.j4)(f,{key:0,color:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.deliveryTime.timeMin)+"-"+(0,r.zw)(e.deliveryTime.timeMax)+"мин",1)])),_:2},1024)):(0,o.kq)("",!0)]),(0,o._)("div",d,[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.store_description),1)])),_:2},1024)])])])),_:2},1032,["onClick"]),(0,o._)("div",c,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.matches,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.product_id},[(0,o.Wm)($,{productItem:t},null,8,["productItem"])])))),128))])])),_:2},1024)))),128))])):((0,o.wg)(),(0,o.iD)("div",p," Ничего не найдено "))])),_:1})}var _=i(9755),h=i.n(_),y=i(7873),g=i(4405);const v=["id"],w={class:"product_list_item_img"},f={style:{position:"relative",top:"-50%"}},k={style:{height:"3.5em",overflow:"hidden"}},I={key:0,style:{color:"var(--ion-color-danger)"}},$=(0,o.Uk)("   "),b={style:{color:"var(--ion-color-primary)"}},z=(0,o.Uk)(" / "),C={style:{color:"var(--ion-color-medium)"}};function T(t,e,i,a,l,n){const s=(0,o.up)("cart-add-buttons"),u=(0,o.up)("ion-img");return(0,o.wg)(),(0,o.iD)("div",{class:(0,r.C_)(i.productItem.product_quantity>0?"":"absent"),id:`product_list_item${i.productItem.product_id}`},[(0,o._)("div",w,[(0,o._)("div",f,[(0,o.Wm)(s,{buttonLayout:"vertical",productItem:i.productItem},null,8,["productItem"])]),(0,o.Wm)(u,{onClick:e[0]||(e[0]=e=>t.$router.push(`product-${i.productItem.product_id}`)),src:`${t.$heap.state.hostname}image/get.php/${i.productItem.image_hash}.150.150.webp`},null,8,["src"])]),(0,o._)("div",k,[i.productItem.product_price!=i.productItem.product_final_price?((0,o.wg)(),(0,o.iD)("span",I,[(0,o._)("s",null,(0,r.zw)(i.productItem.product_price)+(0,r.zw)(t.$heap.state.currencySign),1),$])):(0,o.kq)("",!0),(0,o._)("span",b,(0,r.zw)(i.productItem.product_final_price)+(0,r.zw)(t.$heap.state.currencySign),1),z,(0,o._)("span",C,(0,r.zw)(i.productItem.product_unit),1),(0,o._)("div",{style:{color:"black"},onClick:e[1]||(e[1]=e=>t.$router.push(`product-${i.productItem.product_id}`))},(0,r.zw)(i.productItem.product_name),1)])],10,v)}var q=i(6782),x={props:["productItem"],components:{CartAddButtons:q.Z}},D=i(3744);const W=(0,D.Z)(x,[["render",T],["__scopeId","data-v-24b91e31"]]);var G=W,U={components:{IonSearchbar:y.VI,ProductItem:G},data(){return{query:this.$route.query.q||"",found:null}},ionViewDidEnter(){this.delayedListGet()},created(){this.delayedListGet()},methods:{async listGet(){const t={query:this.query,in_products:1,in_stores:0,location_id:this.locMainGet()};try{const e=await h().get(this.$heap.state.hostname+"Search/listGet",t);this.found=this.storeListCalculate(e)}catch{this.found="void"}},storeListCalculate(t){for(let e in t.product_matches)t.product_matches[e].deliveryTime=g.Z.deliveryTimeCalculate(t.product_matches[e].distance,t.product_matches[e].store_time_preparation);return t},locMainGet(){return this.$heap.state.user.location_main?this.$heap.state.user.location_main.location_id:null},delayedListGet(){clearTimeout(this.clock);const t=this;this.clock=setTimeout((()=>{t.listGet()}),200)}}};const L=(0,D.Z)(U,[["render",m],["__scopeId","data-v-04dbd670"]]);var M=L},4405:function(t,e,i){var o=i(2008);const r={deliveryCalculate(t){if(!t.locations||!t.locations[0]||!t.locations[0].distance)return null;const e=t.locations[0].distance,i=t.store_time_preparation||0;return r.deliveryTimeCalculate(e,i)},deliveryTimeCalculate(t,e){e=e??o.Z.state.deliverySettings.defaultPreparationTime;const i=o.Z.state.deliverySettings.deliveryTimeDelta,r=5*Math.round(t/o.Z.state.deliverySettings.courierVelocity*60/5)+parseInt(e),a=r>i?r-i:r,l=a+i;return{time:r,timeMin:a,timeMax:l}}};e["Z"]=r}}]);
//# sourceMappingURL=16.b59fd5f8.js.map