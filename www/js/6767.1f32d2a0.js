"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[6767],{6178:function(e,t,o){o.d(t,{Z:function(){return h}});var s=o(6252),l=o(3577);const i={style:{position:"absolute",top:"30px",width:"100%","--ion-item-background":"#ffffffdd","border-radius":"10px"}},r={slot:"end",style:{color:"#666"}};function a(e,t,o,a,n,m){const d=(0,s.up)("ymap-marker"),_=(0,s.up)("yandex-map"),u=(0,s.up)("ion-searchbar"),c=(0,s.up)("ion-item"),p=(0,s.up)("ion-content"),h=(0,s.up)("ion-textarea"),f=(0,s.up)("ion-icon"),w=(0,s.up)("ion-button"),k=(0,s.up)("ion-toolbar");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(p,null,{default:(0,s.w5)((()=>[(0,s.Wm)(_,{onClick:t[0]||(t[0]=e=>m.onClick(e)),style:{height:"100%"},coords:n.coords,zoom:16,settings:n.settings,controls:["zoomControl"]},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{coords:n.coords,"marker-id":"1",properties:n.placemarkProperties},null,8,["coords","properties"])])),_:1},8,["coords","settings"]),(0,s._)("div",i,[(0,s.Wm)(u,{debounce:"500",modelValue:n.addressSearchQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>n.addressSearchQuery=e),onIonInput:t[2]||(t[2]=e=>m.suggestionsGet()),placeholder:"поиск по адресу",color:"light"},null,8,["modelValue"]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.suggestions,((e,t)=>((0,s.wg)(),(0,s.j4)(c,{key:t,onClick:t=>m.suggestionSelect(`${e.subtitle.text}, ${e.title.text}`,e.uri),style:{"margin-right":"10px","margin-left":"10px"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.subtitle.text)+" "+(0,l.zw)(e.title.text)+" ",1),(0,s._)("span",r,(0,l.zw)(e.distance.text),1)])),_:2},1032,["onClick"])))),128))])])),_:1}),(0,s.Wm)(k,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,{label:"комментарий к адресу","label-placement":"floating",modelValue:n.addressComment,"onUpdate:modelValue":t[3]||(t[3]=e=>n.addressComment=e)},null,8,["modelValue"]),(0,s.Wm)(w,{strong:!0,onClick:t[4]||(t[4]=e=>m.pickAddress()),color:"primary",expand:"block"},{default:(0,s.w5)((()=>[(0,s.Wm)(f,{src:a.checkmark,slot:"start"},null,8,["src"]),(0,s.Uk)(" Ок ")])),_:1}),(0,s.Wm)(w,{onClick:t[5]||(t[5]=e=>a.closeModal()),color:"light",expand:"block"},{default:(0,s.w5)((()=>[(0,s.Uk)("Закрыть")])),_:1})])),_:1})],64)}o(7658);var n=o(4929),m=o(5836),d=o(8903),_=o(351),u={components:{IonContent:n.W2,IonToolbar:n.sr,IonButton:n.YG,IonSearchbar:n.VI,IonIcon:n.gu,IonItem:n.Ie,IonTextarea:n.g2,yandexMap:m.xR,ymapMarker:m.Jk},setup(){const e=function(){n.Fy.dismiss()};return{closeModal:e,locationOutline:d.Iv7,closeOutline:d.fID,checkmark:d.d29}},props:{location_group_name_low:String,location_group_id:Number},data(){let e=this.location_group_name_low+" адрес",t=this.$heap.state.settings.location,o=JSON.parse(t.mapCenter);return{settings:{apiKey:t.ymapApiKey,lang:"ru_RU",coordorder:"latlong",version:"2.1"},placemarkProperties:{iconCaption:e},suggestions:[],addressSearchQuery:null,locationType:e,locSettings:t,selectedPlacemark:0,selectedAddress:"",selectedCoords:[],coords:o,addressComment:""}},methods:{async pickAddress(){try{if(!this.selectedAddress){var e;const t=await window.ymaps.geocode(this.coords);this.selectedAddress=null===(e=t.geoObjects.get(0))||void 0===e?void 0:e.getAddressLine()}}catch(o){}var t={location_address:this.filterAddress(this.selectedAddress),location_latitude:this.coords[0],location_longitude:this.coords[1],location_comment:this.addressComment};n.Fy.dismiss(t)},filterAddress(e){const t=this.locSettings.addressErase.split(", "),o=e.split(", ");let s=[];for(const l of o)t.find((e=>e==l))||s.push(l);return s.reverse().join(", ")},onClick(e){e&&e.get&&(this.suggestions=[],this.selectedAddress=null,this.coords=e.get("coords"))},async suggestionsGet(){if(this.addressSearchQuery)try{const e=this.$heap.state.settings.location.ymapSuggestionApiKey,t=this.coords.slice().reverse().join(","),o=await fetch(`https://suggest-maps.yandex.ru/v1/suggest?apikey=${e}&lang=ru_RU&ll=${t}&spn=1,1&attrs=uri&types=house&results=5&text=${this.addressSearchQuery}`),s=await o.json();this.suggestions=s.results||[]}catch{}else this.suggestions=[]},async suggestionSelect(e,t){this.selectedAddress=e,this.geocode(t)},async geocode(e){try{this.suggestions=[];const t=this.$heap.state.settings.location.ymapApiKey,o=await fetch(`https://geocode-maps.yandex.ru/1.x?apikey=${t}&format=json&results=1&uri=${e}`),s=await o.json(),l=s.response.GeoObjectCollection.featureMember[0].GeoObject;this.coords=l.Point.pos.split(" ").reverse()}catch(t){console.log(t)}}},async mounted(){await(0,m.xk)();const e=_.Z.geo.lastStoredGet();null!==e&&void 0!==e&&e.location_latitude&&(this.coords=[e.location_latitude,e.location_longitude]);const t=await _.Z.geo.get();if(t){const{coords:e}=t;this.coords=[e.latitude,e.longitude],this.$flash("На карте отмечено ваше местоположение")}}},c=o(3744);const p=(0,c.Z)(u,[["render",a]]);var h=p},6767:function(e,t,o){o.r(t),o.d(t,{default:function(){return U}});var s=o(6252),l=o(3577),i=o(9963);const r={key:0},a={key:0};function n(e,t,o,n,m,d){var _,u;const c=(0,s.up)("ion-label"),p=(0,s.up)("ion-progress-bar"),h=(0,s.up)("ion-card-header"),f=(0,s.up)("ion-text"),w=(0,s.up)("ion-card-content"),k=(0,s.up)("ion-card"),I=(0,s.up)("ion-icon"),g=(0,s.up)("ion-toggle"),y=(0,s.up)("ion-item"),W=(0,s.up)("ion-item-divider"),v=(0,s.up)("ion-list"),U=(0,s.up)("ion-button"),V=(0,s.up)("ion-input"),C=(0,s.up)("ion-textarea"),b=(0,s.up)("ion-item-group"),O=(0,s.up)("ion-img"),S=(0,s.up)("ion-avatar"),$=(0,s.up)("ion-checkbox"),G=(0,s.up)("image-tile-comp"),x=(0,s.up)("ion-note"),D=(0,s.up)("base-layout");return(0,s.wg)(),(0,s.j4)(D,{"page-title":null!==(_=null===(u=this.storeItem)||void 0===u?void 0:u.store_name)&&void 0!==_?_:"Мой магазин",pageDefaultBackLink:`/catalog/store-${m.storeId}`},{default:(0,s.w5)((()=>{var o,_;return[m.storeItem?((0,s.wg)(),(0,s.iD)("div",r,[(0,s.Wm)(k,{color:m.validity_perc<m.validity_min?"danger":""},{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Анкета заполнена на "+(0,l.zw)(m.validity_perc)+"%",1)])),_:1}),(0,s.Wm)(p,{value:m.validity},null,8,["value"])])),_:1}),m.validity_perc<m.validity_min?((0,s.wg)(),(0,s.j4)(w,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Вам необходимо заполнить анкету не меньше чем на "+(0,l.zw)(m.validity_min)+"% для рассмотрения модератором ",1)])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1},8,["color"]),d.message&&m.validity_perc>m.validity_min?((0,s.wg)(),(0,s.j4)(k,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(w,{class:(0,l.C_)(d.messageClass)},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(d.message),1)])),_:1},8,["class"])])),_:1})):(0,s.kq)("",!0),m.storeItem?((0,s.wg)(),(0,s.j4)(v,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.checkmarkCircleOutline,color:"primary",slot:"start"},null,8,["src"]),(0,s.Uk)(" Готово к заказам "),(0,s.Wm)(g,{slot:"end",modelValue:m.is_working,"onUpdate:modelValue":t[0]||(t[0]=e=>m.is_working=e),onIonChange:t[1]||(t[1]=e=>d.save("is_working",e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.trashOutline,color:"primary",slot:"start"},null,8,["src"]),(0,s.Uk)(" Удалено "),(0,s.Wm)(g,{slot:"end",modelValue:m.is_deleted,"onUpdate:modelValue":t[2]||(t[2]=e=>m.is_deleted=e),color:"danger",onIonChange:t[3]||(t[3]=e=>d.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.flagOutline,color:"primary",slot:"start"},null,8,["src"]),(0,s.Uk)(" Опорное "),(0,s.Wm)(g,{slot:"end",modelValue:m.is_primary,"onUpdate:modelValue":t[4]||(t[4]=e=>m.is_primary=e),onIonChange:t[5]||(t[5]=e=>d.save("is_primary",e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.ribbonOutline,color:"primary",slot:"start"},null,8,["src"]),(0,s.Uk)(" На модерации "),(0,s.Wm)(g,{slot:"end",modelValue:m.is_disabled,"onUpdate:modelValue":t[6]||(t[6]=e=>m.is_disabled=e),onIonChange:t[7]||(t[7]=e=>d.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,s.Wm)(W),(0,s.Wm)(y,{button:"",onClick:t[8]||(t[8]=t=>e.$go("/catalog/store-"+m.storeId))},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.chevronBack,slot:"start"},null,8,["src"]),(0,s.Uk)(" Показать "+(0,l.zw)(m.storeItem.store_name),1)])),_:1}),(0,s.Wm)(y,{onClick:t[9]||(t[9]=t=>e.$go(`/catalog/store-edit-products-${m.storeId}`)),button:""},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.chevronBack,slot:"start"},null,8,["src"]),(0,s.Uk)(" Быстрое управление товарами ")])),_:1}),(0,s.Wm)(y,{onClick:t[10]||(t[10]=e=>d.productItemCreate()),button:""},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.addOutline,slot:"start"},null,8,["src"]),(0,s.Uk)(" Добавить товар в "+(0,l.zw)(m.storeItem.store_name),1)])),_:1})])),_:1})):(0,s.kq)("",!0),m.storeItem?((0,s.wg)(),(0,s.iD)("form",{key:2,onChange:t[55]||(t[55]=(...e)=>d.saveForm&&d.saveForm(...e))},[(0,s.Wm)(v,{lines:"full"},{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Основные настройки")])),_:1})])),_:1}),m.storeItem.store_name?((0,s.wg)(),(0,s.j4)(y,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Название")])),_:1}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(m.storeItem.store_name)+" ",1),(0,s._)("div",null,[(0,s.Wm)(U,{onClick:t[11]||(t[11]=e=>{m.is_name_edited=1,m.storeItem.store_name_new=m.storeItem.store_name,d.save("store_name_new",m.storeItem.store_name_new)})},{default:(0,s.w5)((()=>[(0,s.Uk)("Изменить")])),_:1})])])),_:1})])),_:1})):(0,s.kq)("",!0),m.is_name_edited||!m.storeItem.store_name?((0,s.wg)(),(0,s.j4)(y,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Название непроверенное *")])),_:1}),(0,s.Wm)(V,{modelValue:m.storeItem.store_name_new,"onUpdate:modelValue":t[12]||(t[12]=e=>m.storeItem.store_name_new=e),name:"store_name_new"},null,8,["modelValue"]),d.isAdmin?((0,s.wg)(),(0,s.j4)(I,{key:0,icon:n.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[13]||(t[13]=e=>d.fieldApprove("store_name"))},null,8,["icon"])):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),m.storeItem.store_description?((0,s.wg)(),(0,s.j4)(y,{key:2},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Описание")])),_:1}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(m.storeItem.store_description)+" ",1),(0,s._)("div",null,[(0,s.Wm)(U,{onClick:t[14]||(t[14]=e=>{m.is_desc_edited=1,m.storeItem.store_description_new=m.storeItem.store_description,d.save("store_description_new",m.storeItem.store_description_new)})},{default:(0,s.w5)((()=>[(0,s.Uk)("Изменить")])),_:1})])])),_:1})])),_:1})):(0,s.kq)("",!0),m.is_desc_edited||!m.storeItem.store_description?((0,s.wg)(),(0,s.j4)(y,{key:3},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Описание непроверенное *")])),_:1}),(0,s.Wm)(C,{modelValue:m.storeItem.store_description_new,"onUpdate:modelValue":t[15]||(t[15]=e=>m.storeItem.store_description_new=e),name:"store_description_new",rows:"6"},null,8,["modelValue"]),d.isAdmin?((0,s.wg)(),(0,s.j4)(I,{key:0,icon:n.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[16]||(t[16]=e=>d.fieldApprove("store_description"))},null,8,["icon"])):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("ИНН *")])),_:1}),(0,s.Wm)(V,{modelValue:m.storeItem.store_tax_num,"onUpdate:modelValue":t[17]||(t[17]=e=>m.storeItem.store_tax_num=e),name:"store_tax_num"},null,8,["modelValue"])])),_:1}),m.storeItem.store_company_name?((0,s.wg)(),(0,s.j4)(y,{key:4},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Название предприятия (ООО, ИП и т.д.)")])),_:1}),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(m.storeItem.store_company_name)+" ",1),(0,s._)("div",null,[(0,s.Wm)(U,{onClick:t[18]||(t[18]=e=>{m.storeItem.store_company_name_new=m.storeItem.store_company_name,d.save("store_company_name_new",m.storeItem.store_company_name_new)})},{default:(0,s.w5)((()=>[(0,s.Uk)("Изменить")])),_:1})])])),_:1})])),_:1})):(0,s.kq)("",!0),m.storeItem.store_company_name_new||!m.storeItem.store_company_name?((0,s.wg)(),(0,s.j4)(y,{key:5},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Название предприятия непроверенное *")])),_:1}),(0,s.Wm)(C,{modelValue:m.storeItem.store_company_name_new,"onUpdate:modelValue":t[19]||(t[19]=e=>m.storeItem.store_company_name_new=e),name:"store_company_name_new"},null,8,["modelValue"]),d.isAdmin?((0,s.wg)(),(0,s.j4)(I,{key:0,icon:n.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[20]||(t[20]=e=>d.fieldApprove("store_company_name"))},null,8,["icon"])):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Телефон *")])),_:1}),(0,s.Wm)(V,{modelValue:m.storeItem.store_phone,"onUpdate:modelValue":t[21]||(t[21]=e=>m.storeItem.store_phone=e),name:"store_phone",type:"tel",inputmode:"tel",placeholder:"x(xxx)-xxx-xx-xx",onIonChange:t[22]||(t[22]=e=>d.phoneFormat()),spellcheck:"false",autocapitalize:"off"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{position:"stacked",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Uk)("Электронная почта")])),_:1}),(0,s.Wm)(V,{modelValue:m.storeItem.store_email,"onUpdate:modelValue":t[23]||(t[23]=e=>m.storeItem.store_email=e),name:"store_email"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Заказы и своя доставка")])),_:1})])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{icon:n.cartOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Подготовка (минут)*")])),_:1}),(0,s.Wm)(V,{slot:"end",modelValue:m.storeItem.store_time_preparation,"onUpdate:modelValue":t[24]||(t[24]=e=>m.storeItem.store_time_preparation=e),name:"store_time_preparation"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{icon:n.cartOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Мин. заказ ("+(0,l.zw)(e.$heap.state.currencySign)+")*",1)])),_:1}),(0,s.Wm)(V,{slot:"end",modelValue:m.storeItem.store_minimal_order,"onUpdate:modelValue":t[25]||(t[25]=e=>m.storeItem.store_minimal_order=e),name:"store_minimal_order"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{icon:n.storefrontOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Самовывоз разрешен")])),_:1}),(0,s.Wm)(g,{slot:"end",modelValue:m.storeItem.store_pickup_allow,"onUpdate:modelValue":t[26]||(t[26]=e=>m.storeItem.store_pickup_allow=e),onIonChange:t[27]||(t[27]=e=>d.save("store_pickup_allow",e.target.checked?1:0)),name:"store_pickup_allow"},null,8,["modelValue"])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{icon:n.rocketOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Своя доставка")])),_:1}),(0,s.Wm)(g,{slot:"end",modelValue:m.storeItem.store_delivery_allow,"onUpdate:modelValue":t[28]||(t[28]=e=>m.storeItem.store_delivery_allow=e),onIonChange:t[29]||(t[29]=e=>d.save("store_delivery_allow",e.target.checked?1:0)),name:"store_delivery_allow"},null,8,["modelValue"])])),_:1}),1==m.storeItem.store_delivery_allow?((0,s.wg)(),(0,s.j4)(y,{key:0},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{icon:n.rocketOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Своя доставка ("+(0,l.zw)(e.$heap.state.currencySign)+")",1)])),_:1}),(0,s.Wm)(V,{slot:"end",modelValue:m.storeItem.store_delivery_cost,"onUpdate:modelValue":t[30]||(t[30]=e=>m.storeItem.store_delivery_cost=e),name:"store_delivery_cost"},null,8,["modelValue"])])),_:1})):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Категории товаров и услуг *")])),_:1})])),_:1}),(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(d.storeGroupListComp,(t=>((0,s.wg)(),(0,s.j4)(y,{key:t.group_id},{default:(0,s.w5)((()=>[(0,s.Wm)(S,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.50.50.webp`},null,8,["src"])])),_:2},1024),(0,s.Uk)(" "+(0,l.zw)(t.group_name)+" ",1),(0,s.Wm)($,{color:"primary",slot:"end",modelValue:t.is_marked,"onUpdate:modelValue":e=>t.is_marked=e,onClick:e=>d.itemUpdateGroup(e.target.checked?0:1,t.group_id)},null,8,["modelValue","onUpdate:modelValue","onClick"])])),_:2},1024)))),128))])),_:1}),(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Адрес *")])),_:1})])),_:1}),null!==(o=m.storeItem)&&void 0!==o&&null!==(_=o.locations)&&void 0!==_&&_.length?((0,s.wg)(),(0,s.j4)(v,{key:0},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.storeItem.locations,(t=>((0,s.wg)(),(0,s.j4)(y,{key:t.location_id},{default:(0,s.w5)((()=>[(0,s.Wm)(O,{slot:"start",src:`${e.$heap.state.hostname}/image/get.php/${t.image_hash}.32.32.png`},null,8,["src"]),(0,s.Wm)(c,{style:{"white-space":"normal",cursor:"pointer"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(t.location_address),1)])),_:2},1024),(0,s.Wm)(I,{slot:"end",icon:n.trash,onClick:e=>d.locationDelete(`${t.location_id}`)},null,8,["icon","onClick"])])),_:2},1024)))),128))])),_:1})):((0,s.wg)(),(0,s.j4)(v,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(y,{lines:"none"},{default:(0,s.w5)((()=>[(0,s.Wm)(f,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Пока адреса не добавлены")])),_:1})])),_:1}),(0,s.Wm)(U,{onClick:t[31]||(t[31]=e=>d.modalLocationCreate()),color:"light",expand:"block"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.locationOutline},null,8,["src"]),(0,s.Uk)(" Добавить адрес ")])),_:1})])),_:1})),(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Изображения магазина в приложении *")])),_:1})])),_:1}),(0,s.Wm)(G,{images:m.storeItem.images,image_holder_id:m.storeItem.store_id,controller:"Store",title:"Витрина продавца 5 фото",ref:"storeImgs"},null,8,["images","image_holder_id"]),(0,s.Wm)(U,{onClick:t[32]||(t[32]=t=>e.$refs.storeImgs.take_photo()),color:"light",expand:"block"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.cameraOutline,slot:"start"},null,8,["src"]),(0,s.Uk)(" Добавить фото на витрину ")])),_:1}),(0,s.Wm)(G,{images:m.storeItem.avatar,image_holder:"store_avatar",image_holder_id:m.storeItem.store_id,controller:"Store",title:"Аватар продавца 1 фото",ref:"storeAvatar"},null,8,["images","image_holder_id"]),(0,s.Wm)(U,{onClick:t[33]||(t[33]=t=>e.$refs.storeAvatar.take_photo()),color:"light",expand:"block"},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.cameraOutline,slot:"start"},null,8,["src"]),(0,s.Uk)(" Добавить аватар ")])),_:1})])),_:1}),(0,s.Wm)(v,null,{default:(0,s.w5)((()=>[(0,s.Wm)(b,{class:"schedule"},{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Время работы *")])),_:1})])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Понедельник "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_0&&!m.storeItem.store_time_closes_0]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_0,"onUpdate:modelValue":t[34]||(t[34]=e=>m.storeItem.store_time_opens_0=e),name:"store_time_opens_0"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_0,"onUpdate:modelValue":t[35]||(t[35]=e=>m.storeItem.store_time_closes_0=e),name:"store_time_closes_0"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[36]||(t[36]=e=>{m.storeItem.store_time_opens_0=m.storeItem.store_time_closes_0=null,d.saveSchedule("0")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_0]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Вторник "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_1&&!m.storeItem.store_time_closes_1]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_1,"onUpdate:modelValue":t[37]||(t[37]=e=>m.storeItem.store_time_opens_1=e),name:"store_time_opens_1"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_1,"onUpdate:modelValue":t[38]||(t[38]=e=>m.storeItem.store_time_closes_1=e),name:"store_time_closes_1"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[39]||(t[39]=e=>{m.storeItem.store_time_opens_1=m.storeItem.store_time_closes_1=null,d.saveSchedule("1")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_1]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Среда "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_2&&!m.storeItem.store_time_closes_2]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_2,"onUpdate:modelValue":t[40]||(t[40]=e=>m.storeItem.store_time_opens_2=e),name:"store_time_opens_2"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_2,"onUpdate:modelValue":t[41]||(t[41]=e=>m.storeItem.store_time_closes_2=e),name:"store_time_closes_2"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[42]||(t[42]=e=>{m.storeItem.store_time_opens_2=m.storeItem.store_time_closes_2=null,d.saveSchedule("2")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_2]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Четверг "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_3&&!m.storeItem.store_time_closes_3]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_3,"onUpdate:modelValue":t[43]||(t[43]=e=>m.storeItem.store_time_opens_3=e),name:"store_time_opens_3"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_3,"onUpdate:modelValue":t[44]||(t[44]=e=>m.storeItem.store_time_closes_3=e),name:"store_time_closes_3"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[45]||(t[45]=e=>{m.storeItem.store_time_opens_3=m.storeItem.store_time_closes_3=null,d.saveSchedule("3")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_3]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Пятница "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_4&&!m.storeItem.store_time_closes_4]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_4,"onUpdate:modelValue":t[46]||(t[46]=e=>m.storeItem.store_time_opens_4=e),name:"store_time_opens_4"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_4,"onUpdate:modelValue":t[47]||(t[47]=e=>m.storeItem.store_time_closes_4=e),name:"store_time_closes_4"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[48]||(t[48]=e=>{m.storeItem.store_time_opens_4=m.storeItem.store_time_closes_4=null,d.saveSchedule("4")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_4]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Суббота "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_5&&!m.storeItem.store_time_closes_5]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_5,"onUpdate:modelValue":t[49]||(t[49]=e=>m.storeItem.store_time_opens_5=e),name:"store_time_opens_5"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_5,"onUpdate:modelValue":t[50]||(t[50]=e=>m.storeItem.store_time_closes_5=e),name:"store_time_closes_5"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[51]||(t[51]=e=>{m.storeItem.store_time_opens_5=m.storeItem.store_time_closes_5=null,d.saveSchedule("5")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_5]])])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,{slot:"start"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Воскресенье "),(0,s.wy)((0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("(выходной)")])),_:1},512),[[i.F8,!m.storeItem.store_time_opens_6&&!m.storeItem.store_time_closes_6]])])),_:1}),(0,s.Wm)(V,{placeholder:"от",modelValue:m.storeItem.store_time_opens_6,"onUpdate:modelValue":t[52]||(t[52]=e=>m.storeItem.store_time_opens_6=e),name:"store_time_opens_6"},null,8,["modelValue"]),(0,s.Wm)(V,{placeholder:"до",modelValue:m.storeItem.store_time_closes_6,"onUpdate:modelValue":t[53]||(t[53]=e=>m.storeItem.store_time_closes_6=e),name:"store_time_closes_6"},null,8,["modelValue"]),(0,s.wy)((0,s.Wm)(I,{src:n.closeCircle,onClick:t[54]||(t[54]=e=>{m.storeItem.store_time_opens_6=m.storeItem.store_time_closes_6=null,d.saveSchedule("6")})},null,8,["src"]),[[i.F8,m.storeItem.store_time_closes_6]])])),_:1})])),_:1})])),_:1})],32)):(0,s.kq)("",!0),m.storeItem&&d.isAdmin?((0,s.wg)(),(0,s.j4)(v,{key:3},{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Тарифы")])),_:1})])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(d.tariffListComputed,(e=>((0,s.wg)(),(0,s.j4)(y,{key:e.tariff_id},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.briefcaseOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s._)("div",null,[(0,s._)("p",null,(0,l.zw)(e.tariff_name),1),(0,s.Wm)(x,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.start_dmy)+" - "+(0,l.zw)(e.finish_dmy),1)])),_:2},1024)]),(0,s.Wm)(I,{src:n.trashOutline,slot:"end",onClick:t=>d.tariffDelete(e.tariff_id)},null,8,["src","onClick"])])),_:2},1024)))),128)),d.isAdmin?((0,s.wg)(),(0,s.j4)(y,{key:0,button:"",onClick:t[56]||(t[56]=e=>d.tariffPick())},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Добавить тариф")])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),m.ownerList?((0,s.wg)(),(0,s.j4)(v,{key:4},{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Адинистраторы")])),_:1})])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(m.ownerList,(e=>((0,s.wg)(),(0,s.j4)(y,{key:e.user_id},{default:(0,s.w5)((()=>[m.storeItem.owner_id==e.user_id?((0,s.wg)(),(0,s.j4)(I,{key:0,src:n.ribbonOutline,slot:"start",color:"primary"},null,8,["src"])):((0,s.wg)(),(0,s.j4)(I,{key:1,src:n.personOutline,slot:"start",color:"primary"},null,8,["src"])),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.user_phone)+" "+(0,l.zw)(e.user_name)+" ",1),m.storeItem.owner_id==e.user_id?((0,s.wg)(),(0,s.iD)("span",a,"(Суперадмин)")):(0,s.kq)("",!0)])),_:2},1024),d.isStoreSuperadmin&&m.storeItem.owner_id!=e.user_id?((0,s.wg)(),(0,s.j4)(I,{key:2,src:n.trashOutline,slot:"end",onClick:t=>d.ownerDelete(e.user_id)},null,8,["src","onClick"])):(0,s.kq)("",!0),d.isStoreSuperadmin&&m.storeItem.owner_id==e.user_id?((0,s.wg)(),(0,s.j4)(I,{key:3,src:n.swapHorizontalOutline,slot:"end",onClick:t[57]||(t[57]=e=>d.ownerAdd("swap"))},null,8,["src"])):(0,s.kq)("",!0)])),_:2},1024)))),128)),d.isStoreSuperadmin?((0,s.wg)(),(0,s.j4)(y,{key:0,button:"",onClick:t[58]||(t[58]=e=>d.ownerAdd())},{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Добавить администратора")])),_:1})])),_:1})):(0,s.kq)("",!0)])),_:1})):(0,s.kq)("",!0),d.isStoreSuperadmin&&m.storeItem?((0,s.wg)(),(0,s.j4)(v,{key:5},{default:(0,s.w5)((()=>[(0,s.Wm)(W,null,{default:(0,s.w5)((()=>[(0,s.Wm)(c,null,{default:(0,s.w5)((()=>[(0,s.Uk)("API токен")])),_:1})])),_:1}),(0,s.Wm)(y,null,{default:(0,s.w5)((()=>[(0,s.Wm)(I,{src:n.keyOutline,slot:"start",color:"primary"},null,8,["src"]),m.apiToken?((0,s.wg)(),(0,s.j4)(c,{key:0,onClick:t[59]||(t[59]=e=>d.apiTokenCopy())},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(m.apiToken.token_hash),1)])),_:1})):((0,s.wg)(),(0,s.j4)(c,{key:1},{default:(0,s.w5)((()=>[(0,s.Uk)("**** **** ****")])),_:1})),m.apiToken?((0,s.wg)(),(0,s.j4)(I,{key:2,src:n.copyOutline,slot:"end",color:"dark",onClick:t[60]||(t[60]=e=>d.apiTokenCopy())},null,8,["src"])):((0,s.wg)(),(0,s.j4)(I,{key:3,src:n.eyeOutline,slot:"end",color:"dark",onClick:t[61]||(t[61]=e=>d.apiTokenShow())},null,8,["src"]))])),_:1})])),_:1})):(0,s.kq)("",!0)])):(0,s.kq)("",!0)]})),_:1},8,["page-title","pageDefaultBackLink"])}o(7658),o(8862);var m=o(4929),d=o(8903),_=o(7950),u=o(6178);function c(e,t,o,i,r,a){const n=(0,s.up)("ion-icon"),m=(0,s.up)("ion-title"),d=(0,s.up)("ion-toolbar"),_=(0,s.up)("ion-header"),u=(0,s.up)("ion-label"),c=(0,s.up)("ion-select-option"),p=(0,s.up)("ion-select"),h=(0,s.up)("ion-item"),f=(0,s.up)("ion-input"),w=(0,s.up)("ion-list"),k=(0,s.up)("ion-button"),I=(0,s.up)("ion-content");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{color:"secondary"},{default:(0,s.w5)((()=>[(0,s.Wm)(m,null,{default:(0,s.w5)((()=>[(0,s.Wm)(n,{icon:i.briefcaseOutline},null,8,["icon"]),(0,s.Uk)(" Добавить тариф")])),_:1}),(0,s.Wm)(n,{icon:i.closeOutline,onClick:t[0]||(t[0]=e=>{i.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,s.Wm)(I,null,{default:(0,s.w5)((()=>[(0,s.Wm)(w,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Тариф")])),_:1}),(0,s.Wm)(p,{slot:"end",modelValue:r.tariff_id,"onUpdate:modelValue":t[1]||(t[1]=e=>r.tariff_id=e),interface:"action-sheet",placeholder:"Выберите тариф"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.tariffList,(e=>((0,s.wg)(),(0,s.j4)(c,{value:e.tariff_id,key:e.tariff_id},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.tariff_name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Начало действия")])),_:1}),(0,s.Wm)(f,{slot:"end",type:"date",modelValue:r.start_at,"onUpdate:modelValue":t[2]||(t[2]=e=>r.start_at=e)},null,8,["modelValue"])])),_:1}),(0,s.Wm)(h,null,{default:(0,s.w5)((()=>[(0,s.Wm)(u,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Окончание действия")])),_:1}),(0,s.Wm)(f,{slot:"end",type:"date",modelValue:r.finish_at,"onUpdate:modelValue":t[3]||(t[3]=e=>r.finish_at=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,s.Wm)(k,{onClick:t[4]||(t[4]=e=>a.itemCreate()),expand:"block"},{default:(0,s.w5)((()=>[(0,s.Uk)("Добавить")])),_:1})])),_:1})],64)}var p=o(9755),h=o.n(p),f={components:{IonContent:m.W2,IonToolbar:m.sr,IonButton:m.YG,IonHeader:m.Gu,IonIcon:m.gu,IonTitle:m.wd,IonLabel:m.Q$,IonSelectOption:m.n0,IonSelect:m.t9,IonItem:m.Ie,IonInput:m.pK,IonList:m.q_},props:["store_id"],setup(){const e=function(){m.Fy.dismiss()};return{closeModal:e,briefcaseOutline:d.SVL,closeOutline:d.fID}},data(){return{start_at:null,finish_at:null,tariff_id:null,tariffList:null}},methods:{async listGet(){try{this.tariffList=await h().post(`${this.$heap.state.hostname}Admin/Tariff/listGet`)}catch(e){const t=e.responseJSON,o=t.messages.error;switch(o){case"forbidden":this.$flash("Не достаточно прав");break}return!1}},async itemCreate(){if(!this.tariff_id||!this.store_id||!this.start_at||!this.finish_at)return void this.$flash("Форма не заполнена полностью");const e={tariff_id:this.tariff_id,store_id:this.store_id,start_at:this.start_at,finish_at:this.finish_at};m.Fy.dismiss(e)}},mounted(){this.listGet()}},w=o(3744);const k=(0,w.Z)(f,[["render",c]]);var I=k,g=o(2008),y=o(351),W={components:{IonInput:m.pK,IonTextarea:m.g2,IonToggle:m.ho,IonCard:m.PM,IonCardContent:m.FN,IonCardHeader:m.Zi,IonCheckbox:m.nz,IonIcon:m.gu,IonItem:m.Ie,IonList:m.q_,IonLabel:m.Q$,IonItemDivider:m.rH,IonText:m.yW,IonItemGroup:m.Ub,IonImg:m.Xz,IonAvatar:m.BJ,IonButton:m.YG,IonProgressBar:m.X7,IonNote:m.uN,imageTileComp:_.Z},setup(){return{cameraOutline:d.kuq,trash:d._Ij,trashOutline:d.gtu,locationOutline:d.Iv7,storefrontOutline:d.qRG,flagOutline:d.FMn,searchOutline:d.W6I,personOutline:d.QJ7,addOutline:d.s6O,checkmarkCircleOutline:d.Nwd,chevronBack:d.Mny,closeCircle:d.XZx,keyOutline:d.eyg,eyeOutline:d.hII,copyOutline:d.O3B,ribbonOutline:d.Muk,briefcaseOutline:d.SVL,cartOutline:d.Ox0,rocketOutline:d.G$D,swapHorizontalOutline:d._hl}},data(){return{storeId:this.$route.params.id,storeItem:null,storeGroupList:[],ownerList:null,tariffList:null,is_name_edited:0,is_desc_edited:0,is_deleted:0,is_disabled:0,is_working:0,is_primary:0,validity:0,validity_perc:100,validity_min:80,apiToken:null}},computed:{isPhoneValid(){return[11,12].includes(this.storeItem.user_phone.replace(/\D/g,"").length)},isAdmin(){return y.Z.isAdmin()},isStoreSuperadmin(){var e;return this.$heap.state.user.user_id==(null===(e=this.storeItem)||void 0===e?void 0:e.owner_id)||y.Z.isAdmin()},message(){var e,t,o,s;return this.storeItem?null!==(e=this.storeItem)&&void 0!==e&&e.deleted_at?"Предприятие не активно и будет удалено. Вы еще можете отменить удаление":1==(null===(t=this.storeItem)||void 0===t?void 0:t.is_disabled)?"Предприятие не активно и находится на рассмотрении у администратора":0==(null===(o=this.storeItem)||void 0===o?void 0:o.is_working)?"Предприятие отмечено вами как времено не готовое к заказам. Например, в связи с праздниками":1==(null===(s=this.storeItem)||void 0===s?void 0:s.is_primary)?"Предприятие активно и готово принимать заказы в рабочее время. Является опорным":"Предприятие активно и готово принимать заказы в рабочее время.":null},messageClass(){var e,t,o,s;return null!==(e=this.storeItem)&&void 0!==e&&e.deleted_at?"deleted":1==(null===(t=this.storeItem)||void 0===t?void 0:t.is_disabled)?"disabled":1==(null===(o=this.storeItem)||void 0===o?void 0:o.is_primary)?"primary":1!=(null===(s=this.storeItem)||void 0===s?void 0:s.is_working)?"notworking":"active"},tariffListComputed(){if(!this.tariffList)return this.tariffList;for(let e of this.tariffList)e.start_dmy=this.toLocDate(e.start_at),e.finish_dmy=this.toLocDate(e.finish_at);return this.tariffList},storeGroupListComp(){if(!this.storeItem||!this.storeGroupList)return console.log(this.storeItem,this.storeGroupList),null;let e=[];try{var t,o;const s=null===(t=this.storeItem.member_of_groups)||void 0===t||null===(o=t.group_ids)||void 0===o?void 0:o.split(",");for(let t of this.storeGroupList)t.is_marked=null===s||void 0===s?void 0:s.includes(t.group_id),e.push(t)}catch(s){}return e}},mounted(){this.listGroupGet(),this.itemGet(),this.ownerListGet()},methods:{toLocDate(e){const t=new Date(Date.parse(e)),o={month:"short",day:"numeric",year:"numeric"};return t.toLocaleDateString(void 0,o)},async itemGet(){try{this.storeItem=await h().post(g.Z.state.hostname+"Store/itemGet",{store_id:this.storeId}),this.storeItem.store_pickup_allow*=1,this.storeItem.store_delivery_allow*=1,this.itemParseFlags(),this.itemValidityCalc(),this.tariffListGet()}catch(o){var e,t;const s=null===(e=o.responseJSON)||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.error;"notfound"==s&&(this.$flash("Не найден"),this.$go("/"))}},itemParseFlags(){this.is_deleted=null==this.storeItem.deleted_at?0:1,this.is_disabled=0==this.storeItem.is_disabled?0:1,this.is_working=0==this.storeItem.is_working?0:1,this.is_primary=1==this.storeItem.is_primary?1:0},itemValidityCalc(){const e=["store_name|store_name_new","store_description|store_description_new","store_company_name|store_company_name_new","store_phone","store_tax_num","store_minimal_order","store_time_preparation","store_time_opens_0|store_time_opens_1|store_time_opens_2|store_time_opens_3|store_time_opens_4|store_time_opens_5|store_time_opens_6|store_time_closes_0|store_time_closes_1|store_time_closes_2|store_time_closes_3|store_time_closes_4|store_time_closes_5|store_time_closes_6","images","locations","member_of_groups.group_ids"],t=e.length;let o=0;for(const l of e){let e=0;for(const t of l.split("|")){var s;let o=null;const l=t.split(".");if(o=l[1]?this.storeItem[l[0]][l[1]]:this.storeItem[l[0]],(null===(s=o)||void 0===s?void 0:s.length)>0){e=1;break}}o+=e}this.validity=o/t,this.validity_perc=Math.round(100*this.validity)},async itemDelete(e){if(e&&!confirm("Внимание магазин будет удален! Товары, настройки, отзывы будут потеряны. Продолжить?"))return void setTimeout((()=>{this.is_deleted=0}),100);const t=e?"itemDelete":"itemUnDelete";try{await h().post(g.Z.state.hostname+"Store/"+t,{store_id:this.storeId}),this.storeItem.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.storeItem.is_disabled!=e)try{await h().post(g.Z.state.hostname+"Store/itemDisable",{store_id:this.storeId,is_disabled:e}),this.storeItem.is_disabled=e}catch{this.itemGet()}},async productItemCreate(){try{const e={store_id:this.storeId,product_name:"Новый товар",product_price:1e3,product_promo_price:1e3},t=await h().post(`${g.Z.state.hostname}Product/itemCreate`,e);this.$go(`/catalog/product-edit-${t}`)}catch{this.$flash("Не удалось создать товар")}},saveForm(e){const t=e.target.name,o=this.storeItem[t];t.indexOf("store_time_closes")>-1||t.indexOf("store_time_opens")>-1?this.saveSchedule(t):this.save(t,o)},saveSchedule(e){const t=e.split("_").pop();let o=this.storeItem["store_time_opens_"+t],s=this.storeItem["store_time_closes_"+t];o=""==o||null==o?null:Number(o),s=""==s||null==s?null:Number(s),o>24&&(o=0),s>24&&(s=0),(o>=s&&null!=s||0==s)&&(s=o+1,this.$flash("Время закрытия должно быть позже открытия"));const l={store_id:this.storeId,["store_time_opens_"+t]:o,["store_time_closes_"+t]:s};this.storeItem["store_time_opens_"+t]!=o&&(this.storeItem["store_time_opens_"+t]=o),this.storeItem["store_time_closes_"+t]!=s&&(this.storeItem["store_time_closes_"+t]=s),this.itemValidityCalc(),this.itemUpdate(l)},async save(e,t){if("user_phone"==e){if(!this.isPhoneValid)return!1;t=t.replace(/\D/g,"")}if(!e)return;let o={store_id:this.storeId,[e]:t};this.storeItem[e]=t,this.itemValidityCalc(),this.itemUpdate(o),this.itemParseFlags()},async itemUpdate(e){try{e["validity"]=this.validity_perc,await h().post(g.Z.state.hostname+"Store/itemUpdate",JSON.stringify(e)),this.$flash("сохранено")}catch(t){this.$flash("Не удалось сохранить изменение"),this.itemGet()}},phoneFormat(){this.storeItem.store_phone||(this.storeItem.store_phone="");try{let e=this.storeItem.store_phone.replace(/\D/g,"");e.length>12&&(e="+"+e.substring(e.length-12)),this.storeItem.store_phone=e}catch{}},async fieldApprove(e){let t={store_id:this.storeId,field_name:e};try{await this.save(e,this.storeItem[e]),await h().post(g.Z.state.hostname+"Store/fieldApprove",t)}catch(o){const e=o.responseJSON.messages.error;null!==e&&void 0!==e&&e.includes("store_description")?this.$flash("Описание слишком короткое"):null!==e&&void 0!==e&&e.includes("store_name")?this.$flash("Название слишком короткое"):this.$flash("Не удалось сохранить изменение")}this.itemGet()},async itemUpdateGroup(e,t){if(!y.Z.isAdmin()&&0==this.is_disabled&&!confirm("Внимание! Изменение группы, отправит магазин/ресторан на модерацию"))return this.listGroupGet(),!1;const o={store_id:this.storeId,is_joined:e,group_id:t};try{await h().post(g.Z.state.hostname+"Store/itemUpdateGroup",o)}catch(s){this.$flash("Не удалось сохранить изменение")}this.itemGet()},async listGroupGet(){try{this.storeGroupList=await h().get(g.Z.state.hostname+"Store/listGroupGet")}catch{}},async ownerListGet(){try{this.ownerList=await h().post(g.Z.state.hostname+"Store/ownerListGet",{store_id:this.storeId})}catch{}},async ownerAdd(e="add"){let t=prompt("Введите номер телефона нового администратора");if(t)if(t=t.replace(/\D/g,""),[11,12].includes(t.length))try{await h().post(g.Z.state.hostname+"Store/ownerSave",{store_id:this.storeId,action:e,owner_phone:t}),"swap"==e&&await this.itemGet(),this.ownerListGet()}catch{this.$flash("Не удалось добавить администратора")}else this.$flash("Проверьте правильность телефона")},async ownerDelete(e){if(confirm("Удалить этого пользователя из администраторов магазина?"))try{await h().post(g.Z.state.hostname+"Store/ownerSave",{store_id:this.storeId,action:"delete",owner_id:e}),this.ownerListGet()}catch{this.$flash("Не удалось удалить администратора")}},async modalLocationCreate(){if(!g.Z.state.user.user_id)return this.$flash("Чтобы добавленные адреса сохранились, пожалуйста войдите в систему"),void this.$go({name:"UserSignIn"});var e="рабочий";const t=await m.Fy.create({component:u.Z,showBackdrop:!0,backdropDismiss:!0,componentProps:{location_group_name_low:e}});return t.onDidDismiss().then((e=>{this.locationCreate(e.data)})),t.present()},async locationCreate(e){if(!e)return;const t={location_holder:"store",location_holder_id:this.storeId,location_group_type:"address_work",location_address:e.location_address,location_latitude:e.location_latitude,location_longitude:e.location_longitude};try{await h().post(g.Z.state.hostname+"Store/locationCreate",t),this.itemGet()}catch(l){var o,s;const e=null===(o=l.responseJSON)||void 0===o||null===(s=o.messages)||void 0===s?void 0:s.error;"limit_exeeded"==e&&this.$flash("Больше адресов добавить нельзя")}},async locationDelete(e){try{await h().post(g.Z.state.hostname+"Store/locationDelete",{location_id:e}),this.itemGet()}catch{this.$flash("Удалить адрес не удалось")}},async apiTokenShow(){const e={token_holder:"store",token_holder_id:this.storeId};try{this.apiToken=await h().post(g.Z.state.hostname+"Token/itemActiveGet",e)}catch{}},apiTokenCopy(){this.apiToken.token_hash&&(navigator.clipboard.writeText(this.apiToken.token_hash),this.$flash("Токен скопирован"))},async tariffListGet(){const e={store_id:this.storeId};try{this.tariffList=await h().post(g.Z.state.hostname+"Admin/Tariff/storeTariffListGet",e)}catch{this.tariffList=null}},async tariffDelete(e){if(!confirm("Вы уверенны?"))return;const t={store_id:this.storeId,tariff_id:e};try{await h().post(g.Z.state.hostname+"Admin/Tariff/storeTariffDelete",t),this.tariffListGet()}catch{}},async tariffAdd(e){try{await h().post(g.Z.state.hostname+"Admin/Tariff/storeTariffAdd",e),this.tariffListGet()}catch(t){const e=t.responseJSON,o=e.messages.error;switch(o){case"forbidden":this.$flash("Не достаточно прав");break}return!1}},async tariffPick(){if(!this.isAdmin)return;const e=await m.Fy.create({component:I,showBackdrop:!0,backdropDismiss:!0,componentProps:{store_id:this.storeId}});return e.onDidDismiss().then((e=>{var t;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.tariff_id&&this.tariffAdd(e.data)})),e.present()}}};const v=(0,w.Z)(W,[["render",n],["__scopeId","data-v-08ab712e"]]);var U=v}}]);
//# sourceMappingURL=6767.1f32d2a0.js.map