{"version":3,"file":"js/415.9a22d3b9.js","mappings":"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","sources":["webpack://Tezkel/./src/views/UserEdit.vue","webpack://Tezkel/./src/views/UserEdit.vue?c0c1"],"sourcesContent":["<template>\r\n  <base-layout page-title=\"Мой профиль\"  page-default-back-link=\"/user-dashboard\" :errorMessage=\"error\">\r\n        <ion-list>\r\n          <ion-item>\r\n            <ion-label position=\"stacked\" color=\"primary\">Аватар</ion-label>\r\n            <ion-radio-group :value=\"fields.user_avatar_name\">\r\n              <ion-list style=\"margin-top:5px\">\r\n                <ion-item>\r\n                  <ion-thumbnail>\r\n                    <img :src=\"$heap.state.hostname+'img/avatar/man.png'\" />\r\n                  </ion-thumbnail>\r\n                  <ion-label>Муж.</ion-label>\r\n                  <ion-radio value=\"man\" @ionFocus=\"save('user_avatar_name', $event.target.value)\"></ion-radio>\r\n                </ion-item>\r\n                <ion-item>\r\n                  <ion-thumbnail>\r\n                    <img :src=\"$heap.state.hostname+'img/avatar/woman.png'\" />\r\n                  </ion-thumbnail>\r\n                  <ion-label>Жен.</ion-label>\r\n                  <ion-radio value=\"woman\" @ionFocus=\"save('user_avatar_name', $event.target.value)\"></ion-radio>\r\n                </ion-item>\r\n              </ion-list>\r\n            </ion-radio-group>\r\n          </ion-item>\r\n\r\n          <ion-item>\r\n            <ion-label position=\"stacked\" color=\"primary\">Имя</ion-label>\r\n            <ion-input \r\n              v-model=\"fields.user_name\" \r\n              name=\"user_name\" \r\n              type=\"text\" \r\n              :value=\"fields.user_name\"\r\n              @change=\"save('user_name', $event.target.value)\" \r\n              placeholder=\"Имя\"\r\n              required\r\n            ></ion-input>\r\n          </ion-item>\r\n\r\n          <ion-item>\r\n            <ion-label position=\"stacked\" color=\"primary\">Фамилия</ion-label>\r\n            <ion-input \r\n              v-model=\"fields.user_surname\" \r\n              name=\"user_surname\" \r\n              type=\"text\" \r\n              :value=\"fields.user_surname\"\r\n              @change=\"save('user_surname', $event.target.value)\" \r\n              placeholder=\"Фамилия\"\r\n            ></ion-input>\r\n          </ion-item>\r\n\r\n          <ion-item>\r\n            <ion-label position=\"stacked\" color=\"primary\">Отчество</ion-label>\r\n            <ion-input \r\n              v-model=\"fields.user_middlename\" \r\n              name=\"user_middlename\" \r\n              type=\"text\" \r\n              :value=\"fields.user_middlename\"\r\n              @change=\"save('user_middlename', $event.target.value)\" \r\n              placeholder=\"Отчество\"\r\n            ></ion-input>\r\n          </ion-item>\r\n          \r\n          <ion-item>\r\n            <ion-label position=\"stacked\" color=\"primary\">Телефон</ion-label>\r\n            <ion-input\r\n              v-model=\"fields.user_phone\"\r\n              name=\"user_phone\"\r\n              type=\"numeric\"\r\n              inputmode=\"tel\"\r\n              :value=\"fields.user_phone\"\r\n              @input=\"$event.target.value = phoneValidate($event);\"\r\n              @change=\"save('user_phone', $event.target.value)\"\r\n              placeholder=\"7(978)-000-00-00\"\r\n              spellcheck=\"false\"\r\n              autocapitalize=\"off\"\r\n              required\r\n            ></ion-input>\r\n            <ion-button slot=\"end\" v-if=\"fields.user_phone && (!fields.user_phone_verified || fields.user_phone_verified === '0')\" @click=\"phoneVerify\" expand=\"block\">Подтвердить</ion-button>\r\n            <ion-button slot=\"end\" v-if=\"fields.user_phone && fields.user_phone_verified && fields.user_phone_verified !== '0'\" expand=\"block\" disabled=\"true\">Подтверждено</ion-button>\r\n          </ion-item>\r\n\r\n          <ion-item>\r\n            <ion-label position=\"stacked\" color=\"primary\">Электронная почта</ion-label>\r\n            <ion-input \r\n              v-model=\"fields.user_email\" \r\n              name=\"user_email\" \r\n              type=\"email\" \r\n              :value=\"fields.user_email\"\r\n              @change =\"save('user_email', $event.target.value)\" \r\n              placeholder=\"Электронная почта\"\r\n            ></ion-input>\r\n          </ion-item>\r\n\r\n        </ion-list>\r\n\r\n        <ion-row responsive-sm>\r\n          <ion-col>\r\n            <ion-button @click=\"passwordReset\" expand=\"block\">Сбросить пароль</ion-button>\r\n          </ion-col>\r\n        </ion-row>\r\n  </base-layout>\r\n</template>\r\n\r\n<script>\r\nimport router from '../router';\r\nimport jQuery from \"jquery\";\r\nimport heap from '../heap';\r\n\r\n\r\n\r\nexport default  {\r\n  name: 'SignIn',\r\n  data(){\r\n    return {\r\n      error: '',\r\n      submitted: false,\r\n      config: {\r\n        phoneMask: '+0(000)-000-00-00'\r\n      },\r\n      fields: heap.state.user,\r\n      modalOpen: false\r\n    }\r\n  },\r\n  computed: {\r\n    phoneValid() {\r\n      return this.fields.user_phone.replace(/\\D/g,\"\").length == 11;\r\n    }\r\n  },\r\n  methods:{\r\n    async save(field_name, field_value) {\r\n      this.submitted = true;\r\n      if(field_name == 'user_phone'){\r\n        if(!this.phoneValid){\r\n          return false;\r\n        }\r\n        field_value = field_value.replace(/\\D/g,\"\");\r\n      }\r\n      var requestData = {};\r\n      requestData.user_id = heap.state.user.user_id;\r\n      requestData[field_name] = field_value;\r\n      try{\r\n        await jQuery.post( heap.state.hostname + \"User/itemUpdate\", JSON.stringify(requestData))\r\n        this.getUserData()\r\n      }catch{/** */}\r\n    },\r\n    getUserData(){\r\n      var self = this;\r\n      jQuery.post( heap.state.hostname + \"User/itemGet\")\r\n        .done(function(response) {\r\n            heap.commit('setUser', response);\r\n            self.fields = response;\r\n        })\r\n        .fail(function(err) {\r\n            self.error = err.responseJSON.messages.error;\r\n        });\r\n    },\r\n    phoneVerify(){\r\n      var self = this;\r\n      jQuery.post( heap.state.hostname + \"User/phoneVerificationSend\", {user_phone: this.fields.user_phone.replace(/\\D/g,\"\")})\r\n        .done(function() {\r\n            router.push({name: 'UserVerifyPhone', params: {phone: self.fields.user_phone.replace(/\\D/g,\"\")}});\r\n        })\r\n        .fail(function(err) {\r\n            self.error = err.responseJSON.messages.error;\r\n        });\r\n    },\r\n    phoneValidate(ev) {\r\n      this.fields.user_phone = ev.target.value;\r\n      this.fields.user_phone = this.fields.user_phone.replace(/\\D/g,\"\");\r\n      if(this.fields.user_phone.length > 11){\r\n        this.fields.user_phone = this.fields.user_phone.substring(0, 11);\r\n      }\r\n      let result = '';\r\n      let numberIndex = 0; \r\n      for(let index in this.config.phoneMask){\r\n        if(!this.fields.user_phone[numberIndex]){\r\n          break;\r\n        }\r\n        let character = this.config.phoneMask[index];\r\n        if(character == '0'){\r\n          result += this.fields.user_phone[numberIndex];\r\n          numberIndex++;\r\n        } else {\r\n          result += character\r\n        }\r\n      }\r\n      this.fields.user_phone = result;\r\n      return this.fields.user_phone;\r\n    },\r\n  },\r\n  watch: {\r\n    '$route' (to, from) {\r\n      if(to.path != from.path) { \r\n        this.fields = heap.state.user\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./UserEdit.vue?vue&type=template&id=30592aa4\"\nimport script from \"./UserEdit.vue?vue&type=script&lang=js\"\nexport * from \"./UserEdit.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["errorMessage","error","position","color","value","fields","user_avatar_name","style","src","$heap","state","hostname","save","$event","target","user_name","name","type","placeholder","required","user_surname","user_middlename","user_phone","inputmode","phoneValidate","spellcheck","autocapitalize","user_phone_verified","slot","phoneVerify","expand","disabled","user_email","passwordReset","data","submitted","config","phoneMask","heap","modalOpen","computed","phoneValid","this","replace","length","methods","async","field_name","field_value","requestData","user_id","JSON","stringify","getUserData","self","done","response","fail","err","responseJSON","messages","router","params","phone","ev","substring","result","numberIndex","index","character","watch","to","from","path","__exports__","render"],"sourceRoot":""}