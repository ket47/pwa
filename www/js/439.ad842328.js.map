{"version":3,"file":"js/439.ad842328.js","mappings":"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","sources":["webpack://blank/./src/views/UserAddresses.vue","webpack://blank/./src/views/UserAddresses.vue?add7"],"sourcesContent":["<template>\r\n  <base-layout page-title=\"Мои адреса\" page-default-back-link=\"/user-dashboard\" :errorMessage=\"error\"  ref=\"UserAddressPage\">\r\n        <ion-list v-if=\"locationList.length\" lines=\"full\">\r\n          <ion-item v-for=\"(location,i) in locationList\" :key=\"location.location_id\">\r\n              <ion-img slot=\"start\" :src=\"`${$heap.state.hostname}/image/get.php/${location.image_hash}.32.32.png`\" />\r\n              <ion-label @click=\"locationSetMain(`${location.location_id}`,`${i}`)\" style=\"white-space:normal;cursor:pointer;\">{{ location.location_address }}</ion-label>\r\n              <ion-icon slot=\"end\" :icon=\"trash\" @click=\"locationDelete(`${location.location_id}`,`${i}`)\"></ion-icon>\r\n          </ion-item>\r\n        </ion-list>\r\n        <ion-note v-else>Пока адреса не добавлены</ion-note>\r\n\r\n        <ion-list>\r\n          <ion-list-header>\r\n            <ion-label>Добавить адрес</ion-label>\r\n          </ion-list-header>\r\n          <ion-item  v-for=\"location in locationGroupList\" :key=\"location.group_id\" @click=\"modalLocationCreate(`${location.group_id}`,`${location.group_name}`)\" style=\"cursor:pointer\">\r\n              <ion-img :src=\"`${$heap.state.hostname}/image/get.php/${location.image_hash}.32.32.png`\" />\r\n              <ion-label style=\"margin-left:5px;padding-left:5px;border-left:solid 1px black;white-space:normal\">{{ location.group_name }}</ion-label>\r\n          </ion-item>\r\n        </ion-list>\r\n  </base-layout>\r\n</template>\r\n\r\n\r\n<script>\r\nimport {\r\n  modalController\r\n}                         from \"@ionic/vue\";\r\nimport router             from '@/router';\r\nimport heap               from '@/heap';\r\nimport Topic              from '@/scripts/Topic.js'\r\nimport jQuery             from 'jquery';\r\nimport UserAddressPicker  from '@/components/UserAddressPicker.vue';\r\n\r\nimport { IonIcon }        from '@ionic/vue';\r\nimport { trash }          from 'ionicons/icons';\r\n\r\nexport default{\r\n  name: 'UserAddresses',\r\n  components: {\r\n    IonIcon\r\n  },\r\n  setup(){\r\n    return { trash };\r\n  },\r\n  mounted(){\r\n    this.locationListGet();\r\n  },\r\n  methods:{\r\n    async modalLocationCreate( location_group_id, location_group_name ) {\r\n      if(!heap.state.user.user_id){\r\n        this.$flash('Чтобы добавленные адреса сохранились, пожалуйста войдите в систему');\r\n        router.push({name: 'UserSignIn'});\r\n        return;\r\n      }\r\n      var location_group_name_low=String(location_group_name).toLowerCase();\r\n      const modal = await modalController.create({\r\n        component: UserAddressPicker,\r\n        showBackdrop:true,\r\n        backdropDismiss:true,\r\n        swipeToClose: true,\r\n        cssClass: 'update-profile-modal',\r\n        presentingElement: this.$refs.UserAddressPage.$el,\r\n        componentProps:{\r\n          location_group_name_low\r\n        },\r\n      });\r\n      modal.onDidDismiss().then(location => {\r\n        this.locationCreate(location_group_id,location.data);\r\n      });\r\n      return modal.present();\r\n    },\r\n    locationListGet(){\r\n      var self=this;\r\n      jQuery.get(heap.state.hostname + \"User/locationListGet\",{includeGroupList:1}).done(function(response){\r\n        self.locationList=response.location_list;\r\n        self.locationGroupList=response.location_group_list;\r\n        if(self.locationList){\r\n          for(let loc of self.locationList){\r\n            if(loc.is_main!=1)continue;\r\n              heap.state.user.location_main=loc;\r\n          }\r\n        }\r\n      });\r\n    },\r\n    locationCreate(group_id,location){\r\n      if( !location ){\r\n        return;\r\n      }\r\n      let request={\r\n        location_holder:'user',\r\n        location_holder_id:heap.state.user.user_id,\r\n        location_group_id:group_id,\r\n        location_address:location.location_address,\r\n        location_latitude:location.location_latitude,\r\n        location_longitude:location.location_longitude\r\n      };\r\n      var self=this;\r\n      jQuery.post(heap.state.hostname + \"User/locationCreate\",request).done(function(response){\r\n        self.locationListGet();\r\n      }).fail(function(xhr){\r\n        if( xhr.responseJSON && xhr.responseJSON.messages.error=='limit_exeeded' ){\r\n          self.$flash(\"Больше адресов добавить нельзя\");\r\n        }\r\n      });\r\n    },\r\n    async locationSetMain( location_id, index ){\r\n      var self=this;\r\n      var loc=self.locationList[index];\r\n      heap.state.user.location_main={\r\n        location_id:loc.location_id,\r\n        location_latitude:loc.location_latitude,\r\n        location_altitude:loc.location_altitude,\r\n        location_address:loc.location_address,\r\n        image_hash:loc.image_hash\r\n      };\r\n      router.go(-1);\r\n      await jQuery.post(heap.state.hostname + \"User/locationSetMain\",{location_id});\r\n      Topic.publish('userMainLocationSet',heap.state.user.location_main)\r\n    },\r\n    locationDelete( location_id, index ){\r\n      var self=this;\r\n      self.locationList.splice(index,1);\r\n      jQuery.post(heap.state.hostname + \"User/locationDelete\",{location_id}).done(function(response){\r\n        self.locationListGet();\r\n      });\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      locationList:[],\r\n      locationGroupList:[]\r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./UserAddresses.vue?vue&type=template&id=22b1e937\"\nimport script from \"./UserAddresses.vue?vue&type=script&lang=js\"\nexport * from \"./UserAddresses.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["errorMessage","error","ref","locationList","length","lines","location","i","key","location_id","slot","src","$heap","state","hostname","image_hash","locationSetMain","style","location_address","icon","trash","locationDelete","locationGroupList","group_id","modalLocationCreate","group_name","name","components","IonIcon","setup","mounted","this","locationListGet","methods","async","location_group_id","location_group_name","heap","$flash","router","location_group_name_low","String","toLowerCase","modal","component","UserAddressPicker","showBackdrop","backdropDismiss","swipeToClose","cssClass","presentingElement","$refs","UserAddressPage","$el","componentProps","onDidDismiss","then","locationCreate","data","present","self","includeGroupList","done","response","location_list","location_group_list","loc","is_main","request","location_holder","location_holder_id","location_latitude","location_longitude","fail","xhr","responseJSON","messages","index","location_altitude","Topic","splice","__exports__","render"],"sourceRoot":""}