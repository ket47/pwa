"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[4675],{4075:function(t,e,o){o.d(e,{Z:function(){return u}});var a=o(6252);function n(t,e,o,n,i,l){const s=(0,a.up)("ion-icon"),r=(0,a.up)("ion-button"),c=(0,a.up)("ion-buttons"),d=(0,a.up)("ion-label"),u=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-searchbar"),p=(0,a.up)("ion-header"),h=(0,a.up)("ymap-marker"),_=(0,a.up)("yandex-map"),y=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{onClick:e[0]||(e[0]=t=>n.closeModal()),color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{icon:n.closeOutline,slot:"start"},null,8,["icon"]),(0,a.Uk)(" Закрыть ")])),_:1})])),_:1}),(0,a.Wm)(d,{size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)("Добавление адреса")])),_:1}),(0,a.Wm)(c,{slot:"end"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{strong:!0,onClick:e[1]||(e[1]=t=>l.pickAddress()),color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{src:n.checkmark,slot:"start"},null,8,["src"]),(0,a.Uk)(" Ок ")])),_:1})])),_:1})])),_:1}),(0,a.Wm)(m,{id:"suggest",placeholder:"название улицы, номер дома"})])),_:1}),(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{coords:i.coords,zoom:16,onClick:e[2]||(e[2]=t=>l.onClick(t)),style:{height:"100%"},settings:i.settings},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{coords:i.coords,"marker-id":"1",properties:i.placemarkProperties},null,8,["coords","properties"])])),_:1},8,["coords","settings"])])),_:1})],64)}o(3948),o(7658);var i=o(4929),l=o(5836),s=o(8903),r={components:{IonContent:i.W2,IonToolbar:i.sr,IonButton:i.YG,IonButtons:i.Sm,IonSearchbar:i.VI,IonHeader:i.Gu,IonIcon:i.gu,yandexMap:l.xR,ymapMarker:l.Jk},setup(){const t=function(){i.Fy.dismiss()};return{closeModal:t,locationOutline:s.Iv7,closeOutline:s.fID,checkmark:s.d29}},props:{location_group_name_low:String,location_group_id:Number},data(){let t=this.location_group_name_low+" адрес",e=this.$heap.state.settings.location,o=JSON.parse(e.mapCenter);return{settings:{apiKey:e.ymapApiKey,lang:"ru_RU",coordorder:"latlong",version:"2.1"},placemarkProperties:{iconCaption:t},locationType:t,locSettings:e,selectedPlacemark:0,selectedAddress:"",selectedCoords:[],coords:o}},methods:{async pickAddress(){try{var t;const e=await window.ymaps.geocode(this.coords);this.selectedAddress=null===(t=e.geoObjects.get(0))||void 0===t?void 0:t.getAddressLine()}catch(o){}var e={location_address:this.filterAddress(this.selectedAddress),location_latitude:this.coords[0],location_longitude:this.coords[1]};i.Fy.dismiss(e)},filterAddress(t){const e=this.locSettings.addressErase.split(", "),o=t.split(", ");let a=[];for(const n of o)e.find((t=>t==n))||a.push(n);return a.reverse().join(", ")},onClick(t){t&&t.get&&(this.coords=t.get("coords"))}},async mounted(){await(0,l.xk)();let t=window.ymaps;const e=JSON.parse("["+this.locSettings.mapBoundaries[0]+"]"),o=new t.SuggestView("suggest",{boundedBy:e});o.events.add("select",(e=>{this.selectedAddress=e.get("item").displayName,t.geocode(this.selectedAddress).then((t=>{this.coords=t.geoObjects.get(0).geometry.getCoordinates()}))})),this.$flash("Получаем местоположение устройства"),t.geolocation.get().then((t=>{this.coords=t.geoObjects.position,this.$flash("На карте отмечено ваше местоположение")}))}},c=o(3744);const d=(0,c.Z)(r,[["render",n]]);var u=d},4675:function(t,e,o){o.r(e),o.d(e,{default:function(){return V}});var a=o(6252),n=o(3577);const i=t=>((0,a.dD)("data-v-a5985204"),t=t(),(0,a.Cn)(),t),l=i((()=>(0,a._)("h1",null,"Ваш заказ",-1))),s=i((()=>(0,a._)("p",null,[(0,a._)("b",null,"Курьер")],-1))),r=i((()=>(0,a._)("h1",null,"Детали перевозки",-1))),c={style:{"border-radius":"10px",margin:"10px",overflow:"hidden"}},d=i((()=>(0,a._)("b",null,"Откуда:",-1))),u=i((()=>(0,a._)("b",null,"Куда:",-1))),m=i((()=>(0,a._)("b",null,"Ко времени",-1))),p=i((()=>(0,a._)("h1",null,"Способы оплаты",-1))),h=i((()=>(0,a._)("label",{for:"payment_cash"},"Оплата наличными",-1))),_={slot:"end"},y=["checked"],g=i((()=>(0,a._)("label",{for:"payment_cash_store"},"Оплата наличными продавцу",-1))),k={slot:"end"},f=["checked"],w={key:2},v=i((()=>(0,a._)("label",{for:"payment_card"},"Оплата картой без привязки",-1))),C={slot:"end"},W=["checked"],b={for:"use_card_recurrent"},I={slot:"end"},S=["checked"];function O(t,e,o,i,O,D){const L=(0,a.up)("ion-label"),$=(0,a.up)("ion-item"),T=(0,a.up)("ion-icon"),R=(0,a.up)("ion-text"),U=(0,a.up)("ymap-marker"),j=(0,a.up)("yandex-map"),F=(0,a.up)("ion-segment-button"),G=(0,a.up)("ion-segment"),x=(0,a.up)("ion-list"),z=(0,a.up)("ion-img"),A=(0,a.up)("ion-card-content"),P=(0,a.up)("ion-card"),B=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(B,{pageTitle:"Оформление",pageDefaultBackLink:"/order/order-list",ref:"page"},{default:(0,a.w5)((()=>{var o;return[(0,a.Wm)(x,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[l,s])),_:1})])),_:1}),(0,a.Wm)($,{detail:"",lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{src:i.cubeOutline,slot:"start",size:"large",color:"medium",style:{"font-size":"2em"}},null,8,["src"]),(0,a.Wm)(R,{color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)("Скажите нам, что нужно перевезти?")])),_:1})])),_:1}),(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[r])),_:1})])),_:1}),(0,a._)("div",c,[O.placemarkCoords?((0,a.wg)(),(0,a.j4)(j,{key:0,coords:O.placemarkCoords,zoom:16,settings:O.mapsettings,controls:["fullscreenControl"],behaviors:[],style:{height:"200px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{coords:O.placemarkCoords,icon:O.placemarkIcon,"marker-id":"1",properties:O.placemarkProperties},null,8,["coords","icon","properties"])])),_:1},8,["coords","settings"])):(0,a.kq)("",!0)]),O.locationStart?((0,a.wg)(),(0,a.j4)($,{key:0,button:"",onClick:e[0]||(e[0]=t=>D.locationStartSelect())},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{color:"primary",src:i.locationOutline,slot:"start"},null,8,["src"]),(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[d,(0,a.Uk)(" "+(0,n.zw)(O.locationStart.location_address),1)])),_:1})])),_:1})):((0,a.wg)(),(0,a.j4)($,{key:1,button:"","detail-icon":i.addOutline,onClick:e[1]||(e[1]=t=>D.locationStartSelect())},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{color:"medium",src:i.locationOutline,slot:"start"},null,8,["src"]),(0,a.Wm)(R,{color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)("Откуда забрать?")])),_:1})])),_:1},8,["detail-icon"])),O.locationFinish?((0,a.wg)(),(0,a.j4)($,{key:2,button:"",onClick:e[2]||(e[2]=t=>D.locationFinishSelect())},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{color:"primary",src:i.flagOutline,slot:"start"},null,8,["src"]),(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[u,(0,a.Uk)(" "+(0,n.zw)(O.locationFinish.location_address),1)])),_:1})])),_:1})):((0,a.wg)(),(0,a.j4)($,{key:3,button:"","detail-icon":i.addOutline,onClick:e[3]||(e[3]=t=>D.locationFinishSelect())},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{color:"medium",src:i.flagOutline,slot:"start"},null,8,["src"]),(0,a.Wm)(R,{color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)("Куда отвезти?")])),_:1})])),_:1},8,["detail-icon"])),(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a.Wm)(G,{mode:"ios",value:"atonce"},{default:(0,a.w5)((()=>[(0,a.Wm)(F,{value:"atonce"},{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Как можно скорее")])),_:1}),(0,a.Uk)(" отвезти сразу ")])),_:1}),(0,a.Wm)(F,{value:"schedule",onClick:e[4]||(e[4]=t=>D.datetimePick())},{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[m])),_:1}),(0,a.Uk)(" выберите день и время ")])),_:1})])),_:1})])),_:1}),(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[p])),_:1})])),_:1})])),_:1}),1==O.tariffRule.paymentByCash?((0,a.wg)(),(0,a.j4)($,{key:0,button:"",detail:"false",onClick:e[5]||(e[5]=t=>O.paymentType="use_cash")},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{icon:t.cashOutline,slot:"start",color:"primary"},null,8,["icon"]),h,(0,a._)("div",_,[(0,a._)("input",{type:"radio",name:"paymentType",id:"payment_cash",value:"cash",checked:"use_cash"==O.paymentType},null,8,y)])])),_:1})):(0,a.kq)("",!0),1==O.tariffRule.paymentByCashStore?((0,a.wg)(),(0,a.j4)($,{key:1,button:"",detail:"false",onClick:e[6]||(e[6]=t=>O.paymentType="use_cash_store")},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{icon:t.cashOutline,slot:"start",color:"primary"},null,8,["icon"]),g,(0,a._)("div",k,[(0,a._)("input",{type:"radio",name:"paymentType",id:"payment_cash_store",value:"cash",checked:"use_cash_store"==O.paymentType},null,8,f)])])),_:1})):(0,a.kq)("",!0),1==O.tariffRule.paymentByCard?((0,a.wg)(),(0,a.iD)("div",w,[(0,a.Wm)($,{detail:"false",button:"",onClick:e[7]||(e[7]=t=>O.paymentType="use_card")},{default:(0,a.w5)((()=>[(0,a.Wm)(T,{icon:t.cardOutline,slot:"start",color:"primary"},null,8,["icon"]),v,(0,a._)("div",C,[(0,a._)("input",{type:"radio",name:"paymentType",id:"payment_card",value:"card",checked:"use_card"==O.paymentType},null,8,W)])])),_:1}),null!==(o=O.bankCard)&&void 0!==o&&o.card_type?((0,a.wg)(),(0,a.j4)($,{key:0,button:"",detail:"false",onClick:e[8]||(e[8]=t=>O.paymentType="use_card_recurrent")},{default:(0,a.w5)((()=>{var e;return["mir"==O.bankCard.card_type?((0,a.wg)(),(0,a.j4)(z,{key:0,class:"card_type",src:`/img/icons/card-${O.bankCard.card_type}.svg`,slot:"start"},null,8,["src"])):"visa"==O.bankCard.card_type?((0,a.wg)(),(0,a.j4)(z,{key:1,class:"card_type",src:`/img/icons/card-${O.bankCard.card_type}.svg`,slot:"start"},null,8,["src"])):"mastercard"==O.bankCard.card_type?((0,a.wg)(),(0,a.j4)(z,{key:2,class:"card_type",src:`/img/icons/card-${O.bankCard.card_type}.svg`,slot:"start"},null,8,["src"])):((0,a.wg)(),(0,a.j4)(T,{key:3,src:t.cardOutline,slot:"start",color:"primary"},null,8,["src"])),(0,a._)("label",b,"Оплата картой "+(0,n.zw)(null===(e=O.bankCard)||void 0===e?void 0:e.card_mask),1),(0,a._)("div",I,[(0,a._)("input",{type:"radio",name:"paymentType",id:"use_card_recurrent",value:"registered_card",checked:"use_card_recurrent"==O.paymentType},null,8,S)])]})),_:1})):(0,a.kq)("",!0),O.recurrentPaymentAllow?((0,a.wg)(),(0,a.j4)($,{key:1,button:"",detail:"",onClick:e[9]||(e[9]=e=>t.$go("/user/user-cards"))},{default:(0,a.w5)((()=>{var t;return[null!==(t=O.bankCard)&&void 0!==t&&t.card_type?((0,a.wg)(),(0,a.j4)(L,{key:0,color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)("Выбрать другую карту")])),_:1})):((0,a.wg)(),(0,a.j4)(L,{key:1,color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)("Привязать карту")])),_:1}))]})),_:1})):(0,a.kq)("",!0)])):(0,a.kq)("",!0),(0,a.Uk)(" "+(0,n.zw)(O.locationStart)+" ",1),D.checkoutError?((0,a.wg)(),(0,a.j4)(P,{key:3,color:"warning"},{default:(0,a.w5)((()=>[(0,a.Wm)(A,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(D.checkoutError),1)])),_:1})])),_:1})):(0,a.kq)("",!0)]})),_:1},512)}o(8862);var D=o(4929),L=o(8903),$=o(5836),T=o(4405),R=o(9755),U=o.n(R);function j(t,e,o,i,l,s){const r=(0,a.up)("ion-title"),c=(0,a.up)("ion-icon"),d=(0,a.up)("ion-item"),u=(0,a.up)("ion-toolbar"),m=(0,a.up)("ion-header"),p=(0,a.up)("ion-img"),h=(0,a.up)("ion-label"),_=(0,a.up)("ion-list"),y=(0,a.up)("ion-list-header"),g=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Мои адреса")])),_:1}),(0,a.Wm)(c,{slot:"end",onClick:e[0]||(e[0]=t=>{s.modalClose()}),icon:i.closeOutline,size:"large"},null,8,["icon"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[l.locationList.length?((0,a.wg)(),(0,a.j4)(_,{key:0,lines:"full"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.locationList,((e,o)=>((0,a.wg)(),(0,a.j4)(d,{key:e.location_id},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{slot:"start",alt:"location icon",src:`${t.$heap.state.hostname}/image/get.php/${e.image_hash}.60.60.png`,style:{height:"24px"}},null,8,["src"]),(0,a.Wm)(h,{onClick:t=>s.locationSelect(e),style:{"white-space":"normal",cursor:"pointer"},class:(0,n.C_)(1==e.is_main?"is_main":"")},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.location_address),1)])),_:2},1032,["onClick","class"]),(0,a.Wm)(c,{slot:"end",icon:i.trashOutline,onClick:t=>s.locationDelete(`${e.location_id}`,`${o}`)},null,8,["icon","onClick"])])),_:2},1024)))),128))])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Добавить адрес")])),_:1})])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.locationGroupList,(e=>((0,a.wg)(),(0,a.j4)(d,{key:e.group_id,onClick:t=>s.modalLocationCreate(`${e.group_id}`,`${e.group_name}`),style:{cursor:"pointer"}},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{src:`${t.$heap.state.hostname}/image/get.php/${e.image_hash}.60.60.png`,style:{height:"24px"},slot:"start"},null,8,["src"]),(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.group_name),1)])),_:2},1024),(0,a.Wm)(c,{src:i.addOutline,slot:"end"},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1})],64)}o(3948);var F=o(2008),G=o(351),x=o(4075),z={components:{IonImg:D.Xz,IonLabel:D.Q$,IonItem:D.Ie,IonList:D.q_,IonListHeader:D.yh,IonIcon:D.gu,IonHeader:D.Gu,IonToolbar:D.sr,IonTitle:D.wd,IonContent:D.W2},setup(){return{locationOutline:L.Iv7,trashOutline:L.gtu,addOutline:L.s6O,closeOutline:L.fID}},data(){return{locationList:[],locationGroupList:[]}},mounted(){this.locationListGet(),this.$topic.on("dismissModal",(()=>this.modalClose()))},computed:{mainAddress(){var t;return null===(t=this.locationList)||void 0===t?void 0:t.find((t=>1==t.is_main))}},methods:{modalClose(){D.Fy.dismiss(null,"cancel")},async modalLocationCreate(t,e){if(!F.Z.getters.userIsLogged)return void(confirm("Чтобы добавленный адрес сохранился, необходимо авторизироваться")&&this.$go("/user/sign-in"));var o=String(e).toLowerCase();const a=await D.Fy.create({component:x.Z,showBackdrop:!0,componentProps:{location_group_name_low:o}});return a.onDidDismiss().then((e=>{this.locationCreate(t,e.data)})),a.present()},async locationListGet(){try{let t=null;const e=await U().get(F.Z.state.hostname+"User/locationListGet",{includeGroupList:1});if(this.locationList=e.location_list,this.locationGroupList=e.location_group_list,this.locationList)for(let o of this.locationList)1==o.is_main&&(t=o);if(!t)return void G.Z.get()}catch(t){}},async locationCreate(t,e){if(!e)return;let o={location_holder:"user",location_holder_id:F.Z.state.user.user_id,location_group_id:t,location_address:e.location_address,location_latitude:e.location_latitude,location_longitude:e.location_longitude};try{await U().post(F.Z.state.hostname+"User/locationCreate",o),this.locationListGet()}catch(a){const t=a.responseJSON,e=t.messages.error;switch(e){case"limit_exeeded":this.$flash("Больше адресов добавить нельзя");break}return!1}},locationSelect(t){D.Fy.dismiss(t,"confirm")},async locationDelete(t,e){if(confirm("Удалить адрес доставки?")){try{this.locationList.splice(e,1),await U().post(F.Z.state.hostname+"User/locationDelete",{location_id:t})}catch(o){}this.locationListGet()}}}},A=o(3744);const P=(0,A.Z)(z,[["render",j],["__scopeId","data-v-1f3c9982"]]);var B=P;const Z={style:{height:"100%"}};function H(t,e,o,i,l,s){const r=(0,a.up)("ion-title"),c=(0,a.up)("ion-toolbar"),d=(0,a.up)("ion-header"),u=(0,a.up)("ion-datetime"),m=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)("div",Z,[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Время прибытия курьера "+(0,n.zw)(l.datetime),1)])),_:1})])),_:1})])),_:1}),(0,a.Wm)(m,{class:"ion-padding"},{default:(0,a.w5)((()=>{var t,n;return[(0,a.Wm)(u,{style:{"max-width":"100%"},presentation:"date-time",modelValue:l.datetime,"onUpdate:modelValue":e[0]||(e[0]=t=>l.datetime=t),"prefer-wheel":!0,"first-day-of-week":1,min:null===(t=o.dateRange)||void 0===t?void 0:t.dayFirst,max:null===(n=o.dateRange)||void 0===n?void 0:n.dayLast,"hour-values":s.hv,"minute-values":0,"show-default-buttons":!0,onIonConfirm:e[1]||(e[1]=t=>console.log(t))},null,8,["modelValue","min","max","hour-values"]),(0,a._)("button",{onClick:e[2]||(e[2]=t=>s.conf())},"iii")]})),_:1})])}var q={props:["dateRange"],components:{IonTitle:D.wd,IonDatetime:D.x4,IonToolbar:D.sr,IonContent:D.W2,IonHeader:D.Gu},data(){return{datetime:this.dateRange.dayFirst}},computed:{hv(){if(this.dateRange&&this.dateRange.dayHours&&this.datetime){const[t]=this.datetime.split("T");return this.dateRange.dayHours[t]}return null}},watch:{dateRange(){this.datetime=this.dateRange.dayFirst}},mounted(){},methods:{conf(){D.Fy.dismiss("name.value","confirm")},dateChanged(t){var e;const o=null!==(e=t.detail.value)&&void 0!==e?e:null;if(!o)return;const[a,n]=o.split("T");this.hourValues=this.dateRange.dayHours[a]}}};const J=(0,A.Z)(q,[["render",H],["__scopeId","data-v-bbe02ed2"]]);var M=J,N={components:{yandexMap:$.xR,ymapMarker:$.Jk,IonText:D.yW,IonList:D.q_,IonItem:D.Ie,IonIcon:D.gu,IonLabel:D.Q$,IonSegment:D.cJ,IonSegmentButton:D.GO,IonImg:D.Xz,IonCard:D.PM,IonCardContent:D.FN},setup(){return{cubeOutline:L.XFf,locationOutline:L.Iv7,flagOutline:L.FMn,chevronDown:L.Dd1,addOutline:L.s6O,checkmark:L.d29}},computed:{checkoutError(){return"no_input"==this.errorCode?"Выберите адрес забора и доставки посылки":"no_courier"==this.errorCode?"Нет доступных курьеров":null}},data(){var t,e;return{presentingElement:null,isDatePickerOpen:!1,deliveryStartRange:{},deliveryStartRangeHours:[],ship_id:this.$route.params.id,ship:null,shipAutoloadClock:null,paymentType:"use_card",bankCard:null,recurrentPaymentAllow:1==(null===(t=this.$heap.state.settings)||void 0===t||null===(e=t.other)||void 0===e?void 0:e.recurrentPaymentAllow)?1:0,tariffRule:{},tariffRuleList:[],errorCode:null,locationStart:null,locationFinish:null,mapsettings:null,placemarkCoords:null,placemarkProperties:{},placemarkIcon:{layout:"default#imageWithContent",content:"some content here",contentLayout:'<div class="placemarkBaloon">$[properties.iconContent]</div>',contentOffset:[45,10],imageHref:"/img/tezkel-placemark.png",imageSize:[50,50],imageOffset:[-25,-50]}}},methods:{deliveryTimeAllowed(t){const e=new Date(t);e.getUTCDay();return!0},async itemLoad(){this.itemCheckoutDataGet()},async itemCheckoutDataGet(){try{let t=await T.Z.prePost(`${this.$heap.state.hostname}Shipment/itemCheckoutDataGet`,{ship_id:this.ship_id});this.itemCheckoutDataUse(t),t=await T.Z.post(`${this.$heap.state.hostname}Shipment/itemCheckoutDataGet`,{ship_id:this.ship_id}),this.itemCheckoutDataUse(t),this.isDatePickerOpen=!0}catch(o){var t,e;return this.is_checkout_data_loaded=1,this.errorCode=null===o||void 0===o||null===(t=o.responseJSON)||void 0===t||null===(e=t.messages)||void 0===e?void 0:e.error,console.log(this.errorCode),!1}},async itemCheckoutDataUse(t){var e;t&&(this.deliveryTime=T.Z.deliveryTimeCalculate(t.Location_distanceGet,0),this.deliveryStartRange=t.DeliveryStartRange,this.locationStart=t.Ship_locationStart,this.locationFinish=t.Ship_locationFinish,this.bankCard=null===t||void 0===t?void 0:t.bankCard,this.tariffRuleList=t.Store_deliveryOptions,this.tariffRuleSet((null===(e=this.tariffRuleList)||void 0===e?void 0:e[0])||{}),this.is_checkout_data_loaded=1)},async itemCheckoutDataSet(){var t,e;const o={ship_id:this.ship_id,ship_start_location_id:null===(t=this.locationStart)||void 0===t?void 0:t.location_id,ship_finish_location_id:null===(e=this.locationFinish)||void 0===e?void 0:e.location_id};try{await U().post(`${this.$heap.state.hostname}Shipment/itemCheckoutDataSet`,JSON.stringify(o))}catch(a){console.log(a)}},tariffRuleSet(t){var e;this.tariffRule=t,this.order_sum_delivery=t.order_sum_delivery,this.paymentType="use_card",null!==(e=this.bankCard)&&void 0!==e&&e.card_type&&(this.paymentType="use_card_recurrent"),1==t.paymentByCashStore?this.paymentType="use_cash_store":1==t.paymentByCash&&(this.paymentType="use_cash")},async locationSelect(){const t=document.querySelector("ion-router-outlet"),e=await D.Fy.create({component:B,canDismiss:!0,backdropDismiss:!0,keyboardClose:!0,presentingElement:t});e.present();const{data:o,role:a}=await e.onWillDismiss();return o},async locationStartSelect(){this.locationStart=await this.locationSelect()},async locationFinishSelect(){this.locationFinish=await this.locationSelect()},async datetimePick(){const t=await D.Fy.create({component:M,initialBreakpoint:"0.4",showBackdrop:!0,componentProps:{dateRange:this.deliveryStartRange}});t.present();const e=await t.onDidDismiss();console.log(e)},async customerIpLocationGet(){try{const t=await fetch("https://geolocation-db.com/json/");this.iplocation=await t.json()}catch(t){}},async ymapInit(t){this.mapsettings={apiKey:t.ymapApiKey,lang:"ru_RU",coordorder:"latlong",version:"2.1"},this.placemarkCoords=JSON.parse(t.mapCenter),await(0,$.xk)()}},mounted(){this.itemLoad();let t=this.$heap.state.settings;null!==t&&void 0!==t&&t.location&&this.ymapInit(t.location),this.$topic.on("settingsGet",(async t=>{this.ymapInit(t.location)})),this.presentingElement=this.$refs.page.$el},ionViewDidEnter(){this.itemLoad()}};const E=(0,A.Z)(N,[["render",O],["__scopeId","data-v-a5985204"]]);var V=E}}]);
//# sourceMappingURL=4675.3e7a893d.js.map