{"version":3,"file":"js/755.326f527d.js","mappings":"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","sources":["webpack://Tezkel/./src/components/UserAddressWidget.vue","webpack://Tezkel/./src/components/UserAddressWidget.vue?acf1","webpack://Tezkel/./src/views/OrderCheckout.vue","webpack://Tezkel/./src/components/OrderPaymentCardModal.vue","webpack://Tezkel/./src/components/OrderPaymentCardModal.vue?914f","webpack://Tezkel/./src/views/OrderCheckout.vue?1cf7","webpack://Tezkel/./src/scripts/Utils.js"],"sourcesContent":["<style scoped>\r\n  .center{\r\n    height: 100%;\r\n    width: 100%;\r\n    border-top-right-radius: 40px;\r\n    border-bottom-right-radius: 40px;\r\n    background-color: white;\r\n    display: flex;\r\n    align-items: center;\r\n    box-shadow: 5px 0px 5px #0004;\r\n    overflow: hidden;\r\n  }\r\n  .rightend{\r\n    height: 100%;\r\n    width:90px;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n  }\r\n  .selector{\r\n    display: flex;\r\n    background-color: var(--ion-color-secondary);\r\n    height: 40px;\r\n    box-shadow: 0px 0px 15px #0004;\r\n    -margin-bottom: 20px;\r\n  }\r\n  ion-img{\r\n    height: 24px;\r\n    margin: 7px;\r\n  }\r\n</style>\r\n\r\n<template>\r\n    <div v-if=\"isMainLocationSet\" @click=\"selectDeliveryAddress()\" class=\"selector\">\r\n      <div class=\"center\">\r\n        <ion-img v-if=\"location_main.image_hash\" :src=\"$heap.state.hostname + 'image/get.php/'+location_main.image_hash+'.40.40.webp'\"/>\r\n        <ion-text style=\"margin:5px;font-size: 0.7em;\" color=\"dark\">{{$heap.state.user?.location_main?.location_address}}</ion-text>\r\n      </div>\r\n      <div class=\"rightend\" v-if=\"deliveryTime\">\r\n        <ion-text style=\"font-size:24px;color:var(--ion-color-secondary-contrast)\">{{deliveryTime.time}}</ion-text>\r\n        <ion-note style=\"font-size:10px;color:var(--ion-color-secondary-contrast)\">мин</ion-note>\r\n      </div>\r\n      <div class=\"rightend\" v-else></div>\r\n    </div>\r\n    <ion-item v-else detail button @click=\"selectDeliveryAddress()\" class=\"selector\">\r\n      <ion-icon slot=\"start\" style=\"color: var(--ion-color-primary)\" :icon=\"location\"/>\r\n      <ion-label> Выбрать адрес доставки </ion-label>\r\n    </ion-item>\r\n\r\n    <ion-item v-if=\"showComment && $heap.state.user.location_main\">\r\n        <ion-textarea placeholder=\"комментарий к адресу\" @change=\"locationCommentChanged()\" v-model=\"$heap.state.user.location_main.location_comment\"></ion-textarea>\r\n    </ion-item>\r\n</template>\r\n\r\n<script>\r\nimport { \r\n  IonIcon,\r\n  IonTextarea,\r\n  IonImg,\r\n  IonText,\r\n  IonNote,\r\n  IonLabel,\r\n  IonItem,\r\n }  from \"@ionic/vue\";\r\nimport { location }             from \"ionicons/icons\";\r\nimport heap                     from \"@/heap\";\r\nimport router                   from '@/router';\r\nimport Topic                    from '@/scripts/Topic.js'\r\nimport jQuery                   from 'jquery';\r\n\r\nexport default {\r\n  props:['deliveryTime','showComment'],\r\n  components: {\r\n      IonIcon,\r\n      IonTextarea,\r\n      IonImg,\r\n      IonText,\r\n      IonNote,\r\n      IonLabel,\r\n      IonItem,\r\n  },\r\n  setup() {\r\n    return { location };\r\n  },\r\n  data() {\r\n    return {\r\n      location_main: heap.state.user.location_main,\r\n    };\r\n  },\r\n  created(){\r\n    let self=this;\r\n    Topic.on('userMainLocationSet',mainloc=>{\r\n      self.location_main=mainloc\r\n    })\r\n    Topic.on('userGet',user=>{\r\n      self.location_main=user.location_main\r\n    })\r\n  },\r\n  methods: {\r\n    selectDeliveryAddress() {\r\n        router.push('user-addresses');\r\n    },\r\n    async locationCommentChanged(){\r\n      const request={\r\n        location_id:heap.state.user.location_main.location_id,\r\n        location_comment:heap.state.user.location_main.location_comment\r\n      };\r\n      jQuery.post( this.$heap.state.hostname + \"Location/itemUpdate\", JSON.stringify(request) );\r\n    }\r\n  },\r\n  computed: {\r\n    isSignedIn() {\r\n      return heap.state.user.user_id && heap.state.user.user_id > -1;\r\n    },\r\n    isMainLocationSet(){\r\n        return this.location_main?1:0;\r\n    }\r\n  },\r\n};\r\n</script>","import { render } from \"./UserAddressWidget.vue?vue&type=template&id=45e69907&scoped=true\"\nimport script from \"./UserAddressWidget.vue?vue&type=script&lang=js\"\nexport * from \"./UserAddressWidget.vue?vue&type=script&lang=js\"\n\nimport \"./UserAddressWidget.vue?vue&type=style&index=0&id=45e69907&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-45e69907\"]])\n\nexport default __exports__","<style scoped>\r\n    ion-list{\r\n        box-shadow: 0px -5px 5px #eee;\r\n    }\r\n</style>\r\n<template>\r\n    <base-layout :pageTitle=\"`Оформление заказа`\"  :pageDefaultBackLink=\"order?`/order-${order.order_id}`:`order-list`\">\r\n        <user-address-widget :deliveryTime=\"deliveryTime\" showComment=\"1\"></user-address-widget>\r\n\r\n        <ion-list v-if=\"order\">\r\n            <ion-item-divider>Заказ</ion-item-divider>\r\n            <ion-item>\r\n                <ion-icon :icon=\"ordersIcon\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                Номер \r\n                <ion-text slot=\"end\">#{{order?.order_id}}</ion-text>\r\n            </ion-item>            \r\n            <ion-item>\r\n                <ion-icon :icon=\"storefrontOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                Из \"{{order?.store.store_name}}\"\r\n            </ion-item>            \r\n            <ion-item>\r\n                <ion-textarea rows=\"3\" placeholder=\"комментарий к заказу\" @change=\"orderDescriptionChanged()\" v-model=\"order.order_description\"></ion-textarea>\r\n            </ion-item>\r\n\r\n\r\n            <ion-item-divider>Итого к оплате</ion-item-divider>\r\n            <ion-item button detail>\r\n                <ion-icon :icon=\"giftOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                Выберите акцию\r\n            </ion-item>\r\n            <ion-item v-if=\"order?.order_sum_tax\">\r\n                <ion-icon :icon=\"pieChartOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                Налоги \r\n                <ion-text slot=\"end\">{{order?.order_sum_tax}}</ion-text>\r\n            </ion-item>\r\n            <ion-item>\r\n                <ion-icon :icon=\"rocketOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                Доставка \r\n                <ion-text slot=\"end\">{{order?.order_sum_delivery??0}}</ion-text>\r\n            </ion-item>\r\n            <ion-item>\r\n                <ion-icon :icon=\"walletOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                Итого\r\n                <ion-text slot=\"end\">{{order?.order_sum_total}}</ion-text>\r\n            </ion-item>\r\n\r\n            <ion-item-divider>Способы оплаты</ion-item-divider>\r\n            <ion-item button @click=\"paymentType='payment_card'\">\r\n                <ion-icon :icon=\"cardOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                <label for=\"payment_card\">Оплата картой</label>\r\n                <div slot=\"end\">\r\n                    <input type=\"radio\" name=\"paymentType\" id=\"payment_card\" value=\"card\"  :checked=\"paymentType == 'payment_card'\">\r\n                </div>\r\n            </ion-item>\r\n            <ion-item button @click=\"paymentType='payment_cash'\" v-if=\"0\">\r\n                <ion-icon :icon=\"cashOutline\" slot=\"start\" color=\"primary\"></ion-icon>\r\n                <label for=\"payment_cash\">Оплата наличными</label>\r\n                <div slot=\"end\">\r\n                    <input type=\"radio\" name=\"paymentType\" id=\"payment_cash\" value=\"cash\" :checked=\"paymentType == 'payment_cash'\">\r\n                </div>\r\n            </ion-item>\r\n\r\n        </ion-list>\r\n        <ion-grid>\r\n            <ion-row>\r\n                <ion-col><ion-button expand=\"block\" color=\"medium\" @click=\"cancel()\">Вернуться</ion-button></ion-col>\r\n                <ion-col><ion-button expand=\"block\" @click=\"proceed()\">Продолжить</ion-button></ion-col>\r\n            </ion-row>\r\n        </ion-grid>\r\n    </base-layout>\r\n</template>\r\n\r\n<script>\r\nimport Order    from '@/scripts/Order.js';\r\nimport Utils    from '@/scripts/Utils.js';\r\nimport Topic    from '@/scripts/Topic.js';\r\nimport router   from '@/router';\r\nimport jQuery   from 'jquery';\r\n\r\nimport ordersIcon   from \"@/assets/icons/orders.svg\";\r\nimport { \r\n    cardOutline,\r\n    cashOutline,\r\n    giftOutline,\r\n    cubeOutline,\r\n    walletOutline,\r\n    pieChartOutline,\r\n    storefrontOutline,\r\n    rocketOutline\r\n    }                           from 'ionicons/icons';\r\nimport { \r\n    modalController,\r\n    IonTextarea,\r\n    IonItemDivider,\r\n    IonIcon,\r\n    IonItem,\r\n    IonList,\r\n    IonText,\r\n    IonItemGroup,\r\n    IonButton,\r\n    IonCol,\r\n    IonRow,\r\n    IonGrid,\r\n}                               from \"@ionic/vue\";\r\nimport UserAddressWidget        from '@/components/UserAddressWidget.vue';\r\nimport OrderPaymentCardModal    from '@/components/OrderPaymentCardModal.vue';\r\n\r\nexport default({\r\n    components: { \r\n        UserAddressWidget,\r\n        IonTextarea,\r\n        IonItemDivider,\r\n        IonIcon,\r\n        IonItem,\r\n        IonList,\r\n        IonText,\r\n        IonItemGroup,\r\n        IonButton,\r\n        IonCol,\r\n        IonRow,\r\n        IonGrid,\r\n    },\r\n    setup(){\r\n        return {cardOutline,cashOutline,giftOutline,cubeOutline,walletOutline,pieChartOutline,storefrontOutline,ordersIcon,rocketOutline};\r\n    },\r\n    data(){\r\n        return {\r\n            order:null,\r\n            deliveryTime:{},\r\n            paymentType:'payment_card'\r\n        }\r\n    },\r\n    mounted(){\r\n        this.checkoutDataGet();\r\n    },\r\n    ionViewDidEnter(){\r\n        this.checkoutDataGet();\r\n    },\r\n    methods:{\r\n        async checkoutDataGet(){\r\n            this.order=this.$heap.state.currentOrder;\r\n            if( !this.order ){\r\n                this.$flash(\"Заказ не найден\");\r\n                this.$router.push('/order-list')\r\n                //await this.orderGet();\r\n            }\r\n            if( this.order.stage_current!=\"customer_confirmed\" ){\r\n                router.push('order-'+this.order.order_id);\r\n                return;\r\n            }\r\n            const preparation=null;//use default prep time\r\n            this.distance= await this.distanceGet();\r\n            if(this.distance){\r\n                this.deliveryTime=Utils.deliveryTimeCalculate(this.distance,preparation);\r\n            }\r\n        },\r\n        // async orderGet(){\r\n        //     try{\r\n        //         this.order=await Order.api.itemGet(this.order_id);\r\n        //     } catch(err) {\r\n        //         switch(err.status){\r\n        //             case 404:\r\n        //                 this.$flash(\"Заказ не найден\");\r\n        //                 this.order='notfound';\r\n        //                 router.go(-1);\r\n        //                 break;\r\n        //         }\r\n        //     }\r\n        // },\r\n        async distanceGet(){\r\n            const request={\r\n                start_holder:'store',\r\n                start_holder_id:this.order.order_store_id,\r\n                finish_holder:'user',\r\n                finish_holder_id:this.order.owner_id\r\n            };\r\n            try{\r\n                return await jQuery.post( this.$heap.state.hostname + \"Location/distanceHolderGet\", request );\r\n            } catch (err){\r\n                //\r\n            }\r\n        },\r\n        async orderDescriptionChanged(){\r\n            const request={\r\n                order_id:this.order.order_id,\r\n                order_description:this.order.order_description\r\n            };\r\n            Order.api.itemUpdate(request);\r\n        },\r\n        async proceed(){\r\n            if(this.paymentType=='payment_cash'){\r\n                //\r\n            }\r\n            if(this.paymentType=='payment_card'){\r\n                this.paymentFormOpen({\r\n                    order_id:this.order.order_id,\r\n                    order_sum_total:this.order.order_sum_total,\r\n                    user_id:this.order.owner_id\r\n                });\r\n            }\r\n        },\r\n        async cancel(){\r\n            // try{\r\n            //     await Order.api.itemStageCreate(this.order.order_id, 'customer_cart');\r\n            // } catch(err){/* */}\r\n            this.$router.push('order-'+this.order.order_id);\r\n        },\r\n        async paymentFormOpen( order_data ) {\r\n            const self=this;\r\n            const modal = await modalController.create({\r\n                component: OrderPaymentCardModal,\r\n                componentProps:{order_data},\r\n                initialBreakpoint: 0.85,\r\n                breakpoints: [0, 0.85, 0.95]\r\n                });\r\n            const dismissFn=function(){\r\n                modal.dismiss();\r\n            };\r\n            Topic.on('dismissModal',dismissFn);\r\n\r\n            modal.onDidDismiss().then(()=>{\r\n                self.paymentStatusCheck();\r\n            })\r\n            return modal.present();\r\n        },\r\n        async paymentStatusCheck(){\r\n            const request={\r\n                order_id:this.order.order_id\r\n            };\r\n            try{\r\n                const result= await jQuery.post( this.$heap.state.hostname + \"UniPayments/paymentStatusRequest\", request );\r\n                if(result=='OK'){\r\n                    router.push('order-'+this.order.order_id)\r\n                }\r\n            } catch(err){\r\n                this.$flash(\"Данный заказ не может быть оплачен\");\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='wrong_status'){\r\n                    router.push('order-'+this.order.order_id);\r\n                }\r\n            }\r\n        }\r\n    }\r\n})\r\n</script>","\r\n<template>\r\n  <ion-header>\r\n      <ion-toolbar color=\"secondary\">\r\n          <ion-title slot=\"start\" style=\"color:black\">Оплата картой</ion-title>\r\n          <ion-icon :icon=\"closeOutline\" @click=\"closeModal();\" slot=\"end\" size=\"large\"></ion-icon>\r\n      </ion-toolbar>\r\n  </ion-header>\r\n  <ion-content>\r\n    <iframe :src=\"paymentLink\" id=\"paymentFrame1\" style=\"width: 100%; height: 600px;border:none\" @load=\"onLoad()\"></iframe>\r\n    <div v-if=\"loadAnimation\" style=\"position:fixed;top:200px;left:calc( 50% - 50px )\">\r\n      <img :src=\"loading\"/>\r\n    </div>\r\n  </ion-content>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  modalController,\r\n  IonTitle,\r\n  IonIcon,\r\n  IonToolbar,\r\n  IonHeader,\r\n  IonContent,\r\n}                           from \"@ionic/vue\";\r\nimport {closeOutline}       from 'ionicons/icons';\r\nimport loading              from '@/assets/icons/loading.svg';\r\nimport jQuery               from 'jquery';\r\n\r\nexport default{\r\n  components: {\r\n  IonTitle,\r\n  IonIcon,\r\n  IonToolbar,\r\n  IonHeader,\r\n  IonContent,\r\n  },\r\n  props:['order_data'],\r\n  setup() {\r\n      const closeModal = function(){\r\n          modalController.dismiss();\r\n      };\r\n      return { closeModal, closeOutline,loading };\r\n  },\r\n  data(){\r\n    return {\r\n      paymentLink:null,\r\n      loadAnimation:1\r\n    };\r\n  },\r\n  mounted(){\r\n    this.listenFrame();\r\n    this.postToIframe();\r\n  },\r\n  methods: {\r\n    async postToIframe(){\r\n        try{\r\n            this.paymentLink=await jQuery.post(this.$heap.state.hostname+'UniPayments/paymentLinkGet',this.order_data);\r\n        } catch(err){\r\n            this.$flash(\"Нет возможности принять оплату картой\");\r\n            this.closeModal();\r\n        }\r\n    },\r\n    onLoad(){\r\n       this.loadAnimation=0;\r\n    },\r\n    listenFrame(){\r\n      let self=this;\r\n      window.addEventListener('message',event=>{\r\n        if( event.data=='paymentOk' || event.data=='paymentNo' ){\r\n          self.closeModal();\r\n        }\r\n      })\r\n    }\r\n  }\r\n};\r\n</script>","import { render } from \"./OrderPaymentCardModal.vue?vue&type=template&id=7b1d9e09\"\nimport script from \"./OrderPaymentCardModal.vue?vue&type=script&lang=js\"\nexport * from \"./OrderPaymentCardModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./OrderCheckout.vue?vue&type=template&id=73fc7a64&scoped=true\"\nimport script from \"./OrderCheckout.vue?vue&type=script&lang=js\"\nexport * from \"./OrderCheckout.vue?vue&type=script&lang=js\"\n\nimport \"./OrderCheckout.vue?vue&type=style&index=0&id=73fc7a64&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-73fc7a64\"]])\n\nexport default __exports__","import heap from '@/heap';\r\nconst Utils={\r\n    deliveryCalculate(Store){\r\n        if( !Store.locations || !Store.locations[0] || !Store.locations[0].distance){\r\n            return null;\r\n        }\r\n        const distance=Store.locations[0].distance;\r\n        const preparation=Store.store_time_preparation||0;\r\n        return Utils.deliveryTimeCalculate(distance,preparation);\r\n    },\r\n    deliveryTimeCalculate(distance,preparation){\r\n        preparation=parseInt(preparation??heap.getters.settings.delivery.timePreparationDefault)\r\n        const delta=parseInt(heap.getters.settings.delivery.timeDelta)\r\n        const speed=parseInt(heap.getters.settings.delivery.speed)\r\n        const time=Math.round(distance/speed*60/5)*5+preparation\r\n        const timeMin=time>delta?time-delta:time\r\n        const timeMax=timeMin+delta\r\n        return {time,timeMin,timeMax}\r\n    }\r\n  };\r\n  export default Utils;"],"names":["class","isMainLocationSet","selectDeliveryAddress","location_main","image_hash","src","$heap","state","hostname","style","color","user","location_address","deliveryTime","time","detail","button","slot","icon","location","showComment","placeholder","locationCommentChanged","location_comment","props","components","IonIcon","IonTextarea","IonImg","IonText","IonNote","IonLabel","IonItem","setup","data","heap","created","self","this","Topic","mainloc","methods","router","async","request","location_id","JSON","stringify","computed","isSignedIn","__exports__","render","for","pageTitle","pageDefaultBackLink","order","order_id","ordersIcon","storefrontOutline","store","store_name","rows","orderDescriptionChanged","order_description","giftOutline","order_sum_tax","pieChartOutline","rocketOutline","order_sum_delivery","walletOutline","order_sum_total","paymentType","cardOutline","type","name","id","value","checked","expand","cancel","proceed","closeOutline","closeModal","size","paymentLink","onLoad","loadAnimation","loading","IonTitle","IonToolbar","IonHeader","IonContent","mounted","listenFrame","postToIframe","order_data","err","$flash","window","addEventListener","event","UserAddressWidget","IonItemDivider","IonList","IonItemGroup","IonButton","IonCol","IonRow","IonGrid","cashOutline","cubeOutline","checkoutDataGet","ionViewDidEnter","currentOrder","$router","push","stage_current","preparation","distance","distanceGet","Utils","start_holder","start_holder_id","order_store_id","finish_holder","finish_holder_id","owner_id","Order","paymentFormOpen","user_id","modal","component","OrderPaymentCardModal","componentProps","initialBreakpoint","breakpoints","dismissFn","dismiss","onDidDismiss","then","paymentStatusCheck","present","result","message","responseJSON","messages","error","deliveryCalculate","Store","locations","store_time_preparation","deliveryTimeCalculate","parseInt","delta","speed","Math","round","timeMin","timeMax"],"sourceRoot":""}