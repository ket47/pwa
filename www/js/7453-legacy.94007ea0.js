"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[7453],{7453:function(t,e,n){n.r(e),n.d(e,{default:function(){return b}});var a=n(6252),o=n(3577),r=(0,a.Uk)(" Пока адреса не добавлены "),i=(0,a.Uk)("Добавить адрес");function s(t,e,n,s,u,c){var l=(0,a.up)("ion-img"),p=(0,a.up)("ion-label"),d=(0,a.up)("ion-icon"),_=(0,a.up)("ion-item"),h=(0,a.up)("ion-list"),f=(0,a.up)("ion-card-content"),m=(0,a.up)("ion-card"),g=(0,a.up)("ion-list-header"),w=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(w,{"page-title":"Мои адреса",pageDefaultBackLink:"/user",ref:"UserAddressPage"},{default:(0,a.w5)((function(){return[u.locationList.length?((0,a.wg)(),(0,a.j4)(h,{key:0,lines:"full"},{default:(0,a.w5)((function(){return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(u.locationList,(function(e,n){return(0,a.wg)(),(0,a.j4)(_,{key:e.location_id},{default:(0,a.w5)((function(){return[(0,a.Wm)(l,{slot:"start",alt:"location icon",src:`${t.$heap.state.hostname}/image/get.php/${e.image_hash}.32.32.png`},null,8,["src"]),(0,a.Wm)(p,{onClick:function(t){return c.locationSetMain(`${e.location_id}`,`${n}`)},style:{"white-space":"normal",cursor:"pointer"}},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,o.zw)(e.location_address),1)]})),_:2},1032,["onClick"]),(0,a.Wm)(d,{slot:"end",icon:s.trash,onClick:function(t){return c.locationDelete(`${e.location_id}`,`${n}`)}},null,8,["icon","onClick"])]})),_:2},1024)})),128))]})),_:1})):((0,a.wg)(),(0,a.j4)(m,{key:1,color:"warning"},{default:(0,a.w5)((function(){return[(0,a.Wm)(f,null,{default:(0,a.w5)((function(){return[r]})),_:1})]})),_:1})),(0,a.Wm)(h,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(g,null,{default:(0,a.w5)((function(){return[(0,a.Wm)(p,null,{default:(0,a.w5)((function(){return[i]})),_:1})]})),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(u.locationGroupList,(function(e){return(0,a.wg)(),(0,a.j4)(_,{key:e.group_id,onClick:function(t){return c.modalLocationCreate(`${e.group_id}`,`${e.group_name}`)},style:{cursor:"pointer"}},{default:(0,a.w5)((function(){return[(0,a.Wm)(l,{src:`${t.$heap.state.hostname}/image/get.php/${e.image_hash}.32.32.png`},null,8,["src"]),(0,a.Wm)(p,{style:{"margin-left":"5px","padding-left":"5px","border-left":"solid 1px black","white-space":"normal"}},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,o.zw)(e.group_name),1)]})),_:2},1024)]})),_:2},1032,["onClick"])})),128))]})),_:1})]})),_:1},512)}var u=n(8439),c=n(6835),l=n(8534),p=(n(561),n(8292)),d=n(6488),_=n(2008),h=n(351),f=n(9755),m=n.n(f),g=n(4975),w=n(8903),k={name:"UserAddresses",components:{IonImg:p.Xz,IonLabel:p.Q$,IonItem:p.Ie,IonList:p.q_,IonListHeader:p.yh,IonIcon:p.gu,IonCard:p.PM,IonCardContent:p.FN},setup(){return{trash:w._Ij}},mounted(){this.locationListGet()},methods:{modalLocationCreate(t,e){var n=this;return(0,l.Z)((0,c.Z)().mark((function a(){var o,r;return(0,c.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(_.Z.state.user.user_id){a.next=4;break}return n.$flash("Чтобы добавленные адреса сохранились, пожалуйста войдите в систему"),d.Z.push("/user/sign-in"),a.abrupt("return");case 4:return o=String(e).toLowerCase(),a.next=7,p.Fy.create({component:g.Z,showBackdrop:!0,backdropDismiss:!0,swipeToClose:!0,cssClass:"update-profile-modal",presentingElement:n.$refs.UserAddressPage.$el,componentProps:{location_group_name_low:o}});case 7:return r=a.sent,r.onDidDismiss().then((function(e){n.locationCreate(t,e.data)})),a.abrupt("return",r.present());case 10:case"end":return a.stop()}}),a)})))()},locationListGet(){var t=this;return(0,l.Z)((0,c.Z)().mark((function e(){var n,a,o,r,i,s,l;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,o=null,e.next=4,m().get(_.Z.state.hostname+"User/locationListGet",{includeGroupList:1});case 4:if(r=e.sent,t.locationList=r.location_list,t.locationGroupList=r.location_group_list,!t.locationList){e.next=26;break}i=(0,u.Z)(t.locationList),e.prev=9,i.s();case 11:if((s=i.n()).done){e.next=18;break}if(l=s.value,1==l.is_main){e.next=15;break}return e.abrupt("continue",16);case 15:o=l;case 16:e.next=11;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e["catch"](9),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:if(o){e.next=29;break}return h.Z.get(),e.abrupt("return");case 29:o&&(null===(n=o)||void 0===n?void 0:n.location_id)!=(null===(a=_.Z.state.user.location_main)||void 0===a?void 0:a.location_id)&&(_.Z.state.user.location_main=o,t.$topic.publish("userMainLocationSet",_.Z.state.user.location_main)),e.next=34;break;case 32:e.prev=32,e.t1=e["catch"](0);case 34:case"end":return e.stop()}}),e,null,[[0,32],[9,20,23,26]])})))()},locationCreate(t,e){var n=this;return(0,l.Z)((0,c.Z)().mark((function a(){var o,r,i;return(0,c.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e){a.next=2;break}return a.abrupt("return");case 2:return o={location_holder:"user",location_holder_id:_.Z.state.user.user_id,location_group_id:t,location_address:e.location_address,location_latitude:e.location_latitude,location_longitude:e.location_longitude},a.prev=3,a.next=6,m().post(_.Z.state.hostname+"User/locationCreate",o);case 6:n.$heap.state.next_route&&(n.$router.push(n.$heap.state.next_route),n.$heap.state.next_route=null),n.locationListGet(),a.next=20;break;case 10:a.prev=10,a.t0=a["catch"](3),r=a.t0.responseJSON,i=r.messages.error,a.t1=i,a.next="limit_exeeded"===a.t1?17:19;break;case 17:return n.$flash("Больше адресов добавить нельзя"),a.abrupt("break",19);case 19:return a.abrupt("return",!1);case 20:case"end":return a.stop()}}),a,null,[[3,10]])})))()},locationSetMain(t,e){var n=this;return(0,l.Z)((0,c.Z)().mark((function a(){var o,r;return(0,c.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return o=n,r=o.locationList[e],_.Z.state.user.location_main={location_id:r.location_id,location_latitude:r.location_latitude,location_altitude:r.location_altitude,location_address:r.location_address,image_hash:r.image_hash},d.Z.go(-1),a.next=6,m().post(_.Z.state.hostname+"User/locationSetMain",{location_id:t});case 6:n.$topic.publish("userMainLocationSet",_.Z.state.user.location_main);case 7:case"end":return a.stop()}}),a)})))()},locationDelete(t,e){var n=this;return(0,l.Z)((0,c.Z)().mark((function a(){return(0,c.Z)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,n.locationList.splice(e,1),a.next=4,m().post(_.Z.state.hostname+"User/locationDelete",{location_id:t});case 4:a.next=8;break;case 6:a.prev=6,a.t0=a["catch"](0);case 8:n.locationListGet();case 9:case"end":return a.stop()}}),a,null,[[0,6]])})))()}},data(){return{locationList:[],locationGroupList:[]}}},v=n(3744);const Z=(0,v.Z)(k,[["render",s]]);var b=Z}}]);
//# sourceMappingURL=7453-legacy.94007ea0.js.map