{"version":3,"file":"js/16.6c2a9234.js","mappings":"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","sources":["webpack://blank/./src/views/SearchView.vue","webpack://blank/./src/components/ProductItem.vue","webpack://blank/./src/components/ProductItem.vue?ef20","webpack://blank/./src/views/SearchView.vue?6e85","webpack://blank/./src/scripts/Utils.js"],"sourcesContent":["<style scoped>\r\n.search-container {\r\n  visibility: visible;\r\n  margin: 1em 0;\r\n  color: black;\r\n  --border-radius: 10px;\r\n}\r\n\r\n.product_list_widget_grid {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr 1fr;\r\n}\r\n\r\n</style>\r\n<template>\r\n  <base-layout page-title=\"Поиск товаров\" pageDefaultBackLink=\"/home\">\r\n    <ion-searchbar class=\"search-container\" v-model=\"query\" @input=\"delayedListGet()\" placeholder=\"начните искать\"></ion-searchbar>\r\n    <div v-if=\"found\" style=\"background-color:var(--ion-color-light-tint);padding:10px\">\r\n      <ion-title>Найденные товары</ion-title>\r\n      <ion-list v-for=\"store in found.product_matches\" :key=\"store.store_id\" style=\"border-radius:10px;margin-top:30px;\">\r\n          <ion-item detail button @click=\"$router.push(`store-${store.store_id}`)\" lines=\"full\">\r\n            <ion-thumbnail slot=\"start\">\r\n              <ion-img style=\"border-radius:10px\" :src=\"`${$heap.state.hostname}image/get.php/${store.image_hash}.150.150.webp`\"/>\r\n            </ion-thumbnail>\r\n            <div style=\"display:grid;grid-template-columns:1fr 1fr 1fr;width:100%\">\r\n              <div>\r\n                <ion-title>{{store?.store_name}}</ion-title>\r\n              </div>\r\n              <div style=\"text-align:right\">\r\n                <ion-chip v-if=\"store.is_opened\" color=\"success\">Открыт до {{ store.store_time_closes }}:00</ion-chip>\r\n                <ion-chip v-else color=\"danger\">Закрыт до {{ store.store_time_opens }}:00</ion-chip>\r\n              </div>\r\n              <div style=\"text-align:right\">\r\n                <ion-chip v-if=\"store.deliveryTime.timeMin\" color=\"primary\">{{store.deliveryTime.timeMin}}-{{store.deliveryTime.timeMax}}мин</ion-chip>\r\n              </div>\r\n              <div style=\"grid-column: 1/-1\">\r\n                <ion-note>{{store.store_description}}</ion-note>\r\n              </div>\r\n            </div>\r\n          </ion-item>\r\n          \r\n\r\n              <div style=\"margin:10px;display:grid;grid-template-columns:repeat(auto-fit, 150px)\">\r\n                <div v-for=\"productItem in store.matches\" :key=\"productItem.product_id\">                \r\n                  <product-item :productItem=\"productItem\"/>\r\n                </div>\r\n              </div>\r\n\r\n\r\n      </ion-list>\r\n    </div>\r\n    <div v-else>\r\n      Ничего не найдено\r\n    </div>\r\n  </base-layout>\r\n</template>\r\n\r\n<script>\r\nimport jQuery from 'jquery'\r\nimport {IonSearchbar} from '@ionic/vue'\r\nimport Utils from '@/scripts/Utils.js'\r\nimport ProductItem from '@/components/ProductItem.vue'\r\n\r\nexport default  {\r\n  components:{IonSearchbar,ProductItem},\r\n  data(){\r\n    return {\r\n      query:this.$route.query.q||'',\r\n      found:null\r\n    }\r\n  },\r\n  ionViewDidEnter(){\r\n    this.delayedListGet()\r\n  },\r\n  created(){\r\n    this.delayedListGet()\r\n  },\r\n  methods:{\r\n    async listGet(){\r\n      const request={\r\n        query:this.query,\r\n        in_products:1,\r\n        in_stores:0,\r\n        location_id:this.locMainGet()\r\n      }\r\n      try{\r\n        const found=await jQuery.get(this.$heap.state.hostname+'Search/listGet',request)\r\n        this.found=this.storeListCalculate(found)\r\n      }catch{\r\n        this.found='void'\r\n      }\r\n    },\r\n    storeListCalculate(found){\r\n      for(let i in found.product_matches){\r\n        found.product_matches[i].deliveryTime=Utils.deliveryTimeCalculate(found.product_matches[i].distance,found.product_matches[i].store_time_preparation)\r\n      }\r\n      return found\r\n    },\r\n    locMainGet(){\r\n      return this.$heap.state.user.location_main?this.$heap.state.user.location_main.location_id:null\r\n    },\r\n    delayedListGet(){\r\n      clearTimeout(this.clock)\r\n      const self=this;\r\n      this.clock=setTimeout(()=>{self.listGet()},200)\r\n    },\r\n  }\r\n}\r\n</script>","<style scoped>\r\n.product_item{\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.absent{\r\n    filter:grayscale(1);\r\n    opacity: 0.5;\r\n}\r\n.incart .product_list_item_img{\r\n    border: 2px solid var(--ion-color-primary);\r\n}\r\n.product_list_item_img{\r\n    border-radius: 10px;\r\n    border: 2px solid var(--ion-color-light);\r\n    width:130px;\r\n    height:130px;\r\n    overflow:hidden;\r\n    align-items: center;\r\n    display:flex;\r\n}\r\n</style>\r\n<template>\r\n    <div :class=\"productItem.product_quantity>0?'':'absent'\" :id=\"`product_list_item${productItem.product_id}`\"\r\n        >\r\n        <div class=\"product_list_item_img\">\r\n            <div style=\"position:relative;top:-50%;\">\r\n                <cart-add-buttons buttonLayout=\"vertical\" :productItem=\"productItem\"></cart-add-buttons>\r\n            </div>\r\n            <ion-img @click=\"$router.push(`product-${productItem.product_id}`)\" :src=\"`${$heap.state.hostname}image/get.php/${productItem.image_hash}.150.150.webp`\"/>\r\n        </div>\r\n        <div style=\"height:3.5em;overflow:hidden\">\r\n            <span v-if=\"productItem.product_price!=productItem.product_final_price\" style=\"color:var(--ion-color-danger)\">\r\n                <s>{{productItem.product_price}}{{$heap.state.currencySign}}</s>&nbsp;&nbsp;\r\n            </span>\r\n            <span style=\"color:var(--ion-color-primary)\">\r\n                {{productItem.product_final_price}}{{$heap.state.currencySign}}\r\n            </span> / \r\n            <span style=\"color:var(--ion-color-medium)\">\r\n                {{productItem.product_unit}}\r\n            </span>\r\n            <div style=\"color:black;\" @click=\"$router.push(`product-${productItem.product_id}`)\">{{ productItem.product_name }}</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport CartAddButtons from '@/components/CartAddButtons';\r\nexport default {\r\n    props:['productItem'],\r\n    components: {CartAddButtons}\r\n}\r\n</script>","import { render } from \"./ProductItem.vue?vue&type=template&id=24b91e31&scoped=true\"\nimport script from \"./ProductItem.vue?vue&type=script&lang=js\"\nexport * from \"./ProductItem.vue?vue&type=script&lang=js\"\n\nimport \"./ProductItem.vue?vue&type=style&index=0&id=24b91e31&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-24b91e31\"]])\n\nexport default __exports__","import { render } from \"./SearchView.vue?vue&type=template&id=04dbd670&scoped=true\"\nimport script from \"./SearchView.vue?vue&type=script&lang=js\"\nexport * from \"./SearchView.vue?vue&type=script&lang=js\"\n\nimport \"./SearchView.vue?vue&type=style&index=0&id=04dbd670&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-04dbd670\"]])\n\nexport default __exports__","import heap from '@/heap';\r\nconst Utils={\r\n    deliveryCalculate(Store){\r\n        if( !Store.locations || !Store.locations[0] || !Store.locations[0].distance){\r\n            return null;\r\n        }\r\n        const distance=Store.locations[0].distance;\r\n        const preparation=Store.store_time_preparation||0;\r\n        return Utils.deliveryTimeCalculate(distance,preparation);\r\n    },\r\n    deliveryTimeCalculate(distance,preparation){\r\n        preparation=preparation??heap.state.deliverySettings.defaultPreparationTime;\r\n        const delta=heap.state.deliverySettings.deliveryTimeDelta;\r\n        const time=Math.round(distance/heap.state.deliverySettings.courierVelocity*60/5)*5+parseInt(preparation);\r\n        const timeMin=time>delta?time-delta:time;\r\n        const timeMax=timeMin+delta;\r\n        return {time,timeMin,timeMax};\r\n    }\r\n  };\r\n  export default Utils;"],"names":["style","pageDefaultBackLink","class","query","delayedListGet","placeholder","found","product_matches","store","key","store_id","detail","button","$router","push","lines","slot","src","$heap","state","hostname","image_hash","store_name","is_opened","color","store_time_closes","store_time_opens","deliveryTime","timeMin","timeMax","store_description","matches","productItem","product_id","product_quantity","id","buttonLayout","product_price","product_final_price","currencySign","product_unit","product_name","props","components","CartAddButtons","__exports__","IonSearchbar","ProductItem","data","this","$route","q","ionViewDidEnter","created","methods","async","request","in_products","in_stores","location_id","locMainGet","storeListCalculate","i","Utils","distance","store_time_preparation","user","location_main","clearTimeout","clock","self","setTimeout","listGet","render","deliveryCalculate","Store","locations","preparation","deliveryTimeCalculate","heap","delta","time","Math","round","parseInt"],"sourceRoot":""}