{"version":3,"file":"js/653.8630d00a.js","mappings":"uPASuE,a,WAGxB,c,WAGF,gB,SA2BzBA,MAAA,kF,GACHA,MAAA,6C,WAEU,e,UAAuB,OAAI,qB,gUAtCpD,QA0Cc,GA1CD,yBAAuB,QAAQ,aAAW,UAAvD,C,kBACM,IAUc,EAVd,QAUc,GAVD,gBAAc,O,WAAgB,EAAAC,U,qCAAA,EAAAA,UAAS,GAAG,YAAS,eAAE,EAAAC,gBAAgBC,KAAlF,C,kBACI,IAEqB,CAFkB,EAAAC,qBAAA,WAAvC,QAEqB,G,MAFDC,MAAM,QAA1B,C,kBAA2D,IAE3D,M,QAFA,gBAGA,QAEqB,GAFDA,MAAM,UAAQ,C,kBAAC,IAEnC,M,OACA,QAEqB,GAFDA,MAAM,QAAM,C,kBAAC,IAEjC,M,cATJ,kBAWgB,EAAAC,UAAUC,SAAA,WAA1B,QAsBW,W,kBArBG,IAAkC,gBAA5C,QAoBW,mBApBe,EAAAC,mBAATC,K,WAAjB,QAoBW,GApBmCC,IAAKD,EAAME,SAAW,QAAK,GAAE,EAAAC,UAAUH,GAAQI,OAAA,GAAOC,MAAM,QAA1G,C,kBACI,IAKa,EALb,QAKa,GALDC,KAAK,SAAO,C,kBACpB,IAAmF,CAApD,YAAfN,EAAMO,YAAS,WAA/B,QAAmF,G,MAAtCC,IAAI,qCAAjD,eAC+B,WAAfR,EAAMO,YAAS,WAA/B,QAAsF,G,MAA1CC,IAAI,yCAAhD,eAC+B,SAAfR,EAAMO,YAAS,WAA/B,QAAiG,G,MAAvDC,IAAI,0BAA0BjB,MAAA,yBAAxE,eAC+B,YAAfS,EAAMO,YAAS,WAA/B,QAAgG,G,MAAlDE,KAAM,EAAAC,kBAAmBnB,MAAA,sBAAvE,qC,KAJJ,OAMA,QAOW,Q,kBANP,IAAuH,EAAvH,QAAuH,Q,kBAA5G,IAAoB,mBAAlBS,EAAMW,YAAY,MAAE,QAAEX,EAAME,UAAU,MAAE,QAAEF,EAAMY,kBAAe,QAAI,EAAAC,MAAMC,MAAMC,cAAc,IAAC,M,KAA3G,OACA,QAGY,Q,kBAFR,IAAmF,CAAnDf,EAAMgB,cAAA,WAAtC,QAAmF,G,MAAzEC,MAAM,WAAhB,C,kBAAmD,IAAqB,mBAAnBjB,EAAMgB,aAAW,M,KAAtE,uBACgChB,EAAMkB,qBAAA,WAAtC,QAAiG,G,MAAvFD,MAAM,WAAhB,C,kBAA0D,IAA4B,mBAA1BjB,EAAMkB,oBAAkB,M,KAApF,0B,KAFJ,OAIA,QAA+C,Q,kBAArC,IAA0B,mBAAxBlB,EAAMmB,kBAAgB,M,KAAlC,S,KANJ,S,KAPJ,8B,SADJ,WAuBA,QAKM,MALN,EAKM,EAJF,OAGM,MAHN,EAGM,EAFF,QAA0D,GAA/CV,KAAM,EAAAW,gBAAiBC,KAAK,SAAvC,kBACA,QAAkC,Q,kBAAvB,IAAW,M,MAAY,U,8ECvBjCC,MAAM,e,GAkBNA,MAAM,e,GAONA,MAAM,e,WAaoB,c,WASD,c,WAYqB,mB,sTAtE3C,EAAAC,YAAA,WAAhB,QAwEW,W,kBAvEP,IAOW,EAPX,QAOW,GAPDlB,MAAM,QAAM,C,kBAClB,IAEa,EAFb,QAEa,GAFDC,KAAK,SAAO,C,kBACpB,IAA0D,EAA1D,QAA0D,GAA/CG,KAAM,EAAAe,gBAAiBjC,MAAA,sBAAlC,oB,OAEJ,QAEY,Q,kBADR,IAA0E,EAA1E,QAA0E,GAAhE0B,MAAM,WAAS,C,kBAAC,IAAO,UAAP,WAAO,QAAE,EAAAJ,MAAMC,MAAMW,KAAKC,WAAS,M,yBAIrE,QAMW,GANDrB,MAAM,QAAM,C,kBAClB,IAIM,EAJN,OAIM,MAJN,EAIM,EAHF,QAEW,GAFDY,MAAM,WAAS,C,kBACrB,IAAgE,EAAhE,QAAgE,Q,kBAAtD,IAA2C,mBAAzC,EAAAM,WAAWI,8BAA4B,M,2BAK/D,QAQW,GARDtB,MAAM,QAAM,C,kBAClB,IAEa,EAFb,QAEa,GAFDC,KAAK,SAAO,C,kBACpB,IAA6D,EAA7D,QAA6D,GAAlDG,KAAM,EAAAC,kBAAmBnB,MAAA,sBAApC,oB,OAEJ,QAGW,Q,kBAFP,IAA+D,EAA/D,QAA+D,GAApD0B,MAAM,WAAS,C,kBAAC,IAAwB,mBAAtB,EAAAM,UAAUZ,YAAU,M,OACjD,QAAmD,Q,kBAAzC,IAA8B,mBAA5B,EAAAY,UAAUJ,kBAAgB,M,wBAI9B,EAAAS,2BAAA,WAAhB,QAMW,G,MAN+BvB,MAAM,QAAhD,C,kBACI,IAIM,EAJN,OAIM,MAJN,EAIM,EAHF,QAEW,GAFDY,MAAM,WAAS,C,kBACrB,IAAiD,EAAjD,QAAiD,Q,kBAAvC,IAA4B,mBAA1B,EAAAW,0BAAwB,M,6BAHhD,WAOA,QAMW,G,MANMvB,MAAM,QAAvB,C,kBACI,IAIM,EAJN,OAIM,MAJN,EAIM,EAHF,QAEW,GAFDY,MAAM,WAAS,C,kBACrB,IAAoE,EAApE,QAAoE,GAAjDY,SAAA,GAAStC,MAAA,oB,kBAMxB,EAAAuC,MAAA,WAAhB,QAQW,W,kBAPP,IAEa,EAFb,QAEa,GAFDxB,KAAK,SAAO,C,kBACpB,IAAuD,EAAvD,QAAuD,GAA5CG,KAAM,EAAAsB,YAAaxC,MAAA,sBAA9B,oB,OAEJ,QAGW,Q,kBAFP,IAAiD,EAAjD,QAAiD,GAAtC0B,MAAM,WAAS,C,kBAAC,IAAU,M,OACrC,QAAoD,Q,kBAA1C,IAA+B,mBAA7B,EAAAa,IAAIE,yBAAuB,M,2BAN/C,WASA,QASW,W,kBARP,IAEa,EAFb,QAEa,GAFD1B,KAAK,SAAO,C,kBACpB,IAAuD,EAAvD,QAAuD,GAA5CG,KAAM,EAAAsB,YAAaxC,MAAA,sBAA9B,oB,OAEJ,QAIY,Q,kBAHR,IAA+C,EAA/C,QAA+C,GAArC0B,MAAM,WAAS,C,kBAAC,IAAU,M,OACpC,QAAmE,GAAhDY,SAAA,GAAStC,MAAA,iBAC5B,QAAmE,GAAhDsC,SAAA,GAAStC,MAAA,mB,gBAId,EAAAuC,MAAA,WAAtB,QAOiB,W,kBANb,IAIW,EAJX,QAIW,Q,kBAHP,IAEW,EAFX,QAEW,Q,kBAFD,IACA,UADA,WACA,QAAE,EAAAA,IAAIG,oBAAkB,M,gBAGtC,QAA+E,GAAlE,QAAK,eAAE,EAAAC,iBAAiBC,OAAO,QAA5C,C,kBAAmD,IAAe,M,iBANtE,kB,QAhEJ,eAmGJ,OACIC,MAAM,CAAC,aACPC,WAAW,CACXC,QADW,KAEXC,aAFW,KAGXC,SAHW,KAIXC,UAJW,KAKXC,gBALW,KAMXC,QANW,KAOXC,QAPW,KAQXC,QARW,KASXC,SATW,KAUXC,QAVW,KAWXC,UAXW,KAYXC,QAAO,MAEPC,QACI,MAAO,CACHxC,kBADG,MAEHc,gBAFG,MAGHO,YAAW,QAGnBoB,OACI,MAAO,CACHrB,IAAI,OAGZsB,UACIC,KAAKC,UAETC,SAAS,CACL3B,2BACI,OAAIyB,KAAKvB,KAAK0B,sBAGPC,KAAKC,MAAML,KAAKvB,KAAK0B,sBAAsB,KAAM,KAF7C,MAKnBG,QAAQ,CACJC,eACI,IACI,IAAI9B,QAAU+B,EAAA,iBAAqBR,KAAK9B,UAAUrB,UAClD4B,EAAIE,wBAAwBF,EAAIE,wBAAwB8B,MAAM,KAAKC,UAAUC,KAAK,KAClFX,KAAKvB,IAAIA,EACTmC,QAAQC,IAAIb,KAAKvB,KACnB,MAAMqC,GACJF,QAAQC,IAAIC,GACZ,MAAMC,EAAQD,EAAIE,cAAcC,UAAUC,MAC1C,GAAY,YAATH,EAEC,YADAf,KAAKmB,OAAO,sBAGhB,GAAY,YAATJ,EAEC,YADAf,KAAKmB,OAAO,8BAKxBZ,sBACI,MAAMa,EAAWC,EAAA,0BACjB,UACUb,EAAA,mBAAuBR,KAAK9B,UAAUrB,SAASuE,GACrDpB,KAAKsB,QAAQC,KAAK,SAASvB,KAAK9B,UAAUrB,UAE5C,MAAMiE,GACJ,MAAMC,EAAQD,EAAIE,cAAcC,UAAUC,MAC9B,YAATH,GACCf,KAAKmB,OAAO,sBAEJ,YAATJ,GACCf,KAAKmB,OAAO,4BAEJ,gBAATJ,GAAoC,QAATA,GAC1Bf,KAAKmB,OAAO,+BAGpBK,EAAA,UAAc,mB,UCpL1B,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,GAAQ,CAAC,YAAY,qBAEzF,QFmEA,GACIzC,WAAY,CACZ0C,WADY,KAEZC,iBAFY,KAGZ/B,QAHY,KAIZD,UAJY,KAKZD,QALY,KAMZD,SANY,KAOZD,QAPY,KAQZP,QARY,KASZM,QATY,KAUZD,QAAO,MAEPO,QACE,MAAO,CAAE9B,gBAAF,MAAkBV,kBAAlB,MAAoCuE,YAAW,QAExD9B,OACI,MAAO,CACHtD,UAAU,GACVL,UAAU,SACVG,mBAAmB,EACnBuF,MAAM,OAGd3B,SAAS,CACLxD,oBACI,IAAI,IAAIC,KAASqD,KAAKxD,UACbG,EAAMmB,mBACPnB,EAAMmB,iBAAiB,IAGvBnB,EAAMmF,SACNnF,EAAM2B,6BAA6B8B,KAAKC,MAAM1D,EAAMmF,SAAS,KAAM,KAEnEnF,EAAMgB,YAAY,GAG1B,OAAOqC,KAAKxD,YAGpBuF,UACI,IAAIC,EAAKhC,KACTwB,EAAA,KAAS,uBAAsB,WAC3BQ,EAAKC,2BAETD,EAAKC,yBAET3B,QAAQ,CACJC,eAAe2B,GAEX,GADAlC,KAAKmC,WAAWD,GACF,QAAVA,EAEA,YADAlC,KAAKoC,cAGT,IAAIC,EAAiB,kBACP,UAAVH,IACAG,EAAiB,oBAErBrC,KAAKxD,gBAAgBgE,EAAA,eAAmB6B,IAE5CjG,gBAAgBkG,GACZ,MAAMJ,EAASI,EAAEC,OAAOhG,MACxByD,KAAKwC,SAASN,IAElBD,wBACIjC,KAAK1D,mBAAwC,SAArB+E,EAAA,iBAA6B,EAAE,EAC3B,GAAzBrB,KAAK1D,qBACJ0D,KAAK7D,UAAU,WAGvBoE,oBACI,IACI,MAAMa,EAAWC,EAAA,0BACjBrB,KAAKxD,gBAAgBgE,EAAA,iBAAqBY,GAC5C,MAAMN,GACJ,MAAMC,EAAQD,EAAIE,cAAcC,UAAUC,MAC9B,YAATH,IACCM,EAAA,iBAAoB,WACpBrB,KAAKiC,2BAIjBE,WAAWD,GACPO,aAAazC,KAAK6B,OAClB,MAAMG,EAAKhC,KACL0C,EAAQ,KACD,QAAVR,GAA8B,UAAVA,IACnBlC,KAAK6B,MAAMc,YAAW,KAClBX,EAAKQ,SAASN,KAChBQ,KAGVE,kBACI5C,KAAKiC,wBACc,UAAhBjC,KAAK7D,UACJ6D,KAAKwC,SAAS,UAEdxC,KAAK7D,UAAU,UAGvB0G,kBACIJ,aAAazC,KAAK6B,QAEtBtB,gBAAgB5D,GACZ,GAAIA,EAAMmG,eAAgB,CACtB,MAAMC,QAAc,YAAuB,CACvCC,UAAWC,EACXC,eAAe,CAAChF,UAAUvB,GAC1BwG,kBAAmB,GACnBC,YAAa,CAAC,EAAG,GAAK,OAEpBC,EAAU,WACZN,EAAMO,WAGV,OADA9B,EAAA,KAAS,eAAe6B,GACjBN,EAAMQ,UAEjBvD,KAAKwD,SAAS7G,EAAME,WAExB2G,SAAS3G,GACL4G,EAAA,OAAa,SAAQ5G,QG7LjC,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS6G,GAAQ,CAAC,YAAY,qBAEzF","sources":["webpack://Tezkel/./src/views/OrderList.vue","webpack://Tezkel/./src/components/CourierJobPreview.vue","webpack://Tezkel/./src/components/CourierJobPreview.vue?8e41","webpack://Tezkel/./src/views/OrderList.vue?4c42"],"sourcesContent":["<style scoped>\r\n    ion-icon{\r\n        font-size:40px;\r\n        color:var(--ion-color-medium);\r\n    }\r\n</style>\r\n<template>\r\n  <base-layout page-default-back-link=\"/home\" page-title=\"Заказы\">\r\n        <ion-segment swipe-gesture=\"true\" v-model=\"orderType\" @ionChange=\"listTypeChanged($event)\">\r\n            <ion-segment-button value=\"jobs\" v-if=\"courierJobsInclude\">\r\n                Задания\r\n            </ion-segment-button>\r\n            <ion-segment-button value=\"active\">\r\n                Активные\r\n            </ion-segment-button>\r\n            <ion-segment-button value=\"done\">\r\n                Исполненые\r\n            </ion-segment-button>\r\n        </ion-segment>\r\n        <ion-list v-if=\"orderList.length\">\r\n            <ion-item v-for=\"order in orderListComputed\" :key=\"order.order_id\" @click=\"itemClick(order)\" detail lines=\"full\">\r\n                <ion-avatar slot=\"start\">\r\n                    <ion-icon v-if=\"order.user_role=='customer'\" src=\"./assets/icon/box-delivery.svg\"/>\r\n                    <ion-icon v-if=\"order.user_role=='courier'\" src=\"./assets/icon/delivery_staying.svg\"/>\r\n                    <ion-icon v-if=\"order.user_role=='admin'\" src=\"./assets/icon/crown.svg\" style=\"font-size:24px;\"/>\r\n                    <ion-icon v-if=\"order.user_role=='supplier'\" :icon=\"storefrontOutline\" style=\"font-size:24px;\"/>\r\n                </ion-avatar>\r\n                <ion-text>\r\n                    <ion-label>{{order.store_name}} #{{order.order_id}} ({{order.order_sum_total}}{{$heap.state.currencySign}})</ion-label>\r\n                    <ion-label>\r\n                        <ion-chip color=\"primary\" v-if=\"order.distance_km\">{{order.distance_km}}</ion-chip>\r\n                        <ion-chip color=\"success\" v-if=\"order.stage_current_name\">{{order.stage_current_name}}</ion-chip>\r\n                    </ion-label>\r\n                    <ion-note>{{order.location_address}}</ion-note>\r\n                </ion-text>\r\n                <!--\r\n                <ion-thumbnail slot=\"end\" v-if=\"order.image_hash\">\r\n                    <ion-img style=\"border-radius:10px;\" :src=\"`${$heap.state.hostname}image/get.php/${order.image_hash}.150.150.webp`\"/>\r\n                </ion-thumbnail>\r\n                -->\r\n            </ion-item>\r\n        </ion-list>\r\n        <div v-else style=\"display:flex;align-items:center;justify-content:center;height:100%\">\r\n            <div style=\"width:max-content;text-align:center\">\r\n                <ion-icon :icon=\"sparklesOutline\" size=\"large\"></ion-icon>\r\n                <ion-label>Заказов нет</ion-label><br>\r\n            </div>\r\n        </div>\r\n\r\n  </base-layout>\r\n</template>\r\n<script>\r\nimport { \r\n    modalController,\r\n    IonSegment,\r\n    IonSegmentButton,\r\n    IonIcon,\r\n    IonAvatar,\r\n    IonText,\r\n    IonLabel,\r\n    IonItem,\r\n    IonList,\r\n    IonChip,\r\n    IonNote\r\n}                   from '@ionic/vue';\r\nimport {\r\n    storefrontOutline,\r\n    sparklesOutline,\r\n    timeOutline\r\n}                   from 'ionicons/icons';\r\nimport Order        from '@/scripts/Order.js';\r\nimport User         from '@/scripts/User.js';\r\nimport Topic        from '@/scripts/Topic.js';\r\nimport router       from '@/router';\r\nimport CourierJobPreview    from '@/components/CourierJobPreview.vue';\r\n\r\nexport default {\r\n    components: {\r\n    IonSegment,\r\n    IonSegmentButton,\r\n    IonIcon,\r\n    IonAvatar,\r\n    IonText,\r\n    IonLabel,\r\n    IonItem,\r\n    IonList,\r\n    IonChip,\r\n    IonNote\r\n    },\r\n    setup() {\r\n      return { sparklesOutline,storefrontOutline,timeOutline };\r\n    },\r\n    data(){\r\n        return {\r\n            orderList:[],\r\n            orderType:'active',\r\n            courierJobsInclude:0,\r\n            clock:null\r\n        };\r\n    },\r\n    computed:{\r\n        orderListComputed(){\r\n            for(let order of this.orderList){\r\n                if( !order.location_address ){\r\n                    order.location_address='';\r\n                }\r\n                //order.location_address=order.location_address.split(',').reverse().join(',');\r\n                if( order.distance ){\r\n                    order.courier_supplier_distance_km=Math.round(order.distance/1000)+'км';\r\n                } else {\r\n                    order.distance_km='';\r\n                }\r\n            }\r\n            return this.orderList;\r\n        }\r\n    },\r\n    created(){\r\n        let self=this;\r\n        Topic.on('courierStatusChange',function(){\r\n            self.courierReadinessCheck();\r\n        });\r\n        self.courierReadinessCheck();\r\n    },\r\n    methods:{\r\n        async listLoad(listType){\r\n            this.autoReload(listType);\r\n            if( listType=='jobs' ){\r\n                this.listJobLoad();\r\n                return;\r\n            }\r\n            let order_group_type='customer_finish';\r\n            if( listType=='active' ){\r\n                order_group_type='!customer_finish';\r\n            }\r\n            this.orderList=await Order.api.listLoad(order_group_type);\r\n        },\r\n        listTypeChanged(e){\r\n            const listType=e.target.value;\r\n            this.listLoad(listType);\r\n        },\r\n        courierReadinessCheck(){\r\n            this.courierJobsInclude=User.courier.status=='ready'?1:0;\r\n            if(this.courierJobsInclude==0){\r\n                this.orderType='active';\r\n            }\r\n        },\r\n        async listJobLoad(){\r\n            try{\r\n                const courier_id=User.courier?.data?.courier_id;\r\n                this.orderList=await Order.api.listJobGet(courier_id);\r\n            } catch(err){\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='notready'){\r\n                    User.courier.status='notready';\r\n                    this.courierReadinessCheck();\r\n                }\r\n            }\r\n        },\r\n        autoReload(listType){\r\n            clearTimeout(this.clock);\r\n            const self=this;\r\n            const timeout=1000*60*2;\r\n            if(listType=='jobs' || listType=='active'){\r\n                this.clock=setTimeout(()=>{\r\n                    self.listLoad(listType);\r\n                },timeout);\r\n            }\r\n        },\r\n        ionViewDidEnter() {\r\n            this.courierReadinessCheck();\r\n            if(this.orderType=='active'){\r\n                this.listLoad('active');\r\n            } else {\r\n                this.orderType='active'\r\n            }\r\n        },\r\n        ionViewDidLeave() {\r\n            clearTimeout(this.clock);\r\n        },\r\n        async itemClick(order){\r\n            if( order.is_courier_job ){\r\n                const modal = await modalController.create({\r\n                    component: CourierJobPreview,\r\n                    componentProps:{orderData:order},\r\n                    initialBreakpoint: 0.5,\r\n                    breakpoints: [0, 0.5, 0.75]\r\n                    });\r\n                const dismissFn=function(){\r\n                    modal.dismiss();\r\n                };\r\n                Topic.on('dismissModal',dismissFn);\r\n                return modal.present();\r\n            }\r\n            this.itemOpen(order.order_id);\r\n        },\r\n        itemOpen(order_id){\r\n            router.push(`order-${order_id}`);\r\n        }\r\n    }\r\n}\r\n</script>","<style scoped>\r\n    ion-icon{\r\n        font-size:40px;\r\n        color:var(--ion-color-medium);\r\n    }\r\n    .center_chip{\r\n        text-align:center;\r\n        width: 100%;\r\n    }\r\n</style>\r\n<template>\r\n    <ion-list v-if=\"orderData\">\r\n        <ion-item lines=\"none\">\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"locationOutline\" style=\"font-size:30px\"/>\r\n            </ion-avatar>\r\n            <ion-label>\r\n                <ion-text color=\"primary\">Курьер {{$heap.state.user.user_name}}</ion-text>\r\n            </ion-label>            \r\n        </ion-item>\r\n\r\n        <ion-item lines=\"none\">\r\n            <div class=\"center_chip\">\r\n                <ion-chip color=\"success\">\r\n                    <ion-text>{{orderData?.courier_supplier_distance_km}}</ion-text>\r\n                </ion-chip>\r\n            </div>      \r\n        </ion-item>\r\n\r\n        <ion-item lines=\"none\">\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"storefrontOutline\" style=\"font-size:30px;\"/>\r\n            </ion-avatar>\r\n            <ion-text>\r\n                <ion-label color=\"primary\">{{orderData.store_name}}</ion-label>\r\n                <ion-note>{{orderData.location_address}}</ion-note>\r\n            </ion-text>\r\n        </ion-item>\r\n\r\n        <ion-item v-if=\"start_finish_distance_km\" lines=\"none\">\r\n            <div class=\"center_chip\">\r\n                <ion-chip color=\"success\">\r\n                    <ion-text>{{start_finish_distance_km}}</ion-text>\r\n                </ion-chip>\r\n            </div>      \r\n        </ion-item>\r\n        <ion-item v-else lines=\"none\">\r\n            <div class=\"center_chip\">\r\n                <ion-chip color=\"success\">\r\n                    <ion-skeleton-text animated style=\"width: 100%\"></ion-skeleton-text>\r\n                </ion-chip>\r\n            </div>      \r\n        </ion-item>\r\n\r\n\r\n        <ion-item v-if=\"job\">\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"flagOutline\" style=\"font-size:30px;\"/>\r\n            </ion-avatar>\r\n            <ion-text>\r\n                <ion-label color=\"primary\">Покупатель</ion-label>\r\n                <ion-note>{{job.finish_location_address}}</ion-note>\r\n            </ion-text>           \r\n        </ion-item>\r\n        <ion-item v-else>\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"flagOutline\" style=\"font-size:30px;\"/>\r\n            </ion-avatar>\r\n            <ion-label>\r\n                <ion-text color=\"primary\">Покупатель</ion-text>\r\n                <ion-skeleton-text animated style=\"width: 60%\"></ion-skeleton-text>\r\n                <ion-skeleton-text animated style=\"width: 80%\"></ion-skeleton-text>\r\n            </ion-label>           \r\n        </ion-item>\r\n\r\n        <ion-item-group v-if=\"job\">\r\n            <ion-item>\r\n                <ion-text>\r\n                    Бонус {{job.order_sum_delivery}}\r\n                </ion-text>\r\n            </ion-item>\r\n            <ion-button @click=\"deliveryStart()\" expand=\"full\">Начать доставку</ion-button>\r\n        </ion-item-group>\r\n    </ion-list>\r\n</template>\r\n<script>\r\nimport { \r\n    IonList,\r\n    IonItemGroup,\r\n    IonTitle,\r\n    IonButton,\r\n    IonSkeletonText,\r\n    IonNote,\r\n    IonChip,\r\n    IonItem,\r\n    IonLabel,\r\n    IonText,\r\n    IonAvatar,\r\n    IonIcon,\r\n}                   from '@ionic/vue';\r\nimport {\r\n    storefrontOutline,\r\n    locationOutline,\r\n    flagOutline\r\n    }               from 'ionicons/icons';\r\nimport User         from '@/scripts/User.js';\r\nimport Order        from '@/scripts/Order.js';\r\nimport Topic        from '@/scripts/Topic.js';\r\n\r\n\r\nexport default({\r\n    props:['orderData'],\r\n    components:{\r\n    IonList,\r\n    IonItemGroup,\r\n    IonTitle,\r\n    IonButton,\r\n    IonSkeletonText,\r\n    IonNote,\r\n    IonChip,\r\n    IonItem,\r\n    IonLabel,\r\n    IonText,\r\n    IonAvatar,\r\n    IonIcon,\r\n    },\r\n    setup() {\r\n        return { \r\n            storefrontOutline,\r\n            locationOutline,\r\n            flagOutline \r\n            }\r\n    },\r\n    data(){\r\n        return {\r\n            job:null\r\n        };\r\n    },\r\n    mounted(){\r\n        this.jobGet()\r\n    },\r\n    computed:{\r\n        start_finish_distance_km(){\r\n            if(!this.job?.start_finish_distance){\r\n                return '-';\r\n            }\r\n            return Math.round(this.job?.start_finish_distance/1000)+'км';\r\n        }\r\n    },\r\n    methods:{\r\n        async jobGet(){\r\n            try{\r\n                let job=await Order.api.itemJobGet(this.orderData.order_id);\r\n                job.finish_location_address=job.finish_location_address.split(',').reverse().join(',');\r\n                this.job=job;\r\n                console.log(this.job)\r\n            } catch(err){\r\n                console.log(err)\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='notfound'){\r\n                    this.$flash(\"Задание не найдено\");\r\n                    return\r\n                }\r\n                if(message=='notready'){\r\n                    this.$flash(\"Смена курьера не открыта\");\r\n                    return\r\n                }\r\n            }\r\n        },\r\n        async deliveryStart(){\r\n            const courier_id=User.courier?.data?.courier_id;\r\n            try{\r\n                await Order.api.itemJobStart(this.orderData.order_id,courier_id);\r\n                this.$router.push('order-'+this.orderData.order_id);\r\n\r\n            } catch(err){\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='notfound'){\r\n                    this.$flash(\"Задание не найдено\");\r\n                }\r\n                if(message=='notready'){\r\n                    this.$flash(\"Смена курьера не открыта\");\r\n                }\r\n                if(message=='notsearching' || message=='idle'){\r\n                    this.$flash(\"Заданию уже назначен курьер\");\r\n                }\r\n            }\r\n            Topic.publish('dismissModal');\r\n        }\r\n    }\r\n})\r\n</script>\r\n","import { render } from \"./CourierJobPreview.vue?vue&type=template&id=3f162f31&scoped=true\"\nimport script from \"./CourierJobPreview.vue?vue&type=script&lang=js\"\nexport * from \"./CourierJobPreview.vue?vue&type=script&lang=js\"\n\nimport \"./CourierJobPreview.vue?vue&type=style&index=0&id=3f162f31&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3f162f31\"]])\n\nexport default __exports__","import { render } from \"./OrderList.vue?vue&type=template&id=7b6db47d&scoped=true\"\nimport script from \"./OrderList.vue?vue&type=script&lang=js\"\nexport * from \"./OrderList.vue?vue&type=script&lang=js\"\n\nimport \"./OrderList.vue?vue&type=style&index=0&id=7b6db47d&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-7b6db47d\"]])\n\nexport default __exports__"],"names":["style","orderType","listTypeChanged","$event","courierJobsInclude","value","orderList","length","orderListComputed","order","key","order_id","itemClick","detail","lines","slot","user_role","src","icon","storefrontOutline","store_name","order_sum_total","$heap","state","currencySign","distance_km","color","stage_current_name","location_address","sparklesOutline","size","class","orderData","locationOutline","user","user_name","courier_supplier_distance_km","start_finish_distance_km","animated","job","flagOutline","finish_location_address","order_sum_delivery","deliveryStart","expand","props","components","IonList","IonItemGroup","IonTitle","IonButton","IonSkeletonText","IonNote","IonChip","IonItem","IonLabel","IonText","IonAvatar","IonIcon","setup","data","mounted","this","jobGet","computed","start_finish_distance","Math","round","methods","async","Order","split","reverse","join","console","log","err","message","responseJSON","messages","error","$flash","courier_id","User","$router","push","Topic","__exports__","IonSegment","IonSegmentButton","timeOutline","clock","distance","created","self","courierReadinessCheck","listType","autoReload","listJobLoad","order_group_type","e","target","listLoad","clearTimeout","timeout","setTimeout","ionViewDidEnter","ionViewDidLeave","is_courier_job","modal","component","CourierJobPreview","componentProps","initialBreakpoint","breakpoints","dismissFn","dismiss","present","itemOpen","router","render"],"sourceRoot":""}