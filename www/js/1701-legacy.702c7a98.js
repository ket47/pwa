"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[1701],{5069:function(e,t,o){var i=o(2109),n=o(1702),a=o(3157),s=n([].reverse),r=[1,2];i({target:"Array",proto:!0,forced:String(r)===String(r.reverse())},{reverse:function(){return a(this)&&(this.length=this.length),s(this)}})},7327:function(e,t,o){o.d(t,{Z:function(){return c}});var i=o(6252),n=o(3577);const a=(0,i.Uk)("Просмотр фотографии");function s(e,t,o,s,r,l){const d=(0,i.up)("ion-title"),u=(0,i.up)("ion-icon"),m=(0,i.up)("ion-toolbar"),c=(0,i.up)("ion-header"),p=(0,i.up)("ion-button"),h=(0,i.up)("ion-col"),_=(0,i.up)("ion-row"),g=(0,i.up)("ion-grid"),f=(0,i.up)("ion-img"),y=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,{color:"secondary"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[a])),_:1}),(0,i.Wm)(u,{icon:s.closeOutline,onClick:t[0]||(t[0]=e=>{s.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,i.Wm)(y,null,{default:(0,i.w5)((()=>[o.actions?((0,i.wg)(),(0,i.j4)(g,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(_,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.actions,((e,t)=>((0,i.wg)(),(0,i.j4)(h,{key:t},{default:(0,i.w5)((()=>{var o;return[e[0]?((0,i.wg)(),(0,i.j4)(p,{key:0,onClick:o=>l.actionCreate(t,e[1]),expand:"block",color:null!==(o=e[1])&&void 0!==o?o:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e[0]),1)])),_:2},1032,["onClick","color"])):(0,i.kq)("",!0)]})),_:2},1024)))),128))])),_:1})])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(f,{src:e.$heap.state.hostname+"image/get.php/"+o.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var r=o(8903),l=o(8292),d={props:["image_hash","actions"],components:{IonIcon:l.gu,IonToolbar:l.sr,IonHeader:l.Gu,IonImg:l.Xz,IonContent:l.W2,IonTitle:l.wd,IonButton:l.YG,IonCol:l.wI,IonRow:l.Nd,IonGrid:l.jY},setup(){const e=function(){l.Fy.dismiss()};return{closeModal:e,closeOutline:r.fID}},methods:{actionCreate(e,t){("danger"!=t||confirm("Вы уверены?"))&&l.Fy.dismiss(null,e)}}},u=o(3744);const m=(0,u.Z)(d,[["render",s]]);var c=m},1701:function(e,t,o){o.r(t),o.d(t,{default:function(){return w}});var i=o(6252),n=o(3577);const a=(0,i.Uk)(" Картинки "),s=(0,i.Uk)(" Товары "),r=(0,i.Uk)(" Магазины "),l=(0,i.Uk)(" Курьеры "),d=(0,i.Uk)(" Ничего не найдено ");function u(e,t,o,u,m,c){const p=(0,i.up)("ion-segment-button"),h=(0,i.up)("ion-segment"),_=(0,i.up)("ion-searchbar"),g=(0,i.up)("ion-img"),f=(0,i.up)("ion-thumbnail"),y=(0,i.up)("ion-text"),w=(0,i.up)("ion-label"),I=(0,i.up)("ion-item"),k=(0,i.up)("ion-list"),b=(0,i.up)("ion-skeleton-text"),v=(0,i.up)("ion-card-content"),T=(0,i.up)("ion-card"),$=(0,i.up)("ion-infinite-scroll-content"),C=(0,i.up)("ion-infinite-scroll"),W=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(W,{pageDefaultBackLink:"/user","page-title":"Модерация"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{"swipe-gesture":"true",modelValue:m.moderationType,"onUpdate:modelValue":t[0]||(t[0]=e=>m.moderationType=e),onIonChange:t[1]||(t[1]=e=>c.listTypeChanged(e))},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{value:"images"},{default:(0,i.w5)((()=>[a])),_:1}),(0,i.Wm)(p,{value:"products"},{default:(0,i.w5)((()=>[s])),_:1}),(0,i.Wm)(p,{value:"stores"},{default:(0,i.w5)((()=>[r])),_:1}),(0,i.Wm)(p,{value:"couriers"},{default:(0,i.w5)((()=>[l])),_:1})])),_:1},8,["modelValue"]),(0,i._)("div",null,["stores"==m.moderationType||"products"==m.moderationType||"couriers"==m.moderationType?((0,i.wg)(),(0,i.j4)(_,{key:0,placeholder:"Фильтр",modelValue:m.filter,"onUpdate:modelValue":t[2]||(t[2]=e=>m.filter=e)},null,8,["modelValue"])):(0,i.kq)("",!0),c.listComputed.length>0?((0,i.wg)(),(0,i.j4)(k,{key:1},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.listComputed,(t=>((0,i.wg)(),(0,i.j4)(I,{key:t.item_id,button:"",detail:"",onClick:e=>c.itemEdit(t)},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{slot:"start",class:(0,n.C_)(t.class)},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.50.50.webp`},null,8,["src"])])),_:2},1032,["class"]),(0,i.Wm)(y,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(t.item_name),1)])),_:2},1024),(0,i.Wm)(w,{slot:"end"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(t.date_time),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):1==m.is_loading?((0,i.wg)(),(0,i.j4)(k,{key:2},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)([1,2,3],(e=>(0,i.Wm)(I,{key:e,button:"",detail:""},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{slot:"start",style:{"background-color":"lightgray"}}),(0,i.Wm)(b,{animated:""})])),_:2},1024))),64))])),_:1})):((0,i.wg)(),(0,i.j4)(T,{key:3,color:"light"},{default:(0,i.w5)((()=>[(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[d])),_:1})])),_:1})),(0,i.Wm)(C,{onIonInfinite:t[3]||(t[3]=e=>c.listLoadMore(e)),id:"moderation-infinite-scroll"},{default:(0,i.w5)((()=>[(0,i.Wm)($,{"loading-spinner":"bubbles","loading-text":"Loading more data..."})])),_:1})])])),_:1})}var m=o(8534),c=(o(3948),o(5069),o(8292)),p=o(9755),h=o.n(p),_=o(7327),g={components:{IonInfiniteScroll:c.ju,IonInfiniteScrollContent:c.MB,IonItem:c.Ie,IonLabel:c.Q$,IonList:c.q_,IonSegmentButton:c.GO,IonSegment:c.cJ,IonImg:c.Xz,IonThumbnail:c.Bs,IonText:c.yW,IonSkeletonText:c.CK,IonCard:c.PM,IonCardContent:c.FN,IonSearchbar:c.VI},data(){return{items:[],filter:"",is_loading:0,moderationType:"images",holders:{store:"Поставщик",courier:"Курьер",product:"Товар",order:"Заказ",product_group_list:"Категория товара",location_group_list:"Категория местоп.",store_group_list:"Категория поставщ.",user_group_list:"Категория пользователя"}}},computed:{listComputed(){for(let e of this.items)e.image_hash=e.image_hash||e.courier_photo_image_hash,e.item_id=e.image_id||e.store_id||e.courier_id||e.product_id,e.item_name=this.holders[e.image_holder]||e.store_name||e.user_name||e.product_name,e.date_time=this.toLocDateTime(e.updated_at),e.class=e.deleted_at?"deleted":"";return this.items}},methods:{listLoadMore(e){var t=this;return(0,m.Z)((function*(){yield t.listLoad(),e.target.complete()}))()},listReload(){var e=this;return(0,m.Z)((function*(){e.items=[],e.listLoad()}))()},listLoad(){var e=this;return(0,m.Z)((function*(){let t={is_disabled:1,is_active:0,name_query:e.filter,offset:e.items.length,limit:15,order:"updated_at"};try{let o;if(e.is_loading=1,"images"==e.moderationType)o=yield h().post(`${e.$heap.state.hostname}Image/listGet`,t);else if("products"==e.moderationType){t.name_query_fields="product_name,product_description,product_barcode,product_code",t.reverse="validity";const i=yield h().post(`${e.$heap.state.hostname}Product/listGet`,t);o=i.product_list}else"stores"==e.moderationType?(t.name_query_fields="store_name,store_description",t.reverse="validity",o=yield h().post(`${e.$heap.state.hostname}Store/listGet`,t)):"couriers"==e.moderationType&&(t.name_query_fields="courier_vehicle,user_phone,user_name",t.order="courier_list.updated_at",o=yield h().post(`${e.$heap.state.hostname}Courier/listGet`,t));e.is_loading=0,e.items=e.items.concat(o)}catch(o){}}))()},listTypeChanged(e){e.target.value;this.items=[],this.listLoad()},listFilter(){clearTimeout(this.clock);const e=this;this.clock=setTimeout((()=>{e.listReload()}),300)},toLocDate(e){const t=new Date(Date.parse(e)),o={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,o)},toLocDateTime(e){const t=new Date(Date.parse(e)),o={month:"short",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleDateString(void 0,o)},itemEdit(e){"images"==this.moderationType&&this.imageEdit(e),"products"==this.moderationType&&this.$router.push("/catalog/product-edit-"+e.product_id),"stores"==this.moderationType&&this.$router.push("/catalog/store-edit-"+e.store_id),"couriers"==this.moderationType&&this.$router.push("/user/courier-dashboard?courier_id="+e.courier_id)},imageEdit(e){var t=this;return(0,m.Z)((function*(){const o={delete:["Удалить","danger"],postpone:["Потом","primary"],enable:["Ок","success"]},i=yield c.Fy.create({component:_.Z,componentProps:{image_hash:e.image_hash,actions:o},initialBreakpoint:.75,breakpoints:[.75,1]});t.$topic.on("dismissModal",(()=>{i.dismiss()})),i.present();const n=yield i.onDidDismiss();"delete"==n.role&&(yield t.imageDelete(e)),"enable"==n.role&&(yield t.imageEnable(e)),"postpone"==n.role&&(yield t.imagePostpone(e)),t.listReload()}))()},imageEnable(e){var t=this;return(0,m.Z)((function*(){yield h().post(`${t.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:0})}))()},imagePostpone(e){var t=this;return(0,m.Z)((function*(){yield h().post(`${t.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:0}),yield h().post(`${t.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:1})}))()},imageDelete(e){var t=this;return(0,m.Z)((function*(){yield h().post(`${t.$heap.state.hostname}Image/itemDelete`,{image_id:e.image_id})}))()}},mounted(){this.listLoad()},watch:{filter:function(){this.listFilter()}}},f=o(3744);const y=(0,f.Z)(g,[["render",u],["__scopeId","data-v-0d87ad34"]]);var w=y}}]);
//# sourceMappingURL=1701-legacy.702c7a98.js.map