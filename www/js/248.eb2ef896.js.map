{"version":3,"file":"js/248.eb2ef896.js","mappings":"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","sources":["webpack://Tezkel/./src/views/CourierDashboard.vue","webpack://Tezkel/./src/views/CourierDashboard.vue?821e"],"sourcesContent":["<style scoped>\r\ninput,textarea{\r\n  border: none;\r\n  padding: 5px;\r\n  margin: 5px;\r\n  width: 100%;\r\n  outline: none;\r\n}\r\nion-text{\r\n  color:black;\r\n  padding:20px;\r\n  border-radius:10px;\r\n  font-size: 12px;;\r\n}\r\n.disabled{\r\n  background-color: var(--ion-color-light-shade);\r\n}\r\n.deleted{\r\n  background-color: var(--ion-color-danger-tint);\r\n}\r\n.image_disabled{\r\n  border: 4px solid #999;\r\n  filter: grayscale(0.5);\r\n}\r\n</style>\r\n<template>\r\n  <base-layout page-title=\"Анкета курьера\" page-default-back-link=\"/user-dashboard\">\r\n\r\n  <div v-if=\"courier===false\">\r\n    <ion-card>\r\n      <ion-item>\r\n        <ion-label>Пока вы не курьер</ion-label>\r\n      </ion-item>\r\n      <ion-item>\r\n        <ion-note>Подайте заявку, чтобы стать курьером</ion-note>\r\n      </ion-item>\r\n      <ion-button expand=\"full\" @click=\"itemCreate()\">Стать курьером</ion-button>\r\n    </ion-card>\r\n  </div>\r\n\r\n  <div v-if=\"courier\">\r\n    <ion-card lines=\"none\" v-if=\"message\">\r\n      <ion-card-content :class=\"messageClass\">\r\n        {{message}}\r\n      </ion-card-content>\r\n    </ion-card>\r\n    <ion-card lines=\"none\" v-else>\r\n      <ion-card-content style=\"background-color: var(--ion-color-success-tint);\">\r\n      Анкета активна\r\n      </ion-card-content>\r\n    </ion-card>\r\n    \r\n    <form @change=\"updateCourier()\">\r\n        <ion-list>\r\n          <ion-item lines=\"full\">\r\n            <ion-thumbnail v-if=\"courier?.images[0]\" slot=\"start\">\r\n              <ion-img style=\"border-radius:10px;\" :class=\"imageClass\" :src=\"$heap.state.hostname + 'image/get.php/'+courier.images[0].image_hash+'.100.100.webp'\"/>\r\n            </ion-thumbnail>\r\n            <ion-button slot=\"end\" @click=\"uploadImageTrigger()\">Загрузить фото</ion-button>\r\n            <input type=\"file\" id=\"courier_foto_upload\" accept=\"image/*\" @change=\"uploadImage($event)\" style=\"display:none\">\r\n          </ion-item>\r\n\r\n          <ion-item lines=\"full\">\r\n            <ion-label position=\"stacked\" color=\"primary\">Транспорт</ion-label>\r\n            <ion-input v-model=\"courier.courier_vehicle\"/>\r\n          </ion-item>\r\n\r\n          <ion-item lines=\"full\">\r\n            <ion-label position=\"stacked\" color=\"primary\">ИНН</ion-label>\r\n            <ion-input v-model=\"courier.courier_tax_num\"/>\r\n          </ion-item>\r\n\r\n          <ion-item lines=\"full\">\r\n            <ion-label position=\"stacked\" color=\"primary\">Коментарий</ion-label>\r\n            <ion-textarea v-model=\"courier.courier_comment\"></ion-textarea>\r\n          </ion-item>\r\n          \r\n          <ion-item v-if=\"courier.deleted_at\" lines=\"none\">\r\n              <ion-button slot=\"end\" @click=\"itemUnDelete()\" color=\"success\">Восстановить</ion-button>\r\n          </ion-item>\r\n          <ion-item v-else lines=\"none\">\r\n              <ion-button slot=\"end\" color=\"danger\" @click=\"itemDelete()\">Удалить анкету</ion-button>\r\n          </ion-item>\r\n\r\n          <ion-item v-if=\"showDisable\" lines=\"none\">\r\n              <ion-button slot=\"end\" @click=\"itemDisable()\" color=\"dark\">Заблокировать анкету</ion-button>\r\n          </ion-item>\r\n          <ion-item v-if=\"showEnable\" lines=\"none\">\r\n              <ion-button slot=\"end\" @click=\"itemEnable()\" color=\"success\">Утвердить анкету</ion-button>\r\n          </ion-item>\r\n        </ion-list>\r\n    </form>\r\n  </div>\r\n\r\n  </base-layout>\r\n</template>\r\n\r\n<script>\r\nimport jQuery from \"jquery\";\r\nimport heap from '@/heap';\r\nimport User from '@/scripts/User.js';\r\nimport { \r\n  IonTextarea,\r\n  IonInput,\r\n  IonCard,\r\n  IonCardContent,\r\n  IonLabel,\r\n  IonItem,\r\n  IonNote,\r\n  IonButton,\r\n  IonImg,\r\n  IonThumbnail,\r\n  IonList,\r\n\r\n }          from \"@ionic/vue\";\r\n\r\nexport default  {\r\n  components: {\r\n  IonTextarea,\r\n  IonInput,\r\n  IonCard,\r\n  IonCardContent,\r\n  IonLabel,\r\n  IonItem,\r\n  IonNote,\r\n  IonButton,\r\n  IonImg,\r\n  IonThumbnail,\r\n  IonList,\r\n\r\n  },\r\n  data(){\r\n    return {\r\n      courier:User.courier.data,\r\n      isAdmin:User.isAdmin()\r\n    }\r\n  },\r\n  mounted(){\r\n    //this.load();\r\n  },\r\n  computed:{\r\n    message(){\r\n      if(this.courier.deleted_at){\r\n        return \"Анкета не активна и будет удалена. Вы можете еще отменить удаление\";\r\n      }\r\n      if(this.courier.is_disabled==1){\r\n        return \"Анкета не активна и находится на рассмотрении у администратора\";\r\n      }\r\n      return null;\r\n    },\r\n    messageClass(){\r\n      if(this.courier.deleted_at){\r\n        return \"deleted\";\r\n      }\r\n      if(this.courier.is_disabled==1){\r\n        return \"disabled\";\r\n      }\r\n      return null;\r\n    },\r\n    imageClass(){\r\n      if(this.courier?.images[0]?.is_disabled==1){\r\n        return 'image_disabled';\r\n      }\r\n      return '';\r\n    },\r\n    showDisable(){\r\n      if( this.courier.is_disabled==0 && User.isAdmin() ){\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    showEnable(){\r\n      if( this.courier.is_disabled==1 && User.isAdmin() ){\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    showDelete(){\r\n      if( this.courier.deleted_at ){\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    showUnDelete(){\r\n      if( this.courier.deleted_at==-1 || this.courier.deleted_at ){\r\n        return false;\r\n      }\r\n      return true;\r\n    }\r\n  },\r\n  methods:{\r\n    async load(){\r\n      try{\r\n        this.courier=await User.courier.get();\r\n      } catch(err){\r\n        const status=JSON.parse(err.responseJSON?.status);\r\n        if(status==\"404\"){\r\n          //\r\n        }\r\n      }\r\n    },\r\n    async itemCreate(){\r\n      try{\r\n        await jQuery.post(heap.state.hostname + \"Courier/itemCreate\");\r\n        await User.get();\r\n        this.courier=User.courier.data;\r\n      } catch {\r\n        this.$flash(\"Не удалось зарегистрироваться как курьер\")\r\n      }\r\n    },\r\n    async itemDelete(){\r\n      try{\r\n        await jQuery.post(heap.state.hostname + \"Courier/itemDelete\",{courier_id:this.courier.courier_id});\r\n        this.load();\r\n      } catch(err){\r\n        const message=err.responseJSON?.messages?.error;\r\n        if(message=='invalid_status'){\r\n          this.$flash(\"Надо сначала закрыть смену\");\r\n        }\r\n      }\r\n    },\r\n    itemUnDelete(){\r\n      const self=this;\r\n      jQuery.post( heap.state.hostname + \"Courier/itemUnDelete\", {courier_id:this.courier.courier_id})\r\n      .done(()=>{\r\n        self.load();\r\n      });\r\n    },\r\n\r\n    itemDisable(){\r\n      const self=this;\r\n      jQuery.post( heap.state.hostname + \"Courier/itemDisable\", {courier_id:this.courier.courier_id,is_disabled:1})\r\n      .done(()=>{\r\n        self.load();\r\n      });\r\n    },\r\n    itemEnable(){\r\n      const self=this;\r\n      jQuery.post( heap.state.hostname + \"Courier/itemDisable\", {courier_id:this.courier.courier_id,is_disabled:0})\r\n      .done(()=>{\r\n        self.load();\r\n      });\r\n    },\r\n\r\n    async uploadImage(event) {\r\n      let data = new FormData();\r\n      data.append(\"files[]\", event.target.files[0]); \r\n      data.set(\"image_holder_id\", this.courier.courier_id);\r\n      const request={\r\n        url : heap.state.hostname + \"Courier/fileUpload\",\r\n        type: \"POST\",\r\n        data : data,\r\n        processData: false,\r\n        contentType: false\r\n      };\r\n      try{\r\n        await jQuery.ajax(request)\r\n        this.load()\r\n      } catch(err){\r\n        this.$flash(\"Не удалось загрузить фото\");\r\n      }\r\n    },\r\n    uploadImageTrigger(){\r\n      jQuery('#courier_foto_upload').trigger('click');\r\n    },\r\n    async updateCourier(){\r\n      try{\r\n        return await jQuery.post(heap.state.hostname + \"Courier/itemUpdate\",JSON.stringify(this.courier));\r\n      } catch(err){\r\n        const message=JSON.parse(err.responseJSON?.messages?.error);\r\n        if(message.courier_tax_num){\r\n          this.$flash(\"Неверный формат ИНН\");\r\n        }\r\n      }\r\n      \r\n    }\r\n  },\r\n}\r\n</script>","import { render } from \"./CourierDashboard.vue?vue&type=template&id=1e53b10b&scoped=true\"\nimport script from \"./CourierDashboard.vue?vue&type=script&lang=js\"\nexport * from \"./CourierDashboard.vue?vue&type=script&lang=js\"\n\nimport \"./CourierDashboard.vue?vue&type=style&index=0&id=1e53b10b&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-1e53b10b\"]])\n\nexport default __exports__"],"names":["courier","expand","itemCreate","message","lines","class","messageClass","style","updateCourier","images","slot","imageClass","src","$heap","state","hostname","image_hash","uploadImageTrigger","type","id","accept","uploadImage","$event","position","color","courier_vehicle","courier_tax_num","courier_comment","deleted_at","itemUnDelete","itemDelete","showDisable","itemDisable","showEnable","itemEnable","components","IonTextarea","IonInput","IonCard","IonCardContent","IonLabel","IonItem","IonNote","IonButton","IonImg","IonThumbnail","IonList","data","User","isAdmin","mounted","computed","this","is_disabled","showDelete","showUnDelete","methods","async","err","JSON","parse","responseJSON","status","heap","$flash","courier_id","load","messages","error","self","done","event","FormData","append","target","files","set","request","url","processData","contentType","trigger","stringify","__exports__","render"],"sourceRoot":""}