"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[620],{4535:function(e,t,a){a.d(t,{Z:function(){return b}});var l=a(6252),n=a(3577);const i=(0,l.Uk)("Баланс"),o=(0,l.Uk)("Настройки"),u=(0,l.Uk)("Начальная дата"),s={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},r=(0,l.Uk)("Обороты"),d={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},c=(0,l.Uk)("Конечная дата"),m={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},g=(0,l.Uk)(" Нет операций в данном периоде ");function p(e,t,a,p,h,w){const _=(0,l.up)("ion-title"),f=(0,l.up)("ion-text"),y=(0,l.up)("ion-item"),k=(0,l.up)("ion-list"),W=(0,l.up)("ion-icon"),v=(0,l.up)("ion-input"),b=(0,l.up)("ion-accordion"),I=(0,l.up)("ion-accordion-group"),$=(0,l.up)("ion-searchbar"),x=(0,l.up)("ion-skeleton-text"),S=(0,l.up)("ion-label");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(k,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[i])),_:1}),h.balance>0?((0,l.wg)(),(0,l.j4)(f,{key:0,slot:"end",color:"success"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(h.balance)+(0,n.zw)(e.$heap.state.currencySign),1)])),_:1})):((0,l.wg)(),(0,l.j4)(f,{key:1,slot:"end"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(h.balance)+(0,n.zw)(e.$heap.state.currencySign),1)])),_:1}))])),_:1})])),_:1}),(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{slot:"header"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{icon:p.settingsOutline,slot:"start"},null,8,["icon"]),(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[o])),_:1})])),_:1}),(0,l.Wm)(k,{slot:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{color:"light"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[u])),_:1}),(0,l._)("div",s,[(0,l.Wm)(v,{type:"date",modelValue:h.start_at,"onUpdate:modelValue":t[0]||(t[0]=e=>h.start_at=e),onIonChange:t[1]||(t[1]=e=>w.listGet())},null,8,["modelValue"]),h.meta.sum_start?((0,l.wg)(),(0,l.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${h.meta.sum_start}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,l.kq)("",!0)])])),_:1}),(0,l.Wm)(y,{color:"light"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[r])),_:1}),(0,l._)("div",d,[h.meta.sum_debit?((0,l.wg)(),(0,l.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`+${h.meta.sum_debit}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,l.kq)("",!0),h.meta.sum_credit?((0,l.wg)(),(0,l.j4)(v,{key:1,type:"text",style:{"text-align":"right"},color:"medium",value:`-${h.meta.sum_credit}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,l.kq)("",!0)])])),_:1}),(0,l.Wm)(y,{color:"light"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[c])),_:1}),(0,l._)("div",m,[(0,l.Wm)(v,{type:"date",modelValue:h.finish_at,"onUpdate:modelValue":t[2]||(t[2]=e=>h.finish_at=e)},null,8,["modelValue"]),h.meta.sum_finish?((0,l.wg)(),(0,l.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${h.meta.sum_finish}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,l.kq)("",!0)])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l.Wm)($,{modelValue:h.q,"onUpdate:modelValue":t[3]||(t[3]=e=>h.q=e),placeholder:"Поиск по сумме или описанию",onIonChange:t[4]||(t[4]=e=>w.listGet())},null,8,["modelValue"]),null==h.ledger?((0,l.wg)(),(0,l.j4)(k,{key:0},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)([1,2,3],(e=>(0,l.Wm)(y,{key:e},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{slot:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{animated:"",style:{width:"50px"}})])),_:1}),(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x,{animated:"",style:{width:"100%"}})])),_:1}),(0,l.Wm)(S,{slot:"end",color:"success"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{animated:"",style:{width:"50px"}})])),_:1})])),_:2},1024))),64))])),_:1})):h.ledger.length>0?((0,l.wg)(),(0,l.j4)(k,{key:1},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(w.ledgerCalc,(e=>((0,l.wg)(),(0,l.j4)(y,{key:e.trans_id,onClick:t=>w.itemClick(e.trans_id),detail:w.is_admin},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{slot:"start"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.date),1)])),_:2},1024),(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.trans_description),1)])),_:2},1024),1==e.is_debit?((0,l.wg)(),(0,l.j4)(S,{key:0,slot:"end",color:"success"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.trans_amount),1)])),_:2},1024)):((0,l.wg)(),(0,l.j4)(S,{key:1,slot:"end",color:"danger"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,n.zw)(e.trans_amount),1)])),_:2},1024))])),_:2},1032,["onClick","detail"])))),128))])),_:1})):((0,l.wg)(),(0,l.j4)(k,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[g])),_:1})])),_:1}))])}var h=a(2066),w=a(8903),_=a(9755),f=a.n(_),y=a(351),k={components:{IonIcon:h.gu,IonTitle:h.wd,IonLabel:h.Q$,IonItem:h.Ie,IonInput:h.pK,IonList:h.q_,IonAccordion:h.We,IonAccordionGroup:h.eh,IonText:h.yW,IonSkeletonText:h.CK,IonSearchbar:h.VI},props:["account"],setup(){return{settingsOutline:w.C$N}},data(){const e=new Date,t=new Date(Date.parse(`${e.getFullYear()}-${e.getMonth()+1}-1`));return{balance:"-",start_at:t.toISOString().slice(0,10),finish_at:e.toISOString().slice(0,10),q:"",ledger:null,meta:{},today:e}},computed:{ledgerCalc(){if(null==this.ledger)return null;let e=[];for(let t of this.ledger)t.date=this.toLocDate(t.trans_date),e.push(t);return e},is_admin(){return y.Z.isAdmin()}},watch:{account:function(){this.listGet()}},methods:{async listGet(){try{const e={start_at:this.start_at,finish_at:this.finish_at,account:this.account,q:this.q},t=await f().post(`${this.$heap.state.hostname}Transaction/listGet`,e);this.ledger=t.ledger,this.meta=t.meta,this.finish_at==this.today.toISOString().slice(0,10)&&(this.balance=t.meta.sum_finish)}catch(e){const t=e.responseJSON,a=t.messages.error;switch(a){case"no_account":this.$flash("Ошибка получения выписки");break;case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break}return this.ledger=[],this.balance=0,!1}},toLocDate(e){const t=new Date(Date.parse(e)),a={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,a)},itemClick(e){y.Z.isAdmin()&&this.$router.push(`/admin/transaction-edit-${e}`)}},mounted(){this.listGet()}},W=a(3744);const v=(0,W.Z)(k,[["render",p]]);var b=v},4620:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var l=a(6252);const n=(0,l.Uk)(" Баланс ");function i(e,t,a,i,o,u){const s=(0,l.up)("ion-segment-button"),r=(0,l.up)("ion-segment"),d=(0,l.up)("ledger-comp"),c=(0,l.up)("base-layout");return(0,l.wg)(),(0,l.j4)(c,{pageTitle:"Статистика курьера",pageDefaultBackLink:"/user"},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{"swipe-gesture":"true",modelValue:o.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>o.activeTab=e),onIonChange:t[1]||(t[1]=e=>u.activeTabChanged(e))},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{value:"ledger"},{default:(0,l.w5)((()=>[n])),_:1})])),_:1},8,["modelValue"]),"ledger"==o.activeTab?((0,l.wg)(),(0,l.j4)(d,{key:0,account:"courier"})):(0,l.kq)("",!0)])),_:1})}var o=a(2066),u=a(8903),s=a(4535),r={components:{IonSegment:o.cJ,IonSegmentButton:o.GO,ledgerComp:s.Z},setup(){return{receiptOutline:u.d71}},data(){return{activeTab:"ledger"}},methods:{async activeTabChanged(){}}},d=a(3744);const c=(0,d.Z)(r,[["render",i]]);var m=c}}]);
//# sourceMappingURL=620.f5e2247a.js.map