(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[6175],{7850:function(e,t,o){var i=o(111),l=o(4326),r=o(5112),n=r("match");e.exports=function(e){var t;return i(e)&&(void 0!==(t=e[n])?!!t:"RegExp"==l(e))}},3123:function(e,t,o){"use strict";var i=o(2104),l=o(6916),r=o(1702),n=o(7007),d=o(7850),u=o(9670),a=o(4488),c=o(6707),s=o(1530),p=o(7466),m=o(1340),_=o(8173),h=o(1589),g=o(7651),f=o(2261),k=o(2999),I=o(7293),w=k.UNSUPPORTED_Y,v=4294967295,y=Math.min,W=[].push,b=r(/./.exec),U=r(W),C=r("".slice),O=!I((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var o="ab".split(e);return 2!==o.length||"a"!==o[0]||"b"!==o[1]}));n("split",(function(e,t,o){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,o){var r=m(a(this)),n=void 0===o?v:o>>>0;if(0===n)return[];if(void 0===e)return[r];if(!d(e))return l(t,r,e,n);var u,c,s,p=[],_=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,k=new RegExp(e.source,_+"g");while(u=l(f,k,r)){if(c=k.lastIndex,c>g&&(U(p,C(r,g,u.index)),u.length>1&&u.index<r.length&&i(W,p,h(u,1)),s=u[0].length,g=c,p.length>=n))break;k.lastIndex===u.index&&k.lastIndex++}return g===r.length?!s&&b(k,"")||U(p,""):U(p,C(r,g)),p.length>n?h(p,0,n):p}:"0".split(void 0,0).length?function(e,o){return void 0===e&&0===o?[]:l(t,this,e,o)}:t,[function(t,o){var i=a(this),n=void 0==t?void 0:_(t,e);return n?l(n,t,i,o):l(r,m(i),t,o)},function(e,i){var l=u(this),n=m(e),d=o(r,l,n,i,r!==t);if(d.done)return d.value;var a=c(l,RegExp),_=l.unicode,h=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(w?"g":"y"),f=new a(w?"^(?:"+l.source+")":l,h),k=void 0===i?v:i>>>0;if(0===k)return[];if(0===n.length)return null===g(f,n)?[n]:[];var I=0,W=0,b=[];while(W<n.length){f.lastIndex=w?0:W;var O,D=g(f,w?C(n,W):n);if(null===D||(O=y(p(f.lastIndex+(w?W:0)),n.length))===I)W=s(n,W,_);else{if(U(b,C(n,I,W)),b.length===k)return b;for(var V=1;V<=D.length-1;V++)if(U(b,D[V]),b.length===k)return b;W=I=O}}return U(b,C(n,I)),b}]}),!O,w)},7327:function(e,t,o){"use strict";o.d(t,{Z:function(){return p}});var i=o(6252),l=o(3577);const r=(0,i.Uk)("Просмотр фотографии");function n(e,t,o,n,d,u){const a=(0,i.up)("ion-title"),c=(0,i.up)("ion-icon"),s=(0,i.up)("ion-toolbar"),p=(0,i.up)("ion-header"),m=(0,i.up)("ion-button"),_=(0,i.up)("ion-col"),h=(0,i.up)("ion-row"),g=(0,i.up)("ion-grid"),f=(0,i.up)("ion-img"),k=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(s,{color:"secondary"},{default:(0,i.w5)((()=>[(0,i.Wm)(a,null,{default:(0,i.w5)((()=>[r])),_:1}),(0,i.Wm)(c,{icon:n.closeOutline,onClick:t[0]||(t[0]=e=>{n.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[o.actions?((0,i.wg)(),(0,i.j4)(g,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.actions,((e,t)=>((0,i.wg)(),(0,i.j4)(_,{key:t},{default:(0,i.w5)((()=>{var o;return[e[0]?((0,i.wg)(),(0,i.j4)(m,{key:0,onClick:o=>u.actionCreate(t,e[1]),expand:"block",color:null!==(o=e[1])&&void 0!==o?o:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e[0]),1)])),_:2},1032,["onClick","color"])):(0,i.kq)("",!0)]})),_:2},1024)))),128))])),_:1})])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(f,{src:e.$heap.state.hostname+"image/get.php/"+o.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var d=o(8903),u=o(8292),a={props:["image_hash","actions"],components:{IonIcon:u.gu,IonToolbar:u.sr,IonHeader:u.Gu,IonImg:u.Xz,IonContent:u.W2,IonTitle:u.wd,IonButton:u.YG,IonCol:u.wI,IonRow:u.Nd,IonGrid:u.jY},setup(){const e=function(){u.Fy.dismiss()};return{closeModal:e,closeOutline:d.fID}},methods:{actionCreate(e,t){("danger"!=t||confirm("Вы уверены?"))&&u.Fy.dismiss(null,e)}}},c=o(3744);const s=(0,c.Z)(a,[["render",n]]);var p=s},2226:function(e,t,o){"use strict";o.d(t,{Z:function(){return b}});var i=o(6252),l=o(3577);const r=(0,i.Uk)("Фотографии"),n={key:0,class:"image_grid"},d=["onClick"],u={key:0},a={key:1},c={key:0,class:"image_controls"},s=["id"];function p(e,t,o,p,m,_){var h;const g=(0,i.up)("ion-label"),f=(0,i.up)("ion-icon"),k=(0,i.up)("ion-item"),I=(0,i.up)("ion-img"),w=(0,i.up)("ion-avatar");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(k,{lines:"none",onClick:t[0]||(t[0]=e=>{m.editMode=!m.editMode,m.editMode&&_.load()})},{default:(0,i.w5)((()=>[o.title?((0,i.wg)(),(0,i.j4)(g,{key:0,color:"imageList?.length?'':medium"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(o.title),1)])),_:1})):((0,i.wg)(),(0,i.j4)(g,{key:1,color:"imageList?.length?'':medium"},{default:(0,i.w5)((()=>[r])),_:1})),m.editMode?((0,i.wg)(),(0,i.j4)(f,{key:2,slot:"end",icon:p.settingsSharp,color:"primary"},null,8,["icon"])):((0,i.wg)(),(0,i.j4)(f,{key:3,slot:"end",icon:p.settingsOutline},null,8,["icon"]))])),_:1}),null!==(h=_.imageList)&&void 0!==h&&h.length?((0,i.wg)(),(0,i.iD)("div",n,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(_.imageList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.image_id,style:{position:"relative"}},[(0,i._)("div",{style:{position:"absolute",top:"0px","background-color":"#fffc","font-size":"0.75em"},onClick:e=>_.imagePreview(t.image_hash)},[t.deleted_at?((0,i.wg)(),(0,i.iD)("div",u,"будет удалено")):1==t.is_disabled?((0,i.wg)(),(0,i.iD)("div",a,"на модерации")):(0,i.kq)("",!0)],8,d),(0,i.Wm)(w,{onClick:e=>_.imagePreview(t.image_hash),class:(0,l.C_)(t.class)},{default:(0,i.w5)((()=>[(0,i.Wm)(I,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),m.editMode?((0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(f,{icon:p.chevronBackCircleOutline,onClick:e=>_.back(t)},null,8,["icon","onClick"]),_.isAdmin&&1==t.is_disabled?((0,i.wg)(),(0,i.j4)(f,{key:0,icon:p.checkmarkCircle,color:"success",onClick:e=>_.enable(t)},null,8,["icon","onClick"])):(0,i.kq)("",!0),t.deleted_at?((0,i.wg)(),(0,i.j4)(f,{key:1,icon:p.addCircle,color:"success",onClick:e=>_.restore(t)},null,8,["icon","onClick"])):((0,i.wg)(),(0,i.j4)(f,{key:2,icon:p.trash,color:"danger",onClick:e=>_.remove(t)},null,8,["icon","onClick"])),(0,i.Wm)(f,{icon:p.chevronForwardCircleOutline,onClick:e=>_.forward(t)},null,8,["icon","onClick"])])):(0,i.kq)("",!0)])))),128))])):(0,i.kq)("",!0),(0,i._)("input",{type:"file",id:m.fileUploaderId,accept:".png, .jpg, .jpeg, .webp, .gif",onChange:t[1]||(t[1]=e=>_.uploadImage(e)),style:{display:"none"}},null,40,s)])}var m=o(8534),_=o(8903),h=o(8292),g=o(7327),f=o(9755),k=o.n(f),I=o(9042),w=o(351),v={props:["images","image_holder","image_holder_id","controller","title"],components:{IonLabel:h.Q$,IonIcon:h.gu,IonItem:h.Ie,IonImg:h.Xz,IonAvatar:h.BJ},setup(){return{settingsOutline:_.C$N,settingsSharp:_.kiF,chevronBackCircleOutline:_.CK0,chevronForwardCircleOutline:_.esm,trash:_._Ij,addCircle:_.ZWo,checkmarkCircle:_.I1A}},data(){var e;return{images_loaded:null,editMode:!1,fileUploaderId:(null!==(e=this.image_holder)&&void 0!==e?e:this.controller)+this.image_holder_id}},computed:{imageList(){let e=this.images_loaded||this.images,t=[];for(let o in e)e[o].deleted_at?(e[o].class=" deleted",this.editMode&&t.push(e[o])):1==e[o].is_disabled?(e[o].class=" disabled",this.editMode&&t.push(e[o])):t.push(e[o]);return t},isAdmin(){return w.Z.isAdmin()}},methods:{back(e){var t=this;return(0,m.Z)((function*(){try{yield k().post(t.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),t.load()}catch(o){}}))()},forward(e){var t=this;return(0,m.Z)((function*(){try{yield k().post(t.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),t.load()}catch(o){}}))()},remove(e){var t=this;return(0,m.Z)((function*(){try{yield k().post(t.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),t.load(),t.$flash("Фото перемещено в корзину и будет удалено")}catch(o){}}))()},restore(e){var t=this;return(0,m.Z)((function*(){try{yield k().post(t.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),t.load(),t.$flash("Фото перемещено извлечено из корзины")}catch(o){}}))()},enable(e){var t=this;return(0,m.Z)((function*(){try{yield k().post(t.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),t.load()}catch(o){}}))()},load(){var e=this;return(0,m.Z)((function*(){var t;const o={image_holder_id:e.image_holder_id,image_holder:null!==(t=e.image_holder)&&void 0!==t?t:e.controller,is_disabled:1,is_deleted:1,is_active:1};e.images_loaded=yield k().post(e.$heap.state.hostname+"Image/listGet",o)}))()},imagePreview(e){return(0,m.Z)((function*(){const t=yield h.Fy.create({component:g.Z,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[.5,1]}),o=function(){t.dismiss()};return I.Z.on("dismissModal",o),t.present()}))()},uploadImage(e){var t=this;return(0,m.Z)((function*(){let o=new FormData;o.append("files[]",e.target.files[0]),o.set("image_holder_id",t.image_holder_id),t.image_holder&&o.set("image_holder",t.image_holder);const i={url:t.$heap.state.hostname+t.controller+"/fileUpload",type:"POST",data:o,processData:!1,contentType:!1};try{yield k().ajax(i),t.load()}catch(u){var l,r,n,d;if("limit_exeeded"==(null===u||void 0===u||null===(l=u.responseJSON)||void 0===l||null===(r=l.messages)||void 0===r?void 0:r.error))return void t.$flash("Уже загружено максимальное количество фото");if("no_valid_images"==(null===u||void 0===u||null===(n=u.responseJSON)||void 0===n||null===(d=n.messages)||void 0===d?void 0:d.error))return void t.$flash("Формат файла не поддерживается");t.$flash("Не удалось загрузить фото")}}))()},take_photo(){k()(`#${this.fileUploaderId}`).trigger("click"),this.editMode=!0}}},y=o(3744);const W=(0,y.Z)(v,[["render",p],["__scopeId","data-v-5ec0cc30"]]);var b=W},6175:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return fe}});o(3948),o(4916),o(5306);var i=o(6252),l=o(3577);const r=e=>((0,i.dD)("data-v-43fd9045"),e=e(),(0,i.Cn)(),e),n={key:0},d={key:0},u=(0,i.Uk)("Обратите внимание на то, что поля "),a=r((()=>(0,i._)("ul",null,[(0,i._)("li",null,"Название (больше 5 букв), "),(0,i._)("li",null,"Цена, "),(0,i._)("li",null,"Актуальный остаток (если ведется учет), "),(0,i._)("li",null,"Изображения товара")],-1))),c=(0,i.Uk)(" обязательные "),s=[u,a,c],p=(0,i.Uk)(" Удалено "),m=(0,i.Uk)(" Отключено "),_=(0,i.Uk)(" Вести учет остатков "),h=(0,i.Uk)(" Имеет варианты "),g=(0,i.Uk)(" Родительский товар "),f=(0,i.Uk)("Вариант*"),k={style:{display:"grid","grid-template-columns":"1fr 1fr"}},I=(0,i.Uk)("Вариант*"),w=(0,i.Uk)("добавить"),v={key:2},y=(0,i.Uk)(" Показать товар "),W=(0,i.Uk)(" Показать в магазине "),b=(0,i.Uk)(" Управление магазином "),U=(0,i.Uk)("Основные настройки"),C=(0,i.Uk)("Название*"),O=(0,i.Uk)("Описание*"),D=(0,i.Uk)("Артикул"),V=(0,i.Uk)("Штрихкод"),G=(0,i.Uk)("Остаток "),$={key:0},Z=(0,i.Uk)("Мин. заказ*"),j={key:0},q=(0,i.Uk)("Единица*"),L=(0,i.Uk)("штука"),P=(0,i.Uk)("порция вес"),x=(0,i.Uk)("порция объем"),z=(0,i.Uk)("килограмм"),M=(0,i.Uk)("метр"),F=(0,i.Uk)("литр"),S=(0,i.Uk)("Объем л*"),B=(0,i.Uk)("Цена"),T=(0,i.Uk)("Цена*"),Y=(0,i.Uk)("Цена в меню/на полке"),H=(0,i.Uk)("Цена акционная"),N=(0,i.Uk)("Начало акции"),A=(0,i.Uk)("Конец акции"),J=(0,i.Uk)("Изображения товара*"),K=(0,i.Uk)(" Добавить фото на витрину "),X=(0,i.Uk)("Категории товара*"),E=(0,i.Uk)("Без категории (в разделе 'Другое')"),R=(0,i.Uk)("Добавить в категорию");function Q(e,t,o,r,u,a){var c,Q;const ee=(0,i.up)("ion-progress-bar"),te=(0,i.up)("ion-card-title"),oe=(0,i.up)("ion-card-header"),ie=(0,i.up)("ion-text"),le=(0,i.up)("ion-card-content"),re=(0,i.up)("ion-card"),ne=(0,i.up)("ion-icon"),de=(0,i.up)("ion-toggle"),ue=(0,i.up)("ion-item"),ae=(0,i.up)("ion-card-subtitle"),ce=(0,i.up)("ion-img"),se=(0,i.up)("ion-label"),pe=(0,i.up)("ion-input"),me=(0,i.up)("ion-chip"),_e=(0,i.up)("ion-button"),he=(0,i.up)("ion-item-divider"),ge=(0,i.up)("ion-list"),fe=(0,i.up)("ion-textarea"),ke=(0,i.up)("ion-select-option"),Ie=(0,i.up)("ion-select"),we=(0,i.up)("ion-item-group"),ve=(0,i.up)("image-tile-comp"),ye=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(ye,{"page-title":null!==(c=null===(Q=u.productItem)||void 0===Q?void 0:Q.product_name)&&void 0!==c?c:"Товар",pageDefaultBackLink:"/catalog"},{default:(0,i.w5)((()=>{var o,c;return[u.is_option_child?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(re,{color:(null===(o=u.productItem)||void 0===o?void 0:o.validity)<u.validity_min?"danger":""},{default:(0,i.w5)((()=>{var e;return[(0,i.Wm)(oe,null,{default:(0,i.w5)((()=>[(0,i.Wm)(te,null,{default:(0,i.w5)((()=>{var e,t,o;return[(0,i.Uk)(" Форма заполнена на "+(0,l.zw)(null!==(e=null===(t=u.productItem)||void 0===t?void 0:t.validity)&&void 0!==e?e:0)+"% ",1),(0,i.Wm)(ee,{value:(null===(o=u.productItem)||void 0===o?void 0:o.validity)/100},null,8,["value"])]})),_:1})])),_:1}),(null===(e=u.productItem)||void 0===e?void 0:e.validity)<u.validity_min?((0,i.wg)(),(0,i.j4)(le,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(ie,null,{default:(0,i.w5)((()=>{var e;return[(0,i.Uk)(" Вам необходимо заполнить анкету не меньше чем на "+(0,l.zw)(u.validity_min)+"% для рассмотрения модератором ",1),0==(null===(e=u.productItem)||void 0===e?void 0:e.validity)?((0,i.wg)(),(0,i.iD)("p",d,s)):(0,i.kq)("",!0)]})),_:1})])),_:1})):(0,i.kq)("",!0)]})),_:1},8,["color"]),a.message&&(null===(c=u.productItem)||void 0===c?void 0:c.validity)>u.validity_min?((0,i.wg)(),(0,i.j4)(re,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(le,{class:(0,l.C_)(a.messageClass)},{default:(0,i.w5)((()=>[(0,i.Wm)(ie,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(a.message),1)])),_:1})])),_:1},8,["class"])])),_:1})):(0,i.kq)("",!0)])),u.productItem?((0,i.wg)(),(0,i.j4)(ge,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.trashOutline,color:"primary",slot:"start"},null,8,["src"]),p,(0,i.Wm)(de,{slot:"end",modelValue:u.is_deleted,"onUpdate:modelValue":t[0]||(t[0]=e=>u.is_deleted=e),color:"danger",onIonChange:t[1]||(t[1]=e=>a.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.banOutline,color:"primary",slot:"start"},null,8,["src"]),m,(0,i.Wm)(de,{slot:"end",modelValue:u.is_disabled,"onUpdate:modelValue":t[2]||(t[2]=e=>u.is_disabled=e),onIonChange:t[3]||(t[3]=e=>a.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.pizzaOutline,color:"primary",slot:"start"},null,8,["src"]),_,u.productItem?((0,i.wg)(),(0,i.j4)(de,{key:0,slot:"end",modelValue:u.is_counted,"onUpdate:modelValue":t[4]||(t[4]=e=>u.is_counted=e),onIonChange:t[5]||(t[5]=e=>a.save("is_counted",e.target.checked?1:0))},null,8,["modelValue"])):(0,i.kq)("",!0)])),_:1}),u.is_option_child?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ue,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.layersOutline,color:"primary",slot:"start"},null,8,["src"]),h,u.productItem?((0,i.wg)(),(0,i.j4)(de,{key:0,slot:"end",modelValue:u.is_option_parent,"onUpdate:modelValue":t[6]||(t[6]=e=>u.is_option_parent=e),onIonChange:t[7]||(t[7]=e=>{a.itemOptionSet(e.target.checked)})},null,8,["modelValue"])):(0,i.kq)("",!0)])),_:1})),u.optionData?((0,i.wg)(),(0,i.iD)("div",{key:1,onChange:t[12]||(t[12]=(...e)=>a.saveForm&&a.saveForm(...e))},[(0,i.Wm)(re,{onClick:t[9]||(t[9]=t=>e.$router.replace(`product-edit-${u.optionData.parent.product_id}?refreshOptions=1`)),color:u.productId==u.optionData.parent.product_id?"primary":"light"},{default:(0,i.w5)((()=>[(0,i.Wm)(oe,null,{default:(0,i.w5)((()=>[(0,i.Wm)(ae,null,{default:(0,i.w5)((()=>[g])),_:1})])),_:1}),(0,i.Wm)(le,null,{default:(0,i.w5)((()=>[(0,i.Wm)(ue,{color:"light",lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(ce,{slot:"start",style:{height:"70px"},src:`${e.$heap.state.hostname}image/get.php/${u.optionData.parent.image_hash}.70.70.webp`},null,8,["src"]),(0,i.Uk)(" "+(0,l.zw)(u.optionData.parent.product_name),1)])),_:1}),u.productId==u.optionData.parent.product_id?((0,i.wg)(),(0,i.j4)(ue,{key:0,color:"light"},{default:(0,i.w5)((()=>[(0,i.Wm)(se,{position:"stacked"},{default:(0,i.w5)((()=>[f])),_:1}),(0,i.Wm)(pe,{name:"product_option",modelValue:u.productItem.product_option,"onUpdate:modelValue":t[8]||(t[8]=e=>u.productItem.product_option=e)},null,8,["modelValue"])])),_:1})):((0,i.wg)(),(0,i.j4)(ue,{key:1,lines:"none",color:"light"},{default:(0,i.w5)((()=>[(0,i.Wm)(me,null,{default:(0,i.w5)((()=>[(0,i.Uk)("["+(0,l.zw)(u.optionData.parent.product_option)+"]",1)])),_:1})])),_:1}))])),_:1})])),_:1},8,["color"]),(0,i._)("div",k,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(u.optionData.children,(o=>((0,i.wg)(),(0,i.j4)(re,{onClick:t=>e.$router.replace(`product-edit-${o.product_id}?refreshOptions=1`),key:o.product_id,color:u.productItem.product_id==o.product_id?"primary":""},{default:(0,i.w5)((()=>[(0,i.Wm)(le,null,{default:(0,i.w5)((()=>[u.productItem.product_id==o.product_id?((0,i.wg)(),(0,i.j4)(ue,{key:0,color:u.productItem.deleted_at?"danger":""},{default:(0,i.w5)((()=>[(0,i.Wm)(se,{position:"stacked"},{default:(0,i.w5)((()=>[I])),_:1}),(0,i.Wm)(pe,{name:"product_option",modelValue:u.productItem.product_option,"onUpdate:modelValue":t[10]||(t[10]=e=>u.productItem.product_option=e)},null,8,["modelValue"])])),_:1},8,["color"])):((0,i.wg)(),(0,i.j4)(ue,{key:1,lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(me,{color:o.deleted_at?"danger":""},{default:(0,i.w5)((()=>[(0,i.Uk)("["+(0,l.zw)(o.product_option)+"]",1)])),_:2},1032,["color"])])),_:2},1024))])),_:2},1024)])),_:2},1032,["onClick","color"])))),128)),(0,i.Wm)(re,null,{default:(0,i.w5)((()=>[(0,i.Wm)(le,null,{default:(0,i.w5)((()=>[(0,i.Wm)(_e,{color:"light",expand:"block",onClick:t[11]||(t[11]=e=>a.itemOptionCreate())},{default:(0,i.w5)((()=>[w])),_:1})])),_:1})])),_:1})])],32)):(0,i.kq)("",!0),u.is_option_child?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",v,[(0,i.Wm)(he),(0,i.Wm)(ue,{button:"",onClick:t[13]||(t[13]=t=>e.$router.push("product-"+u.productItem.product_id))},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.chevronBack,slot:"start"},null,8,["src"]),y])),_:1}),(0,i.Wm)(ue,{button:"",onClick:t[14]||(t[14]=e=>a.showProductInStore())},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.chevronBack,slot:"start"},null,8,["src"]),W])),_:1}),(0,i.Wm)(ue,{button:"",onClick:t[15]||(t[15]=t=>e.$router.push("/catalog/store-edit-"+u.productItem.store_id))},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.chevronBack,slot:"start"},null,8,["src"]),b])),_:1})]))])),_:1})):(0,i.kq)("",!0),u.productItem?((0,i.wg)(),(0,i.iD)("form",{key:2,onChange:t[29]||(t[29]=(...e)=>a.saveForm&&a.saveForm(...e))},[(0,i.Wm)(ge,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(we,null,{default:(0,i.w5)((()=>[(0,i.Wm)(he,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[U])),_:1})])),_:1}),u.is_option_child?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ue,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(se,{position:"stacked",color:"primary"},{default:(0,i.w5)((()=>[C])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_name,"onUpdate:modelValue":t[16]||(t[16]=e=>u.productItem.product_name=e),name:"product_name",placeholder:"полное название товара",clearInput:"true"},null,8,["modelValue"])])),_:1})),u.is_option_child?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ue,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(se,{position:"stacked",color:"primary"},{default:(0,i.w5)((()=>[O])),_:1}),(0,i.Wm)(fe,{modelValue:u.productItem.product_description,"onUpdate:modelValue":t[17]||(t[17]=e=>u.productItem.product_description=e),name:"product_description",rows:"6",placeholder:"характеристики, свойства, состав товара"},null,8,["modelValue"])])),_:1})),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[D])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_code,"onUpdate:modelValue":t[18]||(t[18]=e=>u.productItem.product_code=e),name:"product_code",slot:"end",placeholder:"код товара"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[V])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_barcode,"onUpdate:modelValue":t[19]||(t[19]=e=>u.productItem.product_barcode=e),name:"product_barcode",slot:"end",placeholder:"штрихкод"},null,8,["modelValue"])])),_:1}),u.is_counted?((0,i.wg)(),(0,i.j4)(ue,{key:2},{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[G,u.productItem.product_unit?((0,i.wg)(),(0,i.iD)("span",$,"("+(0,l.zw)(u.productItem.product_unit)+")",1)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_quantity,"onUpdate:modelValue":t[20]||(t[20]=e=>u.productItem.product_quantity=e),name:"product_quantity",slot:"end",placeholder:"в наличии"},null,8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[Z,u.productItem.product_unit?((0,i.wg)(),(0,i.iD)("span",j,"("+(0,l.zw)(u.productItem.product_unit)+")",1)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_quantity_min,"onUpdate:modelValue":t[21]||(t[21]=e=>u.productItem.product_quantity_min=e),name:"product_quantity_min",type:"number",inputmode:"numeric",pattern:"\\d\\.",slot:"end"},null,8,["modelValue"])])),_:1}),u.is_option_child?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(ue,{key:3},{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[q])),_:1}),(0,i.Wm)(Ie,{modelValue:u.productItem.product_unit,"onUpdate:modelValue":t[22]||(t[22]=e=>u.productItem.product_unit=e),name:"product_unit",slot:"end",onIonChange:a.saveForm},{default:(0,i.w5)((()=>[(0,i.Wm)(ke,{value:"шт"},{default:(0,i.w5)((()=>[L])),_:1}),(0,i.Wm)(ke,{value:"порция"},{default:(0,i.w5)((()=>[P])),_:1}),(0,i.Wm)(ke,{value:"порция мл"},{default:(0,i.w5)((()=>[x])),_:1}),(0,i.Wm)(ke,{value:"кг"},{default:(0,i.w5)((()=>[z])),_:1}),(0,i.Wm)(ke,{value:"м"},{default:(0,i.w5)((()=>[M])),_:1}),(0,i.Wm)(ke,{value:"л"},{default:(0,i.w5)((()=>[F])),_:1})])),_:1},8,["modelValue","onIonChange"])])),_:1})),"кг"!=u.productItem.product_unit?((0,i.wg)(),(0,i.j4)(ue,{key:4},{default:(0,i.w5)((()=>["порция мл"==u.productItem.product_unit?((0,i.wg)(),(0,i.j4)(se,{key:0},{default:(0,i.w5)((()=>[S])),_:1})):((0,i.wg)(),(0,i.j4)(se,{key:1},{default:(0,i.w5)((()=>[(0,i.Uk)("Вес 1"+(0,l.zw)(u.productItem.product_unit)+" (кг)*",1)])),_:1})),(0,i.Wm)(pe,{modelValue:u.productItem.product_weight,"onUpdate:modelValue":t[23]||(t[23]=e=>u.productItem.product_weight=e),name:"product_weight",type:"number",step:"0.1",inputmode:"numeric",pattern:"\\d\\.",slot:"end"},null,8,["modelValue"])])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1}),(0,i.Wm)(ge,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(we,null,{default:(0,i.w5)((()=>[(0,i.Wm)(he,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[B])),_:1})])),_:1})])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[T])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_price,"onUpdate:modelValue":t[24]||(t[24]=e=>u.productItem.product_price=e),name:"product_price",type:"number",inputmode:"numeric",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[Y])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_net_price,"onUpdate:modelValue":t[25]||(t[25]=e=>u.productItem.product_net_price=e),name:"product_net_price",type:"number",inputmode:"numeric",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,{color:"success"},{default:(0,i.w5)((()=>[H])),_:1}),(0,i.Wm)(pe,{modelValue:u.productItem.product_promo_price,"onUpdate:modelValue":t[26]||(t[26]=e=>u.productItem.product_promo_price=e),name:"product_promo_price",type:"number",inputmode:"numeric",slot:"end",color:"success"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,{color:"success"},{default:(0,i.w5)((()=>[N])),_:1}),(0,i.Wm)(pe,{type:"date",modelValue:u.productItem.product_promo_start,"onUpdate:modelValue":t[27]||(t[27]=e=>u.productItem.product_promo_start=e),name:"product_promo_start",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(ue,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,{color:"success"},{default:(0,i.w5)((()=>[A])),_:1}),(0,i.Wm)(pe,{type:"date",modelValue:u.productItem.product_promo_finish,"onUpdate:modelValue":t[28]||(t[28]=e=>u.productItem.product_promo_finish=e),name:"product_promo_finish",slot:"end"},null,8,["modelValue"])])),_:1})])),_:1})],32)):(0,i.kq)("",!0),u.productItem&&!u.is_option_child?((0,i.wg)(),(0,i.j4)(ge,{key:3},{default:(0,i.w5)((()=>[(0,i.Wm)(he,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[J])),_:1})])),_:1}),(0,i.Wm)(ve,{images:u.productItem.images,image_holder_id:u.productItem.product_id,title:"Витрина товара 5 фото",controller:"Product",ref:"productImgs"},null,8,["images","image_holder_id"]),(0,i.Wm)(_e,{onClick:t[30]||(t[30]=t=>e.$refs.productImgs.take_photo()),color:"light",expand:"block"},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.cameraOutline,slot:"start"},null,8,["src"]),K])),_:1})])),_:1})):(0,i.kq)("",!0),u.productItem&&a.categoryList&&!u.is_option_child?((0,i.wg)(),(0,i.j4)(ge,{key:4},{default:(0,i.w5)((()=>[(0,i.Wm)(he,null,{default:(0,i.w5)((()=>[(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[X])),_:1})])),_:1}),0==a.categoryList.length?((0,i.wg)(),(0,i.j4)(ue,{key:0,color:"light"},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.compassOutline,slot:"start",color:"danger"},null,8,["src"]),(0,i.Wm)(se,{color:"danger"},{default:(0,i.w5)((()=>[E])),_:1})])),_:1})):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.categoryList,(e=>((0,i.wg)(),(0,i.j4)(ue,{key:e.group_id},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.compassOutline,slot:"start",color:"primary"},null,8,["src"]),(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.group_name),1)])),_:2},1024),(0,i.Wm)(ne,{src:r.trashOutline,slot:"end",onClick:t=>a.categoryDelete(e.group_id,e.group_name)},null,8,["src","onClick"])])),_:2},1024)))),128)),(0,i.Wm)(ue,{button:"",onClick:t[31]||(t[31]=e=>a.categoryAdd())},{default:(0,i.w5)((()=>[(0,i.Wm)(ne,{src:r.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,i.Wm)(se,null,{default:(0,i.w5)((()=>[R])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0)]})),_:1},8,["page-title"])}var ee=o(8534),te=(o(3123),o(8862),o(6699),o(8292)),oe=o(8903),ie=o(2226);const le=(0,i.Uk)("Категории"),re=(0,i.Uk)("Готово");function ne(e,t,o,r,n,d){const u=(0,i.up)("ion-title"),a=(0,i.up)("ion-icon"),c=(0,i.up)("ion-toolbar"),s=(0,i.up)("ion-button"),p=(0,i.up)("ion-header"),m=(0,i.up)("ion-img"),_=(0,i.up)("ion-avatar"),h=(0,i.up)("ion-label"),g=(0,i.up)("ion-checkbox"),f=(0,i.up)("ion-item"),k=(0,i.up)("ion-item-divider"),I=(0,i.up)("ion-list"),w=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[le])),_:1}),(0,i.Wm)(a,{slot:"end",onClick:t[0]||(t[0]=e=>{d.closeModal()}),icon:r.closeCircle,size:"large",color:"medium"},null,8,["icon"])])),_:1}),(0,i.Wm)(s,{onClick:t[1]||(t[1]=e=>{d.closeModal()}),color:"medium",expand:"full"},{default:(0,i.w5)((()=>[re])),_:1})])),_:1}),(0,i.Wm)(w,null,{default:(0,i.w5)((()=>[n.groupList?((0,i.wg)(),(0,i.j4)(I,{key:0},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.groupList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.group_id},[t.group_parent_id>0?((0,i.wg)(),(0,i.j4)(f,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{slot:"start"},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".50.50.webp"},null,8,["src"])])),_:2},1024),(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.group_name),1)])),_:2},1024),(0,i.Wm)(g,{slot:"end",checked:t.is_marked,onClick:e=>d.mimickChage(e.target,t.group_id)},null,8,["checked","onClick"])])),_:2},1024)):((0,i.wg)(),(0,i.j4)(k,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i._)("b",null,(0,l.zw)(t.group_name),1)])),_:2},1024)])),_:2},1024))])))),128))])),_:1})):(0,i.kq)("",!0)])),_:1})],64)}var de=o(9755),ue=o.n(de),ae={props:["controller","memberId","memberOfIds","memberLimit"],components:{IonCheckbox:te.nz,IonContent:te.W2,IonHeader:te.Gu,IonToolbar:te.sr,IonTitle:te.wd,IonIcon:te.gu,IonButton:te.YG,IonImg:te.Xz,IonAvatar:te.BJ,IonLabel:te.Q$,IonItemDivider:te.rH,IonList:te.q_,IonItem:te.Ie},setup(){return{closeCircle:oe.XZx}},data(){return{groupList:null,checkedGroupList:[]}},created(){this.listGroupGet(),this.checkedGroupList=this.memberOfIds||[]},methods:{listGroupGet(){var e=this;return(0,ee.Z)((function*(){e.groupList=yield ue().get(e.$heap.state.hostname+e.controller+"/listGroupGet"),e.itemMarkGroups()}))()},itemMarkGroups(){if(this.groupList)try{for(let e of this.groupList)e.is_marked=this.checkedGroupList.includes(e.group_id)?1:0}catch(e){}},itemUpdateGroup(e,t){var o=this;return(0,ee.Z)((function*(){const i={[o.controller.toLowerCase()+"_id"]:o.memberId,is_joined:e,group_id:t};try{yield ue().post(o.$heap.state.hostname+o.controller+"/itemUpdateGroup",i)}catch(l){o.$flash("Не удалось сохранить изменение")}}))()},mimickChage(e,t){const o=this;setTimeout((()=>{o.groupChanged(e,t)}),0)},groupChanged(e,t){var o=this;return(0,ee.Z)((function*(){const i=e.checked?1:0;if(i){if(o.checkedGroupList.length>=o.memberLimit)return o.$flash(`Можно выбрать не больше ${o.memberLimit} категорий`),void(e.checked=0);1==o.memberLimit&&o.closeModal(),o.checkedGroupList.push(t)}else o.checkedGroupList=o.checkedGroupList.filter((function(e,o,i){return e!=t}));o.itemUpdateGroup(i,t)}))()},closeModal(){te.Fy.dismiss(this.checkedGroupList)}}},ce=o(3744);const se=(0,ce.Z)(ae,[["render",ne]]);var pe=se,me=o(2008),_e=o(9042),he={components:{IonInput:te.pK,IonTextarea:te.g2,IonCard:te.PM,IonCardContent:te.FN,IonCardHeader:te.Zi,IonToggle:te.ho,IonIcon:te.gu,IonItem:te.Ie,IonList:te.q_,IonLabel:te.Q$,IonItemDivider:te.rH,IonItemGroup:te.Ub,IonButton:te.YG,IonProgressBar:te.X7,IonText:te.yW,IonSelect:te.t9,IonSelectOption:te.n0,IonImg:te.Xz,IonChip:te.hM,IonCardTitle:te.Dq,IonCardSubtitle:te.tO,imageTileComp:ie.Z},setup(){return{cameraOutline:oe.kuq,trashOutline:oe.gtu,banOutline:oe.L6S,personOutline:oe.QJ7,addOutline:oe.s6O,pizzaOutline:oe.fqo,compassOutline:oe.gmD,chevronBack:oe.Mny,layersOutline:oe.Y1P}},data(){return{productId:this.$route.params.id,productItem:null,productGroupList:null,validity:0,validity_min:80,optionData:null,refreshOptions:this.$route.query.refreshOptions,is_option_parent:!1,is_option_child:!1,is_groups_marked:0,is_deleted:0,is_disabled:0,is_counted:0}},computed:{message(){var e,t,o;return null!==(e=this.productItem)&&void 0!==e&&e.deleted_at?"Товар не активен и будет удален. Вы еще можете отменить удаление":1==(null===(t=this.productItem)||void 0===t?void 0:t.is_disabled)?"Товар не активен и находится на рассмотрении у администратора":1!=(null===(o=this.productItem)||void 0===o?void 0:o.is_counted)?"Товар активен и готов к продаже. Учет остатков товара не ведется":"Товар активен и готов к продаже."},messageClass(){var e,t,o;return null!==(e=this.productItem)&&void 0!==e&&e.deleted_at?"deleted":1==(null===(t=this.productItem)||void 0===t?void 0:t.is_disabled)?"disabled":1!=(null===(o=this.productItem)||void 0===o?void 0:o.is_counted)?"primary":"active"},categoryList(){let e=[];try{let t=this.productItem.member_of_groups.group_ids.split(","),o=this.productItem.member_of_groups.group_names.split(",");for(let i in t)e.push({group_id:t[i],group_name:o[i]})}catch(t){}return e}},created(){this.listGroupGet(),this.itemGet()},ionViewDidEnter(){var e;this.refreshOptions&&null!==(e=this.productItem)&&void 0!==e&&e.product_parent_id&&this.itemOptionGet()},methods:{itemGet(){var e=this;return(0,ee.Z)((function*(){try{let t=yield ue().post(me.Z.state.hostname+"Product/itemGet",{product_id:e.productId});e.productItem=e.itemPrepare(t),e.itemParseFlags(),e.is_option_child=e.productItem.product_parent_id&&e.productItem.product_parent_id!=e.productItem.product_id,e.is_option_parent=e.productItem.product_parent_id&&e.productItem.product_parent_id==e.productItem.product_id,yield e.itemOptionGet()}catch(t){}}))()},itemPrepare(e){return e.product_promo_start&&(e.product_promo_start=e.product_promo_start.split(" ")[0]),e.product_promo_finish&&(e.product_promo_finish=e.product_promo_finish.split(" ")[0]),e},itemParseFlags(){this.is_deleted=null==this.productItem.deleted_at?0:1,this.is_disabled=0==this.productItem.is_disabled?0:1,this.is_counted=0==this.productItem.is_counted?0:1},itemDelete(e){var t=this;return(0,ee.Z)((function*(){const o=e?"itemDelete":"itemUnDelete";try{yield ue().post(me.Z.state.hostname+"Product/"+o,{product_id:t.productId}),t.productItem.deleted_at=e?1:null,(t.is_option_child||t.is_option_parent)&&t.itemOptionGet()}catch(i){t.itemGet()}}))()},itemDisable(e){var t=this;return(0,ee.Z)((function*(){if(t.productItem.is_disabled!=e)try{yield ue().post(me.Z.state.hostname+"Product/itemDisable",{product_id:t.productId,is_disabled:e}),t.productItem.is_disabled=e}catch(o){t.itemGet()}}))()},itemUpdate(e){var t=this;return(0,ee.Z)((function*(){try{return yield ue().post(me.Z.state.hostname+"Product/itemUpdate",JSON.stringify(e)),t.$flash("сохранено"),!0}catch(o){const e=o.responseJSON.messages.error;return null!==e&&void 0!==e&&e.includes("product_description")?t.$flash("Описание слишком короткое"):null!==e&&void 0!==e&&e.includes("product_name")?t.$flash("Название слишком короткое"):t.$flash("Изменение не сохранено"),t.itemGet(),!1}}))()},itemOptionGet(){var e=this;return(0,ee.Z)((function*(){e.productItem.product_parent_id||(e.optionData=null);const t={product_parent_id:e.productItem.product_parent_id};let o=yield ue().post(`${e.$heap.state.hostname}Product/itemOptionGet`,t);e.optionData={parent:o[0],children:o.slice(1)}}))()},itemOptionCreate(){var e=this;return(0,ee.Z)((function*(){var t,o,i;const l=null!==(t=null===(o=e.optionData)||void 0===o||null===(i=o.children)||void 0===i?void 0:i.length)&&void 0!==t?t:0,r={is_disabled:1,store_id:e.productItem.store_id,product_parent_id:e.productItem.product_parent_id,product_name:"OPTION",product_price:0,product_option:`Вариант#${l}`};try{yield ue().post(`${e.$heap.state.hostname}Product/itemCreate`,r),e.itemOptionGet()}catch(n){}}))()},itemOptionSet(e){var t=this;return(0,ee.Z)((function*(){e?yield t.itemOptionSave(t.productId,t.productId):yield t.itemOptionDelete(t.productId),t.itemGet()}))()},itemOptionUpdate(e){return(0,ee.Z)((function*(){}))()},itemOptionSave(e,t){var o=this;return(0,ee.Z)((function*(){try{yield ue().post(`${o.$heap.state.hostname}Product/itemOptionSave`,{product_id:e,product_parent_id:t})}catch(i){}}))()},itemOptionDelete(e){var t=this;return(0,ee.Z)((function*(){if(confirm("Удалить разновидности товара?"))try{yield ue().post(`${t.$heap.state.hostname}Product/itemOptionDelete`,{product_id:e}),t.itemOptionGet()}catch(o){}}))()},checkPromoPrice(e){if(this.productItem.product_price>0&&this.productItem.product_promo_price>0&&this.productItem.product_price<=this.productItem.product_promo_price){"product_promo_price"==e&&(this.productItem.product_price=Number(this.productItem.product_promo_price)+1),"product_price"==e&&(this.productItem.product_promo_price=Number(this.productItem.product_price)-1);const t={product_id:this.productId,product_promo_price:this.productItem.product_promo_price,product_price:this.productItem.product_price};return this.itemUpdate(t),this.$flash("Акционная цена должна быть ниже основной. Внимание цена изменена!"),!1}return!0},saveForm(e){const t=e.target.name,o=this.productItem[t]=e.target.value;this.checkPromoPrice(t)&&this.save(t,o)},save(e,t){var o=this;return(0,ee.Z)((function*(){if(!o.productItem.product_id)return;let i={product_id:o.productItem.product_id,[e]:t};o.itemUpdate(i)&&(o.productItem[e]=t,o.itemParseFlags())}))()},categoryDelete(e,t){if(confirm("Исключить товар из категории "+t+"?"))try{this.itemUpdateGroup(0,e)}catch(o){}},categoryAdd(){var e=this;return(0,ee.Z)((function*(){var t,o,i;const l=(null===(t=e.productItem)||void 0===t||null===(o=t.member_of_groups)||void 0===o||null===(i=o.group_ids)||void 0===i?void 0:i.split(","))||[],r=yield te.Fy.create({component:pe,componentProps:{controller:"Product",memberId:e.productId,memberOfIds:l,memberLimit:1},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});r.present(),_e.Z.on("dismissModal",(()=>{r.dismiss()})),yield r.onDidDismiss(),e.itemGet()}))()},itemUpdateGroup(e,t){var o=this;return(0,ee.Z)((function*(){const i={product_id:o.productId,is_joined:e,group_id:t};try{yield ue().post(me.Z.state.hostname+"Product/itemUpdateGroup",i)}catch(l){o.$flash("Не удалось сохранить изменение")}o.itemGet()}))()},listGroupGet(){var e=this;return(0,ee.Z)((function*(){try{e.productGroupList=yield ue().get(me.Z.state.hostname+"Product/listGroupGet"),e.itemMarkGroups()}catch(t){}}))()},showProductInStore(){let e=0;try{e=this.productItem.member_of_groups.group_ids.split(",")[0]}catch(t){}this.$router.push({path:"store-"+this.productItem.store_id,query:{sub_group_id:e}})}}};const ge=(0,ce.Z)(he,[["render",Q],["__scopeId","data-v-43fd9045"]]);var fe=ge}}]);
//# sourceMappingURL=6175-legacy.a137827d.js.map