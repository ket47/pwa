"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[978],{2791:function(t,e,o){o.d(e,{Z:function(){return I}});var i=o(6252),r=o(3577);const a=["id"],n={class:"product_list_item_img"},u={style:{position:"relative",top:"-50%"}},l={style:{height:"3.5em",overflow:"hidden"}},s={key:0,style:{color:"var(--ion-color-danger)"}},c=(0,i.Uk)("   "),d={style:{color:"var(--ion-color-primary)"}},p=(0,i.Uk)(" / "),m={style:{color:"var(--ion-color-medium)"}};function _(t,e,o,_,h,y){const w=(0,i.up)("cart-add-buttons"),g=(0,i.up)("ion-img");return(0,i.wg)(),(0,i.iD)("div",{class:(0,r.C_)(!o.productItem.is_counted||o.productItem.product_quantity>0?"":"absent"),id:`product_list_item${o.productItem.product_id}`},[(0,i._)("div",n,[(0,i._)("div",u,[(0,i.Wm)(w,{buttonLayout:"vertical",productItem:o.productItem},null,8,["productItem"])]),(0,i.Wm)(g,{onClick:e[0]||(e[0]=e=>t.$router.push(`product-${o.productItem.product_id}`)),src:`${t.$heap.state.hostname}image/get.php/${o.productItem.image_hash}.150.150.webp`},null,8,["src"])]),(0,i._)("div",l,[o.productItem.product_price!=o.productItem.product_final_price?((0,i.wg)(),(0,i.iD)("span",s,[(0,i._)("s",null,(0,r.zw)(o.productItem.product_price)+(0,r.zw)(t.$heap.state.currencySign),1),c])):(0,i.kq)("",!0),(0,i._)("span",d,(0,r.zw)(o.productItem.product_final_price)+(0,r.zw)(t.$heap.state.currencySign),1),p,(0,i._)("span",m,(0,r.zw)(o.productItem.product_unit),1),(0,i._)("div",{style:{color:"black"},onClick:e[1]||(e[1]=e=>t.$router.push(`product-${o.productItem.product_id}`))},(0,r.zw)(o.productItem.product_name),1)])],10,a)}var h=o(5731),y=o(2410),w={components:{IonImg:h.Xz,CartAddButtons:y.Z},props:["productItem"]},g=o(3744);const v=(0,g.Z)(w,[["render",_],["__scopeId","data-v-0435858c"]]);var I=v},3978:function(t,e,o){o.r(e),o.d(e,{default:function(){return g}});var i=o(6252),r=o(3577);const a={key:0,style:{"background-color":"var(--ion-color-light-tint)",padding:"10px"}},n=(0,i.Uk)("Найденные товары"),u={style:{margin:"10px",display:"grid","grid-template-columns":"repeat(auto-fit, 150px)"}},l={key:1};function s(t,e,o,s,c,d){const p=(0,i.up)("ion-searchbar"),m=(0,i.up)("ion-title"),_=(0,i.up)("ion-img"),h=(0,i.up)("ion-thumbnail"),y=(0,i.up)("ion-note"),w=(0,i.up)("ion-item"),g=(0,i.up)("ion-chip"),v=(0,i.up)("product-item"),I=(0,i.up)("ion-list"),f=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(f,{"page-title":"Поиск товаров",pageDefaultBackLink:"/home"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{class:"search-container",modelValue:c.query,"onUpdate:modelValue":e[0]||(e[0]=t=>c.query=t),onInput:e[1]||(e[1]=t=>d.delayedListGet()),placeholder:"начните искать"},null,8,["modelValue"]),c.found?((0,i.wg)(),(0,i.iD)("div",a,[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[n])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(c.found.product_matches,(e=>((0,i.wg)(),(0,i.j4)(I,{key:e.store_id,style:{"border-radius":"10px","margin-top":"30px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{detail:"",button:"",onClick:o=>t.$router.push(`store-${e.store_id}`),lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{slot:"start"},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{style:{"border-radius":"10px"},src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.150.150.webp`},null,8,["src"])])),_:2},1024),(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(e?.store_name),1)])),_:2},1024),(0,i.Wm)(y,{slot:"helper"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(e.store_description),1)])),_:2},1024)])),_:2},1032,["onClick"]),(0,i._)("div",null,[e.is_opened?((0,i.wg)(),(0,i.j4)(g,{key:0,color:"success"},{default:(0,i.w5)((()=>[(0,i.Uk)("Открыт до "+(0,r.zw)(e.store_time_closes)+":00",1)])),_:2},1024)):((0,i.wg)(),(0,i.j4)(g,{key:1,color:"danger"},{default:(0,i.w5)((()=>[(0,i.Uk)("Закрыт до "+(0,r.zw)(e.store_time_opens)+":00",1)])),_:2},1024)),e.deliveryTime.timeMin?((0,i.wg)(),(0,i.j4)(g,{key:2,color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,r.zw)(e.deliveryTime.timeMin)+"-"+(0,r.zw)(e.deliveryTime.timeMax)+"мин",1)])),_:2},1024)):(0,i.kq)("",!0)]),(0,i._)("div",u,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.matches,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.product_id},[(0,i.Wm)(v,{productItem:t,storeName:e.store_name},null,8,["productItem","storeName"])])))),128))])])),_:2},1024)))),128))])):((0,i.wg)(),(0,i.iD)("div",l," Ничего не найдено "))])),_:1})}var c=o(5731),d=o(9755),p=o.n(d),m=o(4405),_=o(2791),h={components:{IonSearchbar:c.VI,IonTitle:c.wd,IonImg:c.Xz,IonThumbnail:c.Bs,IonChip:c.hM,IonNote:c.uN,IonItem:c.Ie,IonList:c.q_,ProductItem:_.Z},data(){return{query:this.$route.query.q||"",found:null}},ionViewDidEnter(){this.delayedListGet()},created(){this.delayedListGet()},methods:{async listGet(){const t={query:this.query,in_products:1,in_stores:0,location_id:this.locMainGet()};try{const e=await p().get(this.$heap.state.hostname+"Search/listGet",t);this.found=this.storeListCalculate(e)}catch{this.found="void"}},storeListCalculate(t){for(let e in t.product_matches)t.product_matches[e].deliveryTime=m.Z.deliveryTimeCalculate(t.product_matches[e].distance,t.product_matches[e].store_time_preparation);return t},locMainGet(){return this.$heap.state.user.location_main?this.$heap.state.user.location_main.location_id:null},delayedListGet(){clearTimeout(this.clock);const t=this;this.clock=setTimeout((()=>{t.listGet()}),200)}}},y=o(3744);const w=(0,y.Z)(h,[["render",s],["__scopeId","data-v-706775e2"]]);var g=w},4405:function(t,e,o){var i=o(2008);const r={deliveryCalculate(t){if(!t.locations||!t.locations[0]||!t.locations[0].distance)return null;const e=t.locations[0].distance,o=t.store_time_preparation||0;return r.deliveryTimeCalculate(e,o)},deliveryTimeCalculate(t,e){e=e??i.Z.state.deliverySettings.defaultPreparationTime;const o=i.Z.state.deliverySettings.deliveryTimeDelta,r=5*Math.round(t/i.Z.state.deliverySettings.courierVelocity*60/5)+parseInt(e),a=r>o?r-o:r,n=a+o;return{time:r,timeMin:a,timeMax:n}}};e["Z"]=r}}]);
//# sourceMappingURL=978.41f13362.js.map