(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[6620],{4699:function(e,a,s){var r=s(9781),l=s(1702),n=s(1956),t=s(5656),u=s(5296).f,o=l(u),i=l([].push),p=function(e){return function(a){var s,l=t(a),u=n(l),p=u.length,d=0,_=[];while(p>d)s=u[d++],r&&!o(l,s)||i(_,e?[s,l[s]]:l[s]);return _}};e.exports={entries:p(!0),values:p(!1)}},2479:function(e,a,s){var r=s(2109),l=s(4699).values;r({target:"Object",stat:!0},{values:function(e){return l(e)}})},6620:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return S}});var r=s(6252),l=s(3577),n=s(9963);const t=(0,r.Uk)(" Вы уже вошли в систему с номером телефона "),u=(0,r.Uk)(" Простая регистрация "),o=(0,r.Uk)(" Для регистрации необходим только ваш номер мобильного телефона и имя, чтобы мы знали как обращаться к вам. "),i={novalidate:""},p={style:{display:"grid","grid-template-columns":"100px auto"}},d=(0,r.Uk)("Код"),_=(0,r.Uk)("+7 "),m=(0,r.Uk)("Мобильный телефон*"),c={"padding-left":""},h=(0,r.Uk)("Ваш псевдоним*"),f={"padding-left":""},w=(0,r.Uk)("Ваш е-маил (желательно заполнить)"),k=(0,r.Uk)(" Мы придумали пароль "),v=(0,r.Uk)(" для вас, но вы можете использовать свой вариант. Пароль будет сохранен на этом устройстве. "),g=(0,r.Uk)("Пароль (минимум 4 символа)*"),y={"padding-left":""},W=(0,r.Uk)("Зарегистрироваться"),b=(0,r.Uk)("Уже есть учетная запись?");function x(e,a,s,x,V,I){const U=(0,r.up)("ion-card-title"),$=(0,r.up)("ion-card-header"),q=(0,r.up)("ion-card-content"),C=(0,r.up)("ion-card"),S=(0,r.up)("ion-label"),O=(0,r.up)("ion-select-option"),j=(0,r.up)("ion-select"),z=(0,r.up)("ion-input"),N=(0,r.up)("ion-text"),F=(0,r.up)("ion-item"),J=(0,r.up)("ion-list"),D=(0,r.up)("ion-chip"),Z=(0,r.up)("ion-button"),M=(0,r.up)("ion-col"),G=(0,r.up)("ion-row"),L=(0,r.up)("base-layout");return(0,r.wg)(),(0,r.j4)(L,{"page-title":"Регистрация нового пользователя",pageDefaultBackLink:"/user"},{default:(0,r.w5)((()=>[e.$heap.state.user.user_id>0?((0,r.wg)(),(0,r.j4)(C,{key:0,style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,r.w5)((()=>[(0,r.Wm)($,null,{default:(0,r.w5)((()=>[(0,r.Wm)(U,{color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(e.$heap.state.user.user_name)+" "+(0,l.zw)(e.$heap.state.user.user_surname)+" "+(0,l.zw)(e.$heap.state.user.user_middlename),1)])),_:1})])),_:1}),(0,r.Wm)(q,null,{default:(0,r.w5)((()=>[t,(0,r._)("b",null,(0,l.zw)(e.$heap.state.user.user_phone),1)])),_:1})])),_:1})):((0,r.wg)(),(0,r.j4)(C,{key:1,color:"light"},{default:(0,r.w5)((()=>[(0,r.Wm)($,null,{default:(0,r.w5)((()=>[(0,r.Wm)(U,{color:"primary"},{default:(0,r.w5)((()=>[u])),_:1})])),_:1}),(0,r.Wm)(q,null,{default:(0,r.w5)((()=>[o])),_:1})])),_:1})),(0,r._)("form",i,[(0,r.Wm)(J,null,{default:(0,r.w5)((()=>[(0,r.Wm)(F,{lines:"full"},{default:(0,r.w5)((()=>[(0,r._)("div",p,[(0,r._)("div",null,[(0,r.Wm)(S,{position:"stacked"},{default:(0,r.w5)((()=>[d])),_:1}),(0,r.Wm)(j,{value:V.user_phone_prefix},{default:(0,r.w5)((()=>[(0,r.Wm)(O,{value:"7",selected:""},{default:(0,r.w5)((()=>[_])),_:1})])),_:1},8,["value"])]),(0,r._)("div",null,[(0,r.Wm)(S,{position:"stacked"},{default:(0,r.w5)((()=>[m])),_:1}),(0,r.Wm)(z,{modelValue:V.user_phone,"onUpdate:modelValue":a[0]||(a[0]=e=>V.user_phone=e),onIonChange:a[1]||(a[1]=e=>I.phoneFormat()),name:"phone",type:"tel",inputmode:"tel",placeholder:"(xxx)xxxxxxxxx",required:""},null,8,["modelValue"]),(0,r.Wm)(N,{color:"danger",slot:"helper"},{default:(0,r.w5)((()=>[(0,r.wy)((0,r._)("p",c,"Неверный номер телефона",512),[[n.F8,!I.phoneValid&&1==V.submitted]])])),_:1})])])])),_:1}),(0,r.Wm)(F,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(S,{position:"stacked"},{default:(0,r.w5)((()=>[h])),_:1}),(0,r.Wm)(z,{modelValue:V.user_name,"onUpdate:modelValue":a[2]||(a[2]=e=>V.user_name=e),name:"username",type:"text",placeholder:"как к вам обращаться?",required:""},null,8,["modelValue"]),(0,r.Wm)(N,{color:"danger",slot:"helper"},{default:(0,r.w5)((()=>[(0,r.wy)((0,r._)("p",f,"Проверьте ваш псевдоним",512),[[n.F8,!I.usernameValid&&1==V.submitted]])])),_:1})])),_:1}),(0,r.Wm)(F,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(S,{position:"stacked"},{default:(0,r.w5)((()=>[w])),_:1}),(0,r.Wm)(z,{modelValue:V.user_email,"onUpdate:modelValue":a[3]||(a[3]=e=>V.user_email=e),name:"email",type:"email",placeholder:"е-маил",required:""},null,8,["modelValue"])])),_:1})])),_:1}),V.user_pass==V.genpass?((0,r.wg)(),(0,r.j4)(C,{key:0,style:{"background-color":"var(--ion-color-primary-tint)"}},{default:(0,r.w5)((()=>[(0,r.Wm)(q,null,{default:(0,r.w5)((()=>[k,(0,r.Wm)(D,{style:{"font-family":"monospace,serif"}},{default:(0,r.w5)((()=>[(0,r.Uk)((0,l.zw)(V.user_pass),1)])),_:1}),v])),_:1})])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(F,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(S,{position:"stacked"},{default:(0,r.w5)((()=>[g])),_:1}),(0,r.Wm)(z,{modelValue:V.user_pass,"onUpdate:modelValue":a[4]||(a[4]=e=>V.user_pass=e),name:"password",type:"text",autocorrect:"off",placeholder:"пароль (минимум 4 символа)",required:"",style:{"font-family":"monospace,serif"}},null,8,["modelValue"]),(0,r.Wm)(N,{color:"danger",slot:"helper"},{default:(0,r.w5)((()=>[(0,r.wy)((0,r._)("p",y,"Пароль должен содержать не менее 4 символов.",512),[[n.F8,!I.passwordValid&&1==V.submitted]])])),_:1})])),_:1}),(0,r.Wm)(G,{"responsive-sm":""},{default:(0,r.w5)((()=>[(0,r.Wm)(M,null,{default:(0,r.w5)((()=>[(0,r.Wm)(Z,{onClick:I.onSubmit,expand:"block"},{default:(0,r.w5)((()=>[W])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,r.Wm)(G,{"responsive-sm":""},{default:(0,r.w5)((()=>[(0,r.Wm)(M,null,{default:(0,r.w5)((()=>[(0,r.Wm)(Z,{color:"light",expand:"block",onClick:a[5]||(a[5]=a=>e.$router.push("/user/sign-in"))},{default:(0,r.w5)((()=>[b])),_:1})])),_:1})])),_:1})])])),_:1})}var V=s(8534),I=(s(4916),s(5306),s(8862),s(2479),s(8292)),U=s(351),$=(s(9755),{components:{IonSelect:I.t9,IonSelectOption:I.n0,IonLabel:I.Q$,IonInput:I.pK,IonItem:I.Ie,IonText:I.yW,IonList:I.q_,IonButton:I.YG,IonCard:I.PM,IonCardHeader:I.Zi,IonCardTitle:I.Dq,IonCardContent:I.FN,IonChip:I.hM,IonCol:I.wI,IonRow:I.Nd},data(){const e=this.passGenerate();return{submitted:!1,genpass:e,user_pass:e,user_pass_confirm:null,user_phone:null,user_phone_prefix:"7",user_name:null,user_email:null}},computed:{phoneValid(){var e;return 10==(null===(e=this.user_phone)||void 0===e?void 0:e.replace(/\D/g,"").length)},passwordValid(){var e;return(null===(e=this.user_pass)||void 0===e?void 0:e.length)>=4},usernameValid(){var e;return(null===(e=this.user_name)||void 0===e?void 0:e.length)>0}},methods:{onSubmit(){var e=this;return(0,V.Z)((function*(){var a;if(e.submitted=!0,!e.phoneValid||!e.passwordValid||!e.usernameValid)return;let s={user_phone:e.user_phone_prefix+e.user_phone,user_pass:e.user_pass,user_pass_confirm:e.user_pass,user_name:e.user_name,user_email:e.user_email,inviter_user_id:null!==(a=localStorage.inviter_user_id)&&void 0!==a?a:0};try{yield U.Z.signUp(s),e.phoneVerify(),localStorage.signInData=JSON.stringify({user_phone:e.user_phone_prefix+e.user_phone,user_pass:e.user_pass})}catch(n){var r,l;let a=null===n||void 0===n||null===(r=n.responseJSON)||void 0===r||null===(l=r.messages)||void 0===l?void 0:l.error;if("user_phone_unverified"==a)return void e.phoneVerify();a="unknown";try{const e=Object.keys(JSON.parse(n.responseJSON.messages.error))[0],s=Object.values(JSON.parse(n.responseJSON.messages.error))[0];a=e+"_"+s}catch(t){}switch(a){case"user_phone_notunique":e.$flash("Пользователь с таким телефоном уже зарегистрирован");break;case"user_phone_required":case"user_phone_invalid":case"user_phone_short":e.$flash("Проверьте номер телефона");break;case"user_name_required":case"user_name_short":e.$flash("Проверьте ваш псевдоним");break;case"user_email_invalid":e.$flash("Проверьте ваш е-маил");break;case"user_email_notunique":e.$flash("Такой е-маил уже используется");break;case"user_pass_required":e.$flash("Пароль обязателен для заполнения");break;case"user_pass_short":e.$flash("Пароль слишком короткий");break;case"user_pass_notmatches":e.$flash("Пароль не совпадает с подтверждением");break;default:e.$flash("Не удалось войти зарегистрироваться")}}}))()},passGenerate(){let e="";const a=4,s="abcdefghijklmnopqrstuvwxyz12345678901234567890";for(let r=0;r<a;r++){const a=Math.floor(Math.random()*s.length);e+=s[a]}return e},phoneFormat(){this.user_phone||(this.user_phone="");try{let e=this.user_phone.replace(/\D/g,"");e.length>10&&(e=e.substring(e.length-10)),this.user_phone=e}catch(e){}},phoneVerify(){var e=this;return(0,V.Z)((function*(){let a={user_phone:e.user_phone_prefix+e.user_phone};try{e.$router.replace({name:"UserVerifyPhone",params:a})}catch(s){e.$flash("Не удалось выслать смс с подтверждением")}}))()}}}),q=s(3744);const C=(0,q.Z)($,[["render",x]]);var S=C}}]);
//# sourceMappingURL=6620-legacy.70097858.js.map