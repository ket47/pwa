"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[457],{7327:function(e,i,t){t.d(i,{Z:function(){return m}});var o=t(6252),l=t(3577);const r=(0,o.Uk)("Просмотр фотографии");function a(e,i,t,a,n,d){const u=(0,o.up)("ion-title"),s=(0,o.up)("ion-icon"),c=(0,o.up)("ion-toolbar"),m=(0,o.up)("ion-header"),_=(0,o.up)("ion-button"),p=(0,o.up)("ion-col"),h=(0,o.up)("ion-row"),g=(0,o.up)("ion-grid"),f=(0,o.up)("ion-img"),k=(0,o.up)("ion-content");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(c,{color:"secondary"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(s,{icon:a.closeOutline,onClick:i[0]||(i[0]=e=>{a.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[t.actions?((0,o.wg)(),(0,o.j4)(g,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(h,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.actions,((e,i)=>((0,o.wg)(),(0,o.j4)(p,{key:i},{default:(0,o.w5)((()=>{var t;return[e[0]?((0,o.wg)(),(0,o.j4)(_,{key:0,onClick:t=>d.actionCreate(i,e[1]),expand:"block",color:null!==(t=e[1])&&void 0!==t?t:"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e[0]),1)])),_:2},1032,["onClick","color"])):(0,o.kq)("",!0)]})),_:2},1024)))),128))])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(f,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var n=t(8903),d=t(8292),u={props:["image_hash","actions"],components:{IonIcon:d.gu,IonToolbar:d.sr,IonHeader:d.Gu,IonImg:d.Xz,IonContent:d.W2,IonTitle:d.wd,IonButton:d.YG,IonCol:d.wI,IonRow:d.Nd,IonGrid:d.jY},setup(){const e=function(){d.Fy.dismiss()};return{closeModal:e,closeOutline:n.fID}},methods:{actionCreate(e,i){("danger"!=i||confirm("Вы уверены?"))&&d.Fy.dismiss(null,e)}}},s=t(3744);const c=(0,s.Z)(u,[["render",a]]);var m=c},2226:function(e,i,t){t.d(i,{Z:function(){return W}});var o=t(6252),l=t(3577);const r=(0,o.Uk)("Фотографии"),a={key:0,class:"image_grid"},n=["onClick"],d={key:0},u={key:1},s={key:0,class:"image_controls"},c=["id"];function m(e,i,t,m,_,p){var h;const g=(0,o.up)("ion-label"),f=(0,o.up)("ion-icon"),k=(0,o.up)("ion-item"),w=(0,o.up)("ion-img"),v=(0,o.up)("ion-avatar");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(k,{lines:"none",onClick:i[0]||(i[0]=e=>{_.editMode=!_.editMode,_.editMode&&p.load()})},{default:(0,o.w5)((()=>[t.title?((0,o.wg)(),(0,o.j4)(g,{key:0,color:"imageList?.length?'':medium"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(t.title),1)])),_:1})):((0,o.wg)(),(0,o.j4)(g,{key:1,color:"imageList?.length?'':medium"},{default:(0,o.w5)((()=>[r])),_:1})),_.editMode?((0,o.wg)(),(0,o.j4)(f,{key:2,slot:"end",icon:m.settingsSharp,color:"primary"},null,8,["icon"])):((0,o.wg)(),(0,o.j4)(f,{key:3,slot:"end",icon:m.settingsOutline},null,8,["icon"]))])),_:1}),null!==(h=p.imageList)&&void 0!==h&&h.length?((0,o.wg)(),(0,o.iD)("div",a,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(p.imageList,(i=>((0,o.wg)(),(0,o.iD)("div",{key:i.image_id,style:{position:"relative"}},[(0,o._)("div",{style:{position:"absolute",top:"0px","background-color":"#fffc","font-size":"0.75em"},onClick:e=>p.imagePreview(i.image_hash)},[i.deleted_at?((0,o.wg)(),(0,o.iD)("div",d,"будет удалено")):1==i.is_disabled?((0,o.wg)(),(0,o.iD)("div",u,"на модерации")):(0,o.kq)("",!0)],8,n),(0,o.Wm)(v,{onClick:e=>p.imagePreview(i.image_hash),class:(0,l.C_)(i.class)},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{src:e.$heap.state.hostname+"image/get.php/"+i.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),_.editMode?((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(f,{icon:m.chevronBackCircleOutline,onClick:e=>p.back(i)},null,8,["icon","onClick"]),p.isAdmin&&1==i.is_disabled?((0,o.wg)(),(0,o.j4)(f,{key:0,icon:m.checkmarkCircle,color:"success",onClick:e=>p.enable(i)},null,8,["icon","onClick"])):(0,o.kq)("",!0),i.deleted_at?((0,o.wg)(),(0,o.j4)(f,{key:1,icon:m.addCircle,color:"success",onClick:e=>p.restore(i)},null,8,["icon","onClick"])):((0,o.wg)(),(0,o.j4)(f,{key:2,icon:m.trash,color:"danger",onClick:e=>p.remove(i)},null,8,["icon","onClick"])),(0,o.Wm)(f,{icon:m.chevronForwardCircleOutline,onClick:e=>p.forward(i)},null,8,["icon","onClick"])])):(0,o.kq)("",!0)])))),128))])):(0,o.kq)("",!0),(0,o._)("input",{type:"file",id:_.fileUploaderId,accept:".png, .jpg, .jpeg, .webp, .gif",onChange:i[1]||(i[1]=e=>p.uploadImage(e)),style:{display:"none"}},null,40,c)])}var _=t(8534),p=t(8903),h=t(8292),g=t(7327),f=t(9755),k=t.n(f),w=t(9042),v=t(351),y={props:["images","image_holder","image_holder_id","controller","title"],components:{IonLabel:h.Q$,IonIcon:h.gu,IonItem:h.Ie,IonImg:h.Xz,IonAvatar:h.BJ},setup(){return{settingsOutline:p.C$N,settingsSharp:p.kiF,chevronBackCircleOutline:p.CK0,chevronForwardCircleOutline:p.esm,trash:p._Ij,addCircle:p.ZWo,checkmarkCircle:p.I1A}},data(){var e;return{images_loaded:null,editMode:!1,fileUploaderId:(null!==(e=this.image_holder)&&void 0!==e?e:this.controller)+this.image_holder_id}},computed:{imageList(){let e=this.images_loaded||this.images,i=[];for(let t in e)e[t].deleted_at?(e[t].class=" deleted",this.editMode&&i.push(e[t])):1==e[t].is_disabled?(e[t].class=" disabled",this.editMode&&i.push(e[t])):i.push(e[t]);return i},isAdmin(){return v.Z.isAdmin()}},methods:{back(e){var i=this;return(0,_.Z)((function*(){try{yield k().post(i.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),i.load()}catch(t){}}))()},forward(e){var i=this;return(0,_.Z)((function*(){try{yield k().post(i.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),i.load()}catch(t){}}))()},remove(e){var i=this;return(0,_.Z)((function*(){try{yield k().post(i.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),i.load(),i.$flash("Фото перемещено в корзину и будет удалено")}catch(t){}}))()},restore(e){var i=this;return(0,_.Z)((function*(){try{yield k().post(i.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),i.load(),i.$flash("Фото перемещено извлечено из корзины")}catch(t){}}))()},enable(e){var i=this;return(0,_.Z)((function*(){try{yield k().post(i.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),i.load()}catch(t){}}))()},load(){var e=this;return(0,_.Z)((function*(){var i;const t={image_holder_id:e.image_holder_id,image_holder:null!==(i=e.image_holder)&&void 0!==i?i:e.controller,is_disabled:1,is_deleted:1,is_active:1};e.images_loaded=yield k().post(e.$heap.state.hostname+"Image/listGet",t)}))()},imagePreview(e){return(0,_.Z)((function*(){const i=yield h.Fy.create({component:g.Z,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[.5,1]}),t=function(){i.dismiss()};return w.Z.on("dismissModal",t),i.present()}))()},uploadImage(e){var i=this;return(0,_.Z)((function*(){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",i.image_holder_id),i.image_holder&&t.set("image_holder",i.image_holder);const o={url:i.$heap.state.hostname+i.controller+"/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{yield k().ajax(o),i.load()}catch(d){var l,r,a,n;if("limit_exeeded"==(null===d||void 0===d||null===(l=d.responseJSON)||void 0===l||null===(r=l.messages)||void 0===r?void 0:r.error))return void i.$flash("Уже загружено максимальное количество фото");if("no_valid_images"==(null===d||void 0===d||null===(a=d.responseJSON)||void 0===a||null===(n=a.messages)||void 0===n?void 0:n.error))return void i.$flash("Формат файла не поддерживается");i.$flash("Не удалось загрузить фото")}}))()},take_photo(){k()(`#${this.fileUploaderId}`).trigger("click"),this.editMode=!0}}},C=t(3744);const I=(0,C.Z)(y,[["render",m],["__scopeId","data-v-5ec0cc30"]]);var W=I},457:function(e,i,t){t.r(i),t.d(i,{default:function(){return T}});var o=t(6252),l=t(3577);const r={key:0},a=(0,o.Uk)("Пока вы не курьер"),n=(0,o.Uk)(" Подавая заявку вы даете согласие на условия "),d=(0,o.Uk)("Оферта об оказании услуг доставки"),u=(0,o.Uk)("Стать курьером"),s={key:1},c=(0,o.Uk)(" Анкета активна. Вы можете открыть смену для приема заказов. "),m=(0,o.Uk)(" Удалено "),_=(0,o.Uk)(" На модерации "),p=(0,o.Uk)("Основные настройки"),h=(0,o.Uk)("Имя"),g=(0,o.Uk)("Транспорт"),f=(0,o.Uk)("ИНН"),k=(0,o.Uk)("Комментарий"),w=(0,o.Uk)("Ваше фото"),v=(0,o.Uk)(" Добавить "),y=(0,o.Uk)("Информация"),C=(0,o.Uk)("Правила пользования для курьера");function I(e,i,t,I,W,b){const U=(0,o.up)("ion-card-title"),Z=(0,o.up)("ion-card-header"),D=(0,o.up)("router-link"),$=(0,o.up)("ion-text"),O=(0,o.up)("ion-checkbox"),V=(0,o.up)("ion-item"),j=(0,o.up)("ion-button"),x=(0,o.up)("ion-card-content"),q=(0,o.up)("ion-card"),T=(0,o.up)("ion-icon"),M=(0,o.up)("ion-toggle"),G=(0,o.up)("ion-label"),z=(0,o.up)("ion-item-divider"),A=(0,o.up)("ion-input"),F=(0,o.up)("ion-textarea"),L=(0,o.up)("ion-list"),P=(0,o.up)("image-tile-comp"),S=(0,o.up)("base-layout");return(0,o.wg)(),(0,o.j4)(S,{"page-title":"Анкета курьера",pageDefaultBackLink:"/user"},{default:(0,o.w5)((()=>[W.courier?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",r,[(0,o.Wm)(q,{color:"light"},{default:(0,o.w5)((()=>[(0,o.Wm)(Z,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[a])),_:1})])),_:1}),(0,o.Wm)(x,null,{default:(0,o.w5)((()=>[(0,o.Wm)(V,{lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)($,null,{default:(0,o.w5)((()=>[n,(0,o.Wm)(D,{to:"/page/rules-courier"},{default:(0,o.w5)((()=>[d])),_:1})])),_:1}),(0,o.Wm)(O,{slot:"end",modelValue:W.contractAccepted,"onUpdate:modelValue":i[0]||(i[0]=e=>W.contractAccepted=e)},null,8,["modelValue"])])),_:1}),(0,o.Wm)(j,{expand:"block",onClick:i[1]||(i[1]=e=>b.itemCreate()),disabled:!W.contractAccepted},{default:(0,o.w5)((()=>[u])),_:1},8,["disabled"])])),_:1})])),_:1})])),W.courier?((0,o.wg)(),(0,o.iD)("div",s,[b.message?((0,o.wg)(),(0,o.j4)(q,{key:0,lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{class:(0,l.C_)(b.messageClass)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(b.message),1)])),_:1},8,["class"])])),_:1})):((0,o.wg)(),(0,o.j4)(q,{key:1,lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)(x,{style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,o.w5)((()=>[c])),_:1})])),_:1})),(0,o._)("form",{onChange:i[10]||(i[10]=e=>b.updateCourier())},[(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o.Wm)(V,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,{src:I.trashOutline,color:"primary",slot:"start"},null,8,["src"]),m,(0,o.Wm)(M,{slot:"end",modelValue:W.is_deleted,"onUpdate:modelValue":i[2]||(i[2]=e=>W.is_deleted=e),color:"danger",onIonChange:i[3]||(i[3]=e=>b.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,o.Wm)(V,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,{src:I.searchOutline,color:"primary",slot:"start"},null,8,["src"]),_,(0,o.Wm)(M,{slot:"end",modelValue:W.is_disabled,"onUpdate:modelValue":i[4]||(i[4]=e=>W.is_disabled=e),onIonChange:i[5]||(i[5]=e=>b.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,o.Wm)(z,null,{default:(0,o.w5)((()=>[(0,o.Wm)(G,null,{default:(0,o.w5)((()=>[p])),_:1})])),_:1}),(0,o.Wm)(V,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(G,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[h])),_:1}),(0,o.Wm)(A,{modelValue:W.courier.courier_name,"onUpdate:modelValue":i[6]||(i[6]=e=>W.courier.courier_name=e),placeholder:"Имя курьера"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(V,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(G,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[g])),_:1}),(0,o.Wm)(A,{modelValue:W.courier.courier_vehicle,"onUpdate:modelValue":i[7]||(i[7]=e=>W.courier.courier_vehicle=e),placeholder:"автомобиль, мопед, велосипед"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(V,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(G,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[f])),_:1}),(0,o.Wm)(A,{modelValue:W.courier.courier_tax_num,"onUpdate:modelValue":i[8]||(i[8]=e=>W.courier.courier_tax_num=e),placeholder:"ИНН курьера"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(V,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(G,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[k])),_:1}),(0,o.Wm)(F,{modelValue:W.courier.courier_comment,"onUpdate:modelValue":i[9]||(i[9]=e=>W.courier.courier_comment=e),placeholder:"Цвет, номер авто"},null,8,["modelValue"])])),_:1})])),_:1})],32),W.courier?((0,o.wg)(),(0,o.j4)(L,{key:2},{default:(0,o.w5)((()=>[(0,o.Wm)(z,null,{default:(0,o.w5)((()=>[(0,o.Wm)(G,null,{default:(0,o.w5)((()=>[w])),_:1})])),_:1}),(0,o.Wm)(P,{images:W.courier.images,image_holder_id:W.courier.courier_id,controller:"Courier",ref:"courierImgs"},null,8,["images","image_holder_id"]),(0,o.Wm)(j,{onClick:i[11]||(i[11]=i=>e.$refs.courierImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,o.w5)((()=>[(0,o.Wm)(T,{src:I.cameraOutline},null,8,["src"]),v])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o.Wm)(z,null,{default:(0,o.w5)((()=>[(0,o.Wm)(G,null,{default:(0,o.w5)((()=>[y])),_:1})])),_:1}),(0,o.Wm)(V,{lines:"none",button:"",detail:"",onClick:i[12]||(i[12]=i=>e.$router.push("/page/rules-courier"))},{default:(0,o.w5)((()=>[(0,o.Wm)(T,{src:I.documentTextOutline,slot:"start"},null,8,["src"]),(0,o.Wm)(D,{to:"/page/rules-courier"},{default:(0,o.w5)((()=>[C])),_:1})])),_:1})])),_:1})])):(0,o.kq)("",!0)])),_:1})}var W=t(8534),b=(t(8862),t(8292)),U=t(8903),Z=t(9755),D=t.n(Z),$=t(2008),O=t(351),V=t(2226),j={components:{imageTileComp:V.Z,IonTextarea:b.g2,IonInput:b.pK,IonCard:b.PM,IonCardHeader:b.Zi,IonCardTitle:b.Dq,IonCardContent:b.FN,IonLabel:b.Q$,IonItem:b.Ie,IonButton:b.YG,IonList:b.q_,IonCheckbox:b.nz,IonText:b.yW,IonItemDivider:b.rH,IonToggle:b.ho,IonIcon:b.gu},setup(){return{cameraOutline:U.kuq,trashOutline:U.gtu,searchOutline:U.W6I,documentTextOutline:U.L82}},data(){var e,i;return{other_courier_id:null===(e=this.$route)||void 0===e||null===(i=e.query)||void 0===i?void 0:i.courier_id,courier:null,isAdmin:O.Z.isAdmin(),contractAccepted:0,is_deleted:0,is_disabled:0}},ionViewDidEnter(){var e,i,t,o;this.other_courier_id!=(null===(e=this.$route)||void 0===e||null===(i=e.query)||void 0===i?void 0:i.courier_id)&&(this.other_courier_id=null===(t=this.$route)||void 0===t||null===(o=t.query)||void 0===o?void 0:o.courier_id,this.itemGet())},mounted(){this.itemGet()},computed:{message(){return this.courier.deleted_at?"Анкета не активна и будет удалена. Вы можете еще отменить удаление":1==this.courier.is_disabled?"Анкета не активна и находится на рассмотрении у администратора":null},messageClass(){return this.courier.deleted_at?"deleted":1==this.courier.is_disabled?"disabled":null},imageClass(){var e,i;return 1==(null===(e=this.courier)||void 0===e||null===(i=e.images[0])||void 0===i?void 0:i.is_disabled)?"image_disabled":""}},methods:{itemGet(){var e=this;return(0,W.Z)((function*(){e.other_courier_id?e.courier=yield D().post($.Z.state.hostname+"Courier/itemGet",{courier_id:e.other_courier_id}):e.courier=yield O.Z.courier.get(),e.itemParseFlags()}))()},itemParseFlags(){this.courier&&(this.is_deleted=null==this.courier.deleted_at?0:1,this.is_disabled=0==this.courier.is_disabled?0:1)},itemCreate(){var e=this;return(0,W.Z)((function*(){try{yield D().post($.Z.state.hostname+"Courier/itemCreate"),yield O.Z.get("full"),e.courier=O.Z.courier.data}catch(i){e.$flash("Не удалось зарегистрироваться как курьер")}}))()},itemDelete(e){var i=this;return(0,W.Z)((function*(){const t=e?"itemDelete":"itemUnDelete";try{yield D().post($.Z.state.hostname+"Courier/"+t,{courier_id:i.courier.courier_id}),i.courier.deleted_at=e?1:null}catch(o){i.itemGet()}}))()},itemDisable(e){var i=this;return(0,W.Z)((function*(){if(i.courier.is_disabled!=e)try{yield D().post($.Z.state.hostname+"Courier/itemDisable",{courier_id:i.courier.courier_id,is_disabled:e}),i.courier.is_disabled=e}catch(t){i.itemGet()}}))()},uploadImage(e){var i=this;return(0,W.Z)((function*(){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",i.courier.courier_id);const o={url:$.Z.state.hostname+"Courier/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{yield D().ajax(o),i.itemGet()}catch(l){i.$flash("Не удалось загрузить фото")}}))()},uploadImageTrigger(){D()("#courier_foto_upload").trigger("click")},updateCourier(){var e=this;return(0,W.Z)((function*(){try{return yield D().post($.Z.state.hostname+"Courier/itemUpdate",JSON.stringify(e.courier))}catch(o){var i,t;const l=JSON.parse(null===(i=o.responseJSON)||void 0===i||null===(t=i.messages)||void 0===t?void 0:t.error);l.courier_tax_num&&e.$flash("Неверный формат ИНН")}}))()}}},x=t(3744);const q=(0,x.Z)(j,[["render",I],["__scopeId","data-v-67875374"]]);var T=q}}]);
//# sourceMappingURL=457-legacy.bf47b192.js.map