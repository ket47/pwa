"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[139],{139:function(e,t,i){i.r(t),i.d(t,{default:function(){return w}});var l=i(6252),r=i(3577);const o={key:0},a={key:1};function u(e,t,i,u,d,s){const n=(0,l.up)("ion-card-title"),c=(0,l.up)("ion-card-header"),m=(0,l.up)("router-link"),_=(0,l.up)("ion-text"),h=(0,l.up)("ion-checkbox"),p=(0,l.up)("ion-item"),f=(0,l.up)("ion-button"),g=(0,l.up)("ion-card-content"),w=(0,l.up)("ion-card"),k=(0,l.up)("ion-icon"),W=(0,l.up)("ion-toggle"),y=(0,l.up)("ion-label"),C=(0,l.up)("ion-item-divider"),v=(0,l.up)("ion-input"),b=(0,l.up)("ion-textarea"),I=(0,l.up)("ion-list"),U=(0,l.up)("image-tile-comp"),V=(0,l.up)("base-layout");return(0,l.wg)(),(0,l.j4)(V,{"page-title":"Анкета курьера",pageDefaultBackLink:"/user"},{default:(0,l.w5)((()=>[d.courier?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",o,[(0,l.Wm)(w,{color:"light"},{default:(0,l.w5)((()=>[(0,l.Wm)(c,null,{default:(0,l.w5)((()=>[(0,l.Wm)(n,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Пока вы не курьер")])),_:1})])),_:1}),(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,{lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Подавая заявку вы даете согласие на условия "),(0,l.Wm)(m,{to:"/page/rules-courier"},{default:(0,l.w5)((()=>[(0,l.Uk)("Оферта об оказании услуг доставки")])),_:1})])),_:1}),(0,l.Wm)(h,{slot:"end",modelValue:d.contractAccepted,"onUpdate:modelValue":t[0]||(t[0]=e=>d.contractAccepted=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(f,{expand:"block",onClick:t[1]||(t[1]=e=>s.itemCreate()),disabled:!d.contractAccepted},{default:(0,l.w5)((()=>[(0,l.Uk)("Стать курьером")])),_:1},8,["disabled"])])),_:1})])),_:1})])),d.courier?((0,l.wg)(),(0,l.iD)("div",a,[s.message?((0,l.wg)(),(0,l.j4)(w,{key:0,lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{class:(0,r.C_)(s.messageClass)},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(s.message),1)])),_:1},8,["class"])])),_:1})):((0,l.wg)(),(0,l.j4)(w,{key:1,lines:"none"},{default:(0,l.w5)((()=>[(0,l.Wm)(g,{style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,l.w5)((()=>[(0,l.Uk)(" Анкета активна. Вы можете открыть смену для приема заказов. ")])),_:1})])),_:1})),(0,l._)("form",{onChange:t[10]||(t[10]=e=>s.updateCourier())},[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:u.trashOutline,color:"primary",slot:"start"},null,8,["src"]),(0,l.Uk)(" Удалено "),(0,l.Wm)(W,{slot:"end",modelValue:d.is_deleted,"onUpdate:modelValue":t[2]||(t[2]=e=>d.is_deleted=e),color:"danger",onIonChange:t[3]||(t[3]=e=>s.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:u.searchOutline,color:"primary",slot:"start"},null,8,["src"]),(0,l.Uk)(" На модерации "),(0,l.Wm)(W,{slot:"end",modelValue:d.is_disabled,"onUpdate:modelValue":t[4]||(t[4]=e=>d.is_disabled=e),onIonChange:t[5]||(t[5]=e=>s.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Основные настройки")])),_:1})])),_:1}),(0,l.Wm)(p,{lines:"full"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("Имя")])),_:1}),(0,l.Wm)(v,{modelValue:d.courier.courier_name,"onUpdate:modelValue":t[6]||(t[6]=e=>d.courier.courier_name=e),placeholder:"Имя курьера"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{lines:"full"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("Транспорт")])),_:1}),(0,l.Wm)(v,{modelValue:d.courier.courier_vehicle,"onUpdate:modelValue":t[7]||(t[7]=e=>d.courier.courier_vehicle=e),placeholder:"автомобиль, мопед, велосипед"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{lines:"full"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("ИНН")])),_:1}),(0,l.Wm)(v,{modelValue:d.courier.courier_tax_num,"onUpdate:modelValue":t[8]||(t[8]=e=>d.courier.courier_tax_num=e),placeholder:"ИНН курьера"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(p,{lines:"full"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("Комментарий")])),_:1}),(0,l.Wm)(b,{modelValue:d.courier.courier_comment,"onUpdate:modelValue":t[9]||(t[9]=e=>d.courier.courier_comment=e),placeholder:"Цвет, номер авто"},null,8,["modelValue"])])),_:1})])),_:1})],32),d.courier?((0,l.wg)(),(0,l.j4)(I,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Ваше фото")])),_:1})])),_:1}),(0,l.Wm)(U,{images:d.courier.images,image_holder_id:d.courier.courier_id,controller:"Courier",ref:"courierImgs"},null,8,["images","image_holder_id"]),(0,l.Wm)(f,{onClick:t[11]||(t[11]=t=>e.$refs.courierImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:u.cameraOutline},null,8,["src"]),(0,l.Uk)(" Добавить ")])),_:1})])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Информация")])),_:1})])),_:1}),(0,l.Wm)(p,{lines:"none",button:"",detail:"",onClick:t[12]||(t[12]=t=>e.$go("/page/rules-courier"))},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:u.documentTextOutline,slot:"start"},null,8,["src"]),(0,l.Wm)(m,{to:"/page/rules-courier"},{default:(0,l.w5)((()=>[(0,l.Uk)("Правила пользования для курьера")])),_:1})])),_:1})])),_:1})])):(0,l.kq)("",!0)])),_:1})}i(8862);var d=i(4929),s=i(8903),n=i(9755),c=i.n(n),m=i(2008),_=i(351),h=i(2639),p={components:{imageTileComp:h.Z,IonTextarea:d.g2,IonInput:d.pK,IonCard:d.PM,IonCardHeader:d.Zi,IonCardTitle:d.Dq,IonCardContent:d.FN,IonLabel:d.Q$,IonItem:d.Ie,IonButton:d.YG,IonList:d.q_,IonCheckbox:d.nz,IonText:d.yW,IonItemDivider:d.rH,IonToggle:d.ho,IonIcon:d.gu},setup(){return{cameraOutline:s.kuq,trashOutline:s.gtu,searchOutline:s.W6I,documentTextOutline:s.L82}},data(){var e,t;return{other_courier_id:null===(e=this.$route)||void 0===e||null===(t=e.query)||void 0===t?void 0:t.courier_id,courier:null,isAdmin:_.Z.isAdmin(),contractAccepted:0,is_deleted:0,is_disabled:0}},ionViewDidEnter(){var e,t,i,l;this.other_courier_id!=(null===(e=this.$route)||void 0===e||null===(t=e.query)||void 0===t?void 0:t.courier_id)&&(this.other_courier_id=null===(i=this.$route)||void 0===i||null===(l=i.query)||void 0===l?void 0:l.courier_id,this.itemGet())},mounted(){this.itemGet()},computed:{message(){return this.courier.deleted_at?"Анкета не активна и будет удалена. Вы можете еще отменить удаление":1==this.courier.is_disabled?"Анкета не активна и находится на рассмотрении у администратора":null},messageClass(){return this.courier.deleted_at?"deleted":1==this.courier.is_disabled?"disabled":null},imageClass(){var e,t;return 1==(null===(e=this.courier)||void 0===e||null===(t=e.images[0])||void 0===t?void 0:t.is_disabled)?"image_disabled":""}},methods:{async itemGet(){this.other_courier_id?this.courier=await c().post(m.Z.state.hostname+"Courier/itemGet",{courier_id:this.other_courier_id}):this.courier=await _.Z.courier.get(),this.itemParseFlags()},itemParseFlags(){this.courier&&(this.is_deleted=null==this.courier.deleted_at?0:1,this.is_disabled=0==this.courier.is_disabled?0:1)},async itemCreate(){try{await c().post(m.Z.state.hostname+"Courier/itemCreate"),await _.Z.get("full"),this.courier=_.Z.courier.data}catch(e){this.$flash("Не удалось зарегистрироваться как курьер")}},async itemDelete(e){const t=e?"itemDelete":"itemUnDelete";try{await c().post(m.Z.state.hostname+"Courier/"+t,{courier_id:this.courier.courier_id}),this.courier.deleted_at=e?1:null}catch(i){this.itemGet()}},async itemDisable(e){if(this.courier.is_disabled!=e)try{await c().post(m.Z.state.hostname+"Courier/itemDisable",{courier_id:this.courier.courier_id,is_disabled:e}),this.courier.is_disabled=e}catch(t){this.itemGet()}},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.courier.courier_id);const i={url:m.Z.state.hostname+"Courier/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await c().ajax(i),this.itemGet()}catch(l){this.$flash("Не удалось загрузить фото")}},uploadImageTrigger(){c()("#courier_foto_upload").trigger("click")},async updateCourier(){try{return await c().post(m.Z.state.hostname+"Courier/itemUpdate",JSON.stringify(this.courier))}catch(i){var e,t;const l=JSON.parse(null===(e=i.responseJSON)||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.error);l.courier_tax_num&&this.$flash("Неверный формат ИНН")}}}},f=i(3744);const g=(0,f.Z)(p,[["render",u],["__scopeId","data-v-7ccc5a29"]]);var w=g}}]);
//# sourceMappingURL=139.296dfad1.js.map