"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[2957],{4535:function(e,t,n){n.d(t,{Z:function(){return x}});var u=n(6252),r=n(3577),l=(0,u.Uk)("Баланс"),a=(0,u.Uk)("Настройки"),o=(0,u.Uk)("Начальная дата"),i={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},c=(0,u.Uk)("Обороты"),d={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},s=(0,u.Uk)("Конечная дата"),f={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},m=(0,u.Uk)(" Нет операций в данном периоде ");function p(e,t,n,p,g,w){var _=(0,u.up)("ion-title"),h=(0,u.up)("ion-text"),k=(0,u.up)("ion-item"),y=(0,u.up)("ion-list"),W=(0,u.up)("ion-icon"),v=(0,u.up)("ion-input"),I=(0,u.up)("ion-accordion"),b=(0,u.up)("ion-accordion-group"),$=(0,u.up)("ion-searchbar"),x=(0,u.up)("ion-skeleton-text"),U=(0,u.up)("ion-label");return(0,u.wg)(),(0,u.iD)("div",null,[(0,u.Wm)(y,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(k,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(_,null,{default:(0,u.w5)((function(){return[l]})),_:1}),g.balance>0?((0,u.wg)(),(0,u.j4)(h,{key:0,slot:"end",color:"success"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(g.balance)+(0,r.zw)(e.$heap.state.currencySign),1)]})),_:1})):((0,u.wg)(),(0,u.j4)(h,{key:1,slot:"end"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(g.balance)+(0,r.zw)(e.$heap.state.currencySign),1)]})),_:1}))]})),_:1})]})),_:1}),(0,u.Wm)(b,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(I,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(k,{slot:"header"},{default:(0,u.w5)((function(){return[(0,u.Wm)(W,{icon:p.settingsOutline,slot:"start"},null,8,["icon"]),(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[a]})),_:1})]})),_:1}),(0,u.Wm)(y,{slot:"content"},{default:(0,u.w5)((function(){return[(0,u.Wm)(k,{color:"light"},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[o]})),_:1}),(0,u._)("div",i,[(0,u.Wm)(v,{type:"date",modelValue:g.start_at,"onUpdate:modelValue":t[0]||(t[0]=function(e){return g.start_at=e}),onIonChange:t[1]||(t[1]=function(e){return w.listGet()})},null,8,["modelValue"]),g.meta.sum_start?((0,u.wg)(),(0,u.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${g.meta.sum_start}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0)])]})),_:1}),(0,u.Wm)(k,{color:"light"},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[c]})),_:1}),(0,u._)("div",d,[g.meta.sum_debit?((0,u.wg)(),(0,u.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`+${g.meta.sum_debit}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0),g.meta.sum_credit?((0,u.wg)(),(0,u.j4)(v,{key:1,type:"text",style:{"text-align":"right"},color:"medium",value:`-${g.meta.sum_credit}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0)])]})),_:1}),(0,u.Wm)(k,{color:"light"},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[s]})),_:1}),(0,u._)("div",f,[(0,u.Wm)(v,{type:"date",modelValue:g.finish_at,"onUpdate:modelValue":t[2]||(t[2]=function(e){return g.finish_at=e})},null,8,["modelValue"]),g.meta.sum_finish?((0,u.wg)(),(0,u.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${g.meta.sum_finish}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0)])]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,u.Wm)($,{modelValue:g.q,"onUpdate:modelValue":t[3]||(t[3]=function(e){return g.q=e}),placeholder:"Поиск по сумме или описанию",onIonChange:t[4]||(t[4]=function(e){return w.listGet()})},null,8,["modelValue"]),null==g.ledger?((0,u.wg)(),(0,u.j4)(y,{key:0},{default:(0,u.w5)((function(){return[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)([1,2,3],(function(e){return(0,u.Wm)(k,{key:e},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,{slot:"start"},{default:(0,u.w5)((function(){return[(0,u.Wm)(x,{animated:"",style:{width:"50px"}})]})),_:1}),(0,u.Wm)(U,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(x,{animated:"",style:{width:"100%"}})]})),_:1}),(0,u.Wm)(U,{slot:"end",color:"success"},{default:(0,u.w5)((function(){return[(0,u.Wm)(x,{animated:"",style:{width:"50px"}})]})),_:1})]})),_:2},1024)})),64))]})),_:1})):g.ledger.length>0?((0,u.wg)(),(0,u.j4)(y,{key:1},{default:(0,u.w5)((function(){return[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(w.ledgerCalc,(function(e){return(0,u.wg)(),(0,u.j4)(k,{key:e.trans_id,onClick:function(t){return w.itemClick(e.trans_id)},detail:w.is_admin},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,{slot:"start"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(e.date),1)]})),_:2},1024),(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(e.trans_description),1)]})),_:2},1024),1==e.is_debit?((0,u.wg)(),(0,u.j4)(U,{key:0,slot:"end",color:"success"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(e.trans_amount),1)]})),_:2},1024)):((0,u.wg)(),(0,u.j4)(U,{key:1,slot:"end",color:"danger"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(e.trans_amount),1)]})),_:2},1024))]})),_:2},1032,["onClick","detail"])})),128))]})),_:1})):((0,u.wg)(),(0,u.j4)(y,{key:2},{default:(0,u.w5)((function(){return[(0,u.Wm)(k,null,{default:(0,u.w5)((function(){return[m]})),_:1})]})),_:1}))])}var g=n(6835),w=n(8534),_=n(8439),h=(n(7042),n(2066)),k=n(8903),y=n(9755),W=n.n(y),v=n(351),I={components:{IonIcon:h.gu,IonTitle:h.wd,IonLabel:h.Q$,IonItem:h.Ie,IonInput:h.pK,IonList:h.q_,IonAccordion:h.We,IonAccordionGroup:h.eh,IonText:h.yW,IonSkeletonText:h.CK,IonSearchbar:h.VI},props:["account"],setup(){return{settingsOutline:k.C$N}},data(){var e=new Date,t=new Date(Date.parse(`${e.getFullYear()}-${e.getMonth()+1}-1`));return{balance:"-",start_at:t.toISOString().slice(0,10),finish_at:e.toISOString().slice(0,10),q:"",ledger:null,meta:{},today:e}},computed:{ledgerCalc(){if(null==this.ledger)return null;var e,t=[],n=(0,_.Z)(this.ledger);try{for(n.s();!(e=n.n()).done;){var u=e.value;u.date=this.toLocDate(u.trans_date),t.push(u)}}catch(r){n.e(r)}finally{n.f()}return t},is_admin(){return v.Z.isAdmin()}},watch:{account:function(){this.listGet()}},methods:{listGet(){var e=this;return(0,w.Z)((0,g.Z)().mark((function t(){var n,u,r,l;return(0,g.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,n={start_at:e.start_at,finish_at:e.finish_at,account:e.account,q:e.q},t.next=4,W().post(`${e.$heap.state.hostname}Transaction/listGet`,n);case 4:u=t.sent,e.ledger=u.ledger,e.meta=u.meta,e.finish_at==e.today.toISOString().slice(0,10)&&(e.balance=u.meta.sum_finish),t.next=24;break;case 10:t.prev=10,t.t0=t["catch"](0),r=t.t0.responseJSON,l=r.messages.error,t.t1=l,t.next="no_account"===t.t1?17:"large_interval"===t.t1?19:21;break;case 17:return e.$flash("Ошибка получения выписки"),t.abrupt("break",21);case 19:return e.$flash("Период должен быть не больше 3 месяцев"),t.abrupt("break",21);case 21:return e.ledger=[],e.balance=0,t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t,null,[[0,10]])})))()},toLocDate(e){var t=new Date(Date.parse(e)),n={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,n)},itemClick(e){v.Z.isAdmin()&&this.$router.push(`/admin/transaction-edit-${e}`)}},mounted(){this.listGet()}},b=n(3744);const $=(0,b.Z)(I,[["render",p]]);var x=$},2957:function(e,t,n){n.r(t),n.d(t,{default:function(){return k}});var u=n(6252),r=(0,u.Uk)(" Проводки "),l={key:0},a=(0,u.Uk)("Выписка по счету"),o=(0,u.Uk)("Счет"),i=(0,u.Uk)("Прибыль"),c=(0,u.Uk)("Продавцы"),d=(0,u.Uk)("Курьеры"),s=(0,u.Uk)("Добавить проводку");function f(e,t,n,f,m,p){var g=(0,u.up)("ion-segment-button"),w=(0,u.up)("ion-segment"),_=(0,u.up)("ion-card-title"),h=(0,u.up)("ion-card-header"),k=(0,u.up)("ion-label"),y=(0,u.up)("ion-select-option"),W=(0,u.up)("ion-select"),v=(0,u.up)("ion-item"),I=(0,u.up)("ion-icon"),b=(0,u.up)("ion-list"),$=(0,u.up)("ion-card-content"),x=(0,u.up)("ion-card"),U=(0,u.up)("ledger-comp"),C=(0,u.up)("base-layout");return(0,u.wg)(),(0,u.j4)(C,{pageDefaultBackLink:"/user","page-title":"Бухгалтерия"},{default:(0,u.w5)((function(){return[(0,u.Wm)(w,{"swipe-gesture":"true",modelValue:m.activeTab,"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.activeTab=e}),onIonChange:t[1]||(t[1]=function(t){return e.listTypeChanged(t)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(g,{value:"ledger"},{default:(0,u.w5)((function(){return[r]})),_:1})]})),_:1},8,["modelValue"]),"ledger"==m.activeTab?((0,u.wg)(),(0,u.iD)("div",l,[(0,u.Wm)(x,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(_,null,{default:(0,u.w5)((function(){return[a]})),_:1})]})),_:1}),(0,u.Wm)($,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(b,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(v,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(k,null,{default:(0,u.w5)((function(){return[o]})),_:1}),(0,u.Wm)(W,{modelValue:m.ledgerAccount,"onUpdate:modelValue":t[2]||(t[2]=function(e){return m.ledgerAccount=e})},{default:(0,u.w5)((function(){return[(0,u.Wm)(y,{value:"profit"},{default:(0,u.w5)((function(){return[i]})),_:1}),(0,u.Wm)(y,{value:"supplier"},{default:(0,u.w5)((function(){return[c]})),_:1}),(0,u.Wm)(y,{value:"courier"},{default:(0,u.w5)((function(){return[d]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,u.Wm)(v,{button:"",detail:"",onClick:t[3]||(t[3]=function(e){return p.itemCreate()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(I,{slot:"start",src:f.addOutline},null,8,["src"]),(0,u.Wm)(k,null,{default:(0,u.w5)((function(){return[s]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,u.Wm)(U,{account:m.ledgerAccount,holder:m.ledgerHolder,holderId:m.ledgerHolderId},null,8,["account","holder","holderId"])])):(0,u.kq)("",!0)]})),_:1})}var m=n(2066),p=n(8903),g=(n(9755),n(4535)),w={components:{LedgerComp:g.Z,IonSegmentButton:m.GO,IonSegment:m.cJ,IonSelect:m.t9,IonSelectOption:m.n0,IonList:m.q_,IonItem:m.Ie,IonLabel:m.Q$,IonCard:m.PM,IonCardHeader:m.Zi,IonCardTitle:m.Dq,IonCardContent:m.FN,IonIcon:m.gu},setup(){return{addOutline:p.s6O}},data(){return{activeTab:"ledger",ledgerAccount:"supplier",ledgerHolder:null,ledgerHolderId:null}},computed:{},methods:{itemCreate(){this.$router.push("/admin/transaction-edit-0")}}},_=n(3744);const h=(0,_.Z)(w,[["render",f],["__scopeId","data-v-5e95aff8"]]);var k=h}}]);
//# sourceMappingURL=2957-legacy.f2b22e5f.js.map