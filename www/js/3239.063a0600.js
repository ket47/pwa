"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[3239],{3239:function(e,t,o){o.r(t),o.d(t,{default:function(){return O}});var s=o(641),l=o(33),r=o(3751);const i={key:0},a=["href"],n=["href"],_={key:0},d=["innerHTML"],u=["href"],m={key:0};function c(e,t,o,c,p,h){var f;const k=(0,s.g2)("ion-label"),b=(0,s.g2)("ion-progress-bar"),I=(0,s.g2)("ion-card-header"),g=(0,s.g2)("ion-text"),v=(0,s.g2)("ion-card-content"),y=(0,s.g2)("ion-card"),F=(0,s.g2)("ion-icon"),w=(0,s.g2)("ion-toggle"),C=(0,s.g2)("ion-item"),V=(0,s.g2)("ion-item-divider"),W=(0,s.g2)("router-link"),G=(0,s.g2)("ion-list"),O=(0,s.g2)("ion-button"),A=(0,s.g2)("ion-input"),$=(0,s.g2)("ion-textarea"),S=(0,s.g2)("ion-item-group"),L=(0,s.g2)("ion-note"),x=(0,s.g2)("ion-img"),X=(0,s.g2)("ion-avatar"),U=(0,s.g2)("ion-checkbox"),D=(0,s.g2)("image-tile-comp"),T=(0,s.g2)("base-layout");return(0,s.uX)(),(0,s.Wv)(T,{"page-title":(null===(f=this.storeItem)||void 0===f?void 0:f.store_name)??"Мой магазин",pageDefaultBackLink:`/catalog/store-${p.storeId}`},{default:(0,s.k6)(()=>{var o,f;return[p.storeItem?((0,s.uX)(),(0,s.CE)("div",i,[(0,s.bF)(y,{color:p.validity_perc<p.validity_min?"danger":""},{default:(0,s.k6)(()=>[(0,s.bF)(I,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>[(0,s.eW)("Анкета заполнена на "+(0,l.v_)(p.validity_perc)+"%",1)]),_:1}),(0,s.bF)(b,{value:p.validity},null,8,["value"])]),_:1}),p.validity_perc<p.validity_min?((0,s.uX)(),(0,s.Wv)(v,{key:0},{default:(0,s.k6)(()=>[(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.eW)(" Вам необходимо заполнить анкету не меньше чем на "+(0,l.v_)(p.validity_min)+"% для рассмотрения модератором ",1)]),_:1})]),_:1})):(0,s.Q3)("",!0)]),_:1},8,["color"]),h.message&&p.validity_perc>p.validity_min?((0,s.uX)(),(0,s.Wv)(y,{key:0},{default:(0,s.k6)(()=>[(0,s.bF)(v,{class:(0,l.C4)(h.messageClass)},{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(h.message),1)]),_:1},8,["class"])]),_:1})):(0,s.Q3)("",!0),p.storeItem?((0,s.uX)(),(0,s.Wv)(G,{key:1},{default:(0,s.k6)(()=>[(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.checkmarkCircleOutline,color:"primary",slot:"start"},null,8,["src"]),t[62]||(t[62]=(0,s.eW)(" Готово к заказам ")),(0,s.bF)(w,{slot:"end",modelValue:p.is_working,"onUpdate:modelValue":t[0]||(t[0]=e=>p.is_working=e),onIonChange:t[1]||(t[1]=e=>h.save("is_working",e.target.checked?1:0))},null,8,["modelValue"])]),_:1,__:[62]}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.trashOutline,color:"primary",slot:"start"},null,8,["src"]),t[63]||(t[63]=(0,s.eW)(" Удалено ")),(0,s.bF)(w,{slot:"end",modelValue:p.is_deleted,"onUpdate:modelValue":t[2]||(t[2]=e=>p.is_deleted=e),color:"danger",onIonChange:t[3]||(t[3]=e=>h.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])]),_:1,__:[63]}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.ribbonOutline,color:"primary",slot:"start"},null,8,["src"]),t[64]||(t[64]=(0,s.eW)(" На модерации ")),(0,s.bF)(w,{slot:"end",modelValue:p.is_disabled,"onUpdate:modelValue":t[4]||(t[4]=e=>p.is_disabled=e),onIonChange:t[5]||(t[5]=e=>h.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])]),_:1,__:[64]}),(0,s.bF)(V),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.chevronBack,slot:"start",color:"medium"},null,8,["src"]),(0,s.bF)(W,{to:`/catalog/store-${p.storeId}`},{default:(0,s.k6)(()=>[(0,s.eW)("Показать "+(0,l.v_)(p.storeItem.store_name),1)]),_:1},8,["to"]),(0,s.bF)(k,{slot:"end"},{default:(0,s.k6)(()=>[(0,s.Lk)("a",{href:` ${e.$heap.state.hostname}Store/qrGet?store_id=${p.storeId}&type=store`,target:"_blank"},[(0,s.bF)(F,{src:c.qrCode,color:"primary"},null,8,["src"])],8,a)]),_:1})]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.chevronBack,slot:"start",color:"medium"},null,8,["src"]),(0,s.bF)(W,{to:`/catalog/store-${p.storeId}/menu`},{default:(0,s.k6)(()=>t[65]||(t[65]=[(0,s.eW)("Электронное меню")])),_:1,__:[65]},8,["to"]),(0,s.bF)(k,{slot:"end"},{default:(0,s.k6)(()=>[(0,s.Lk)("a",{href:` ${e.$heap.state.hostname}Store/qrGet?store_id=${p.storeId}&type=menu`,target:"_blank"},[(0,s.bF)(F,{src:c.qrCode,color:"primary"},null,8,["src"])],8,n)]),_:1})]),_:1}),(0,s.bF)(C,{onClick:t[6]||(t[6]=t=>e.$go(`/user/supplier-statistics-${p.storeId}`))},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.pieChartOutline,slot:"start",color:"medium"},null,8,["src"]),t[66]||(t[66]=(0,s.eW)(" Аналитика продаж "))]),_:1,__:[66]}),(0,s.bF)(C,{onClick:t[7]||(t[7]=t=>e.$go(`/catalog/store-edit-products-${p.storeId}`))},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.listOutline,slot:"start",color:"medium"},null,8,["src"]),t[67]||(t[67]=(0,s.eW)(" Быстрое управление товарами "))]),_:1,__:[67]}),(0,s.bF)(C,{onClick:t[8]||(t[8]=e=>h.productItemCreate())},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.addOutline,slot:"start",color:"medium"},null,8,["src"]),(0,s.eW)(" Добавить товар в "+(0,l.v_)(p.storeItem.store_name),1)]),_:1})]),_:1})):(0,s.Q3)("",!0),p.storeItem?((0,s.uX)(),(0,s.CE)("form",{key:2,onChange:t[55]||(t[55]=(...e)=>h.saveForm&&h.saveForm(...e))},[(0,s.bF)(G,{lines:"full"},{default:(0,s.k6)(()=>[(0,s.bF)(S,null,{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[68]||(t[68]=[(0,s.eW)("Основные настройки")])),_:1,__:[68]})]),_:1}),p.storeItem.store_name?((0,s.uX)(),(0,s.Wv)(C,{key:0},{default:(0,s.k6)(()=>[(0,s.bF)(k,{position:"stacked",color:"primary"},{default:(0,s.k6)(()=>t[69]||(t[69]=[(0,s.eW)("Название")])),_:1,__:[69]}),(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(p.storeItem.store_name)+" ",1),(0,s.Lk)("div",null,[(0,s.bF)(O,{onClick:t[9]||(t[9]=e=>{p.is_name_edited=1,p.storeItem.store_name_new=p.storeItem.store_name,h.save("store_name_new",p.storeItem.store_name_new)})},{default:(0,s.k6)(()=>t[70]||(t[70]=[(0,s.eW)("Изменить")])),_:1,__:[70]})])]),_:1})]),_:1})):(0,s.Q3)("",!0),p.is_name_edited||!p.storeItem.store_name?((0,s.uX)(),(0,s.Wv)(C,{key:1},{default:(0,s.k6)(()=>[(0,s.bF)(A,{modelValue:p.storeItem.store_name_new,"onUpdate:modelValue":t[10]||(t[10]=e=>p.storeItem.store_name_new=e),name:"store_name_new",label:"Название непроверенное *","label-placement":"stacked"},null,8,["modelValue"]),h.isAdmin?((0,s.uX)(),(0,s.Wv)(F,{key:0,icon:c.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[11]||(t[11]=e=>h.fieldApprove("store_name"))},null,8,["icon"])):(0,s.Q3)("",!0)]),_:1})):(0,s.Q3)("",!0),p.storeItem.store_description?((0,s.uX)(),(0,s.Wv)(C,{key:2},{default:(0,s.k6)(()=>[(0,s.bF)(k,{position:"stacked",color:"primary"},{default:(0,s.k6)(()=>t[71]||(t[71]=[(0,s.eW)("Описание")])),_:1,__:[71]}),(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(p.storeItem.store_description)+" ",1),(0,s.Lk)("div",null,[(0,s.bF)(O,{onClick:t[12]||(t[12]=e=>{p.is_desc_edited=1,p.storeItem.store_description_new=p.storeItem.store_description,h.save("store_description_new",p.storeItem.store_description_new)})},{default:(0,s.k6)(()=>t[72]||(t[72]=[(0,s.eW)("Изменить")])),_:1,__:[72]})])]),_:1})]),_:1})):(0,s.Q3)("",!0),p.is_desc_edited||!p.storeItem.store_description?((0,s.uX)(),(0,s.Wv)(C,{key:3},{default:(0,s.k6)(()=>[(0,s.bF)($,{modelValue:p.storeItem.store_description_new,"onUpdate:modelValue":t[13]||(t[13]=e=>p.storeItem.store_description_new=e),name:"store_description_new",rows:"6",label:"Описание непроверенное *","label-placement":"stacked"},null,8,["modelValue"]),h.isAdmin?((0,s.uX)(),(0,s.Wv)(F,{key:0,icon:c.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[14]||(t[14]=e=>h.fieldApprove("store_description"))},null,8,["icon"])):(0,s.Q3)("",!0)]),_:1})):(0,s.Q3)("",!0),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(A,{modelValue:p.storeItem.store_tax_num,"onUpdate:modelValue":t[15]||(t[15]=e=>p.storeItem.store_tax_num=e),name:"store_tax_num",label:"ИНН *","label-placement":"stacked"},null,8,["modelValue"])]),_:1}),p.storeItem.store_company_name?((0,s.uX)(),(0,s.Wv)(C,{key:4},{default:(0,s.k6)(()=>[(0,s.bF)(k,{position:"stacked",color:"primary"},{default:(0,s.k6)(()=>t[73]||(t[73]=[(0,s.eW)("Юридическое название (ООО, ИП и т.д.)")])),_:1,__:[73]}),(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(p.storeItem.store_company_name)+" ",1),(0,s.Lk)("div",null,[(0,s.bF)(O,{onClick:t[16]||(t[16]=e=>{p.storeItem.store_company_name_new=p.storeItem.store_company_name,h.save("store_company_name_new",p.storeItem.store_company_name_new)})},{default:(0,s.k6)(()=>t[74]||(t[74]=[(0,s.eW)("Изменить")])),_:1,__:[74]})])]),_:1})]),_:1})):(0,s.Q3)("",!0),p.storeItem.store_company_name_new||!p.storeItem.store_company_name?((0,s.uX)(),(0,s.Wv)(C,{key:5},{default:(0,s.k6)(()=>[(0,s.bF)($,{modelValue:p.storeItem.store_company_name_new,"onUpdate:modelValue":t[17]||(t[17]=e=>p.storeItem.store_company_name_new=e),name:"store_company_name_new",label:"Юридическое название (ООО, ИП и т.д.) *","label-placement":"stacked"},null,8,["modelValue"]),h.isAdmin?((0,s.uX)(),(0,s.Wv)(F,{key:0,icon:c.checkmarkCircleOutline,slot:"end",color:"success",onClick:t[18]||(t[18]=e=>h.fieldApprove("store_company_name"))},null,8,["icon"])):(0,s.Q3)("",!0)]),_:1})):(0,s.Q3)("",!0),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(A,{modelValue:p.storeItem.store_phone,"onUpdate:modelValue":t[19]||(t[19]=e=>p.storeItem.store_phone=e),name:"store_phone",type:"tel",inputmode:"tel",placeholder:"x(xxx)-xxx-xx-xx",onIonChange:t[20]||(t[20]=e=>h.phoneFormat()),spellcheck:"false",autocapitalize:"off",label:"Телефон *","label-placement":"stacked"},null,8,["modelValue"])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(A,{modelValue:p.storeItem.store_email,"onUpdate:modelValue":t[21]||(t[21]=e=>p.storeItem.store_email=e),name:"store_email",label:"Электронная почта","label-placement":"stacked"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),(0,s.bF)(G,null,{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[75]||(t[75]=[(0,s.eW)("Заказы и своя доставка")])),_:1,__:[75]})]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{icon:c.cartOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.bF)(g,null,{default:(0,s.k6)(()=>t[76]||(t[76]=[(0,s.eW)("Подготовка (минут)*")])),_:1,__:[76]}),(0,s.bF)(A,{slot:"end",modelValue:p.storeItem.store_time_preparation,"onUpdate:modelValue":t[22]||(t[22]=e=>p.storeItem.store_time_preparation=e),name:"store_time_preparation",style:{width:"100px"},label:""},null,8,["modelValue"])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{icon:c.cartOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.eW)("Мин. заказ ("+(0,l.v_)(e.$heap.state.currencySign)+")*",1)]),_:1}),(0,s.bF)(A,{slot:"end",modelValue:p.storeItem.store_minimal_order,"onUpdate:modelValue":t[23]||(t[23]=e=>p.storeItem.store_minimal_order=e),name:"store_minimal_order",style:{width:"100px"},label:""},null,8,["modelValue"])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{icon:c.storefrontOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.bF)(g,null,{default:(0,s.k6)(()=>t[77]||(t[77]=[(0,s.eW)("Самовывоз разрешен")])),_:1,__:[77]}),(0,s.bF)(w,{slot:"end",modelValue:p.storeItem.store_pickup_allow,"onUpdate:modelValue":t[24]||(t[24]=e=>p.storeItem.store_pickup_allow=e),onIonChange:t[25]||(t[25]=e=>h.save("store_pickup_allow",e.target.checked?1:0)),name:"store_pickup_allow"},null,8,["modelValue"])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{icon:c.rocketOutline,slot:"start",color:"primary"},null,8,["icon"]),(0,s.bF)(g,null,{default:(0,s.k6)(()=>t[78]||(t[78]=[(0,s.eW)("Своя доставка")])),_:1,__:[78]}),(0,s.bF)(w,{slot:"end",modelValue:p.storeItem.store_delivery_allow,"onUpdate:modelValue":t[26]||(t[26]=e=>p.storeItem.store_delivery_allow=e),onIonChange:t[27]||(t[27]=e=>h.save("store_delivery_allow",e.target.checked?1:0)),name:"store_delivery_allow"},null,8,["modelValue"])]),_:1}),1==p.storeItem.store_delivery_allow?((0,s.uX)(),(0,s.CE)("div",_,[(0,s.bF)(C,{lines:"none"},{default:(0,s.k6)(()=>[(0,s.bF)(g,null,{default:(0,s.k6)(()=>[(0,s.eW)("Минимальная стоимость доставки ("+(0,l.v_)(e.$heap.state.currencySign)+")",1)]),_:1}),(0,s.bF)(A,{slot:"end",modelValue:p.storeItem.store_delivery_cost,"onUpdate:modelValue":t[28]||(t[28]=e=>p.storeItem.store_delivery_cost=e),name:"store_delivery_cost",placeholder:"бесплатно",style:{width:"100px"},label:""},null,8,["modelValue"])]),_:1}),(0,s.bF)(C,{lines:"none"},{default:(0,s.k6)(()=>[(0,s.bF)(g,null,{default:(0,s.k6)(()=>t[79]||(t[79]=[(0,s.eW)("Максимальный радиус доставки (км)")])),_:1,__:[79]}),(0,s.bF)(A,{slot:"end",modelValue:p.storeItem.store_delivery_radius,"onUpdate:modelValue":t[29]||(t[29]=e=>p.storeItem.store_delivery_radius=e),name:"store_delivery_radius",placeholder:"по умолчанию",style:{width:"100px"},label:""},null,8,["modelValue"])]),_:1}),(0,s.bF)(C,{lines:"none",color:p.storeItem.store_delivery_methods?"":"warning"},{default:(0,s.k6)(()=>[(0,s.bF)(g,null,{default:(0,s.k6)(()=>t[80]||(t[80]=[(0,s.eW)("Условия доставки")])),_:1,__:[80]}),(0,s.bF)(O,{slot:"end",onClick:t[30]||(t[30]=t=>e.$go(`/catalog/store-edit-dmethods-${p.storeId}`))},{default:(0,s.k6)(()=>t[81]||(t[81]=[(0,s.eW)("Изменить")])),_:1,__:[81]})]),_:1},8,["color"]),(0,s.bF)(C,{lines:"none"},{default:(0,s.k6)(()=>[p.storeItem.store_delivery_methods?((0,s.uX)(),(0,s.CE)("p",{key:0,innerHTML:p.storeItem.store_delivery_methods,style:{display:"-webkit-box","-webkit-line-clamp":"4","-webkit-box-orient":"vertical",overflow:"hidden"}},null,8,d)):((0,s.uX)(),(0,s.Wv)(L,{key:1},{default:(0,s.k6)(()=>t[82]||(t[82]=[(0,s.eW)("Нажмите кнопку изменить и впишите ваши условия доставки")])),_:1,__:[82]}))]),_:1})])):(0,s.Q3)("",!0)]),_:1}),(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[83]||(t[83]=[(0,s.eW)("Категории товаров и услуг *")])),_:1,__:[83]})]),_:1}),(0,s.bF)(G,null,{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(h.storeGroupListComp,t=>((0,s.uX)(),(0,s.Wv)(C,{key:t.group_id},{default:(0,s.k6)(()=>[(0,s.bF)(X,{slot:"start"},{default:(0,s.k6)(()=>[(0,s.bF)(x,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.50.50.webp`},null,8,["src"])]),_:2},1024),(0,s.eW)(" "+(0,l.v_)(t.group_name)+" ",1),(0,s.bF)(U,{color:"primary",slot:"end",modelValue:t.is_marked,"onUpdate:modelValue":e=>t.is_marked=e,onClick:e=>h.itemUpdateGroup(e.target.checked?0:1,t.group_id)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:2},1024))),128))]),_:1}),(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[84]||(t[84]=[(0,s.eW)("Адрес *")])),_:1,__:[84]})]),_:1}),null!==(o=p.storeItem)&&void 0!==o&&null!==(f=o.locations)&&void 0!==f&&f.length?((0,s.uX)(),(0,s.Wv)(G,{key:0},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.storeItem.locations,t=>((0,s.uX)(),(0,s.Wv)(C,{key:t.location_id},{default:(0,s.k6)(()=>[(0,s.bF)(x,{slot:"start",src:`${e.$heap.state.hostname}/image/get.php/${t.image_hash}.32.32.png`},null,8,["src"]),(0,s.bF)(k,{style:{"white-space":"normal",cursor:"pointer"}},{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(t.location_address),1)]),_:2},1024),(0,s.bF)(F,{slot:"end",icon:c.trash,onClick:e=>h.locationDelete(`${t.location_id}`)},null,8,["icon","onClick"])]),_:2},1024))),128))]),_:1})):((0,s.uX)(),(0,s.Wv)(G,{key:1},{default:(0,s.k6)(()=>[(0,s.bF)(C,{lines:"none"},{default:(0,s.k6)(()=>[(0,s.bF)(g,null,{default:(0,s.k6)(()=>t[85]||(t[85]=[(0,s.eW)("Пока адреса не добавлены")])),_:1,__:[85]})]),_:1}),(0,s.bF)(O,{onClick:t[31]||(t[31]=e=>h.modalLocationCreate()),color:"light",expand:"block"},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.locationOutline},null,8,["src"]),t[86]||(t[86]=(0,s.eW)(" Добавить адрес "))]),_:1,__:[86]})]),_:1})),(0,s.bF)(G,null,{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[87]||(t[87]=[(0,s.eW)("Изображения магазина в приложении *")])),_:1,__:[87]})]),_:1}),(0,s.bF)(D,{images:p.storeItem.images,image_holder_id:p.storeItem.store_id,controller:"Store",title:"Витрина продавца 5 фото",ref:"storeImgs"},null,8,["images","image_holder_id"]),(0,s.bF)(O,{onClick:t[32]||(t[32]=t=>e.$refs.storeImgs.take_photo()),color:"light",expand:"block"},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.cameraOutline,slot:"start"},null,8,["src"]),t[88]||(t[88]=(0,s.eW)(" Добавить фото на витрину "))]),_:1,__:[88]}),(0,s.bF)(D,{images:p.storeItem.avatar,image_holder:"store_avatar",image_holder_id:p.storeItem.store_id,controller:"Store",title:"Логотип продавца 1 фото",ref:"storeAvatar"},null,8,["images","image_holder_id"]),(0,s.bF)(O,{onClick:t[33]||(t[33]=t=>e.$refs.storeAvatar.take_photo()),color:"light",expand:"block"},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.cameraOutline,slot:"start"},null,8,["src"]),t[89]||(t[89]=(0,s.eW)(" Добавить логотип "))]),_:1,__:[89]})]),_:1}),(0,s.bF)(G,{lines:"full"},{default:(0,s.k6)(()=>[(0,s.bF)(S,{class:"schedule"},{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[90]||(t[90]=[(0,s.eW)("Время работы *")])),_:1,__:[90]})]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[92]||(t[92]=(0,s.eW)(" Понедельник ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[91]||(t[91]=[(0,s.eW)("(выходной)")])),_:1,__:[91]},512),[[r.aG,!p.storeItem.store_time_opens_0&&!p.storeItem.store_time_closes_0]])]),_:1,__:[92]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_0,"onUpdate:modelValue":t[34]||(t[34]=e=>p.storeItem.store_time_opens_0=e),name:"store_time_opens_0",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_0,"onUpdate:modelValue":t[35]||(t[35]=e=>p.storeItem.store_time_closes_0=e),name:"store_time_closes_0",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[36]||(t[36]=e=>{p.storeItem.store_time_opens_0=p.storeItem.store_time_closes_0=null,h.saveSchedule("0")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_0]])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[94]||(t[94]=(0,s.eW)(" Вторник ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[93]||(t[93]=[(0,s.eW)("(выходной)")])),_:1,__:[93]},512),[[r.aG,!p.storeItem.store_time_opens_1&&!p.storeItem.store_time_closes_1]])]),_:1,__:[94]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_1,"onUpdate:modelValue":t[37]||(t[37]=e=>p.storeItem.store_time_opens_1=e),name:"store_time_opens_1",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_1,"onUpdate:modelValue":t[38]||(t[38]=e=>p.storeItem.store_time_closes_1=e),name:"store_time_closes_1",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[39]||(t[39]=e=>{p.storeItem.store_time_opens_1=p.storeItem.store_time_closes_1=null,h.saveSchedule("1")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_1]])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[96]||(t[96]=(0,s.eW)(" Среда ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[95]||(t[95]=[(0,s.eW)("(выходной)")])),_:1,__:[95]},512),[[r.aG,!p.storeItem.store_time_opens_2&&!p.storeItem.store_time_closes_2]])]),_:1,__:[96]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_2,"onUpdate:modelValue":t[40]||(t[40]=e=>p.storeItem.store_time_opens_2=e),name:"store_time_opens_2",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_2,"onUpdate:modelValue":t[41]||(t[41]=e=>p.storeItem.store_time_closes_2=e),name:"store_time_closes_2",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[42]||(t[42]=e=>{p.storeItem.store_time_opens_2=p.storeItem.store_time_closes_2=null,h.saveSchedule("2")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_2]])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[98]||(t[98]=(0,s.eW)(" Четверг ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[97]||(t[97]=[(0,s.eW)("(выходной)")])),_:1,__:[97]},512),[[r.aG,!p.storeItem.store_time_opens_3&&!p.storeItem.store_time_closes_3]])]),_:1,__:[98]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_3,"onUpdate:modelValue":t[43]||(t[43]=e=>p.storeItem.store_time_opens_3=e),name:"store_time_opens_3",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_3,"onUpdate:modelValue":t[44]||(t[44]=e=>p.storeItem.store_time_closes_3=e),name:"store_time_closes_3",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[45]||(t[45]=e=>{p.storeItem.store_time_opens_3=p.storeItem.store_time_closes_3=null,h.saveSchedule("3")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_3]])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[100]||(t[100]=(0,s.eW)(" Пятница ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[99]||(t[99]=[(0,s.eW)("(выходной)")])),_:1,__:[99]},512),[[r.aG,!p.storeItem.store_time_opens_4&&!p.storeItem.store_time_closes_4]])]),_:1,__:[100]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_4,"onUpdate:modelValue":t[46]||(t[46]=e=>p.storeItem.store_time_opens_4=e),name:"store_time_opens_4",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_4,"onUpdate:modelValue":t[47]||(t[47]=e=>p.storeItem.store_time_closes_4=e),name:"store_time_closes_4",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[48]||(t[48]=e=>{p.storeItem.store_time_opens_4=p.storeItem.store_time_closes_4=null,h.saveSchedule("4")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_4]])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[102]||(t[102]=(0,s.eW)(" Суббота ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[101]||(t[101]=[(0,s.eW)("(выходной)")])),_:1,__:[101]},512),[[r.aG,!p.storeItem.store_time_opens_5&&!p.storeItem.store_time_closes_5]])]),_:1,__:[102]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_5,"onUpdate:modelValue":t[49]||(t[49]=e=>p.storeItem.store_time_opens_5=e),name:"store_time_opens_5",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_5,"onUpdate:modelValue":t[50]||(t[50]=e=>p.storeItem.store_time_closes_5=e),name:"store_time_closes_5",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[51]||(t[51]=e=>{p.storeItem.store_time_opens_5=p.storeItem.store_time_closes_5=null,h.saveSchedule("5")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_5]])]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,{slot:"start"},{default:(0,s.k6)(()=>[t[104]||(t[104]=(0,s.eW)(" Воскресенье ")),(0,s.bo)((0,s.bF)(k,null,{default:(0,s.k6)(()=>t[103]||(t[103]=[(0,s.eW)("(выходной)")])),_:1,__:[103]},512),[[r.aG,!p.storeItem.store_time_opens_6&&!p.storeItem.store_time_closes_6]])]),_:1,__:[104]}),(0,s.bF)(A,{placeholder:"от",modelValue:p.storeItem.store_time_opens_6,"onUpdate:modelValue":t[52]||(t[52]=e=>p.storeItem.store_time_opens_6=e),name:"store_time_opens_6",label:""},null,8,["modelValue"]),(0,s.bF)(A,{placeholder:"до",modelValue:p.storeItem.store_time_closes_6,"onUpdate:modelValue":t[53]||(t[53]=e=>p.storeItem.store_time_closes_6=e),name:"store_time_closes_6",label:""},null,8,["modelValue"]),(0,s.bo)((0,s.bF)(F,{slot:"end",src:c.closeCircle,onClick:t[54]||(t[54]=e=>{p.storeItem.store_time_opens_6=p.storeItem.store_time_closes_6=null,h.saveSchedule("6")})},null,8,["src"]),[[r.aG,p.storeItem.store_time_closes_6]])]),_:1})]),_:1})]),_:1})],32)):(0,s.Q3)("",!0),p.storeItem&&h.isAdmin?((0,s.uX)(),(0,s.Wv)(G,{key:3},{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[105]||(t[105]=[(0,s.eW)("Тарифы")])),_:1,__:[105]})]),_:1}),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(h.tariffListComputed,e=>((0,s.uX)(),(0,s.Wv)(C,{key:e.tariff_id},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.briefcaseOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.Lk)("div",null,[(0,s.Lk)("p",null,(0,l.v_)(e.tariff_name),1),(0,s.bF)(L,null,{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(e.start_dmy)+" - "+(0,l.v_)(e.finish_dmy),1)]),_:2},1024)]),(0,s.bF)(F,{src:c.trashOutline,slot:"end",onClick:t=>h.tariffDelete(e.tariff_id)},null,8,["src","onClick"])]),_:2},1024))),128)),h.isAdmin?((0,s.uX)(),(0,s.Wv)(C,{key:0,button:"",onClick:t[56]||(t[56]=e=>h.tariffPick())},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[106]||(t[106]=[(0,s.eW)("Добавить тариф")])),_:1,__:[106]})]),_:1})):(0,s.Q3)("",!0)]),_:1})):(0,s.Q3)("",!0),p.ownerList?((0,s.uX)(),(0,s.Wv)(G,{key:4},{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[107]||(t[107]=[(0,s.eW)("Адинистраторы")])),_:1,__:[107]})]),_:1}),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.ownerList,e=>((0,s.uX)(),(0,s.Wv)(C,{key:e.user_id},{default:(0,s.k6)(()=>[p.storeItem.owner_id==e.user_id?((0,s.uX)(),(0,s.Wv)(F,{key:0,src:c.ribbonOutline,slot:"start",color:"primary"},null,8,["src"])):((0,s.uX)(),(0,s.Wv)(F,{key:1,src:c.personOutline,slot:"start",color:"primary"},null,8,["src"])),(0,s.bF)(k,null,{default:(0,s.k6)(()=>[(0,s.Lk)("a",{href:`tel:+${e.user_phone}`},"+"+(0,l.v_)(e.user_phone),9,u),(0,s.eW)(" "+(0,l.v_)(e.user_name)+" ",1),p.storeItem.owner_id==e.user_id?((0,s.uX)(),(0,s.CE)("span",m,"(Суперадмин)")):(0,s.Q3)("",!0)]),_:2},1024),h.isStoreSuperadmin&&p.storeItem.owner_id!=e.user_id?((0,s.uX)(),(0,s.Wv)(F,{key:2,src:c.trashOutline,slot:"end",onClick:t=>h.ownerDelete(e.user_id)},null,8,["src","onClick"])):(0,s.Q3)("",!0),h.isStoreSuperadmin&&p.storeItem.owner_id==e.user_id?((0,s.uX)(),(0,s.Wv)(F,{key:3,src:c.swapHorizontalOutline,slot:"end",onClick:t[57]||(t[57]=e=>h.ownerAdd("swap"))},null,8,["src"])):(0,s.Q3)("",!0)]),_:2},1024))),128)),h.isStoreSuperadmin?((0,s.uX)(),(0,s.Wv)(C,{key:0,button:"",onClick:t[58]||(t[58]=e=>h.ownerAdd())},{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[108]||(t[108]=[(0,s.eW)("Добавить администратора")])),_:1,__:[108]})]),_:1})):(0,s.Q3)("",!0)]),_:1})):(0,s.Q3)("",!0),h.isStoreSuperadmin&&p.storeItem?((0,s.uX)(),(0,s.Wv)(G,{key:5},{default:(0,s.k6)(()=>[(0,s.bF)(V,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>t[109]||(t[109]=[(0,s.eW)("API токен")])),_:1,__:[109]})]),_:1}),(0,s.bF)(C,null,{default:(0,s.k6)(()=>[(0,s.bF)(F,{src:c.keyOutline,slot:"start",color:"primary"},null,8,["src"]),p.apiToken?((0,s.uX)(),(0,s.Wv)(k,{key:0,onClick:t[59]||(t[59]=e=>h.apiTokenCopy())},{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(p.apiToken.token_hash),1)]),_:1})):((0,s.uX)(),(0,s.Wv)(k,{key:1},{default:(0,s.k6)(()=>t[110]||(t[110]=[(0,s.eW)("**** **** ****")])),_:1,__:[110]})),p.apiToken?((0,s.uX)(),(0,s.Wv)(F,{key:2,src:c.copyOutline,slot:"end",color:"dark",onClick:t[60]||(t[60]=e=>h.apiTokenCopy())},null,8,["src"])):((0,s.uX)(),(0,s.Wv)(F,{key:3,src:c.eyeOutline,slot:"end",color:"dark",onClick:t[61]||(t[61]=e=>h.apiTokenShow())},null,8,["src"]))]),_:1})]),_:1})):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)]}),_:1},8,["page-title","pageDefaultBackLink"])}o(4114);var p=o(5634),h=o(5480),f=o(4933),k=o(8926);function b(e,t,o,r,i,a){const n=(0,s.g2)("ion-icon"),_=(0,s.g2)("ion-title"),d=(0,s.g2)("ion-toolbar"),u=(0,s.g2)("ion-header"),m=(0,s.g2)("ion-label"),c=(0,s.g2)("ion-select-option"),p=(0,s.g2)("ion-select"),h=(0,s.g2)("ion-item"),f=(0,s.g2)("ion-input"),k=(0,s.g2)("ion-list"),b=(0,s.g2)("ion-button"),I=(0,s.g2)("ion-content");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(u,null,{default:(0,s.k6)(()=>[(0,s.bF)(d,{color:"secondary"},{default:(0,s.k6)(()=>[(0,s.bF)(_,null,{default:(0,s.k6)(()=>[(0,s.bF)(n,{icon:r.briefcaseOutline},null,8,["icon"]),t[5]||(t[5]=(0,s.eW)(" Добавить тариф"))]),_:1,__:[5]}),(0,s.bF)(n,{icon:r.closeOutline,onClick:t[0]||(t[0]=e=>{r.closeModal()}),slot:"end",size:"large"},null,8,["icon"])]),_:1})]),_:1}),(0,s.bF)(I,null,{default:(0,s.k6)(()=>[(0,s.bF)(k,null,{default:(0,s.k6)(()=>[(0,s.bF)(h,null,{default:(0,s.k6)(()=>[(0,s.bF)(m,null,{default:(0,s.k6)(()=>t[6]||(t[6]=[(0,s.eW)("Тариф")])),_:1,__:[6]}),(0,s.bF)(p,{slot:"end",modelValue:i.tariff_id,"onUpdate:modelValue":t[1]||(t[1]=e=>i.tariff_id=e),interface:"action-sheet",placeholder:"Выберите тариф"},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.tariffList,e=>((0,s.uX)(),(0,s.Wv)(c,{value:e.tariff_id,key:e.tariff_id},{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(e.tariff_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,s.bF)(h,null,{default:(0,s.k6)(()=>[(0,s.bF)(m,null,{default:(0,s.k6)(()=>t[7]||(t[7]=[(0,s.eW)("Начало действия")])),_:1,__:[7]}),(0,s.bF)(f,{slot:"end",type:"date",modelValue:i.start_at,"onUpdate:modelValue":t[2]||(t[2]=e=>i.start_at=e)},null,8,["modelValue"])]),_:1}),(0,s.bF)(h,null,{default:(0,s.k6)(()=>[(0,s.bF)(m,null,{default:(0,s.k6)(()=>t[8]||(t[8]=[(0,s.eW)("Окончание действия")])),_:1,__:[8]}),(0,s.bF)(f,{slot:"end",type:"date",modelValue:i.finish_at,"onUpdate:modelValue":t[3]||(t[3]=e=>i.finish_at=e)},null,8,["modelValue"])]),_:1})]),_:1}),(0,s.bF)(b,{onClick:t[4]||(t[4]=e=>a.itemCreate()),expand:"block"},{default:(0,s.k6)(()=>t[9]||(t[9]=[(0,s.eW)("Добавить")])),_:1,__:[9]})]),_:1})],64)}var I=o(2311),g=o.n(I),v={components:{IonContent:p.W9,IonToolbar:p.ai,IonButton:p.Jm,IonHeader:p.eU,IonIcon:p.iq,IonTitle:p.BC,IonLabel:p.he,IonSelectOption:p.Ip,IonSelect:p.Nm,IonItem:p.uz,IonInput:p.$w,IonList:p.nf},props:["store_id"],setup(){const e=function(){p.OZ.dismiss()};return{closeModal:e,briefcaseOutline:h.vOb,closeOutline:h.xfX}},data(){return{start_at:null,finish_at:null,tariff_id:null,tariffList:null}},methods:{async listGet(){try{this.tariffList=await g().post(`${this.$heap.state.hostname}Admin/Tariff/listGet`)}catch(e){const t=e.responseJSON,o=t.messages.error;switch(o){case"forbidden":this.$flash("Не достаточно прав");break}return!1}},async itemCreate(){if(!this.tariff_id||!this.store_id||!this.start_at||!this.finish_at)return void this.$flash("Форма не заполнена полностью");const e={tariff_id:this.tariff_id,store_id:this.store_id,start_at:this.start_at,finish_at:this.finish_at};p.OZ.dismiss(e)}},mounted(){this.listGet()}},y=o(6262);const F=(0,y.A)(v,[["render",b]]);var w=F,C=o(5538),V=o(8701),W={components:{IonInput:p.$w,IonTextarea:p.nc,IonToggle:p.BY,IonCard:p.b_,IonCardContent:p.I9,IonCardHeader:p.ME,IonCheckbox:p.eY,IonIcon:p.iq,IonItem:p.uz,IonList:p.nf,IonLabel:p.he,IonItemDivider:p.Dg,IonText:p.IO,IonItemGroup:p.jh,IonImg:p.KW,IonAvatar:p.mC,IonButton:p.Jm,IonProgressBar:p.FH,IonNote:p.JI,imageTileComp:f.A},setup(){return{cameraOutline:h.GOB,trash:h.dco,trashOutline:h.P1A,locationOutline:h.UN$,storefrontOutline:h.te8,flagOutline:h.NBP,searchOutline:h.jBE,personOutline:h.wAZ,addOutline:h.EKF,checkmarkCircleOutline:h.gz2,chevronBack:h.fcl,closeCircle:h.P0k,keyOutline:h.uNo,eyeOutline:h.ov$,copyOutline:h.cwK,ribbonOutline:h.rp8,briefcaseOutline:h.vOb,cartOutline:h.jSK,rocketOutline:h.hGQ,swapHorizontalOutline:h.Ilt,pieChartOutline:h.p1S,qrCode:h.JBo,listOutline:h.PFj}},data(){return{storeId:this.$route.params.id,storeItem:null,storeGroupList:[],ownerList:null,tariffList:null,is_name_edited:0,is_desc_edited:0,is_deleted:0,is_disabled:0,is_working:0,is_primary:0,validity:0,validity_perc:100,validity_min:80,apiToken:null}},computed:{isPhoneValid(){return[11,12].includes(this.storeItem.user_phone.replace(/\D/g,"").length)},isAdmin(){return V.A.isAdmin()},isStoreSuperadmin(){var e;return this.$heap.state.user.user_id==(null===(e=this.storeItem)||void 0===e?void 0:e.owner_id)||V.A.isAdmin()},message(){var e,t,o,s;return this.storeItem?null!==(e=this.storeItem)&&void 0!==e&&e.deleted_at?"Предприятие не активно и будет удалено. Вы еще можете отменить удаление":1==(null===(t=this.storeItem)||void 0===t?void 0:t.is_disabled)?"Предприятие не активно и находится на рассмотрении у администратора":0==(null===(o=this.storeItem)||void 0===o?void 0:o.is_working)?"Предприятие отмечено вами как времено не готовое к заказам. Например, в связи с праздниками":1==(null===(s=this.storeItem)||void 0===s?void 0:s.is_primary)?"Предприятие активно и готово принимать заказы в рабочее время. Является опорным":"Предприятие активно и готово принимать заказы в рабочее время.":null},messageClass(){var e,t,o,s;return null!==(e=this.storeItem)&&void 0!==e&&e.deleted_at?"deleted":1==(null===(t=this.storeItem)||void 0===t?void 0:t.is_disabled)?"disabled":1==(null===(o=this.storeItem)||void 0===o?void 0:o.is_primary)?"primary":1!=(null===(s=this.storeItem)||void 0===s?void 0:s.is_working)?"notworking":"active"},tariffListComputed(){if(!this.tariffList)return this.tariffList;for(let e of this.tariffList)e.start_dmy=this.toLocDate(e.start_at),e.finish_dmy=this.toLocDate(e.finish_at);return this.tariffList},storeGroupListComp(){if(!this.storeItem||!this.storeGroupList)return console.log(this.storeItem,this.storeGroupList),null;let e=[];try{var t,o;const s=null===(t=this.storeItem.member_of_groups)||void 0===t||null===(o=t.group_ids)||void 0===o?void 0:o.split(",");for(let t of this.storeGroupList)t.is_marked=null===s||void 0===s?void 0:s.includes(t.group_id),e.push(t)}catch(s){}return e}},mounted(){this.listGroupGet(),this.itemGet(),this.ownerListGet()},methods:{toLocDate(e){const t=new Date(Date.parse(e)),o={month:"short",day:"numeric",year:"numeric"};return t.toLocaleDateString(void 0,o)},async itemGet(){try{this.storeItem=await g().post(C.A.state.hostname+"Store/itemGet",{store_id:this.storeId}),this.storeItem.store_pickup_allow*=1,this.storeItem.store_delivery_allow*=1,this.storeItem.store_delivery_radius>0?this.storeItem.store_delivery_radius=this.storeItem.store_delivery_radius/1e3:this.storeItem.store_delivery_radius="",this.storeItem.store_delivery_methods_short=String(this.storeItem.store_delivery_methods).substring(0,100)+"...",this.itemParseFlags(),this.itemValidityCalc(),this.tariffListGet()}catch(o){var e,t;const s=null===(e=o.responseJSON)||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.error;"notfound"==s&&(this.$flash("Не найден"),this.$go("/"))}},itemParseFlags(){this.is_deleted=null==this.storeItem.deleted_at?0:1,this.is_disabled=0==this.storeItem.is_disabled?0:1,this.is_working=0==this.storeItem.is_working?0:1,this.is_primary=1==this.storeItem.is_primary?1:0},itemValidityCalc(){const e=["store_name|store_name_new","store_description|store_description_new","store_company_name|store_company_name_new","store_phone","store_tax_num","store_minimal_order","store_time_preparation","store_time_opens_0|store_time_opens_1|store_time_opens_2|store_time_opens_3|store_time_opens_4|store_time_opens_5|store_time_opens_6|store_time_closes_0|store_time_closes_1|store_time_closes_2|store_time_closes_3|store_time_closes_4|store_time_closes_5|store_time_closes_6","images","locations","member_of_groups.group_ids"],t=e.length;let o=0;for(const l of e){let e=0;for(const t of l.split("|")){var s;let o=null;const l=t.split(".");if(o=l[1]?this.storeItem[l[0]][l[1]]:this.storeItem[l[0]],(null===(s=o)||void 0===s?void 0:s.length)>0){e=1;break}}o+=e}this.validity=o/t,this.validity_perc=Math.round(100*this.validity)},async itemDelete(e){if(e&&!confirm("Внимание магазин будет удален! Товары, настройки, отзывы будут потеряны. Продолжить?"))return void setTimeout(()=>{this.is_deleted=0},100);const t=e?"itemDelete":"itemUnDelete";try{await g().post(C.A.state.hostname+"Store/"+t,{store_id:this.storeId}),this.storeItem.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.storeItem.is_disabled!=e)try{await g().post(C.A.state.hostname+"Store/itemDisable",{store_id:this.storeId,is_disabled:e}),this.storeItem.is_disabled=e}catch{this.itemGet()}},async productItemCreate(){try{const e={store_id:this.storeId,product_name:"Новый товар",product_price:1e3,product_promo_price:1e3},t=await g().post(`${C.A.state.hostname}Product/itemCreate`,e);this.$go(`/catalog/product-edit-${t}`)}catch{this.$flash("Не удалось создать товар")}},saveForm(e){const t=e.target.name,o=this.storeItem[t];t.indexOf("store_time_closes")>-1||t.indexOf("store_time_opens")>-1?this.saveSchedule(t):this.save(t,o)},saveSchedule(e){const t=e.split("_").pop();let o=this.storeItem["store_time_opens_"+t],s=this.storeItem["store_time_closes_"+t];o=""==o||null==o?null:Number(o),s=""==s||null==s?null:Number(s),o>24&&(o=0),s>24&&(s=0);const l={store_id:this.storeId,["store_time_opens_"+t]:o,["store_time_closes_"+t]:s};this.storeItem["store_time_opens_"+t]!=o&&(this.storeItem["store_time_opens_"+t]=o),this.storeItem["store_time_closes_"+t]!=s&&(this.storeItem["store_time_closes_"+t]=s),this.itemValidityCalc(),this.itemUpdate(l)},async save(e,t){if(!e)return;if("user_phone"==e){if(!this.isPhoneValid)return!1;t=t.replace(/\D/g,"")}let o={store_id:this.storeId,[e]:t};this.storeItem[e]=t,"store_delivery_radius"==e&&t>0&&(o.store_delivery_radius=1e3*t),this.itemValidityCalc(),this.itemUpdate(o),this.itemParseFlags()},async itemUpdate(e){try{e["validity"]=this.validity_perc,await g().post(C.A.state.hostname+"Store/itemUpdate",JSON.stringify(e)),this.$flash("сохранено")}catch(t){this.$flash("Не удалось сохранить изменение"),this.itemGet()}},phoneFormat(){this.storeItem.store_phone||(this.storeItem.store_phone="");try{let e=this.storeItem.store_phone.replace(/\D/g,"");e.length>12&&(e="+"+e.substring(e.length-12)),this.storeItem.store_phone=e}catch{}},async fieldApprove(e){let t={store_id:this.storeId,field_name:e};try{await this.save(e,this.storeItem[e]),await g().post(C.A.state.hostname+"Store/fieldApprove",t)}catch(o){const e=o.responseJSON.messages.error;null!==e&&void 0!==e&&e.includes("store_description")?this.$flash("Описание слишком короткое"):null!==e&&void 0!==e&&e.includes("store_name")?this.$flash("Название слишком короткое"):this.$flash("Не удалось сохранить изменение")}this.itemGet()},async itemUpdateGroup(e,t){if(!V.A.isAdmin()&&0==this.is_disabled&&!confirm("Внимание! Изменение группы, отправит магазин/ресторан на модерацию"))return this.listGroupGet(),!1;const o={store_id:this.storeId,is_joined:e,group_id:t};try{await g().post(C.A.state.hostname+"Store/itemUpdateGroup",o)}catch(s){this.$flash("Не удалось сохранить изменение")}this.itemGet()},async listGroupGet(){try{this.storeGroupList=await g().get(C.A.state.hostname+"Store/listGroupGet")}catch{}},async ownerListGet(){try{this.ownerList=await g().post(C.A.state.hostname+"Store/ownerListGet",{store_id:this.storeId})}catch{}},async ownerAdd(e="add"){let t=prompt("Введите номер телефона нового администратора");if(t)if(t=t.replace(/\D/g,""),[11,12].includes(t.length))try{await g().post(C.A.state.hostname+"Store/ownerSave",{store_id:this.storeId,action:e,owner_phone:t}),"swap"==e&&await this.itemGet(),this.ownerListGet()}catch{this.$flash("Не удалось добавить администратора")}else this.$flash("Проверьте правильность телефона")},async ownerDelete(e){if(confirm("Удалить этого пользователя из администраторов магазина?"))try{await g().post(C.A.state.hostname+"Store/ownerSave",{store_id:this.storeId,action:"delete",owner_id:e}),this.ownerListGet()}catch{this.$flash("Не удалось удалить администратора")}},async modalLocationCreate(){if(!C.A.state.user.user_id)return this.$flash("Чтобы добавленные адреса сохранились, пожалуйста войдите в систему"),void this.$go({name:"UserSignIn"});var e="рабочий";const t=await p.OZ.create({component:k.A,showBackdrop:!0,backdropDismiss:!0,componentProps:{location_group_name_low:e}});return t.onDidDismiss().then(e=>{this.locationCreate(e.data)}),t.present()},async locationCreate(e){if(!e)return;const t={location_holder:"store",location_holder_id:this.storeId,location_group_type:"address_work",location_address:e.location_address,location_latitude:e.location_latitude,location_longitude:e.location_longitude};try{await g().post(C.A.state.hostname+"Store/locationCreate",t),this.itemGet()}catch(l){var o,s;const e=null===(o=l.responseJSON)||void 0===o||null===(s=o.messages)||void 0===s?void 0:s.error;"limit_exeeded"==e&&this.$flash("Больше адресов добавить нельзя")}},async locationDelete(e){try{await g().post(C.A.state.hostname+"Store/locationDelete",{location_id:e}),this.itemGet()}catch{this.$flash("Удалить адрес не удалось")}},async apiTokenShow(){const e={token_holder:"store",token_holder_id:this.storeId};try{this.apiToken=await g().post(C.A.state.hostname+"Token/itemActiveGet",e)}catch{}},apiTokenCopy(){this.apiToken.token_hash&&(navigator.clipboard.writeText(this.apiToken.token_hash),this.$flash("Токен скопирован"))},async tariffListGet(){const e={store_id:this.storeId};try{this.tariffList=await g().post(C.A.state.hostname+"Admin/Tariff/storeTariffListGet",e)}catch{this.tariffList=null}},async tariffDelete(e){if(!confirm("Вы уверены?"))return;const t={store_id:this.storeId,tariff_id:e};try{await g().post(C.A.state.hostname+"Admin/Tariff/storeTariffDelete",t),this.tariffListGet()}catch{}},async tariffAdd(e){try{await g().post(C.A.state.hostname+"Admin/Tariff/storeTariffAdd",e),this.tariffListGet()}catch(t){const e=t.responseJSON,o=e.messages.error;switch(o){case"forbidden":this.$flash("Не достаточно прав");break}return!1}},async tariffPick(){if(!this.isAdmin)return;const e=await p.OZ.create({component:w,showBackdrop:!0,backdropDismiss:!0,componentProps:{store_id:this.storeId}});return e.onDidDismiss().then(e=>{var t;null!==e&&void 0!==e&&null!==(t=e.data)&&void 0!==t&&t.tariff_id&&this.tariffAdd(e.data)}),e.present()}}};const G=(0,y.A)(W,[["render",c],["__scopeId","data-v-e151e18c"]]);var O=G},8926:function(e,t,o){o.d(t,{A:function(){return v}});var s=o(641),l=o(33),r=o(3751);const i={style:{position:"absolute",bottom:"10px",width:"100%"}},a={style:{"margin-left":"12px","margin-right":"12px","background-color":"#ffffffdd","--ion-item-background":"#ffffff00","border-top-left-radius":"10px","border-top-right-radius":"10px"}},n={key:0},_={key:1},d={slot:"end",style:{color:"#666"}},u={style:{width:"100%"}},m={style:{display:"grid","grid-template-columns":"1fr 1fr"}};function c(e,t,o,c,p,h){const f=(0,s.g2)("ymap-marker"),k=(0,s.g2)("yandex-map"),b=(0,s.g2)("ion-item"),I=(0,s.g2)("ion-searchbar"),g=(0,s.g2)("ion-content"),v=(0,s.g2)("ion-img"),y=(0,s.g2)("ion-label"),F=(0,s.g2)("ion-segment-button"),w=(0,s.g2)("ion-segment"),C=(0,s.g2)("ion-input"),V=(0,s.g2)("ion-icon"),W=(0,s.g2)("ion-button"),G=(0,s.g2)("ion-toolbar");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(g,null,{default:(0,s.k6)(()=>[p.showed?((0,s.uX)(),(0,s.Wv)(k,{key:0,onClick:t[0]||(t[0]=e=>{h.onClick(e)}),style:{height:"100%"},coords:p.coords,zoom:16,settings:p.settings,controls:["zoomControl"]},{default:(0,s.k6)(()=>[(0,s.bF)(f,{coords:p.coords,"marker-id":"1",properties:h.placemarkProperties},null,8,["coords","properties"])]),_:1},8,["coords","settings"])):(0,s.Q3)("",!0),(0,s.Lk)("div",i,[(0,s.Lk)("div",a,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.suggestions,(e,t)=>((0,s.uX)(),(0,s.Wv)(b,{key:t,onClick:t=>h.suggestionSelect(`${e.subtitle.text}, ${e.title.text}`,e.uri),lines:"full"},{default:(0,s.k6)(()=>[0==t?((0,s.uX)(),(0,s.CE)("p",n,[(0,s.Lk)("b",null,(0,l.v_)(e.subtitle.text)+" "+(0,l.v_)(e.title.text),1)])):((0,s.uX)(),(0,s.CE)("p",_,(0,l.v_)(e.subtitle.text)+" "+(0,l.v_)(e.title.text),1)),(0,s.Lk)("span",d,(0,l.v_)(e.distance.text),1)]),_:2},1032,["onClick"]))),128))]),(0,s.bF)(I,{debounce:"500",modelValue:p.addressSearchQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>p.addressSearchQuery=e),onIonInput:t[2]||(t[2]=e=>h.suggestionsGet()),onKeyup:t[3]||(t[3]=(0,r.jR)(e=>h.pickAddress(),["enter"])),placeholder:"поиск по адресу",class:"search"},null,8,["modelValue"])])]),_:1}),(0,s.bF)(G,{style:{"--background":"white"}},{default:(0,s.k6)(()=>[(0,s.Lk)("div",u,[p.locationGroups?((0,s.uX)(),(0,s.Wv)(w,{key:0,mode:"ios",modelValue:p.locationGroup,"onUpdate:modelValue":t[4]||(t[4]=e=>p.locationGroup=e)},{default:(0,s.k6)(()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.locationGroups,t=>((0,s.uX)(),(0,s.Wv)(F,{key:t.group_id,value:t},{default:(0,s.k6)(()=>[(0,s.bF)(v,{src:`${e.$heap.state.hostname}/image/get.php/${t.image_hash}.40.40.png`,style:{height:"18px"}},null,8,["src"]),(0,s.bF)(y,null,{default:(0,s.k6)(()=>[(0,s.eW)((0,l.v_)(t.group_name),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):(0,s.Q3)("",!0),(0,s.bF)(C,{label:"квартира, дом, этаж, подъезд","label-placement":"floating",modelValue:p.addressComment,"onUpdate:modelValue":t[5]||(t[5]=e=>p.addressComment=e)},null,8,["modelValue"]),(0,s.Lk)("div",m,[(0,s.bF)(W,{onClick:t[6]||(t[6]=e=>c.closeModal()),color:"light",expand:"block"},{default:(0,s.k6)(()=>[(0,s.bF)(V,{src:c.closeOutline,slot:"start"},null,8,["src"]),t[8]||(t[8]=(0,s.eW)(" Закрыть "))]),_:1,__:[8]}),(0,s.bF)(W,{strong:!0,onClick:t[7]||(t[7]=e=>h.pickAddress()),color:"primary",expand:"block"},{default:(0,s.k6)(()=>[(0,s.bF)(V,{src:c.checkmark,slot:"start"},null,8,["src"]),t[9]||(t[9]=(0,s.eW)("Ок "))]),_:1,__:[9]})])])]),_:1})],64)}o(4114),o(8111),o(116);var p=o(5634),h=o(5221),f=o(5480),k=o(8701),b={components:{IonContent:p.W9,IonToolbar:p.ai,IonButton:p.Jm,IonSearchbar:p.S1,IonIcon:p.iq,IonItem:p.uz,IonInput:p.$w,IonSegment:p.Gp,IonSegmentButton:p.eP,IonImg:p.KW,IonLabel:p.he,yandexMap:h.IK,ymapMarker:h.cT},setup(){const e=function(){p.OZ.dismiss()};return{closeModal:e,locationOutline:f.UN$,closeOutline:f.xfX,checkmark:f.AIp}},props:["location_group_name_low","locationGroupList"],data(){var e;let t=this.$heap.state.settings.location,o=JSON.parse(t.mapCenter);return{settings:{apiKey:t.ymapApiKey,lang:"ru_RU",coordorder:"latlong",version:"2.1"},suggestions:[],addressSearchQuery:null,markDeviceOnMap:!0,locationGroup:(null===(e=this.locationGroupList)||void 0===e?void 0:e[0])??null,locationGroups:this.locationGroupList??null,locSettings:t,selectedPlacemark:0,selectedAddress:"",selectedCoords:[],coords:o,addressComment:"",showed:1}},computed:{locationType(){return this.locationGroup?this.locationGroup.group_name+" адрес":this.location_group_name_low??"адрес"},placemarkProperties(){return{iconCaption:this.locationType}}},methods:{async pickAddress(){var e;try{if(this.suggestions[0]&&(console.log(this.coords),await this.suggestionSelect(this.suggestions[0].title.text,this.suggestions[0].uri),console.log(this.coords)),!this.selectedAddress){var t;const e=await window.ymaps.geocode(this.coords);this.selectedAddress=null===(t=e.geoObjects.get(0))||void 0===t?void 0:t.getAddressLine()}}catch(s){console.log(s)}var o={location_group_id:(null===(e=this.locationGroup)||void 0===e?void 0:e.group_id)??null,location_address:this.filterAddress(this.selectedAddress),location_latitude:this.coords[0],location_longitude:this.coords[1],location_comment:this.addressComment};p.OZ.dismiss(o)},filterAddress(e){const t=this.locSettings.addressErase.split(", "),o=e.split(", ");let s=[];for(const l of o)t.find(e=>e==l)||s.push(l);return s.reverse().join(", ")},onClick(e){e&&e.get&&(this.markDeviceOnMap=!1,this.suggestions=[],this.selectedAddress=null,this.coords=e.get("coords"))},async suggestionsGet(){if(this.markDeviceOnMap=!1,this.addressSearchQuery)try{const e=this.$heap.state.settings.location.ymapSuggestionApiKey,t=this.coords.slice().reverse().join(","),o=await fetch(`https://suggest-maps.yandex.ru/v1/suggest?apikey=${e}&results=3&lang=ru_RU&ll=${t}&spn=1,1&attrs=uri&types=house&results=5&text=${this.addressSearchQuery}`),s=await o.json();this.suggestions=s.results||[]}catch{}else this.suggestions=[]},async suggestionSelect(e,t){this.selectedAddress=e,this.addressSearchQuery=e,await this.geocode(t)},async geocode(e){try{this.suggestions=[];const t=this.$heap.state.settings.location.ymapApiKey,o=await fetch(`https://geocode-maps.yandex.ru/1.x?apikey=${t}&format=json&results=1&uri=${e}`),s=await o.json(),l=s.response.GeoObjectCollection.featureMember[0].GeoObject;this.coords=l.Point.pos.split(" ").reverse()}catch(t){console.log(t)}}},async mounted(){this.showed=0,setTimeout(async()=>{await(0,h.wc)(),this.showed=1,document.querySelectorAll(".search input")[0].focus();const e=k.A.geo.lastStoredGet();null!==e&&void 0!==e&&e.location_latitude&&(this.coords=[e.location_latitude,e.location_longitude]);const t=await k.A.geo.get();if(this.markDeviceOnMap&&t){const{coords:e}=t;this.coords=[e.latitude,e.longitude],this.$flash("На карте отмечено ваше местоположение")}},100)}},I=o(6262);const g=(0,I.A)(b,[["render",c],["__scopeId","data-v-ed952a3e"]]);var v=g}}]);
//# sourceMappingURL=3239.063a0600.js.map