"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[988],{988:function(e,t,l){l.r(t),l.d(t,{default:function(){return w}});var r=l(6252),i=l(3577);const o={key:0},u={key:1};function a(e,t,l,a,d,n){const s=(0,r.up)("ion-card-title"),c=(0,r.up)("ion-card-header"),m=(0,r.up)("router-link"),_=(0,r.up)("ion-text"),p=(0,r.up)("ion-checkbox"),h=(0,r.up)("ion-item"),f=(0,r.up)("ion-button"),g=(0,r.up)("ion-card-content"),k=(0,r.up)("ion-card"),w=(0,r.up)("ion-icon"),W=(0,r.up)("ion-toggle"),v=(0,r.up)("ion-label"),y=(0,r.up)("ion-item-divider"),C=(0,r.up)("ion-input"),b=(0,r.up)("ion-textarea"),I=(0,r.up)("ion-list"),U=(0,r.up)("image-tile-comp"),V=(0,r.up)("base-layout");return(0,r.wg)(),(0,r.j4)(V,{"page-title":"Анкета курьера",pageDefaultBackLink:"/user"},{default:(0,r.w5)((()=>[d.courier?(0,r.kq)("",!0):((0,r.wg)(),(0,r.iD)("div",o,[(0,r.Wm)(k,{color:"light"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,null,{default:(0,r.w5)((()=>[(0,r.Wm)(s,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Пока вы не курьер")])),_:1})])),_:1}),(0,r.Wm)(g,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h,{lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(_,null,{default:(0,r.w5)((()=>[(0,r.Uk)(" Подавая заявку вы даете согласие на условия "),(0,r.Wm)(m,{to:"/page/rules-courier"},{default:(0,r.w5)((()=>[(0,r.Uk)("Оферта об оказании услуг доставки")])),_:1})])),_:1}),(0,r.Wm)(p,{slot:"end",modelValue:d.contractAccepted,"onUpdate:modelValue":t[0]||(t[0]=e=>d.contractAccepted=e)},null,8,["modelValue"])])),_:1}),(0,r.Wm)(f,{expand:"block",onClick:t[1]||(t[1]=e=>n.itemCreate()),disabled:!d.contractAccepted},{default:(0,r.w5)((()=>[(0,r.Uk)("Стать курьером")])),_:1},8,["disabled"])])),_:1})])),_:1})])),d.courier?((0,r.wg)(),(0,r.iD)("div",u,[n.message?((0,r.wg)(),(0,r.j4)(k,{key:0,lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{class:(0,i.C_)(n.messageClass)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(n.message),1)])),_:1},8,["class"])])),_:1})):((0,r.wg)(),(0,r.j4)(k,{key:1,lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(g,{style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,r.w5)((()=>[(0,r.Uk)(" Анкета активна. Вы можете открыть смену для приема заказов. ")])),_:1})])),_:1})),(0,r._)("form",{onChange:t[10]||(t[10]=e=>n.updateCourier())},[(0,r.Wm)(I,null,{default:(0,r.w5)((()=>[(0,r.Wm)(h,null,{default:(0,r.w5)((()=>[(0,r.Wm)(w,{src:a.trashOutline,color:"primary",slot:"start"},null,8,["src"]),(0,r.Uk)(" Удалено "),(0,r.Wm)(W,{slot:"end",modelValue:d.is_deleted,"onUpdate:modelValue":t[2]||(t[2]=e=>d.is_deleted=e),color:"danger",onIonChange:t[3]||(t[3]=e=>n.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,r.Wm)(h,null,{default:(0,r.w5)((()=>[(0,r.Wm)(w,{src:a.searchOutline,color:"primary",slot:"start"},null,8,["src"]),(0,r.Uk)(" На модерации "),(0,r.Wm)(W,{slot:"end",modelValue:d.is_disabled,"onUpdate:modelValue":t[4]||(t[4]=e=>d.is_disabled=e),onIonChange:t[5]||(t[5]=e=>n.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,r.Wm)(y,null,{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Основные настройки")])),_:1})])),_:1}),(0,r.Wm)(h,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{position:"stacked",color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Имя")])),_:1}),(0,r.Wm)(C,{modelValue:d.courier.courier_name,"onUpdate:modelValue":t[6]||(t[6]=e=>d.courier.courier_name=e),placeholder:"Имя курьера"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(h,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{position:"stacked",color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Транспорт")])),_:1}),(0,r.Wm)(C,{modelValue:d.courier.courier_vehicle,"onUpdate:modelValue":t[7]||(t[7]=e=>d.courier.courier_vehicle=e),placeholder:"автомобиль, мопед, велосипед"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(h,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{position:"stacked",color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("ИНН")])),_:1}),(0,r.Wm)(C,{modelValue:d.courier.courier_tax_num,"onUpdate:modelValue":t[8]||(t[8]=e=>d.courier.courier_tax_num=e),placeholder:"ИНН курьера"},null,8,["modelValue"])])),_:1}),(0,r.Wm)(h,{lines:"full"},{default:(0,r.w5)((()=>[(0,r.Wm)(v,{position:"stacked",color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)("Комментарий")])),_:1}),(0,r.Wm)(b,{modelValue:d.courier.courier_comment,"onUpdate:modelValue":t[9]||(t[9]=e=>d.courier.courier_comment=e),placeholder:"Цвет, номер авто"},null,8,["modelValue"])])),_:1})])),_:1})],32),d.courier?((0,r.wg)(),(0,r.j4)(I,{key:2},{default:(0,r.w5)((()=>[(0,r.Wm)(y,null,{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Ваше фото")])),_:1})])),_:1}),(0,r.Wm)(U,{images:d.courier.images,image_holder_id:d.courier.courier_id,controller:"Courier",ref:"courierImgs"},null,8,["images","image_holder_id"]),(0,r.Wm)(f,{onClick:t[11]||(t[11]=t=>e.$refs.courierImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{src:a.cameraOutline},null,8,["src"]),(0,r.Uk)(" Добавить ")])),_:1})])),_:1})):(0,r.kq)("",!0),(0,r.Wm)(I,null,{default:(0,r.w5)((()=>[(0,r.Wm)(y,null,{default:(0,r.w5)((()=>[(0,r.Wm)(v,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Информация")])),_:1})])),_:1}),(0,r.Wm)(h,{lines:"none",button:"",detail:"",onClick:t[12]||(t[12]=t=>e.$go("/page/rules-courier"))},{default:(0,r.w5)((()=>[(0,r.Wm)(w,{src:a.documentTextOutline,slot:"start"},null,8,["src"]),(0,r.Wm)(m,{to:"/page/rules-courier"},{default:(0,r.w5)((()=>[(0,r.Uk)("Правила пользования для курьера")])),_:1})])),_:1})])),_:1})])):(0,r.kq)("",!0)])),_:1})}var d=l(8534),n=(l(8862),l(1632)),s=l(8903),c=l(9755),m=l.n(c),_=l(2008),p=l(351),h=l(3914),f={components:{imageTileComp:h.Z,IonTextarea:n.g2,IonInput:n.pK,IonCard:n.PM,IonCardHeader:n.Zi,IonCardTitle:n.Dq,IonCardContent:n.FN,IonLabel:n.Q$,IonItem:n.Ie,IonButton:n.YG,IonList:n.q_,IonCheckbox:n.nz,IonText:n.yW,IonItemDivider:n.rH,IonToggle:n.ho,IonIcon:n.gu},setup(){return{cameraOutline:s.kuq,trashOutline:s.gtu,searchOutline:s.W6I,documentTextOutline:s.L82}},data(){var e,t;return{other_courier_id:null===(e=this.$route)||void 0===e||null===(t=e.query)||void 0===t?void 0:t.courier_id,courier:null,isAdmin:p.Z.isAdmin(),contractAccepted:0,is_deleted:0,is_disabled:0}},ionViewDidEnter(){var e,t,l,r;this.other_courier_id!=(null===(e=this.$route)||void 0===e||null===(t=e.query)||void 0===t?void 0:t.courier_id)&&(this.other_courier_id=null===(l=this.$route)||void 0===l||null===(r=l.query)||void 0===r?void 0:r.courier_id,this.itemGet())},mounted(){this.itemGet()},computed:{message(){return this.courier.deleted_at?"Анкета не активна и будет удалена. Вы можете еще отменить удаление":1==this.courier.is_disabled?"Анкета не активна и находится на рассмотрении у администратора":null},messageClass(){return this.courier.deleted_at?"deleted":1==this.courier.is_disabled?"disabled":null},imageClass(){var e,t;return 1==(null===(e=this.courier)||void 0===e||null===(t=e.images[0])||void 0===t?void 0:t.is_disabled)?"image_disabled":""}},methods:{itemGet(){var e=this;return(0,d.Z)((function*(){e.other_courier_id?e.courier=yield m().post(_.Z.state.hostname+"Courier/itemGet",{courier_id:e.other_courier_id}):e.courier=yield p.Z.courier.get(),e.itemParseFlags()}))()},itemParseFlags(){this.courier&&(this.is_deleted=null==this.courier.deleted_at?0:1,this.is_disabled=0==this.courier.is_disabled?0:1)},itemCreate(){var e=this;return(0,d.Z)((function*(){try{yield m().post(_.Z.state.hostname+"Courier/itemCreate"),yield p.Z.get("full"),e.courier=p.Z.courier.data}catch(t){e.$flash("Не удалось зарегистрироваться как курьер")}}))()},itemDelete(e){var t=this;return(0,d.Z)((function*(){const l=e?"itemDelete":"itemUnDelete";try{yield m().post(_.Z.state.hostname+"Courier/"+l,{courier_id:t.courier.courier_id}),t.courier.deleted_at=e?1:null}catch(r){t.itemGet()}}))()},itemDisable(e){var t=this;return(0,d.Z)((function*(){if(t.courier.is_disabled!=e)try{yield m().post(_.Z.state.hostname+"Courier/itemDisable",{courier_id:t.courier.courier_id,is_disabled:e}),t.courier.is_disabled=e}catch(l){t.itemGet()}}))()},uploadImage(e){var t=this;return(0,d.Z)((function*(){let l=new FormData;l.append("files[]",e.target.files[0]),l.set("image_holder_id",t.courier.courier_id);const r={url:_.Z.state.hostname+"Courier/fileUpload",type:"POST",data:l,processData:!1,contentType:!1};try{yield m().ajax(r),t.itemGet()}catch(i){t.$flash("Не удалось загрузить фото")}}))()},uploadImageTrigger(){m()("#courier_foto_upload").trigger("click")},updateCourier(){var e=this;return(0,d.Z)((function*(){try{return yield m().post(_.Z.state.hostname+"Courier/itemUpdate",JSON.stringify(e.courier))}catch(r){var t,l;const i=JSON.parse(null===(t=r.responseJSON)||void 0===t||null===(l=t.messages)||void 0===l?void 0:l.error);i.courier_tax_num&&e.$flash("Неверный формат ИНН")}}))()}}},g=l(3744);const k=(0,g.Z)(f,[["render",a],["__scopeId","data-v-7ccc5a29"]]);var w=k}}]);
//# sourceMappingURL=988-legacy.882a06c1.js.map