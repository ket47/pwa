{"version":3,"file":"js/366.19956cf2.js","mappings":"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","sources":["webpack://tezkel/./src/components/UserAddressPicker.vue","webpack://tezkel/./src/components/UserAddressPicker.vue?5734","webpack://tezkel/./src/views/UserAddresses.vue","webpack://tezkel/./src/views/UserAddresses.vue?cfef"],"sourcesContent":["<template>\r\n    <ion-header>\r\n        <ion-toolbar>\r\n            <ion-item lines=\"none\">\r\n                <ion-icon :icon=\"locationOutline\" slot=\"start\" />\r\n                <ion-title>Выбор нового адреса</ion-title>\r\n                <ion-icon :icon=\"closeOutline\" @click=\"closeModal();\" slot=\"end\" size=\"large\"/>\r\n            </ion-item>\r\n        </ion-toolbar>\r\n            <ion-button @click=\"pickAddress()\" :disabled=\"!coords\" color=\"primary\" expand=\"block\">\r\n                <ion-icon :src=\"checkmark\" slot=\"start\"/>\r\n                Ок\r\n            </ion-button> \r\n\r\n        <!--<ion-toolbar>\r\n             <ion-button @click=\"pickAddress\" :disabled=\"!selectedPlacemark\" color=\"primary\" expand=\"block\">\r\n                Добавить {{location_group_name_low}} адрес\r\n            </ion-button>             \r\n        </ion-toolbar>-->\r\n            \r\n        </ion-header>\r\n  <ion-content>\r\n    <ion-searchbar id=\"suggest\" placeholder=\"название улицы, номер дома\"/>\r\n    <yandex-map :coords=\"coords\" :zoom=\"16\" @click=\"onClick($event)\" style=\"height:100%\" :settings=\"settings\">\r\n        <ymap-marker :coords=\"coords\" marker-id=\"1\" :properties=\"placemarkProperties\"/>\r\n    </yandex-map>\r\n  </ion-content>\r\n</template>\r\n\r\n<script>\r\nimport { \r\n    IonContent,\r\n    IonToolbar,\r\n    IonButton,\r\n    IonSearchbar,\r\n    IonHeader,\r\n    IonIcon,\r\n    IonTitle,\r\n    IonItem,\r\n    modalController\r\n}                           from \"@ionic/vue\";\r\nimport { yandexMap,ymapMarker,loadYmap }         from \"vue-yandex-maps\";\r\nimport { locationOutline,closeOutline,checkmark }  from 'ionicons/icons';\r\n\r\nexport default({\r\n    components: {\r\n    IonContent,\r\n    IonToolbar,\r\n    IonButton,\r\n    IonSearchbar,\r\n    IonHeader,\r\n    IonIcon,\r\n    IonTitle,\r\n    IonItem,\r\n    yandexMap,\r\n    ymapMarker,\r\n    },\r\n    setup() {\r\n        const closeModal = function(){\r\n            modalController.dismiss();\r\n        };\r\n        return { closeModal, locationOutline,closeOutline,checkmark };\r\n    },\r\n    props: {\r\n\t\tlocation_group_name_low: String,\r\n        location_group_id: Number\r\n    },\r\n    data(){\r\n        let locationType=this.location_group_name_low+\" адрес\"\r\n        let locSettings=this.$heap.state.settings.location;\r\n        let mapCenter=JSON.parse(locSettings.mapCenter)\r\n\r\n        return {\r\n            settings: {\r\n                apiKey: locSettings.ymapApiKey,\r\n                lang: \"ru_RU\",\r\n                coordorder: \"latlong\",\r\n                version: \"2.1\",\r\n            },\r\n            placemarkProperties:{\r\n                iconCaption:locationType\r\n            },\r\n            locationType,\r\n            locSettings,\r\n            selectedPlacemark:0,\r\n            selectedAddress:'',\r\n            selectedCoords:[],\r\n            coords: mapCenter\r\n        };\r\n    },\r\n    methods:{\r\n        async pickAddress(){\r\n            try{\r\n                const result=await window.ymaps.geocode(this.coords)\r\n                this.selectedAddress=result.geoObjects.get(0)?.getAddressLine();\r\n            } catch(err){\r\n                console.log(err)\r\n            }\r\n            var location={\r\n                location_address:this.filterAddress(this.selectedAddress),\r\n                location_latitude:this.coords[0],\r\n                location_longitude:this.coords[1],\r\n            };\r\n            modalController.dismiss(location);\r\n        },\r\n        filterAddress( address ){\r\n            const bannedParts=this.locSettings.addressErase.split(', ')\r\n            const parts=address.split(', ')\r\n            let filtered=[]\r\n            for(const part of parts){\r\n                if(bannedParts.find(pt=>pt==part)){\r\n                    continue\r\n                }\r\n                filtered.push(part)\r\n            }\r\n            return filtered.reverse().join(', ')\r\n        },\r\n        onClick(e) {\r\n            if( !e || !e.get ){\r\n                return\r\n            }\r\n            this.coords=e.get('coords')\r\n        }\r\n    },\r\n    async mounted(){\r\n        await loadYmap();\r\n        let ymaps=window.ymaps\r\n        const mapBoundaries = JSON.parse('['+this.locSettings.mapBoundaries[0]+']');\r\n        const suggestView = new ymaps.SuggestView('suggest',{boundedBy:mapBoundaries});\r\n        suggestView.events.add('select',(e)=>{\r\n            this.selectedAddress=e.get('item').displayName;\r\n            ymaps.geocode(this.selectedAddress).then(res=>{\r\n                this.coords=res.geoObjects.get(0).geometry.getCoordinates();\r\n            });\r\n        });\r\n        this.$flash(\"Получаем местоположение устройства\")\r\n        ymaps.geolocation.get().then(res => {\r\n            this.coords = res.geoObjects.position;\r\n            this.$flash(\"На карте отмечено ваше местоположение\")\r\n        });\r\n    }\r\n});\r\n</script>","import { render } from \"./UserAddressPicker.vue?vue&type=template&id=5eb1425e\"\nimport script from \"./UserAddressPicker.vue?vue&type=script&lang=js\"\nexport * from \"./UserAddressPicker.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<style scoped>\r\n.is_main{\r\n    font-weight: bold;\r\n}\r\n</style>\r\n<template>\r\n  <base-layout page-title=\"Мои адреса\" pageDefaultBackLink=\"/user\" ref=\"UserAddressPage\">\r\n        <ion-card v-if=\"mainAddress\">\r\n          <ion-card-header>\r\n            <ion-card-subtitle>\r\n              Адрес доставки заказа\r\n            </ion-card-subtitle>\r\n          </ion-card-header>\r\n          <ion-card-content>\r\n            <p>Вы выбрали <b style=\"color:var(--ion-color-primary)\">{{mainAddress.location_address}}</b>, как адрес доставки заказов.</p>\r\n            <p>Вы сможете заказать из ресторанов и магазинов в пределах радиуса доставки.</p>\r\n          </ion-card-content>\r\n        </ion-card>\r\n        <ion-card v-else>\r\n          <ion-card-header>\r\n            <ion-card-subtitle>\r\n              Адрес не установлен\r\n            </ion-card-subtitle>\r\n          </ion-card-header>\r\n          <ion-card-content>\r\n            <p>Вы пока не добавили адрес доставки заказа.</p>\r\n            <p>Для поиска ресторанов и магазинов будет использоваться адрес по умолчанию.</p>\r\n          </ion-card-content>\r\n        </ion-card>\r\n\r\n        <ion-list v-if=\"locationList.length\" lines=\"full\">\r\n          <ion-item v-for=\"(location,i) in locationList\" :key=\"location.location_id\">\r\n              <ion-img slot=\"start\" alt=\"location icon\" :src=\"`${$heap.state.hostname}/image/get.php/${location.image_hash}.60.60.png`\" style=\"height:24px\" />\r\n              <ion-label @click=\"locationSetMain(`${location.location_id}`,`${i}`)\" style=\"white-space:normal;cursor:pointer;\"  :class=\"location.is_main==1?'is_main':''\">{{ location.location_address }}</ion-label>\r\n              <ion-icon slot=\"end\" :icon=\"trashOutline\" @click=\"locationDelete(`${location.location_id}`,`${i}`)\"></ion-icon>\r\n          </ion-item>\r\n        </ion-list>\r\n\r\n        <ion-list>\r\n          <ion-list-header>\r\n            <ion-label>Добавить адрес</ion-label>\r\n          </ion-list-header>\r\n          <ion-item  v-for=\"location in locationGroupList\" :key=\"location.group_id\" @click=\"modalLocationCreate(`${location.group_id}`,`${location.group_name}`)\" style=\"cursor:pointer\">\r\n              <ion-img :src=\"`${$heap.state.hostname}/image/get.php/${location.image_hash}.60.60.png`\" style=\"height:24px\"  slot=\"start\"/>\r\n              <ion-label>{{ location.group_name }}</ion-label>\r\n              <ion-icon :src=\"addOutline\" slot=\"end\"/>\r\n          </ion-item>\r\n        </ion-list>\r\n  </base-layout>\r\n</template>\r\n\r\n\r\n<script>\r\nimport {\r\n  IonImg,\r\n  IonLabel,\r\n  IonItem,\r\n  IonList,\r\n  IonListHeader,\r\n  IonIcon,\r\n  IonCard,\r\n  IonCardHeader,\r\n  IonCardContent,\r\n  IonCardSubtitle,\r\n  modalController,\r\n  loadingController,\r\n}                         from \"@ionic/vue\";\r\nimport router             from '@/router';\r\nimport heap               from '@/heap';\r\nimport User               from '@/scripts/User.js'\r\nimport jQuery             from 'jquery';\r\nimport UserAddressPicker  from '@/components/UserAddressPicker.vue';\r\n\r\nimport { locationOutline,trashOutline,addOutline }          from 'ionicons/icons';\r\n\r\n\r\nexport default{\r\n  name: 'UserAddresses',\r\n  components: {\r\n  IonImg,\r\n  IonLabel,\r\n  IonItem,\r\n  IonList,\r\n  IonListHeader,\r\n  IonIcon,\r\n  IonCard,\r\n  IonCardHeader,\r\n  IonCardContent,\r\n  IonCardSubtitle,\r\n  },\r\n  setup(){\r\n    return { locationOutline,trashOutline,addOutline };\r\n  },\r\n  mounted(){\r\n    this.locationListGet();\r\n  },\r\n  computed:{\r\n    mainAddress(){\r\n      return this.locationList?.find(location=>location.is_main==1)\r\n    }\r\n  },\r\n  methods:{\r\n    async modalLocationCreate( location_group_id, location_group_name ) {\r\n      if(!heap.getters.userIsLogged){\r\n        if( confirm('Чтобы добавленный адрес сохранился, необходимо авторизироваться') ){\r\n          router.push('/user/sign-in');\r\n        }\r\n        return;\r\n      }\r\n      var location_group_name_low=String(location_group_name).toLowerCase();\r\n      const modal = await modalController.create({\r\n        component: UserAddressPicker,\r\n        showBackdrop:true,\r\n        backdropDismiss:true,\r\n        canDismiss: true,\r\n        cssClass: 'update-profile-modal',\r\n        presentingElement: this.$refs.UserAddressPage.$el,\r\n        componentProps:{\r\n          location_group_name_low\r\n        },\r\n      });\r\n      modal.onDidDismiss().then(location => {\r\n        this.locationCreate(location_group_id,location.data);\r\n      });\r\n      return modal.present();\r\n    },\r\n    async locationListGet(){\r\n      try{\r\n        let new_location_main=null\r\n        const response=await jQuery.get(heap.state.hostname + \"User/locationListGet\",{includeGroupList:1})\r\n        this.locationList=response.location_list;\r\n        this.locationGroupList=response.location_group_list;\r\n        if(this.locationList){\r\n          for(let loc of this.locationList){\r\n            if(loc.is_main!=1)continue;\r\n              new_location_main=loc;\r\n          }\r\n        }\r\n        if( !new_location_main ){\r\n          /**\r\n           * for some reason main location is not present so reload user data\r\n           */\r\n          User.get()\r\n          return\r\n        }\r\n        if(new_location_main && new_location_main?.location_id!=heap.state.user.location_main?.location_id){\r\n          heap.state.user.location_main=new_location_main\r\n          this.$topic.publish('userMainLocationSet',heap.state.user.location_main)\r\n        }\r\n      }catch{/** */}\r\n    },\r\n    async locationCreate(group_id,location){\r\n      if( !location ){\r\n        return;\r\n      }\r\n      let request={\r\n        location_holder:'user',\r\n        location_holder_id:heap.state.user.user_id,\r\n        location_group_id:group_id,\r\n        location_address:location.location_address,\r\n        location_latitude:location.location_latitude,\r\n        location_longitude:location.location_longitude\r\n      };\r\n      try{\r\n        await jQuery.post(heap.state.hostname + \"User/locationCreate\",request)\r\n        if(this.$heap.state.next_route){\r\n          this.$router.push(this.$heap.state.next_route)\r\n          this.$heap.state.next_route=null\r\n        }\r\n        this.locationListGet();\r\n      } catch(err){\r\n        const exception=err.responseJSON;\r\n        const exception_code=exception.messages.error;\r\n        switch(exception_code){\r\n            case 'limit_exeeded':\r\n                this.$flash(\"Больше адресов добавить нельзя\");\r\n                break;\r\n        }\r\n        return false\r\n      }\r\n    },\r\n    async locationSetMain( location_id, index ){\r\n      var self=this;\r\n      var loc=self.locationList[index];\r\n      heap.state.user.location_main={\r\n        location_id:loc.location_id,\r\n        location_latitude:loc.location_latitude,\r\n        location_altitude:loc.location_altitude,\r\n        location_address:loc.location_address,\r\n        image_hash:loc.image_hash\r\n      };\r\n      router.go(-1);\r\n      await jQuery.post(heap.state.hostname + \"User/locationSetMain\",{location_id});\r\n      this.$topic.publish('userMainLocationSet',heap.state.user.location_main)\r\n    },\r\n    async locationDelete( location_id, index ){\r\n      if(!confirm(\"Удалить адрес доставки?\")){\r\n        return\r\n      }\r\n      try{\r\n        this.locationList.splice(index,1);\r\n        await jQuery.post(heap.state.hostname + \"User/locationDelete\",{location_id})\r\n      }catch{/** */}\r\n      this.locationListGet();\r\n    },\r\n    async locationCurrentSet(){\r\n      const loading = await loadingController.create({\r\n        message: 'Определяем ваше местоположение',\r\n      });\r\n      loading.present();\r\n      try{\r\n        await User.geo.locationCurrentGet()\r\n        this.$flash(\"Ваше местоположение определено\")\r\n      } catch(err){\r\n        console.log(err)\r\n        this.$flash(\"Не удалось получить ваше местоположение\")\r\n      }\r\n      loading.dismiss();\r\n      router.go(-1)\r\n    }\r\n  },\r\n  data(){\r\n    return{\r\n      locationList:[],\r\n      locationGroupList:[]\r\n    }\r\n  }\r\n}\r\n</script>","import { render } from \"./UserAddresses.vue?vue&type=template&id=72814b94&scoped=true\"\nimport script from \"./UserAddresses.vue?vue&type=script&lang=js\"\nexport * from \"./UserAddresses.vue?vue&type=script&lang=js\"\n\nimport \"./UserAddresses.vue?vue&type=style&index=0&id=72814b94&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-72814b94\"]])\n\nexport default __exports__"],"names":["_createVNode","_component_ion_header","_component_ion_toolbar","_component_ion_item","lines","_component_ion_icon","icon","$setup","slot","_component_ion_title","onClick","size","_component_ion_button","$options","disabled","$data","color","expand","src","_component_ion_content","_component_ion_searchbar","id","placeholder","_component_yandex_map","coords","zoom","$event","style","settings","_component_ymap_marker","properties","components","IonContent","IonToolbar","IonButton","IonSearchbar","IonHeader","IonIcon","IonTitle","IonItem","yandexMap","ymapMarker","setup","closeModal","modalController","locationOutline","closeOutline","checkmark","props","location_group_name_low","String","location_group_id","Number","data","locationType","this","locSettings","$heap","state","location","mapCenter","JSON","parse","apiKey","ymapApiKey","lang","coordorder","version","placemarkProperties","iconCaption","selectedPlacemark","selectedAddress","selectedCoords","methods","async","result","window","ymaps","geocode","geoObjects","get","getAddressLine","err","console","log","location_address","filterAddress","location_latitude","location_longitude","address","bannedParts","addressErase","split","parts","filtered","part","find","pt","push","reverse","join","e","loadYmap","mapBoundaries","suggestView","SuggestView","boundedBy","events","add","displayName","then","res","geometry","getCoordinates","$flash","geolocation","position","__exports__","render","_createElementVNode","_createBlock","_component_base_layout","pageDefaultBackLink","ref","_component_ion_card","key","_component_ion_card_header","_component_ion_card_subtitle","_component_ion_card_content","_hoisted_3","_hoisted_5","_hoisted_7","_hoisted_8","length","_component_ion_list","_createElementBlock","_Fragment","i","location_id","_component_ion_img","alt","_ctx","hostname","image_hash","_component_ion_label","class","is_main","_component_ion_list_header","group_id","group_name","name","IonImg","IonLabel","IonList","IonListHeader","IonCard","IonCardHeader","IonCardContent","IonCardSubtitle","trashOutline","addOutline","mounted","locationListGet","computed","mainAddress","locationList","location_group_name","heap","confirm","router","toLowerCase","modal","component","UserAddressPicker","showBackdrop","backdropDismiss","canDismiss","cssClass","presentingElement","$refs","UserAddressPage","$el","componentProps","onDidDismiss","locationCreate","present","new_location_main","response","jQuery","includeGroupList","location_list","locationGroupList","location_group_list","loc","User","$topic","publish","request","location_holder","location_holder_id","next_route","$router","exception","responseJSON","exception_code","messages","error","index","self","location_altitude","splice","loading","loadingController","message","dismiss"],"sourceRoot":""}