"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[5851],{1539:function(e,t,l){l.d(t,{A:function(){return y}});var i=l(641),a=l(33),n=l(3751);const s={style:{position:"absolute",bottom:"10px",width:"100%"}},o={style:{"margin-left":"12px","margin-right":"12px","background-color":"#ffffffdd","--ion-item-background":"#ffffff00","border-top-left-radius":"10px","border-top-right-radius":"10px"}},r={key:0},u={key:1},d={slot:"end",style:{color:"#666"}},c={style:{width:"100%"}},m={style:{display:"grid","grid-template-columns":"1fr 1fr"}};function g(e,t,l,g,p,h){const _=(0,i.g2)("ymap-marker"),k=(0,i.g2)("yandex-map"),f=(0,i.g2)("ion-item"),b=(0,i.g2)("ion-searchbar"),v=(0,i.g2)("ion-content"),y=(0,i.g2)("ion-img"),F=(0,i.g2)("ion-label"),x=(0,i.g2)("ion-segment-button"),C=(0,i.g2)("ion-segment"),I=(0,i.g2)("ion-input"),w=(0,i.g2)("ion-icon"),W=(0,i.g2)("ion-button"),O=(0,i.g2)("ion-toolbar");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(v,null,{default:(0,i.k6)((()=>[p.showed?((0,i.uX)(),(0,i.Wv)(k,{key:0,onClick:t[0]||(t[0]=e=>{h.onClick(e)}),style:{height:"100%"},coords:p.coords,zoom:16,settings:p.settings,controls:["zoomControl"]},{default:(0,i.k6)((()=>[(0,i.bF)(_,{coords:p.coords,"marker-id":"1",properties:h.placemarkProperties},null,8,["coords","properties"])])),_:1},8,["coords","settings"])):(0,i.Q3)("",!0),(0,i.Lk)("div",s,[(0,i.Lk)("div",o,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.suggestions,((e,t)=>((0,i.uX)(),(0,i.Wv)(f,{key:t,onClick:t=>h.suggestionSelect(`${e.subtitle.text}, ${e.title.text}`,e.uri),lines:"full"},{default:(0,i.k6)((()=>[0==t?((0,i.uX)(),(0,i.CE)("p",r,[(0,i.Lk)("b",null,(0,a.v_)(e.subtitle.text)+" "+(0,a.v_)(e.title.text),1)])):((0,i.uX)(),(0,i.CE)("p",u,(0,a.v_)(e.subtitle.text)+" "+(0,a.v_)(e.title.text),1)),(0,i.Lk)("span",d,(0,a.v_)(e.distance.text),1)])),_:2},1032,["onClick"])))),128))]),(0,i.bF)(b,{debounce:"500",modelValue:p.addressSearchQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>p.addressSearchQuery=e),onIonInput:t[2]||(t[2]=e=>h.suggestionsGet()),onKeyup:t[3]||(t[3]=(0,n.jR)((e=>h.pickAddress()),["enter"])),placeholder:"Ð¿Ð¾Ð¸ÑÐº Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ",class:"search"},null,8,["modelValue"])])])),_:1}),(0,i.bF)(O,{style:{"--background":"white"}},{default:(0,i.k6)((()=>[(0,i.Lk)("div",c,[p.locationGroups?((0,i.uX)(),(0,i.Wv)(C,{key:0,mode:"ios",modelValue:p.locationGroup,"onUpdate:modelValue":t[4]||(t[4]=e=>p.locationGroup=e)},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.locationGroups,(t=>((0,i.uX)(),(0,i.Wv)(x,{key:t.group_id,value:t},{default:(0,i.k6)((()=>[(0,i.bF)(y,{src:`${e.$heap.state.hostname}/image/get.php/${t.image_hash}.40.40.png`,style:{height:"18px"}},null,8,["src"]),(0,i.bF)(F,null,{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(t.group_name),1)])),_:2},1024)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])):(0,i.Q3)("",!0),(0,i.bF)(I,{label:"ÐºÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ðº Ð°Ð´Ñ€ÐµÑÑƒ","label-placement":"floating",modelValue:p.addressComment,"onUpdate:modelValue":t[5]||(t[5]=e=>p.addressComment=e)},null,8,["modelValue"]),(0,i.Lk)("div",m,[(0,i.bF)(W,{onClick:t[6]||(t[6]=e=>g.closeModal()),color:"light",expand:"block"},{default:(0,i.k6)((()=>[(0,i.bF)(w,{src:g.closeOutline,slot:"start"},null,8,["src"]),(0,i.eW)(" Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ ")])),_:1}),(0,i.bF)(W,{strong:!0,onClick:t[7]||(t[7]=e=>h.pickAddress()),color:"primary",expand:"block"},{default:(0,i.k6)((()=>[(0,i.bF)(w,{src:g.checkmark,slot:"start"},null,8,["src"]),(0,i.eW)("ÐžÐº ")])),_:1})])])])),_:1})],64)}l(4114);var p=l(5654),h=l(5221),_=l(5480),k=l(8701),f={components:{IonContent:p.W9,IonToolbar:p.ai,IonButton:p.Jm,IonSearchbar:p.S1,IonIcon:p.iq,IonItem:p.uz,IonInput:p.$w,IonSegment:p.Gp,IonSegmentButton:p.eP,IonImg:p.KW,IonLabel:p.he,yandexMap:h.IK,ymapMarker:h.cT},setup(){const e=function(){p.OZ.dismiss()};return{closeModal:e,locationOutline:_.UN$,closeOutline:_.xfX,checkmark:_.AIp}},props:["location_group_name_low","locationGroupList"],data(){var e;let t=this.$heap.state.settings.location,l=JSON.parse(t.mapCenter);return{settings:{apiKey:t.ymapApiKey,lang:"ru_RU",coordorder:"latlong",version:"2.1"},suggestions:[],addressSearchQuery:null,markDeviceOnMap:!0,locationGroup:(null===(e=this.locationGroupList)||void 0===e?void 0:e[0])??null,locationGroups:this.locationGroupList??null,locSettings:t,selectedPlacemark:0,selectedAddress:"",selectedCoords:[],coords:l,addressComment:"",showed:1}},computed:{locationType(){return this.locationGroup?this.locationGroup.group_name+" Ð°Ð´Ñ€ÐµÑ":this.location_group_name_low??"Ð°Ð´Ñ€ÐµÑ"},placemarkProperties(){return{iconCaption:this.locationType}}},methods:{async pickAddress(){var e;try{if(this.suggestions[0]&&(console.log(this.coords),await this.suggestionSelect(this.suggestions[0].title.text,this.suggestions[0].uri),console.log(this.coords)),!this.selectedAddress){var t;const e=await window.ymaps.geocode(this.coords);this.selectedAddress=null===(t=e.geoObjects.get(0))||void 0===t?void 0:t.getAddressLine()}}catch(i){console.log(i)}var l={location_group_id:(null===(e=this.locationGroup)||void 0===e?void 0:e.group_id)??null,location_address:this.filterAddress(this.selectedAddress),location_latitude:this.coords[0],location_longitude:this.coords[1],location_comment:this.addressComment};p.OZ.dismiss(l)},filterAddress(e){const t=this.locSettings.addressErase.split(", "),l=e.split(", ");let i=[];for(const a of l)t.find((e=>e==a))||i.push(a);return i.reverse().join(", ")},onClick(e){e&&e.get&&(this.markDeviceOnMap=!1,this.suggestions=[],this.selectedAddress=null,this.coords=e.get("coords"))},async suggestionsGet(){if(this.markDeviceOnMap=!1,this.addressSearchQuery)try{const e=this.$heap.state.settings.location.ymapSuggestionApiKey,t=this.coords.slice().reverse().join(","),l=await fetch(`https://suggest-maps.yandex.ru/v1/suggest?apikey=${e}&results=3&lang=ru_RU&ll=${t}&spn=1,1&attrs=uri&types=house&results=5&text=${this.addressSearchQuery}`),i=await l.json();this.suggestions=i.results||[]}catch{}else this.suggestions=[]},async suggestionSelect(e,t){this.selectedAddress=e,this.addressSearchQuery=e,await this.geocode(t)},async geocode(e){try{this.suggestions=[];const t=this.$heap.state.settings.location.ymapApiKey,l=await fetch(`https://geocode-maps.yandex.ru/1.x?apikey=${t}&format=json&results=1&uri=${e}`),i=await l.json(),a=i.response.GeoObjectCollection.featureMember[0].GeoObject;this.coords=a.Point.pos.split(" ").reverse()}catch(t){console.log(t)}}},async mounted(){this.showed=0,setTimeout((async()=>{await(0,h.wc)(),this.showed=1,document.querySelectorAll(".search input")[0].focus();const e=k.A.geo.lastStoredGet();null!==e&&void 0!==e&&e.location_latitude&&(this.coords=[e.location_latitude,e.location_longitude]);const t=await k.A.geo.get();if(this.markDeviceOnMap&&t){const{coords:e}=t;this.coords=[e.latitude,e.longitude],this.$flash("ÐÐ° ÐºÐ°Ñ€Ñ‚Ðµ Ð¾Ñ‚Ð¼ÐµÑ‡ÐµÐ½Ð¾ Ð²Ð°ÑˆÐµ Ð¼ÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ")}}),100)}},b=l(6262);const v=(0,b.A)(f,[["render",g],["__scopeId","data-v-2f702511"]]);var y=v},5851:function(e,t,l){l.r(t),l.d(t,{default:function(){return j}});var i=l(641),a=l(33);const n=e=>((0,i.Qi)("data-v-4a267516"),e=e(),(0,i.jt)(),e),s={key:0},o={key:1},r=n((()=>(0,i.Lk)("h4",null,"ÐŸÑ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾ÐºÐ°Ð·",-1))),u=n((()=>(0,i.Lk)("img",{src:"/img/icons/monochrome.png"},null,-1))),d={style:{"font-size":"14px"}},c={class:"max-two-lines"},m={style:{"max-height":"200px",overflow:"hidden","border-radius":"5px","margin-top":"5px"}},g=["src"],p=n((()=>(0,i.Lk)("img",{src:"/img/logo-full.png"},null,-1))),h=["src"],_={class:"ion-margin-vertical ion-text-center"},k={style:{"max-height":"200px",overflow:"hidden","margin-bottom":"10px"}},f=["src"],b={style:{"margin-top":"10px"},class:"max-two-lines"},v=n((()=>(0,i.Lk)("b",null,"Tezkel",-1))),y={class:"ion-padding"},F={key:0},x={key:0,class:"ion-text-center ion-margin-vertical"},C={key:0},I={key:1},w={key:1,class:"ion-text-center ion-margin-vertical"};function W(e,t,l,n,W,O){const $=(0,i.g2)("ion-loading"),S=(0,i.g2)("ion-icon"),L=(0,i.g2)("ion-toggle"),V=(0,i.g2)("ion-item"),X=(0,i.g2)("ion-input"),A=(0,i.g2)("ion-select-option"),D=(0,i.g2)("ion-select"),G=(0,i.g2)("ion-item-divider"),j=(0,i.g2)("ion-label"),U=(0,i.g2)("ion-button"),z=(0,i.g2)("ion-chip"),Q=(0,i.g2)("ion-list"),T=(0,i.g2)("ion-textarea"),E=(0,i.g2)("image-tile-comp"),M=(0,i.g2)("ion-card-content"),K=(0,i.g2)("ion-card"),N=(0,i.g2)("ion-col"),B=(0,i.g2)("ion-avatar"),P=(0,i.g2)("ion-note"),J=(0,i.g2)("ion-card-header"),R=(0,i.g2)("ion-row"),Z=(0,i.g2)("ion-card-title"),q=(0,i.g2)("ion-skeleton-text"),Y=(0,i.g2)("ion-grid"),H=(0,i.g2)("base-layout");return(0,i.uX)(),(0,i.Wv)(H,{pageDefaultBackLink:"/admin/mailing-list","page-title":"Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ"},{default:(0,i.k6)((()=>[(0,i.bF)($,{message:"Dismissing after 3 seconds..."}),(0,i.bF)(Q,null,{default:(0,i.k6)((()=>[(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.layersOutline},null,8,["src"]),(0,i.bF)(L,{onIonChange:t[0]||(t[0]=e=>{e.target.checked?W.mailing.regular_group="signin":W.mailing.regular_group="0",W.mailing.is_delayed=!1,O.itemSave()}),checked:"0"!=W.mailing.regular_group},{default:(0,i.k6)((()=>[(0,i.eW)(" Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð°Ñ Ñ€Ð°ÑÑÑ‹Ð»ÐºÐ° ")])),_:1},8,["checked"])])),_:1}),"0"==W.mailing.regular_group?((0,i.uX)(),(0,i.CE)("div",s,[(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.alarmOutline},null,8,["src"]),(0,i.bF)(L,{onIonChange:t[1]||(t[1]=e=>W.mailing.is_delayed=e.target.checked),checked:W.mailing.is_delayed},{default:(0,i.k6)((()=>[(0,i.eW)("ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ‚Ð¾Ð¼")])),_:1},8,["checked"])])),_:1}),W.mailing.is_delayed?((0,i.uX)(),(0,i.Wv)(V,{key:0},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.alarmOutline},null,8,["src"]),(0,i.bF)(X,{modelValue:W.mailing.start_at,"onUpdate:modelValue":t[2]||(t[2]=e=>W.mailing.start_at=e),type:"datetime-local",min:(new Date).toISOString().slice(0,-8),label:"ÐšÐ¾Ð³Ð´Ð° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ?",onIonChange:t[3]||(t[3]=e=>O.itemSave())},null,8,["modelValue","min"])])),_:1})):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",o,[(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(D,{placeholder:"Ð“Ñ€ÑƒÐ¿Ð¿Ð° Ñ€Ð°ÑÑÑ‹Ð»Ð¾Ðº",label:"Ð“Ñ€ÑƒÐ¿Ð¿Ð° Ñ€Ð°ÑÑÑ‹Ð»Ð¾Ðº",modelValue:W.mailing.regular_group,"onUpdate:modelValue":t[4]||(t[4]=e=>W.mailing.regular_group=e),onIonChange:t[5]||(t[5]=e=>O.itemSave())},{default:(0,i.k6)((()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(W.regularGroupTranslation,((e,t)=>((0,i.uX)(),(0,i.Wv)(A,{value:t,key:e},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.alarmOutline},null,8,["src"]),(0,i.bF)(X,{modelValue:W.mailing.start_at,"onUpdate:modelValue":t[6]||(t[6]=e=>W.mailing.start_at=e),type:"time",label:"Ð’Ð¾ ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÑÑ‚ÑŒ?",onIonChange:t[7]||(t[7]=e=>O.itemSave())},null,8,["modelValue"])])),_:1})])),(0,i.bF)(G,null,{default:(0,i.k6)((()=>[(0,i.eW)(" Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÐµÐ¹ ")])),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.callOutline},null,8,["src"]),(0,i.bF)(X,{modelValue:W.mailing.user_filter.phones,"onUpdate:modelValue":t[8]||(t[8]=e=>W.mailing.user_filter.phones=e),name:"user_filter.phones",label:"Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½Ñ‹",onIonChange:t[9]||(t[9]=e=>O.itemSave(e)),placeholder:"xxxxxxxxxxx,..."},null,8,["modelValue"])])),_:1}),W.mailing.user_filter.location?((0,i.uX)(),(0,i.Wv)(V,{key:2},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.locationOutline},null,8,["src"]),(0,i.bF)(j,{style:{"white-space":"normal",cursor:"pointer"}},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(W.mailing.user_filter.location.location_address),1)])),_:1}),(0,i.bF)(S,{slot:"end",icon:n.trash,onClick:t[10]||(t[10]=e=>O.locationDelete(`${W.mailing.user_filter.location.location_id}`))},null,8,["icon"])])),_:1})):((0,i.uX)(),(0,i.Wv)(V,{key:3},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.locationOutline},null,8,["src"]),(0,i.bF)(j,null,{default:(0,i.k6)((()=>[(0,i.eW)("Ð›Ð¾ÐºÐ°Ñ†Ð¸Ñ")])),_:1}),W.mailing.user_filter.location?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(U,{key:0,onClick:t[11]||(t[11]=e=>O.modalLocationCreate()),color:"light",expand:"block"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{src:n.locationOutline},null,8,["src"]),(0,i.eW)(" Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð°Ð´Ñ€ÐµÑ ")])),_:1}))])),_:1})),W.mailing.user_filter.location?((0,i.uX)(),(0,i.Wv)(V,{key:4,lines:"none"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.locateOutline},null,8,["src"]),(0,i.bF)(X,{modelValue:W.mailing.user_filter.radius,"onUpdate:modelValue":t[12]||(t[12]=e=>W.mailing.user_filter.radius=e),name:"user_filter.radius",label:"Ð Ð°Ð´Ð¸ÑƒÑ Ð²Ð¾ÐºÑ€ÑƒÐ³ Ð»Ð¾ÐºÐ°Ñ†Ð¸Ð¸ ÐºÐ¼"},null,8,["modelValue"])])),_:1})):(0,i.Q3)("",!0),(0,i.bF)(V,{lines:"none"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.pieChartOutline},null,8,["src"]),W.mailing.recieverCount.all>0?((0,i.uX)(),(0,i.Wv)(z,{key:0},{default:(0,i.k6)((()=>[(0,i.eW)("Ð’ÑÐµÐ³Ð¾ "+(0,a.v_)(W.mailing.recieverCount.all),1)])),_:1})):(0,i.Q3)("",!0),W.mailing.recieverCount.sent>0?((0,i.uX)(),(0,i.Wv)(z,{key:1,color:"success"},{default:(0,i.k6)((()=>[(0,i.eW)("ÐŸÐ¾ÑÐ»Ð°Ð½Ð¾ "+(0,a.v_)(W.mailing.recieverCount.sent),1)])),_:1})):(0,i.Q3)("",!0),W.mailing.recieverCount.failed>0?((0,i.uX)(),(0,i.Wv)(z,{key:2,color:"danger"},{default:(0,i.k6)((()=>[(0,i.eW)("ÐžÑˆÐ¸Ð±ÐºÐ° "+(0,a.v_)(W.mailing.recieverCount.failed),1)])),_:1})):(0,i.Q3)("",!0)])),_:1}),(0,i.bF)(G,null,{default:(0,i.k6)((()=>[(0,i.eW)(" Ð¡Ð¿Ð¾ÑÐ¾Ð± Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ ")])),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.mailOutline},null,8,["src"]),(0,i.bF)(D,{label:"Ð¢Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚",modelValue:W.mailing.transport,"onUpdate:modelValue":t[13]||(t[13]=e=>W.mailing.transport=e),onIonChange:t[14]||(t[14]=e=>O.itemSave())},{default:(0,i.k6)((()=>[(0,i.bF)(A,{value:"push"},{default:(0,i.k6)((()=>[(0,i.eW)("ðŸ–¼ï¸ Push")])),_:1}),(0,i.bF)(A,{value:"email"},{default:(0,i.k6)((()=>[(0,i.eW)("ðŸ“§ Email")])),_:1}),(0,i.bF)(A,{value:"sms"},{default:(0,i.k6)((()=>[(0,i.eW)("ðŸ’¬ Sms")])),_:1}),(0,i.bF)(A,{value:"telegram"},{default:(0,i.k6)((()=>[(0,i.eW)("ðŸ–º Telegram")])),_:1})])),_:1},8,["modelValue"])])),_:1}),(0,i.bF)(G,null,{default:(0,i.k6)((()=>[(0,i.eW)(" Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ ")])),_:1})])),_:1}),(0,i.bF)(Y,null,{default:(0,i.k6)((()=>[(0,i.bF)(R,null,{default:(0,i.k6)((()=>[(0,i.bF)(N,{size:"12","size-sm":"6"},{default:(0,i.k6)((()=>[(0,i.bF)(K,null,{default:(0,i.k6)((()=>[(0,i.bF)(M,null,{default:(0,i.k6)((()=>[(0,i.Lk)("form",{onChange:t[21]||(t[21]=(...e)=>O.itemSave&&O.itemSave(...e))},[(0,i.bF)(Q,{lines:"full"},{default:(0,i.k6)((()=>{var e,l;return[(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(X,{modelValue:W.mailing.subject_template,"onUpdate:modelValue":t[15]||(t[15]=e=>W.mailing.subject_template=e),ref:"subject_template",placeholder:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº",label:"Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº","label-placement":"stacked",disabled:O.isSubjectDisabled},null,8,["modelValue","disabled"])])),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(T,{modelValue:W.mailing.text_template,"onUpdate:modelValue":t[16]||(t[16]=e=>W.mailing.text_template=e),ref:"text_template",placeholder:"Ð¢ÐµÐºÑÑ‚ (Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾)",label:"Ð¢ÐµÐºÑÑ‚","label-placement":"stacked"},null,8,["modelValue"])])),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(X,{modelValue:W.mailing.link,"onUpdate:modelValue":t[17]||(t[17]=e=>W.mailing.link=e),label:"Ð¡ÑÑ‹Ð»ÐºÐ°",ref:"link","label-placement":"stacked",disabled:O.isLinkDisabled},null,8,["modelValue","disabled"])])),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)((()=>[(0,i.bF)(D,{onIonChange:t[18]||(t[18]=e=>O.itemSave()),label:"Ð Ð¸Ð½Ð³Ñ‚Ð¾Ð½","label-placement":"stacked",modelValue:W.mailing.sound,"onUpdate:modelValue":t[19]||(t[19]=e=>W.mailing.sound=e),value:"default",disabled:O.isRingtoneDisabled},{default:(0,i.k6)((()=>[(0,i.bF)(A,{value:""},{default:(0,i.k6)((()=>[(0,i.eW)("-")])),_:1}),(0,i.bF)(A,{value:"default"},{default:(0,i.k6)((()=>[(0,i.eW)("ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚")])),_:1}),(0,i.bF)(A,{value:"short.wav"},{default:(0,i.k6)((()=>[(0,i.eW)("ÐšÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹")])),_:1}),(0,i.bF)(A,{value:"medium.wav"},{default:(0,i.k6)((()=>[(0,i.eW)("Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹")])),_:1}),(0,i.bF)(A,{value:"long.wav"},{default:(0,i.k6)((()=>[(0,i.eW)("Ð”Ð»Ð¸Ð½Ð½Ñ‹Ð¹")])),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),(0,i.bF)(E,{images:null===(e=W.mailing)||void 0===e?void 0:e.images,image_holder:"mailing",image_holder_id:null===(l=W.mailing)||void 0===l?void 0:l.mailing_id,hide_if_empty:"true",controller:"Admin/Mailing",ref:"mailingImgs",onOnChange:O.imageChange},null,8,["images","image_holder_id","onOnChange"]),(0,i.bF)(V,{lines:"none",onClick:t[20]||(t[20]=e=>this.$refs.mailingImgs.take_photo())},{default:(0,i.k6)((()=>[(0,i.bF)(S,{src:n.addOutline,slot:"start"},null,8,["src"]),(0,i.eW)(" Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð¾Ñ‚Ð¾ ")])),_:1})]})),_:1})],32)])),_:1})])),_:1})])),_:1}),(0,i.bF)(N,{size:"12","size-sm":"6"},{default:(0,i.k6)((()=>[r,"push"==W.mailing.transport||"telegram"==W.mailing.transport?((0,i.uX)(),(0,i.Wv)(K,{key:0,class:"preview-card"},{default:(0,i.k6)((()=>[(0,i.bF)(M,null,{default:(0,i.k6)((()=>[(0,i.bF)(V,{class:"ion-no-padding",lines:"none"},{default:(0,i.k6)((()=>[(0,i.bF)(B,{slot:"start",style:{"--border-radius":"5px",width:"25px",height:"25px"}},{default:(0,i.k6)((()=>[u])),_:1}),(0,i.bF)(j,null,{default:(0,i.k6)((()=>[(0,i.bF)(P,{style:{"font-size":"12px"}},{default:(0,i.k6)((()=>[(0,i.eW)("Tezkel 00:00")])),_:1}),(0,i.Lk)("div",null,[(0,i.Lk)("b",d,(0,a.v_)(W.mailing.subject_template),1),(0,i.Lk)("span",c,(0,a.v_)(W.mailing.text_template),1)])])),_:1})])),_:1}),(0,i.Lk)("div",m,[W.mailing.image?((0,i.uX)(),(0,i.CE)("img",{key:0,src:W.mailing.image},null,8,g)):(0,i.Q3)("",!0)])])),_:1})])),_:1})):(0,i.Q3)("",!0),"email"==W.mailing.transport?((0,i.uX)(),(0,i.Wv)(K,{key:1,class:"preview-card"},{default:(0,i.k6)((()=>[(0,i.bF)(J,null,{default:(0,i.k6)((()=>[(0,i.bF)(V,{class:"ion-no-padding",lines:"none"},{default:(0,i.k6)((()=>[(0,i.bF)(B,{slot:"start",style:{"--border-radius":"5px",width:"25px",height:"25px"}},{default:(0,i.k6)((()=>[p])),_:1}),(0,i.bF)(j,null,{default:(0,i.k6)((()=>[(0,i.bF)(P,{style:{"font-size":"12px"}},{default:(0,i.k6)((()=>[(0,i.eW)("Tezkel â—‹ "+(0,a.v_)(W.mailing.start_at),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,i.bF)(M,{style:{"padding-left":"55px"}},{default:(0,i.k6)((()=>[(0,i.bF)(R,{class:"ion-justify-content-center"},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{src:`${e.$heap.state.hostname}img/tezbanner.jpg`,width:"450px"},null,8,h)])),_:1}),(0,i.bF)(R,{class:"ion-justify-content-center ion-margin-vertical"},{default:(0,i.k6)((()=>[(0,i.bF)(Z,{style:{"font-size":"14px"}},{default:(0,i.k6)((()=>[(0,i.Lk)("b",null,(0,a.v_)(W.mailing.subject_template),1)])),_:1})])),_:1}),(0,i.Lk)("div",_,[(0,i.Lk)("div",k,[W.mailing.image?((0,i.uX)(),(0,i.CE)("img",{key:0,style:{height:"200px","border-radius":"5px"},src:W.mailing.image},null,8,f)):(0,i.Q3)("",!0)]),(0,i.Lk)("span",b,(0,a.v_)(W.mailing.text_template),1)]),(0,i.bF)(R,{class:"ion-justify-content-center"},{default:(0,i.k6)((()=>[(0,i.bF)(q,{animated:!0,style:{width:"80%"}})])),_:1}),(0,i.bF)(R,{class:"ion-justify-content-center"},{default:(0,i.k6)((()=>[(0,i.bF)(q,{animated:!0,style:{width:"50%"}})])),_:1})])),_:1})])),_:1})):(0,i.Q3)("",!0),"sms"==W.mailing.transport?((0,i.uX)(),(0,i.Wv)(K,{key:2,class:"preview-card"},{default:(0,i.k6)((()=>[(0,i.bF)(J,null,{default:(0,i.k6)((()=>[(0,i.bF)(V,{class:"ion-no-padding",lines:"none"},{default:(0,i.k6)((()=>[(0,i.bF)(j,{slot:"start"},{default:(0,i.k6)((()=>[v])),_:1}),(0,i.bF)(j,{slot:"end"},{default:(0,i.k6)((()=>[(0,i.bF)(P,{style:{"font-size":"12px"}},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(W.mailing.start_at),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,i.bF)(M,{style:{"padding-top":"0"}},{default:(0,i.k6)((()=>[(0,i.bF)(Z,{style:{"font-size":"14px"}},{default:(0,i.k6)((()=>[(0,i.eW)((0,a.v_)(W.mailing.text_template),1)])),_:1})])),_:1})])),_:1})):(0,i.Q3)("",!0)])),_:1})])),_:1})])),_:1}),(0,i.Lk)("div",y,[W.mailing.transport?((0,i.uX)(),(0,i.CE)("div",F,["0"==W.mailing.regular_group?((0,i.uX)(),(0,i.CE)("div",x,["0"==W.mailing.is_started?((0,i.uX)(),(0,i.Wv)(U,{key:0,onClick:t[22]||(t[22]=e=>O.itemStart()),expand:"block"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.playOutline},null,8,["src"]),W.mailing.is_delayed?((0,i.uX)(),(0,i.CE)("span",C,"Ð—Ð°Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ")):((0,i.uX)(),(0,i.CE)("span",I,"ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ"))])),_:1})):((0,i.uX)(),(0,i.Wv)(U,{key:1,onClick:t[23]||(t[23]=e=>O.itemStart("restart")),color:"warning",expand:"block"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.refreshOutline},null,8,["src"]),(0,i.eW)(" ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ")])),_:1}))])):((0,i.uX)(),(0,i.CE)("div",w,[(0,i.bF)(U,{onClick:t[24]||(t[24]=e=>O.itemStart()),expand:"block"},{default:(0,i.k6)((()=>[(0,i.bF)(S,{slot:"start",src:n.saveOutline},null,8,["src"]),(0,i.eW)(" Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ ")])),_:1})]))])):(0,i.Q3)("",!0),(0,i.bF)(U,{onClick:t[25]||(t[25]=e=>O.itemDelete()),color:"danger",fill:"clear",expand:"block"},{default:(0,i.k6)((()=>[(0,i.eW)("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ")])),_:1})])])),_:1})}var O=l(5654),$=l(5480),S=l(2311),L=l.n(S),V=l(4933),X=l(1539),A={components:{ImageTileComp:V.A,IonList:O.nf,IonItem:O.uz,IonLabel:O.he,IonIcon:O.iq,IonButton:O.Jm,IonInput:O.$w,IonTextarea:O.nc,IonCard:O.b_,IonCardTitle:O.tN,IonCardHeader:O.ME,IonCardContent:O.I9,IonSelect:O.Nm,IonSelectOption:O.Ip,IonGrid:O.lO,IonRow:O.ln,IonCol:O.hU,IonChip:O.ZB,IonToggle:O.BY,IonAvatar:O.mC,IonNote:O.JI,IonSkeletonText:O.ds,IonLoading:O.rQ,IonItemDivider:O.Dg},setup(){return{addOutline:$.EKF,refreshOutline:$.mVv,imageOutline:$.ETD,closeOutline:$.xfX,playOutline:$.zsx,saveOutline:$.oc8,locationOutline:$.UN$,trash:$.dco,callOutline:$.bNN,locateOutline:$.jew,mailOutline:$.SM1,pieChartOutline:$.p1S,alarmOutline:$.WYB,layersOutline:$.z8i}},data(){return{openedAccordion:"message",mailingId:this.$route.params.id,mailing:{transport:"push",regular_group:0,is_started:0,sound:null,user_filter:{},recieverCount:0},saveClock:null,regularGroupTranslation:{cart23:"ÐšÐ¾Ñ€Ð·Ð¸Ð½Ð° Ð±Ñ€Ð¾ÑˆÐµÐ½Ð° ÑÑƒÑ‚ÐºÐ¸","promo-10":"Ð”Ð¾ ÐºÐ¾Ð½Ñ†Ð° ÑÐºÐ¸Ð´ÐºÐ¸ 10 Ð´Ð½ÐµÐ¹","promo-3":"Ð”Ð¾ ÐºÐ¾Ð½Ñ†Ð° ÑÐºÐ¸Ð´ÐºÐ¸ 3 Ð´Ð½Ñ","promo-1":"Ð”Ð¾ ÐºÐ¾Ð½Ñ†Ð° ÑÐºÐ¸Ð´ÐºÐ¸ 1 Ð´ÐµÐ½ÑŒ",forgot14:"ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð²Ñ…Ð¾Ð´ 2 Ð½ÐµÐ´ÐµÐ»Ð¸ Ð½Ð°Ð·Ð°Ð´",forgot30:"ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð²Ñ…Ð¾Ð´ Ð¼ÐµÑÑÑ† Ð½Ð°Ð·Ð°Ð´",forgot90:"ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ Ð²Ñ…Ð¾Ð´ 3 Ð¼ÐµÑÑÑ†Ð° Ð½Ð°Ð·Ð°Ð´",every_monday:"ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð¿Ð¾Ð½ÐµÐ´ÐµÐ»ÑŒÐ½Ð¸Ðº",every_tuesday:"ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ð²Ñ‚Ð¾Ñ€Ð½Ð¸Ðº",every_wednesday:"ÐšÐ°Ð¶Ð´ÑƒÑŽ ÑÑ€ÐµÐ´Ñƒ",every_thursday:"ÐšÐ°Ð¶Ð´Ñ‹Ð¹ Ñ‡ÐµÑ‚Ð²ÐµÑ€Ð³",every_friday:"ÐšÐ°Ð¶Ð´ÑƒÑŽ Ð¿ÑÑ‚Ð½Ð¸Ñ†Ñƒ",every_saturday:"ÐšÐ°Ð¶Ð´ÑƒÑŽ ÑÑƒÐ±Ð±Ð¾Ñ‚Ñƒ",every_sunday:"ÐšÐ°Ð¶Ð´Ð¾Ðµ Ð²Ð¾ÑÐºÑ€ÐµÑÐµÐ½ÑŒÐµ"}}},computed:{isPhotoDisabled(){return"sms"==this.mailing.transport},isSubjectDisabled(){return"sms"==this.mailing.transport},isRingtoneDisabled(){return"sms"==this.mailing.transport||"email"==this.mailing.transport},isLinkDisabled(){return"sms"==this.mailing.transport}},methods:{async itemGet(){let e={mailing_id:this.mailingId};try{const t=await L().post(`${this.$heap.state.hostname}Admin/Mailing/itemGet`,e);t.user_filter??(t.user_filter={}),"0"!==t.regular_group?t.start_at=new Date(t.start_at).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit"}):t.is_delayed=new Date(t.start_at)>new Date,this.mailing=t}catch{}},async itemSave(e){clearTimeout(this.saveClock),this.saveClock=setTimeout((async()=>{var t,l;await this.itemUpdate(),e&&(null===(t=e.target)||void 0===t||null===(l=t.name)||void 0===l?void 0:l.indexOf("user_filter"))>-1&&this.recieverListCreate()}),500)},async imageChange(e){if(e){this.mailing.image="";var t=e.find((e=>null==e.deleted_at));t&&t.length>0&&(this.mailing.image=`${this.$heap.state.hostname}image/get.php/${t[0].image_hash}.500.500.webp`)}},async itemUpdate(){var e;let t=this.mailing;"0"!==t.regular_group&&(null===(e=t.start_at)||void 0===e?void 0:e.length)<10&&(t.start_at="1999-07-01 "+t.start_at+":00");try{await L().post(`${this.$heap.state.hostname}Admin/Mailing/itemUpdate`,JSON.stringify(t)),this.$flash("ðŸ’¾ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾"),this.itemGet()}catch{this.$flash("ÐžÑˆÐ¸Ð±ÐºÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ")}},async itemDelete(){if(!confirm("Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ñ‹?"))return;const e={mailing_id:this.mailing.mailing_id};try{await L().post(`${this.$heap.state.hostname}Admin/Mailing/itemDelete`,e),this.$go({name:"MailingList"})}catch{}},itemValidate(){var e,t;if(!this.mailing.is_delayed||this.mailing.start_at)if(0!=this.mailing.regular_group||null!==(e=this.mailing)&&void 0!==e&&null!==(t=e.user_filter)&&void 0!==t&&t.phones)if(this.mailing.subject_template||"email"!=this.mailing.transport){if(!this.mailing.text_template)return this.$refs.text_template.$el.classList.add("ion-invalid"),void alert("Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ Ð½Ðµ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾");if(this.mailing.transport)return!0;alert("Ð¢Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚ Ð½Ðµ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½")}else alert("Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº Ð½Ðµ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½");else alert("ÐŸÐ¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»Ð¸ Ð½Ðµ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹");else alert("ÐÐ°Ñ‡Ð°Ð»Ð¾ Ñ€Ð°ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ðµ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾")},async itemStart(e=""){if(!this.itemValidate()||!confirm(`Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÑÑ‹Ð»ÐºÑƒ Ð² ${this.mailing.start_at}?`))return;const t={mailing_id:this.mailing.mailing_id,mode:e};try{await L().post(`${this.$heap.state.hostname}Admin/Mailing/itemStart`,t),this.itemGet()}catch(a){var l,i;const e=null===a||void 0===a||null===(l=a.responseJSON)||void 0===l||null===(i=l.messages)||void 0===i?void 0:i.error;switch(e){case"empty_recievers":this.$flash("ÐÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ñ€Ð°ÑÑÑ‹Ð»ÐºÐ¸. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€");break;default:this.$flash("ÐžÑ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð½Ðµ ÑƒÐ´Ð°Ð»Ð°ÑÑŒ")}return!1}},async modalLocationCreate(){if(!this.$heap.state.user.user_id)return this.$flash("Ð§Ñ‚Ð¾Ð±Ñ‹ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð°Ð´Ñ€ÐµÑÐ° ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ð»Ð¸ÑÑŒ, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð²Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ Ð² ÑÐ¸ÑÑ‚ÐµÐ¼Ñƒ"),void this.$go({name:"UserSignIn"});var e="Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¹";const t=await O.OZ.create({component:X.A,showBackdrop:!0,backdropDismiss:!0,componentProps:{location_group_name_low:e}});await t.present();const l=await t.onDidDismiss();l&&(this.mailing.user_filter.location=l.data,this.recieverListCreate())},async locationDelete(e){try{this.mailing.user_filter.location=null,this.recieverListCreate()}catch{this.$flash("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð°Ð´Ñ€ÐµÑ Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ")}},async recieverListCreate(){try{const e={mailing_id:this.mailing.mailing_id};await this.itemUpdate();const t=await L().post(this.$heap.state.hostname+"Admin/Mailing/recieverListCreate",e);this.$flash(`Ð’ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¾ ${t} Ð·Ð°Ð¿Ð¸ÑÑŒ`),this.itemGet(this.mailing.mailing_id)}catch{this.$flash("Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð¿Ð¾Ð»ÑƒÑ‡Ð°Ñ‚ÐµÐ»ÐµÐ¹ Ð½Ðµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ")}}},mounted(){this.itemGet()}},D=l(6262);const G=(0,D.A)(A,[["render",W],["__scopeId","data-v-4a267516"]]);var j=G}}]);
//# sourceMappingURL=5851.74ec5705.js.map