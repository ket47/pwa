"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[459],{8459:function(e,t,i){i.r(t),i.d(t,{default:function(){return C}});var n=i(6252);const s=(0,n.Uk)("Уведомления заблокированы вами"),a=(0,n.Uk)(" К сожалению, мы не сможем уведомлять вас о статусах заказов "),o=(0,n.Uk)("Подписаться на уведомления"),u=(0,n.Uk)("Уведомления не разрешены"),l=(0,n.Uk)(" Чтобы вовремя узнавать об изменениях статусов заказов, подпишитесь на уведомления "),r=(0,n.Uk)("Подписаться на уведомления"),d={key:2},c=(0,n.Uk)("Вы подписаны на уведомления"),f=(0,n._)("p",null,"Вам будут приходить некоторые уведомления",-1),p=(0,n.Uk)("Темы уведомлений"),m=(0,n.Uk)("Статусы заказов"),h=(0,n.Uk)("Начисленные бонусы");function w(e,t,i,w,k,_){const g=(0,n.up)("ion-card-title"),b=(0,n.up)("ion-card-header"),W=(0,n.up)("ion-button"),v=(0,n.up)("ion-card-content"),y=(0,n.up)("ion-card"),I=(0,n.up)("ion-item-divider"),C=(0,n.up)("ion-item"),U=(0,n.up)("ion-list"),$=(0,n.up)("base-layout");return(0,n.wg)(),(0,n.j4)($,{pageTitle:"Уведомления"},{default:(0,n.w5)((()=>["denied"==k.permission?((0,n.wg)(),(0,n.j4)(y,{key:0,color:"danger"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[s])),_:1})])),_:1}),(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[a,(0,n._)("p",null,[(0,n.Wm)(W,{onClick:t[0]||(t[0]=e=>_.subscribe()),expand:"full"},{default:(0,n.w5)((()=>[o])),_:1})])])),_:1})])),_:1})):(0,n.kq)("",!0),"default"==k.permission?((0,n.wg)(),(0,n.j4)(y,{key:1,color:"warning"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[u])),_:1})])),_:1}),(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[l,(0,n._)("p",null,[(0,n.Wm)(W,{onClick:t[1]||(t[1]=e=>_.subscribe()),expand:"full"},{default:(0,n.w5)((()=>[r])),_:1})])])),_:1})])),_:1})):(0,n.kq)("",!0),k.registered?((0,n.wg)(),(0,n.iD)("div",d,[(0,n.Wm)(y,{color:"success"},{default:(0,n.w5)((()=>[(0,n.Wm)(b,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,null,{default:(0,n.w5)((()=>[c])),_:1})])),_:1}),(0,n.Wm)(v,null,{default:(0,n.w5)((()=>[f])),_:1})])),_:1}),(0,n.Wm)(U,null,{default:(0,n.w5)((()=>[(0,n.Wm)(I,null,{default:(0,n.w5)((()=>[p])),_:1}),(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[m])),_:1}),(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[h])),_:1})])),_:1})])):(0,n.kq)("",!0)])),_:1})}var k=i(5503),_=i(1146),g=i(7391),b=i(9755),W=i.n(b),v={components:{IonButton:g.YG,IonCard:g.PM,IonCardHeader:g.Zi,IonCardTitle:g.Dq,IonCardContent:g.FN,IonList:g.q_,IonItem:g.Ie,IonItemDivider:g.rH},data(){return{permission:Notification.permission,registered:!1}},methods:{async saveNotificationToken(){if("granted"==this.permission&&this.$heap.state.user.user_id>0&&this.$heap.state.settings?.firebase&&!this.registered)try{const e=this.$heap.state.settings.firebase.vapidKey,t=(0,_.KL)(),i=await(0,_.LP)(t,{vapidKey:e}),n={type:"webpush",registration_id:i,user_agent:navigator.userAgent};await W().post(`${this.$heap.state.hostname}MessageSub/itemCreate`,n),this.registered=!0}catch(e){console.log(e)}},async subscribe(){try{this.permission=await Notification.requestPermission(),"granted"==this.permission&&this.saveNotificationToken()}catch(e){this.$flash("Вы не разрешили уведомлять вас")}},init(){this.$heap.state?.settings?.firebase&&(0,k.ZF)(this.$heap.state.settings.firebase)}},mounted(){const e=this;this.$topic.on("settingsGet",(function(){e.init(),e.saveNotificationToken()})),this.$topic.on("userGet",(function(){e.saveNotificationToken()})),e.init(),e.saveNotificationToken()}},y=i(3744);const I=(0,y.Z)(v,[["render",w]]);var C=I}}]);
//# sourceMappingURL=459.54d346b1.js.map