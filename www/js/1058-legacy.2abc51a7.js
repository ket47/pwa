"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[1058],{4480:function(e,t,n){var r=n(2109),i=n(2092).filter,o=n(1194),a=o("filter");r({target:"Array",proto:!0,forced:!a},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},7327:function(e,t,n){n.d(t,{Z:function(){return m}});var r=n(6252),i=n(3577),o=(0,r.Uk)("Просмотр фотографии");function a(e,t,n,a,s,u){var l=(0,r.up)("ion-title"),c=(0,r.up)("ion-icon"),d=(0,r.up)("ion-toolbar"),m=(0,r.up)("ion-header"),p=(0,r.up)("ion-button"),f=(0,r.up)("ion-col"),h=(0,r.up)("ion-row"),_=(0,r.up)("ion-grid"),g=(0,r.up)("ion-img"),w=(0,r.up)("ion-content");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(m,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(d,{color:"secondary"},{default:(0,r.w5)((function(){return[(0,r.Wm)(l,null,{default:(0,r.w5)((function(){return[o]})),_:1}),(0,r.Wm)(c,{icon:a.closeOutline,onClick:t[0]||(t[0]=function(e){a.closeModal()}),slot:"end",size:"large"},null,8,["icon"])]})),_:1})]})),_:1}),(0,r.Wm)(w,null,{default:(0,r.w5)((function(){return[n.actions?((0,r.wg)(),(0,r.j4)(_,{key:0},{default:(0,r.w5)((function(){return[(0,r.Wm)(h,null,{default:(0,r.w5)((function(){return[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(n.actions,(function(e,t){return(0,r.wg)(),(0,r.j4)(f,{key:t},{default:(0,r.w5)((function(){var n;return[e[0]?((0,r.wg)(),(0,r.j4)(p,{key:0,onClick:function(n){return u.actionCreate(t,e[1])},expand:"block",color:null!==(n=e[1])&&void 0!==n?n:"primary"},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,i.zw)(e[0]),1)]})),_:2},1032,["onClick","color"])):(0,r.kq)("",!0)]})),_:2},1024)})),128))]})),_:1})]})),_:1})):(0,r.kq)("",!0),(0,r.Wm)(g,{src:e.$heap.state.hostname+"image/get.php/"+n.image_hash+".1000.1000.webp"},null,8,["src"])]})),_:1})],64)}var s=n(8903),u=n(8292),l={props:["image_hash","actions"],components:{IonIcon:u.gu,IonToolbar:u.sr,IonHeader:u.Gu,IonImg:u.Xz,IonContent:u.W2,IonTitle:u.wd,IonButton:u.YG,IonCol:u.wI,IonRow:u.Nd,IonGrid:u.jY},setup(){var e=function(){u.Fy.dismiss()};return{closeModal:e,closeOutline:s.fID}},methods:{actionCreate(e,t){("danger"!=t||confirm("Вы уверены?"))&&u.Fy.dismiss(null,e)}}},c=n(3744);const d=(0,c.Z)(l,[["render",a]]);var m=d},1058:function(e,t,n){n.r(t),n.d(t,{default:function(){return b}});n(4480),n(1539);var r=n(6252),i=n(3577),o=(0,r.Uk)(" Картинки "),a=(0,r.Uk)(" Товары "),s=(0,r.Uk)(" Магазины "),u=(0,r.Uk)(" Курьеры "),l=(0,r.Uk)(" Ничего не найдено ");function c(e,t,n,c,d,m){var p=(0,r.up)("ion-segment-button"),f=(0,r.up)("ion-segment"),h=(0,r.up)("ion-searchbar"),_=(0,r.up)("ion-img"),g=(0,r.up)("ion-thumbnail"),w=(0,r.up)("ion-text"),k=(0,r.up)("ion-label"),v=(0,r.up)("ion-item"),b=(0,r.up)("ion-list"),y=(0,r.up)("ion-skeleton-text"),I=(0,r.up)("ion-card-content"),x=(0,r.up)("ion-card"),Z=(0,r.up)("ion-infinite-scroll-content"),T=(0,r.up)("ion-infinite-scroll"),$=(0,r.up)("base-layout");return(0,r.wg)(),(0,r.j4)($,{pageDefaultBackLink:"/user","page-title":"Модерация"},{default:(0,r.w5)((function(){return[(0,r.Wm)(f,{"swipe-gesture":"true",modelValue:d.moderationType,"onUpdate:modelValue":t[0]||(t[0]=function(e){return d.moderationType=e}),onIonChange:t[1]||(t[1]=function(e){return m.listTypeChanged(e)})},{default:(0,r.w5)((function(){return[(0,r.Wm)(p,{value:"images"},{default:(0,r.w5)((function(){return[o]})),_:1}),(0,r.Wm)(p,{value:"products"},{default:(0,r.w5)((function(){return[a]})),_:1}),(0,r.Wm)(p,{value:"stores"},{default:(0,r.w5)((function(){return[s]})),_:1}),(0,r.Wm)(p,{value:"couriers"},{default:(0,r.w5)((function(){return[u]})),_:1})]})),_:1},8,["modelValue"]),(0,r._)("div",null,["stores"==d.moderationType||"products"==d.moderationType||"couriers"==d.moderationType?((0,r.wg)(),(0,r.j4)(h,{key:0,placeholder:"Фильтр",modelValue:d.filter,"onUpdate:modelValue":t[2]||(t[2]=function(e){return d.filter=e})},null,8,["modelValue"])):(0,r.kq)("",!0),m.listComputed.length>0?((0,r.wg)(),(0,r.j4)(b,{key:1},{default:(0,r.w5)((function(){return[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(m.listComputed,(function(t){return(0,r.wg)(),(0,r.j4)(v,{key:t.item_id,button:"",detail:"",onClick:function(e){return m.itemEdit(t)}},{default:(0,r.w5)((function(){return[(0,r.Wm)(g,{slot:"start",class:(0,i.C_)(t.class)},{default:(0,r.w5)((function(){return[(0,r.Wm)(_,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.50.50.webp`},null,8,["src"])]})),_:2},1032,["class"]),(0,r.Wm)(w,null,{default:(0,r.w5)((function(){return[(0,r.Uk)((0,i.zw)(t.item_name),1)]})),_:2},1024),(0,r.Wm)(k,{slot:"end"},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,i.zw)(t.date_time),1)]})),_:2},1024)]})),_:2},1032,["onClick"])})),128))]})),_:1})):1==d.is_loading?((0,r.wg)(),(0,r.j4)(b,{key:2},{default:(0,r.w5)((function(){return[((0,r.wg)(),(0,r.iD)(r.HY,null,(0,r.Ko)([1,2,3],(function(e){return(0,r.Wm)(v,{key:e,button:"",detail:""},{default:(0,r.w5)((function(){return[(0,r.Wm)(g,{slot:"start",style:{"background-color":"lightgray"}}),(0,r.Wm)(y,{animated:""})]})),_:2},1024)})),64))]})),_:1})):((0,r.wg)(),(0,r.j4)(x,{key:3,color:"light"},{default:(0,r.w5)((function(){return[(0,r.Wm)(I,null,{default:(0,r.w5)((function(){return[l]})),_:1})]})),_:1})),(0,r.Wm)(T,{onIonInfinite:t[3]||(t[3]=function(e){return m.listLoadMore(e)}),id:"moderation-infinite-scroll"},{default:(0,r.w5)((function(){return[(0,r.Wm)(Z,{"loading-spinner":"bubbles","loading-text":"Loading more data..."})]})),_:1})])]})),_:1})}var d=n(6835),m=n(8534),p=n(8439),f=(n(5069),n(2222),n(8292)),h=n(9755),_=n.n(h),g=n(7327),w={components:{IonInfiniteScroll:f.ju,IonInfiniteScrollContent:f.MB,IonItem:f.Ie,IonLabel:f.Q$,IonList:f.q_,IonSegmentButton:f.GO,IonSegment:f.cJ,IonImg:f.Xz,IonThumbnail:f.Bs,IonText:f.yW,IonSkeletonText:f.CK,IonCard:f.PM,IonCardContent:f.FN,IonSearchbar:f.VI},data(){return{items:[],filter:"",is_loading:0,moderationType:"images",holders:{store:"Поставщик",courier:"Курьер",product:"Товар",order:"Заказ",product_group_list:"Категория товара",location_group_list:"Категория местоп.",store_group_list:"Категория поставщ.",user_group_list:"Категория пользователя"}}},computed:{listComputed(){var e,t=(0,p.Z)(this.items);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.image_hash=n.image_hash||n.courier_photo_image_hash,n.item_id=n.image_id||n.store_id||n.courier_id||n.product_id,n.item_name=this.holders[n.image_holder]||n.store_name||n.user_name||n.product_name,n.date_time=this.toLocDateTime(n.updated_at),n.class=n.deleted_at?"deleted":""}}catch(r){t.e(r)}finally{t.f()}return this.items}},methods:{listLoadMore(e){var t=this;return(0,m.Z)((0,d.Z)().mark((function n(){return(0,d.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.listLoad();case 2:e.target.complete();case 3:case"end":return n.stop()}}),n)})))()},listReload(){var e=this;return(0,m.Z)((0,d.Z)().mark((function t(){return(0,d.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.items=[],e.listLoad();case 2:case"end":return t.stop()}}),t)})))()},listLoad(){var e=this;return(0,m.Z)((0,d.Z)().mark((function t(){var n,r,i;return(0,d.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n={is_disabled:1,is_active:0,name_query:e.filter,offset:e.items.length,limit:15,order:"updated_at"},t.prev=1,e.is_loading=1,"images"!=e.moderationType){t.next=9;break}return t.next=6,_().post(`${e.$heap.state.hostname}Image/listGet`,n);case 6:r=t.sent,t.next=32;break;case 9:if("products"!=e.moderationType){t.next=18;break}return n.name_query_fields="product_name,product_description,product_barcode,product_code",n.reverse="validity",t.next=14,_().post(`${e.$heap.state.hostname}Product/listGet`,n);case 14:i=t.sent,r=i.product_list,t.next=32;break;case 18:if("stores"!=e.moderationType){t.next=26;break}return n.name_query_fields="store_name,store_description",n.reverse="validity",t.next=23,_().post(`${e.$heap.state.hostname}Store/listGet`,n);case 23:r=t.sent,t.next=32;break;case 26:if("couriers"!=e.moderationType){t.next=32;break}return n.name_query_fields="courier_vehicle,user_phone,user_name",n.order="courier_list.updated_at",t.next=31,_().post(`${e.$heap.state.hostname}Courier/listGet`,n);case 31:r=t.sent;case 32:e.is_loading=0,e.items=e.items.concat(r),t.next=38;break;case 36:t.prev=36,t.t0=t["catch"](1);case 38:case"end":return t.stop()}}),t,null,[[1,36]])})))()},listTypeChanged(e){e.target.value;this.items=[],this.listLoad()},listFilter(){clearTimeout(this.clock);var e=this;this.clock=setTimeout((function(){e.listReload()}),300)},toLocDate(e){var t=new Date(Date.parse(e)),n={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,n)},toLocDateTime(e){var t=new Date(Date.parse(e)),n={month:"short",day:"numeric",hour:"numeric",minute:"numeric"};return t.toLocaleDateString(void 0,n)},itemEdit(e){"images"==this.moderationType&&this.imageEdit(e),"products"==this.moderationType&&this.$router.push("/catalog/product-edit-"+e.product_id),"stores"==this.moderationType&&this.$router.push("/catalog/store-edit-"+e.store_id),"couriers"==this.moderationType&&this.$router.push("/user/courier-dashboard?courier_id="+e.courier_id)},imageEdit(e){var t=this;return(0,m.Z)((0,d.Z)().mark((function n(){var r,i,o;return(0,d.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={delete:["Удалить","danger"],postpone:["Потом","primary"],enable:["Ок","success"]},n.next=3,f.Fy.create({component:g.Z,componentProps:{image_hash:e.image_hash,actions:r},initialBreakpoint:.75,breakpoints:[.75,1]});case 3:return i=n.sent,t.$topic.on("dismissModal",(function(){i.dismiss()})),i.present(),n.next=8,i.onDidDismiss();case 8:if(o=n.sent,"delete"!=o.role){n.next=12;break}return n.next=12,t.imageDelete(e);case 12:if("enable"!=o.role){n.next=15;break}return n.next=15,t.imageEnable(e);case 15:if("postpone"!=o.role){n.next=18;break}return n.next=18,t.imagePostpone(e);case 18:t.listReload();case 19:case"end":return n.stop()}}),n)})))()},imageEnable(e){var t=this;return(0,m.Z)((0,d.Z)().mark((function n(){return(0,d.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,_().post(`${t.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:0});case 2:case"end":return n.stop()}}),n)})))()},imagePostpone(e){var t=this;return(0,m.Z)((0,d.Z)().mark((function n(){return(0,d.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,_().post(`${t.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:0});case 2:return n.next=4,_().post(`${t.$heap.state.hostname}Image/itemDisable`,{image_id:e.image_id,is_disabled:1});case 4:case"end":return n.stop()}}),n)})))()},imageDelete(e){var t=this;return(0,m.Z)((0,d.Z)().mark((function n(){return(0,d.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,_().post(`${t.$heap.state.hostname}Image/itemDelete`,{image_id:e.image_id});case 2:case"end":return n.stop()}}),n)})))()}},mounted(){this.listLoad()},watch:{filter:function(){this.listFilter()}}},k=n(3744);const v=(0,k.Z)(w,[["render",c],["__scopeId","data-v-0d87ad34"]]);var b=v}}]);
//# sourceMappingURL=1058-legacy.2abc51a7.js.map