"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[886],{2126:function(e,t,o){o.d(t,{Z:function(){return v}});var i=o(6252),l=o(3577);const a=(0,i.Uk)("Фотографии"),r={key:0,class:"image_grid"},s=["onClick"],n={key:0},d={key:1},u={key:0,class:"image_controls"};function c(e,t,o,c,m,p){const _=(0,i.up)("ion-label"),h=(0,i.up)("ion-icon"),g=(0,i.up)("ion-item"),k=(0,i.up)("ion-img"),w=(0,i.up)("ion-avatar");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",null,[(0,i.Wm)(g,{lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(_,null,{default:(0,i.w5)((()=>[a])),_:1}),m.editMode?((0,i.wg)(),(0,i.j4)(h,{key:0,slot:"end",icon:c.settingsSharp,color:"primary",onClick:t[0]||(t[0]=e=>m.editMode=0)},null,8,["icon"])):((0,i.wg)(),(0,i.j4)(h,{key:1,slot:"end",icon:c.settingsOutline,onClick:t[1]||(t[1]=e=>{m.editMode=1,p.load()})},null,8,["icon"]))])),_:1}),p.imageList?.length?((0,i.wg)(),(0,i.iD)("div",r,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(p.imageList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.image_id,style:{position:"relative"}},[(0,i._)("div",{style:{position:"absolute",top:"0px","background-color":"#fffc","font-size":"0.75em"},onClick:e=>p.imagePreview(t.image_hash)},[t.deleted_at?((0,i.wg)(),(0,i.iD)("div",n,"будет удалено")):1==t.is_disabled?((0,i.wg)(),(0,i.iD)("div",d,"на модерации")):(0,i.kq)("",!0)],8,s),(0,i.Wm)(w,{onClick:e=>p.imagePreview(t.image_hash),class:(0,l.C_)(t.class)},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),m.editMode?((0,i.wg)(),(0,i.iD)("div",u,[(0,i.Wm)(h,{icon:c.chevronBackCircleOutline,onClick:e=>p.back(t)},null,8,["icon","onClick"]),p.isAdmin&&1==t.is_disabled?((0,i.wg)(),(0,i.j4)(h,{key:0,icon:c.checkmarkCircle,color:"success",onClick:e=>p.enable(t)},null,8,["icon","onClick"])):(0,i.kq)("",!0),t.deleted_at?((0,i.wg)(),(0,i.j4)(h,{key:1,icon:c.trash,color:"success",onClick:e=>p.restore(t)},null,8,["icon","onClick"])):((0,i.wg)(),(0,i.j4)(h,{key:2,icon:c.trashBin,color:"danger",onClick:e=>p.remove(t)},null,8,["icon","onClick"])),(0,i.Wm)(h,{icon:c.chevronForwardCircleOutline,onClick:e=>p.forward(t)},null,8,["icon","onClick"])])):(0,i.kq)("",!0)])))),128))])):(0,i.kq)("",!0)]),(0,i._)("input",{type:"file",id:"foto_upload",accept:"image/*",onChange:t[2]||(t[2]=e=>p.uploadImage(e)),style:{display:"none"}},null,32)],64)}var m=o(8903),p=o(3064);const _=(0,i.Uk)("Просмотр фотографии");function h(e,t,o,l,a,r){const s=(0,i.up)("ion-title"),n=(0,i.up)("ion-icon"),d=(0,i.up)("ion-toolbar"),u=(0,i.up)("ion-header"),c=(0,i.up)("ion-img"),m=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Wm)(s,null,{default:(0,i.w5)((()=>[_])),_:1}),(0,i.Wm)(n,{icon:l.closeOutline,onClick:t[0]||(t[0]=e=>{l.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,{src:e.$heap.state.hostname+"image/get.php/"+o.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var g={props:["image_hash"],components:{IonLabel:p.Q$,IonIcon:p.gu,IonToolbar:p.sr,IonHeader:p.Gu,IonImg:p.Xz,IonContent:p.W2,IonTitle:p.wd},setup(){const e=function(){p.Fy.dismiss()};return{closeModal:e,closeOutline:m.fID}}},k=o(3744);const w=(0,k.Z)(g,[["render",h]]);var f=w,I=o(9755),y=o.n(I),W=o(9042),b=o(351),C={props:["images","image_holder_id","controller"],components:{IonLabel:p.Q$,IonIcon:p.gu,IonItem:p.Ie,IonImg:p.Xz,IonAvatar:p.BJ},setup(){return{settingsOutline:m.C$N,settingsSharp:m.kiF,chevronBackCircleOutline:m.CK0,chevronForwardCircleOutline:m.esm,trashBin:m.UQi,trash:m._Ij,checkmarkCircle:m.I1A}},data(){return{images_loaded:null,editMode:!1}},computed:{imageList(){let e=this.images_loaded||this.images,t=[];for(let o in e)e[o].deleted_at?(e[o].class=" deleted",this.editMode&&t.push(e[o])):1==e[o].is_disabled?(e[o].class=" disabled",this.editMode&&t.push(e[o])):t.push(e[o]);return t},isAdmin(){return b.Z.isAdmin()}},methods:{async back(e){try{await y().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),this.load()}catch{}},async forward(e){try{await y().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),this.load()}catch{}},async remove(e){try{await y().post(this.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено в корзину и будет удалено")}catch{}},async restore(e){try{await y().post(this.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено извлечено из корзины")}catch{}},async enable(e){try{await y().post(this.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),this.load()}catch{}},async load(){const e={image_holder_id:this.image_holder_id,image_holder:this.controller,is_disabled:1,is_deleted:1,is_active:1};this.images_loaded=await y().post(this.$heap.state.hostname+"Image/listGet",e)},async imagePreview(e){const t=await p.Fy.create({component:f,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[.5,1]}),o=function(){t.dismiss()};return W.Z.on("dismissModal",o),t.present()},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.image_holder_id);const o={url:this.$heap.state.hostname+this.controller+"/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await y().ajax(o),this.load()}catch(i){if("limit_exeeded"==i?.responseJSON?.messages?.error)return void this.$flash("Уже загружено максимальное количество фото");this.$flash("Не удалось загрузить фото")}},take_photo(){y()("#foto_upload").trigger("click"),this.editMode=!0}}};const U=(0,k.Z)(C,[["render",c],["__scopeId","data-v-4609f3b7"]]);var v=U},8886:function(e,t,o){o.r(t),o.d(t,{default:function(){return J}});var i=o(6252),l=o(3577);const a=(0,i.Uk)(" Удалено "),r=(0,i.Uk)(" На модерации "),s=(0,i.Uk)(" Вести учет остатков "),n=(0,i.Uk)(" Вернуться в Магазин "),d=(0,i.Uk)(" Управление магазином "),u=(0,i.Uk)("Основные настройки"),c=(0,i.Uk)("Название"),m=(0,i.Uk)("Описание"),p=(0,i.Uk)("Артикул"),_=(0,i.Uk)("Остаток "),h={key:0},g=(0,i.Uk)("Единица"),k=(0,i.Uk)("Мин. заказ "),w={key:0},f=(0,i.Uk)("Вес единицы (кг)"),I=(0,i.Uk)("Цена"),y=(0,i.Uk)("Цена"),W=(0,i.Uk)("Цена акционная"),b=(0,i.Uk)("Начало акции"),C=(0,i.Uk)("Конец акции"),U=(0,i.Uk)("Изображения товара"),v=(0,i.Uk)(" Добавить "),G=(0,i.Uk)("Категории товара"),V=(0,i.Uk)("Добавить в категорию");function D(e,t,o,D,L,O){const $=(0,i.up)("ion-card-content"),q=(0,i.up)("ion-card"),M=(0,i.up)("ion-icon"),z=(0,i.up)("ion-toggle"),P=(0,i.up)("ion-item"),j=(0,i.up)("ion-item-divider"),Z=(0,i.up)("ion-list"),F=(0,i.up)("ion-label"),B=(0,i.up)("ion-textarea"),T=(0,i.up)("ion-input"),x=(0,i.up)("ion-item-group"),H=(0,i.up)("image-tile-comp"),A=(0,i.up)("ion-button"),Y=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(Y,{"page-title":L.productItem?.product_name??"Товар","page-default-back-link":"/product-"+this.productId},{default:(0,i.w5)((()=>[O.message?((0,i.wg)(),(0,i.j4)(q,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)($,{class:(0,l.C_)(O.messageClass)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(O.message),1)])),_:1},8,["class"])])),_:1})):(0,i.kq)("",!0),L.productItem?((0,i.wg)(),(0,i.j4)(Z,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.trashOutline,color:"primary",slot:"start"},null,8,["src"]),a,(0,i.Wm)(z,{slot:"end",modelValue:L.is_deleted,"onUpdate:modelValue":t[0]||(t[0]=e=>L.is_deleted=e),color:"danger",onIonChange:t[1]||(t[1]=e=>O.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.searchOutline,color:"primary",slot:"start"},null,8,["src"]),r,(0,i.Wm)(z,{slot:"end",modelValue:L.is_disabled,"onUpdate:modelValue":t[2]||(t[2]=e=>L.is_disabled=e),onIonChange:t[3]||(t[3]=e=>O.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.pizzaOutline,color:"primary",slot:"start"},null,8,["src"]),s,(0,i.Wm)(z,{slot:"end",modelValue:L.is_counted,"onUpdate:modelValue":t[4]||(t[4]=e=>L.is_counted=e),onIonChange:t[5]||(t[5]=e=>O.save("is_counted",e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(j),(0,i.Wm)(P,{button:"",onClick:t[6]||(t[6]=t=>e.$router.push("store-"+L.productItem.store_id))},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.chevronBack,slot:"start"},null,8,["src"]),n])),_:1}),(0,i.Wm)(P,{button:"",onClick:t[7]||(t[7]=t=>e.$router.push("store-edit-"+L.productItem.store_id))},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.chevronBack,slot:"start"},null,8,["src"]),d])),_:1})])),_:1})):(0,i.kq)("",!0),L.productItem?((0,i.wg)(),(0,i.iD)("form",{key:2,onChange:t[19]||(t[19]=(...e)=>O.saveForm&&O.saveForm(...e))},[(0,i.Wm)(Z,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[u])),_:1})])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{position:"stacked",color:"primary"},{default:(0,i.w5)((()=>[c])),_:1}),(0,i.Wm)(B,{modelValue:L.productItem.product_name,"onUpdate:modelValue":t[8]||(t[8]=e=>L.productItem.product_name=e),name:"product_name",placeholder:"полное название товара"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{position:"stacked",color:"primary"},{default:(0,i.w5)((()=>[m])),_:1}),(0,i.Wm)(B,{modelValue:L.productItem.product_description,"onUpdate:modelValue":t[9]||(t[9]=e=>L.productItem.product_description=e),name:"product_description",rows:"6",placeholder:"характеристики, свойства, состав товара"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[p])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_code,"onUpdate:modelValue":t[10]||(t[10]=e=>L.productItem.product_code=e),name:"product_code",slot:"end",placeholder:"код товара"},null,8,["modelValue"])])),_:1}),L.is_counted?((0,i.wg)(),(0,i.j4)(P,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[_,L.productItem.product_unit?((0,i.wg)(),(0,i.iD)("span",h,"("+(0,l.zw)(L.productItem.product_unit)+")",1)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_quantity,"onUpdate:modelValue":t[11]||(t[11]=e=>L.productItem.product_quantity=e),name:"product_quantity",slot:"end",placeholder:"в наличии"},null,8,["modelValue"])])),_:1})):(0,i.kq)("",!0),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[g])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_unit,"onUpdate:modelValue":t[12]||(t[12]=e=>L.productItem.product_unit=e),name:"product_unit",slot:"end",placeholder:"шт,кг и т.д."},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[k,L.productItem.product_unit?((0,i.wg)(),(0,i.iD)("span",w,"("+(0,l.zw)(L.productItem.product_unit)+")",1)):(0,i.kq)("",!0)])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_quantity_min,"onUpdate:modelValue":t[13]||(t[13]=e=>L.productItem.product_quantity_min=e),name:"product_quantity_min",type:"number",inputmode:"numeric",pattern:"\\d\\.",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[f])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_weight,"onUpdate:modelValue":t[14]||(t[14]=e=>L.productItem.product_weight=e),name:"product_weight",type:"number",step:"0.1",inputmode:"numeric",pattern:"\\d\\.",slot:"end"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,i.Wm)(Z,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[I])),_:1})])),_:1})])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[y])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_price,"onUpdate:modelValue":t[15]||(t[15]=e=>L.productItem.product_price=e),name:"product_price",type:"number",inputmode:"numeric",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[W])),_:1}),(0,i.Wm)(T,{modelValue:L.productItem.product_promo_price,"onUpdate:modelValue":t[16]||(t[16]=e=>L.productItem.product_promo_price=e),name:"product_promo_price",type:"number",inputmode:"numeric",slot:"end",color:"success"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[b])),_:1}),(0,i.Wm)(T,{type:"date",modelValue:L.productItem.product_promo_start,"onUpdate:modelValue":t[17]||(t[17]=e=>L.productItem.product_promo_start=e),name:"product_promo_start",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(P,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,{color:"primary"},{default:(0,i.w5)((()=>[C])),_:1}),(0,i.Wm)(T,{type:"date",modelValue:L.productItem.product_promo_finish,"onUpdate:modelValue":t[18]||(t[18]=e=>L.productItem.product_promo_finish=e),name:"product_promo_finish",slot:"end"},null,8,["modelValue"])])),_:1})])),_:1})],32)):(0,i.kq)("",!0),L.productItem?((0,i.wg)(),(0,i.j4)(Z,{key:3},{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[U])),_:1})])),_:1}),(0,i.Wm)(H,{images:L.productItem.images,image_holder_id:L.productItem.product_id,controller:"Product",ref:"productImgs"},null,8,["images","image_holder_id"]),(0,i.Wm)(A,{onClick:t[20]||(t[20]=t=>e.$refs.productImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.cameraOutline},null,8,["src"]),v])),_:1})])),_:1})):(0,i.kq)("",!0),O.categoryList?((0,i.wg)(),(0,i.j4)(Z,{key:4},{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[G])),_:1})])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(O.categoryList,(e=>((0,i.wg)(),(0,i.j4)(P,{key:e.group_id},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.compassOutline,slot:"start",color:"primary"},null,8,["src"]),(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.group_name),1)])),_:2},1024),(0,i.Wm)(M,{src:D.trashOutline,slot:"end",onClick:t=>O.categoryDelete(e.group_id,e.group_name)},null,8,["src","onClick"])])),_:2},1024)))),128)),(0,i.Wm)(P,{button:"",onClick:t[21]||(t[21]=e=>O.categoryAdd())},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{src:D.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,i.Wm)(F,null,{default:(0,i.w5)((()=>[V])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1},8,["page-title","page-default-back-link"])}var L=o(3064),O=o(8903),$=o(2126);const q=(0,i.Uk)("Категории"),M=(0,i.Uk)("Готово");function z(e,t,o,a,r,s){const n=(0,i.up)("ion-title"),d=(0,i.up)("ion-icon"),u=(0,i.up)("ion-toolbar"),c=(0,i.up)("ion-button"),m=(0,i.up)("ion-header"),p=(0,i.up)("ion-img"),_=(0,i.up)("ion-avatar"),h=(0,i.up)("ion-label"),g=(0,i.up)("ion-checkbox"),k=(0,i.up)("ion-item"),w=(0,i.up)("ion-item-divider"),f=(0,i.up)("ion-list"),I=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(n,null,{default:(0,i.w5)((()=>[q])),_:1}),(0,i.Wm)(d,{slot:"end",onClick:t[0]||(t[0]=e=>{s.closeModal()}),icon:a.closeCircle,size:"large",color:"medium"},null,8,["icon"])])),_:1}),(0,i.Wm)(c,{onClick:t[1]||(t[1]=e=>{s.closeModal()}),color:"medium",expand:"full"},{default:(0,i.w5)((()=>[M])),_:1})])),_:1}),(0,i.Wm)(I,null,{default:(0,i.w5)((()=>[r.groupList?((0,i.wg)(),(0,i.j4)(f,{key:0},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(r.groupList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.group_id},[t.group_parent_id>0?((0,i.wg)(),(0,i.j4)(k,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{slot:"start"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".50.50.webp"},null,8,["src"])])),_:2},1024),(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.group_name),1)])),_:2},1024),(0,i.Wm)(g,{slot:"end",checked:t.is_marked,onClick:e=>s.mimickChage(e.target,t.group_id)},null,8,["checked","onClick"])])),_:2},1024)):((0,i.wg)(),(0,i.j4)(w,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i._)("b",null,(0,l.zw)(t.group_name),1)])),_:2},1024)])),_:2},1024))])))),128))])),_:1})):(0,i.kq)("",!0)])),_:1})],64)}var P=o(9755),j=o.n(P),Z={props:["controller","memberId","memberOfIds","memberLimit"],components:{IonCheckbox:L.nz,IonContent:L.W2,IonHeader:L.Gu,IonToolbar:L.sr,IonTitle:L.wd,IonIcon:L.gu,IonButton:L.YG,IonImg:L.Xz,IonAvatar:L.BJ,IonLabel:L.Q$,IonItemDivider:L.rH,IonList:L.q_,IonItem:L.Ie},setup(){return{closeCircle:O.XZx}},data(){return{groupList:null,checkedGroupList:[]}},created(){this.listGroupGet(),this.checkedGroupList=this.memberOfIds||[]},methods:{async listGroupGet(){this.groupList=await j().get(this.$heap.state.hostname+this.controller+"/listGroupGet"),this.itemMarkGroups()},itemMarkGroups(){if(this.groupList)try{for(let e of this.groupList)e.is_marked=this.checkedGroupList.includes(e.group_id)?1:0}catch{}},async itemUpdateGroup(e,t){const o={[this.controller.toLowerCase()+"_id"]:this.memberId,is_joined:e,group_id:t};try{await j().post(this.$heap.state.hostname+this.controller+"/itemUpdateGroup",o)}catch(i){this.$flash("Не удалось сохранить изменение")}},mimickChage(e,t){const o=this;setTimeout((()=>{o.groupChanged(e,t)}),0)},async groupChanged(e,t){const o=e.checked?1:0;if(o){if(this.checkedGroupList.length>=this.memberLimit)return this.$flash(`Можно выбрать не больше ${this.memberLimit} категорий`),void(e.checked=0);this.checkedGroupList.push(t)}else this.checkedGroupList=this.checkedGroupList.filter((function(e,o,i){return e!=t}));this.itemUpdateGroup(o,t)},closeModal(){L.Fy.dismiss(this.checkedGroupList)}}},F=o(3744);const B=(0,F.Z)(Z,[["render",z]]);var T=B,x=o(2008),H=o(9042),A={components:{IonInput:L.pK,IonTextarea:L.g2,IonCard:L.PM,IonCardContent:L.FN,IonToggle:L.ho,IonIcon:L.gu,IonItem:L.Ie,IonList:L.q_,IonLabel:L.Q$,IonItemDivider:L.rH,IonItemGroup:L.Ub,IonButton:L.YG,imageTileComp:$.Z},setup(){return{cameraOutline:O.kuq,trashOutline:O.gtu,searchOutline:O.W6I,personOutline:O.QJ7,addOutline:O.s6O,pizzaOutline:O.fqo,compassOutline:O.gmD,chevronBack:O.Mny}},data(){return{productId:this.$route.params.id,productItem:null,productGroupList:null,is_groups_marked:0,is_deleted:0,is_disabled:0,is_counted:0}},computed:{message(){return this.productItem?.deleted_at?"Товар не активен и будет удален. Вы еще можете отменить удаление":1==this.productItem?.is_disabled?"Товар не активен и находится на рассмотрении у администратора":1!=this.productItem?.is_counted?"Товар активен и готов к продаже. Товар произодится вами, например еда":"Товар активен и готов к продаже."},messageClass(){return this.productItem?.deleted_at?"deleted":1==this.productItem?.is_disabled?"disabled":1!=this.productItem?.is_counted?"primary":"active"},categoryList(){let e=[];try{let t=this.productItem.member_of_groups.group_ids.split(","),o=this.productItem.member_of_groups.group_names.split(",");for(let i in t)e.push({group_id:t[i],group_name:o[i]})}catch{}return e}},created(){this.listGroupGet(),this.itemGet()},methods:{async itemGet(){try{let e=await j().post(x.Z.state.hostname+"Product/itemGet",{product_id:this.productId});this.productItem=this.itemPrepare(e),this.itemParseFlags(),this.itemMarkGroups()}catch{}},itemPrepare(e){return e.product_promo_start&&(e.product_promo_start=e.product_promo_start.split(" ")[0]),e.product_promo_finish&&(e.product_promo_finish=e.product_promo_finish.split(" ")[0]),e},itemParseFlags(){this.is_deleted=null==this.productItem.deleted_at?0:1,this.is_disabled=0==this.productItem.is_disabled?0:1,this.is_counted=0==this.productItem.is_counted?0:1},async itemDelete(e){const t=e?"itemDelete":"itemUnDelete";try{await j().post(x.Z.state.hostname+"Product/"+t,{product_id:this.productId}),this.productItem.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.productItem.is_disabled!=e)try{await j().post(x.Z.state.hostname+"Product/itemDisable",{product_id:this.productId,is_disabled:e}),this.productItem.is_disabled=e}catch{this.itemGet()}},saveForm(e){const t=e.target.name,o=this.productItem[t]=e.target.value;this.save(t,o)},async save(e,t){let o={product_id:this.productId,[e]:t};try{await j().post(x.Z.state.hostname+"Product/itemUpdate",JSON.stringify(o)),this.productItem[e]=t,this.itemParseFlags()}catch(i){const e=i.responseJSON.messages.error;e?.includes("product_description")?this.$flash("Описание слишком короткое"):e?.includes("product_name")?this.$flash("Название слишком короткое"):this.$flash("Не удалось сохранить изменение"),this.itemGet()}},categoryDelete(e,t){if(confirm("Исключить товар из категории "+t+"?"))try{this.itemUpdateGroup(0,e)}catch{}},async categoryAdd(){const e=this.productItem?.member_of_groups?.group_ids?.split(",")||[],t=await L.Fy.create({component:T,componentProps:{controller:"Product",memberId:this.productId,memberOfIds:e,memberLimit:1},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});t.present(),H.Z.on("dismissModal",(()=>{t.dismiss()})),await t.onDidDismiss(),this.itemGet()},async itemUpdateGroup(e,t){const o={product_id:this.productId,is_joined:e,group_id:t};try{await j().post(x.Z.state.hostname+"Product/itemUpdateGroup",o)}catch(i){this.$flash("Не удалось сохранить изменение")}this.itemGet()},async listGroupGet(){try{this.productGroupList=await j().get(x.Z.state.hostname+"Product/listGroupGet"),this.itemMarkGroups()}catch{}}}};const Y=(0,F.Z)(A,[["render",D],["__scopeId","data-v-791f5b86"]]);var J=Y}}]);
//# sourceMappingURL=886.6e7950d6.js.map