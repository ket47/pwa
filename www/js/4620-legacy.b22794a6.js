"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[4620],{4535:function(e,t,l){l.d(t,{Z:function(){return I}});var a=l(6252),n=l(3577);const u=(0,a.Uk)("Баланс"),o=(0,a.Uk)("Настройки"),i=(0,a.Uk)("Начальная дата"),r={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},s=(0,a.Uk)("Обороты"),d={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},c=(0,a.Uk)("Конечная дата"),m={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},g=(0,a.Uk)(" Нет операций в данном периоде ");function p(e,t,l,p,w,_){const h=(0,a.up)("ion-title"),f=(0,a.up)("ion-text"),y=(0,a.up)("ion-item"),k=(0,a.up)("ion-list"),W=(0,a.up)("ion-icon"),v=(0,a.up)("ion-input"),b=(0,a.up)("ion-accordion"),I=(0,a.up)("ion-accordion-group"),$=(0,a.up)("ion-searchbar"),x=(0,a.up)("ion-skeleton-text"),S=(0,a.up)("ion-label");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[u])),_:1}),w.balance>0?((0,a.wg)(),(0,a.j4)(f,{key:0,slot:"end",color:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(w.balance)+(0,n.zw)(e.$heap.state.currencySign),1)])),_:1})):((0,a.wg)(),(0,a.j4)(f,{key:1,slot:"end"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(w.balance)+(0,n.zw)(e.$heap.state.currencySign),1)])),_:1}))])),_:1})])),_:1}),(0,a.Wm)(I,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Wm)(y,{slot:"header"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{icon:p.settingsOutline,slot:"start"},null,8,["icon"]),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[o])),_:1})])),_:1}),(0,a.Wm)(k,{slot:"content"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{color:"light"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[i])),_:1}),(0,a._)("div",r,[(0,a.Wm)(v,{type:"date",modelValue:w.start_at,"onUpdate:modelValue":t[0]||(t[0]=e=>w.start_at=e),onIonChange:t[1]||(t[1]=e=>_.listGet())},null,8,["modelValue"]),w.meta.sum_start?((0,a.wg)(),(0,a.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${w.meta.sum_start}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,a.kq)("",!0)])])),_:1}),(0,a.Wm)(y,{color:"light"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[s])),_:1}),(0,a._)("div",d,[w.meta.sum_debit?((0,a.wg)(),(0,a.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`+${w.meta.sum_debit}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,a.kq)("",!0),w.meta.sum_credit?((0,a.wg)(),(0,a.j4)(v,{key:1,type:"text",style:{"text-align":"right"},color:"medium",value:`-${w.meta.sum_credit}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,a.kq)("",!0)])])),_:1}),(0,a.Wm)(y,{color:"light"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[c])),_:1}),(0,a._)("div",m,[(0,a.Wm)(v,{type:"date",modelValue:w.finish_at,"onUpdate:modelValue":t[2]||(t[2]=e=>w.finish_at=e)},null,8,["modelValue"]),w.meta.sum_finish?((0,a.wg)(),(0,a.j4)(v,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${w.meta.sum_finish}${e.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,a.kq)("",!0)])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)($,{modelValue:w.q,"onUpdate:modelValue":t[3]||(t[3]=e=>w.q=e),placeholder:"Поиск по сумме или описанию",onIonChange:t[4]||(t[4]=e=>_.listGet())},null,8,["modelValue"]),null==w.ledger?((0,a.wg)(),(0,a.j4)(k,{key:0},{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)([1,2,3],(e=>(0,a.Wm)(y,{key:e},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{animated:"",style:{width:"50px"}})])),_:1}),(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,{animated:"",style:{width:"100%"}})])),_:1}),(0,a.Wm)(S,{slot:"end",color:"success"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{animated:"",style:{width:"50px"}})])),_:1})])),_:2},1024))),64))])),_:1})):w.ledger.length>0?((0,a.wg)(),(0,a.j4)(k,{key:1},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(_.ledgerCalc,(e=>((0,a.wg)(),(0,a.j4)(y,{key:e.trans_id,onClick:t=>_.itemClick(e.trans_id),detail:_.is_admin},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.date),1)])),_:2},1024),(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.trans_description),1)])),_:2},1024),1==e.is_debit?((0,a.wg)(),(0,a.j4)(S,{key:0,slot:"end",color:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.trans_amount),1)])),_:2},1024)):((0,a.wg)(),(0,a.j4)(S,{key:1,slot:"end",color:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(e.trans_amount),1)])),_:2},1024))])),_:2},1032,["onClick","detail"])))),128))])),_:1})):((0,a.wg)(),(0,a.j4)(k,{key:2},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[g])),_:1})])),_:1}))])}var w=l(8534),_=(l(3948),l(2066)),h=l(8903),f=l(9755),y=l.n(f),k=l(351),W={components:{IonIcon:_.gu,IonTitle:_.wd,IonLabel:_.Q$,IonItem:_.Ie,IonInput:_.pK,IonList:_.q_,IonAccordion:_.We,IonAccordionGroup:_.eh,IonText:_.yW,IonSkeletonText:_.CK,IonSearchbar:_.VI},props:["account"],setup(){return{settingsOutline:h.C$N}},data(){const e=new Date,t=new Date(Date.parse(`${e.getFullYear()}-${e.getMonth()+1}-1`));return{balance:"-",start_at:t.toISOString().slice(0,10),finish_at:e.toISOString().slice(0,10),q:"",ledger:null,meta:{},today:e}},computed:{ledgerCalc(){if(null==this.ledger)return null;let e=[];for(let t of this.ledger)t.date=this.toLocDate(t.trans_date),e.push(t);return e},is_admin(){return k.Z.isAdmin()}},watch:{account:function(){this.listGet()}},methods:{listGet(){var e=this;return(0,w.Z)((function*(){try{const t={start_at:e.start_at,finish_at:e.finish_at,account:e.account,q:e.q},l=yield y().post(`${e.$heap.state.hostname}Transaction/listGet`,t);e.ledger=l.ledger,e.meta=l.meta,e.finish_at==e.today.toISOString().slice(0,10)&&(e.balance=l.meta.sum_finish)}catch(t){const l=t.responseJSON,a=l.messages.error;switch(a){case"no_account":e.$flash("Ошибка получения выписки");break;case"large_interval":e.$flash("Период должен быть не больше 3 месяцев");break}return e.ledger=[],e.balance=0,!1}}))()},toLocDate(e){const t=new Date(Date.parse(e)),l={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,l)},itemClick(e){k.Z.isAdmin()&&this.$router.push(`/admin/transaction-edit-${e}`)}},mounted(){this.listGet()}},v=l(3744);const b=(0,v.Z)(W,[["render",p]]);var I=b},4620:function(e,t,l){l.r(t),l.d(t,{default:function(){return g}});var a=l(6252);const n=(0,a.Uk)(" Баланс ");function u(e,t,l,u,o,i){const r=(0,a.up)("ion-segment-button"),s=(0,a.up)("ion-segment"),d=(0,a.up)("ledger-comp"),c=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(c,{pageTitle:"Статистика курьера",pageDefaultBackLink:"/user"},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{"swipe-gesture":"true",modelValue:o.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>o.activeTab=e),onIonChange:t[1]||(t[1]=e=>i.activeTabChanged(e))},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{value:"ledger"},{default:(0,a.w5)((()=>[n])),_:1})])),_:1},8,["modelValue"]),"ledger"==o.activeTab?((0,a.wg)(),(0,a.j4)(d,{key:0,account:"courier"})):(0,a.kq)("",!0)])),_:1})}var o=l(8534),i=l(2066),r=l(8903),s=l(4535),d={components:{IonSegment:i.cJ,IonSegmentButton:i.GO,ledgerComp:s.Z},setup(){return{receiptOutline:r.d71}},data(){return{activeTab:"ledger"}},methods:{activeTabChanged(){return(0,o.Z)((function*(){}))()}}},c=l(3744);const m=(0,c.Z)(d,[["render",u]]);var g=m}}]);
//# sourceMappingURL=4620-legacy.b22794a6.js.map