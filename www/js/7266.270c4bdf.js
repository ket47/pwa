"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[7266],{7266:function(t,e,a){a.r(e),a.d(e,{default:function(){return T}});var i=a(641),n=a(33);const o={style:{color:"#999"}},s={key:0},l={key:1},r={key:3};function u(t,e,a,u,d,c){const p=(0,i.g2)("ion-segment-button"),h=(0,i.g2)("ion-segment"),m=(0,i.g2)("ion-icon"),_=(0,i.g2)("ion-text"),g=(0,i.g2)("ion-item"),k=(0,i.g2)("ion-list"),b=(0,i.g2)("ion-skeleton-text"),v=(0,i.g2)("promo-statistics"),f=(0,i.g2)("base-layout");return(0,i.uX)(),(0,i.Wv)(f,{pageTitle:"Мои бонусы",pageDefaultBackLink:"/user"},{default:(0,i.k6)(()=>[(0,i.bF)(h,{"swipe-gesture":"true",modelValue:d.promoType,"onUpdate:modelValue":e[0]||(e[0]=t=>d.promoType=t),onIonChange:e[1]||(e[1]=t=>c.listTypeChanged(t))},{default:(0,i.k6)(()=>[(0,i.bF)(p,{value:"bonuses"},{default:(0,i.k6)(()=>e[4]||(e[4]=[(0,i.eW)(" Бонусы ")])),_:1,__:[4]}),(0,i.bF)(p,{value:"active"},{default:(0,i.k6)(()=>e[5]||(e[5]=[(0,i.eW)(" Скидки ")])),_:1,__:[5]}),(0,i.bF)(p,{value:"inactive"},{default:(0,i.k6)(()=>e[6]||(e[6]=[(0,i.eW)(" Архив ")])),_:1,__:[6]})]),_:1},8,["modelValue"]),"active"==d.promoType?((0,i.uX)(),(0,i.Wv)(k,{key:0},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.compPromoList,e=>((0,i.uX)(),(0,i.CE)("div",{key:e.promo_id},[(0,i.bF)(g,{lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(m,{slot:"start",icon:u.giftOutline,color:"primary"},null,8,["icon"]),(0,i.bF)(_,null,{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(e.promo_name)+" ",1),(0,i.Lk)("p",o,"мин. заказ "+(0,n.v_)(e.min_order_sum_product)+(0,n.v_)(t.$heap.state.currencySign)+"; до "+(0,n.v_)(e.expiration),1)]),_:2},1024),(0,i.bF)(_,{slot:"end",color:"success"},{default:(0,i.k6)(()=>[(0,i.Lk)("b",null,(0,n.v_)(e.promo_value)+(0,n.v_)(t.$heap.state.currencySign),1)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):(0,i.Q3)("",!0),"inactive"==d.promoType?((0,i.uX)(),(0,i.Wv)(k,{key:1},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(c.compPromoList,a=>((0,i.uX)(),(0,i.CE)("div",{key:a.promo_id},[(0,i.bF)(g,{lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(m,{slot:"start",icon:u.giftOutline,color:"medium"},null,8,["icon"]),(0,i.bF)(_,null,{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(a.promo_name)+" до "+(0,n.v_)(a.exp_date_time),1)]),_:2},1024),(0,i.bF)(_,{slot:"end"},{default:(0,i.k6)(()=>[(0,i.Lk)("b",null,(0,n.v_)(a.promo_value)+(0,n.v_)(t.$heap.state.currencySign),1)]),_:2},1024)]),_:2},1024),(0,i.bF)(g,null,{default:(0,i.k6)(()=>[1==a.is_expired?((0,i.uX)(),(0,i.CE)("div",s,[(0,i.bF)(_,{color:"danger"},{default:(0,i.k6)(()=>e[7]||(e[7]=[(0,i.eW)("просрочена")])),_:1,__:[7]})])):1==a.is_disabled?((0,i.uX)(),(0,i.CE)("div",l,[(0,i.bF)(_,{color:"warning",style:{cursor:"pointer"},onClick:e[2]||(e[2]=t=>c.helpNotActive())},{default:(0,i.k6)(()=>e[8]||(e[8]=[(0,i.eW)("не активирована")])),_:1,__:[8]}),(0,i.bF)(m,{color:"warning",icon:u.helpCircle,onClick:e[3]||(e[3]=t=>c.helpNotActive()),style:{cursor:"pointer"}},null,8,["icon"])])):(0,i.Q3)("",!0),a.promo_order_id?((0,i.uX)(),(0,i.Wv)(_,{key:2},{default:(0,i.k6)(()=>[(0,i.eW)("использована в заказе #"+(0,n.v_)(a.promo_order_id),1)]),_:2},1024)):(0,i.Q3)("",!0)]),_:2},1024)]))),128))]),_:1})):(0,i.Q3)("",!0),null==d.promoList?((0,i.uX)(),(0,i.Wv)(k,{key:2},{default:(0,i.k6)(()=>[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)([1,2,3],t=>(0,i.Lk)("div",{key:t},[(0,i.bF)(g,{lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(m,{slot:"start",icon:u.giftOutline,color:"medium"},null,8,["icon"]),(0,i.bF)(b,{style:{width:"70%"}}),(0,i.bF)(b,{slot:"end",style:{width:"50px"}})]),_:1}),(0,i.bF)(g,null,{default:(0,i.k6)(()=>[(0,i.bF)(b,{style:{width:"70%"}})]),_:1})])),64))]),_:1})):(0,i.Q3)("",!0),"bonuses"==d.promoType?((0,i.uX)(),(0,i.CE)("div",r,[(0,i.bF)(v)])):(0,i.Q3)("",!0)]),_:1})}a(4114);var d=a(5634),c=a(5480),p=a(2311),h=a.n(p),m=a(962);const _={class:"promo-total"},g={class:"promo-value"},k={slot:"start"},b={key:0},v={style:{"text-align":"center"}},f=["href"],y=["src"];function L(t,e,a,o,s,l){const r=(0,i.g2)("statistics-card"),u=(0,i.g2)("ion-col"),d=(0,i.g2)("ion-row"),c=(0,i.g2)("ion-grid"),p=(0,i.g2)("ion-icon"),h=(0,i.g2)("ion-button"),m=(0,i.g2)("ion-card-content"),L=(0,i.g2)("ion-card"),F=(0,i.g2)("ion-label"),I=(0,i.g2)("ion-item"),x=(0,i.g2)("ion-accordion"),w=(0,i.g2)("ion-accordion-group");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("div",null,[(0,i.Lk)("div",_,[e[2]||(e[2]=(0,i.Lk)("div",{class:"promo-text"},[(0,i.Lk)("h4",null,"Мои бонусы"),(0,i.Lk)("p",null,"Доступные к использованию")],-1)),(0,i.Lk)("div",g,[(0,i.Lk)("h2",k,(0,n.v_)(s.bonusTotal),1),e[1]||(e[1]=(0,i.Lk)("img",{src:"/img/crystal.png",width:"25px"},null,-1))])])]),s.dataset.bonus_gained||s.dataset.bonus_spent?((0,i.uX)(),(0,i.CE)("div",b,[e[3]||(e[3]=(0,i.Lk)("div",{class:"ion-padding-horizontal"},[(0,i.Lk)("h5",null,"Статистика бонусов"),(0,i.Lk)("p",{style:{"margin-top":"0"}},"За последние 30 дней")],-1)),(0,i.bF)(c,null,{default:(0,i.k6)(()=>[(0,i.bF)(d,null,{default:(0,i.k6)(()=>[(0,i.bF)(u,{size:"12","size-sm":"4"},{default:(0,i.k6)(()=>[s.dataset.bonus_gained?((0,i.uX)(),(0,i.Wv)(r,{key:0,label:"Заработано",data:s.dataset.bonus_gained,format:"integer",color:"#008FFB",dates:s.statisticsDates},null,8,["data","dates"])):(0,i.Q3)("",!0)]),_:1}),(0,i.bF)(u,{size:"12","size-sm":"4"},{default:(0,i.k6)(()=>[s.dataset.bonus_spent?((0,i.uX)(),(0,i.Wv)(r,{key:0,label:"Потрачено",data:s.dataset.bonus_spent,format:"integer",color:"#04e398",dates:s.statisticsDates},null,8,["data","dates"])):(0,i.Q3)("",!0)]),_:1})]),_:1})]),_:1})])):(0,i.Q3)("",!0),e[11]||(e[11]=(0,i.Lk)("div",{class:"ion-padding-horizontal"},[(0,i.Lk)("h5",null,"Копите бонусы"),(0,i.Lk)("p",{style:{"margin-top":"0"}},"Пригласив друга")],-1)),(0,i.bF)(L,null,{default:(0,i.k6)(()=>[(0,i.bF)(m,null,{default:(0,i.k6)(()=>[e[5]||(e[5]=(0,i.Lk)("p",null,[(0,i.eW)("Новый пользователь, зарегистриванный "),(0,i.Lk)("u",null,"на сайте"),(0,i.eW)(" по вашему приглашению, получит бонус 200"),(0,i.Lk)("span",null,[(0,i.Lk)("img",{class:"bonus-chip",src:"/img/crystal.png",width:"14px"})]),(0,i.eW)(".")],-1)),e[6]||(e[6]=(0,i.Lk)("p",null,[(0,i.eW)("В качестве благодарности, мы начислим вам бонус 100"),(0,i.Lk)("span",null,[(0,i.Lk)("img",{class:"bonus-chip",src:"/img/crystal.png",width:"14px"})])],-1)),(0,i.Lk)("p",v,[this.$heap.state.user.user_id>0?((0,i.uX)(),(0,i.CE)("a",{key:0,href:`${this.$heap.state.hostname}User/itemInvitationQR?user_id=${this.$heap.state.user.user_id}`,target:"_blank"},[(0,i.Lk)("img",{src:`${this.$heap.state.hostname}User/itemInvitationQR?user_id=${this.$heap.state.user.user_id}`,style:{width:"150px",height:"150px"}},null,8,y)],8,f)):(0,i.Q3)("",!0)]),(0,i.bF)(h,{onClick:e[0]||(e[0]=t=>l.shareInvitation()),expand:"block",color:"success"},{default:(0,i.k6)(()=>[(0,i.bF)(p,{src:o.arrowRedoOutline},null,8,["src"]),e[4]||(e[4]=(0,i.eW)("Пригласить друга"))]),_:1,__:[4]})]),_:1,__:[5,6]})]),_:1}),(0,i.bF)(w,null,{default:(0,i.k6)(()=>[(0,i.bF)(x,{value:"first"},{default:(0,i.k6)(()=>[(0,i.bF)(I,{slot:"header",color:"light"},{default:(0,i.k6)(()=>[(0,i.bF)(F,null,{default:(0,i.k6)(()=>e[7]||(e[7]=[(0,i.eW)("Как "),(0,i.Lk)("b",null,"получить",-1),(0,i.eW)(" бонусы?")])),_:1,__:[7]})]),_:1}),e[8]||(e[8]=(0,i.Lk)("div",{class:"ion-padding",slot:"content",style:{color:"#666"}},[(0,i.Lk)("p",null,[(0,i.eW)(" При "),(0,i.Lk)("b",null,"покупке"),(0,i.eW)(" товаров со значком изумруда "),(0,i.Lk)("span",null,[(0,i.Lk)("img",{class:"bonus-chip",src:"/img/crystal.png",width:"14px"})]),(0,i.eW)(", вы получаете на свой счёт соответствующее количество бонусов. ")]),(0,i.Lk)("p",null," Бонусы действуют 6 месяцев. ")],-1))]),_:1,__:[8]}),(0,i.bF)(x,{value:"second"},{default:(0,i.k6)(()=>[(0,i.bF)(I,{slot:"header",color:"light"},{default:(0,i.k6)(()=>[(0,i.bF)(F,null,{default:(0,i.k6)(()=>e[9]||(e[9]=[(0,i.eW)("Как "),(0,i.Lk)("b",null,"потратить",-1),(0,i.eW)(" бонусы?")])),_:1,__:[9]})]),_:1}),e[10]||(e[10]=(0,i.Lk)("div",{class:"ion-padding",slot:"content",style:{color:"#666"}},[(0,i.Lk)("p",null,[(0,i.eW)(" Вы можете "),(0,i.Lk)("b",null,"потратить"),(0,i.eW)(" бонусы на реальные покупки. При этом "),(0,i.Lk)("b",null,"1 изумруд = 1 рубль"),(0,i.eW)(". ")]),(0,i.Lk)("p",null,[(0,i.eW)(" Так вы можете оплатить до "),(0,i.Lk)("b",null,"100%"),(0,i.eW)(" следующего заказа! Товары, со значком изумруда "),(0,i.Lk)("span",null,[(0,i.Lk)("img",{class:"bonus-chip",src:"/img/crystal.png",width:"14px"})]),(0,i.eW)(", можно купить по цене до 1 рубля. ")])],-1))]),_:1,__:[10]})]),_:1})],64)}var F=a(8384),I={components:{IonAccordionGroup:d.YH,IonAccordion:d.xk,IonLabel:d.he,IonChip:d.ZB,IonItem:d.uz,IonGrid:d.lO,IonRow:d.ln,IonCol:d.hU,IonText:d.IO,IonCard:d.b_,IonCardHeader:d.ME,IonCardTitle:d.tN,IonCardContent:d.I9,IonIcon:d.iq,IonButton:d.Jm,StatisticsCard:F.A},setup(){return{timeOutline:c.CVk,searchOutline:c.jBE,arrowRedoOutline:c.Kgq}},data(){return{dataset:{},bonusTotal:0,statisticsDates:[]}},computed:{},methods:{async listGet(){try{const t={user_id:this.$heap.state.user.user_id,point_span:3,point_num:10},e=await this.$post(`${this.$heap.state.hostname}Statistics/bonusParametersGet`,t);e.body.reverse(),this.bonusTotal=e.head.bonus_total??0,this.statisticsDates=this.parseDates(e),this.parseStatisticResponse(e)}catch{}},parseStatisticResponse(t){const e={bonus_gained:!0,bonus_spent:!0};for(var a in e){let e={[a]:{value:0,series:[]}};for(var i in t.body)t.body[i][a]&&(e[a].series.push(t.body[i][a]),e[a].value+=1*t.body[i][a]);e[a].series.length&&(this.dataset=e)}},parseDates(t){let e=[];for(var a in t.body)e.unshift(t.body[a].point_finish);return e},async shareInvitation(){try{const t=this.$heap.state.settings.app_title,e="Присоединяйтесь и получите бонус",a=await m.S.canShare(),i=`${this.$heap.getters.settings.app.frontendUrl}invitation.html?inviter_user_id=${this.$heap.state.user.user_id}`;a?await m.S.share({title:t,text:e,url:i,dialogTitle:t}):navigator.clipboard?(await navigator.clipboard.writeText(i),this.$alert("Теперь вы можете поделиться ей с друзьями в социальных сетях или мессенджерах.","Ссылка на страницу скопирована")):this.$alert("Устройство не поддерживает функцию поделиться","")}catch(t){}}},mounted(){this.listGet()},activated(){this.listGet()}},x=a(6262);const w=(0,x.A)(I,[["render",L],["__scopeId","data-v-25a1c1f2"]]);var C=w,W={components:{IonIcon:d.iq,IonTitle:d.BC,IonList:d.nf,IonItem:d.uz,IonText:d.IO,IonSegment:d.Gp,IonSegmentButton:d.eP,IonSkeletonText:d.ds,IonAccordion:d.xk,IonAccordionGroup:d.YH,PromoStatistics:C},setup(){return{giftOutline:c.Lsq,closeOutline:c.xfX,banOutline:c.Av6,helpCircle:c.MGW,arrowRedoOutline:c.Kgq}},data(){return{promoType:"bonuses",promoList:null}},mounted(){this.listGet()},computed:{compPromoList(){let t=[];if(this.promoList)for(let e of this.promoList)e.exp_date_time=this.toLocDate(e.expired_at),e.date_time=this.toLocDate(e.created_at),t.push(e);return t}},methods:{async listGet(){try{this.promoList=[];const t={user_id:this.$heap.state.user.user_id,type:this.promoType};this.promoList=await h().post(`${this.$heap.state.hostname}Promo/listGet`,t)}catch{}},listTypeChanged(t){const e=t.target.value;this.listGet(e)},toLocDate(t){const e=new Date(Date.parse(t)),a={month:"short",day:"numeric",year:"numeric"};return e.toLocaleDateString(void 0,a)},async shareInvitation(){try{const t=this.$heap.state.settings.app_title,e="Присоединяйтесь и получите 5 сертификатов по 200руб",a=await m.S.canShare(),i=`${this.$heap.getters.settings.app.frontendUrl}invitation.html?inviter_user_id=${this.$heap.state.user.user_id}`;a?await m.S.share({title:t,text:e,url:i,dialogTitle:t}):navigator.clipboard?(await navigator.clipboard.writeText(i),this.$alert("Теперь вы можете поделиться ей с друзьями в социальных сетях или мессенджерах.","Ссылка на страницу скопирована")):this.$alert("Устройство не поддерживает функцию поделиться","")}catch(t){}},helpNotActive(){this.$alert("Эта скидка будет активирована, когда приглашённый вами друг воспользуется начисленной ему скидкой. Не забудьте напомнить😉")}}};const $=(0,x.A)(W,[["render",u]]);var T=$},8384:function(t,e,a){a.d(e,{A:function(){return m}});var i=a(641),n=a(33);const o={style:{"font-size":"22px"}},s={key:1,class:"ion-padding ion-text-center"};function l(t,e,a,l,r,u){const d=(0,i.g2)("ion-card-subtitle"),c=(0,i.g2)("ion-icon"),p=(0,i.g2)("ion-label"),h=(0,i.g2)("ion-chip"),m=(0,i.g2)("ion-card-title"),_=(0,i.g2)("ion-card-header"),g=(0,i.g2)("apexchart"),k=(0,i.g2)("ion-card-content"),b=(0,i.g2)("ion-card");return(0,i.uX)(),(0,i.Wv)(b,{style:{contain:"initial",overflow:"visible"}},{default:(0,i.k6)(()=>[(0,i.bF)(_,{style:{"padding-bottom":"0"}},{default:(0,i.k6)(()=>[(0,i.bF)(d,null,{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(a.label),1)]),_:1}),(0,i.bF)(m,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",null,[(0,i.Lk)("b",o,(0,n.v_)(u.mainValue),1),0!=u.dynamicsData.value?((0,i.uX)(),(0,i.Wv)(h,{key:0,outline:!0,color:u.dynamicsData.color,class:"ion-no-margin",style:{"font-size":"12px",border:"none"}},{default:(0,i.k6)(()=>[(0,i.bF)(c,{icon:u.dynamicsData.icon},null,8,["icon"]),(0,i.bF)(p,null,{default:(0,i.k6)(()=>[(0,i.eW)((0,n.v_)(u.dynamicsData.value)+"%",1)]),_:1})]),_:1},8,["color"])):(0,i.Q3)("",!0)])]),_:1})]),_:1}),(0,i.bF)(k,{class:"ion-no-padding"},{default:(0,i.k6)(()=>[a.data.series.length>1?((0,i.uX)(),(0,i.Wv)(g,{key:0,type:"area",height:"70",options:r.chartOptions,series:r.series,ref:"apexChart"},null,8,["options","series"])):((0,i.uX)(),(0,i.CE)("div",s,e[0]||(e[0]=[(0,i.Lk)("h2",null,"Недостаточно данных",-1),(0,i.Lk)("p",null,"для показа статистики",-1)])))]),_:1})]),_:1})}var r=a(5634),u=a(5480),d=a(5564),c={components:{IonIcon:r.iq,IonLabel:r.he,IonCard:r.b_,IonCardHeader:r.ME,IonCardTitle:r.tN,IonCardSubtitle:r.HW,IonCardContent:r.I9,IonChip:r.ZB,apexchart:d.A},props:["label","data","format","color","dates"],setup(){return{calendarOutline:u.RXF,caretUpOutline:u.rHB,caretDownOutline:u.mF9,caretForwardOutline:u.d2Q}},data(){return{value:0,series:[{name:this.label,data:this.data.series}],chartOptions:{chart:{height:70,type:"area",zoom:{enabled:!1},toolbar:{show:!1},parentHeightOffset:0,sparkline:{enabled:!0}},stroke:{width:2},colors:["#008FFB"],legend:{show:!1},fill:{type:"gradient",gradient:{opacityFrom:.6,opacityTo:.4}},dataLabels:{enabled:!1},grid:{padding:{left:-10,right:-10,top:-15,bottom:-15},yaxis:{lines:{show:!1}}},xaxis:{show:!1,labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1},categories:[]},yaxis:{min:0,show:!1,labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}}}}},computed:{mainValue(){const t=this.data.value??0;return"integer"==this.format?new Intl.NumberFormat("ru-RU").format(Math.round(t)):"float"==this.format?new Intl.NumberFormat("ru-RU",{maximumSignificantDigits:2}).format(parseFloat(t).toFixed(2)):"currency"==this.format?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(parseFloat(t).toFixed(2)):null},dynamicsData(){const t=1*this.data.avg??0,e=1*this.data.value??0,a=((e-t)/((e+t)/2)*100||0).toFixed(2);var i="medium",n=u.d2Q;return a>0&&(i="success",n=u.rHB),a<0&&(i="danger",n=u.mF9),{value:a,color:i,icon:n}},datesParsed(){return this.getDates(this.dates)}},methods:{initChart(){this.$refs.apexChart&&(this.$refs.apexChart.updateSeries(this.series),this.$refs.apexChart.updateOptions({xaxis:{categories:this.datesParsed}}))},getDates(t){let e=[];for(let a=0;a<t.length;a++)e.unshift(new Date(t[a]).toLocaleString("ru",{day:"numeric",month:"long"}));return e}},mounted(){this.chartOptions.colors=[this.color]??0,setTimeout(()=>{this.initChart()},10)},updated(){setTimeout(()=>{this.initChart()},10)}},p=a(6262);const h=(0,p.A)(c,[["render",l]]);var m=h}}]);
//# sourceMappingURL=7266.270c4bdf.js.map