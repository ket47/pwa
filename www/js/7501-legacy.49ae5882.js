"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[7501],{4405:function(e,t,r){r(4916),r(5306);var o=r(2008),i={deliveryCalculate(e){if(!e.locations||!e.locations[0]||!e.locations[0].distance)return null;var t=e.locations[0].distance,r=e.store_time_preparation||0;return i.deliveryTimeCalculate(t,r)},deliveryTimeCalculate(e,t){var r;t=parseInt(null!==(r=t)&&void 0!==r?r:o.Z.getters.settings.delivery.timePreparationDefault);var i=parseInt(o.Z.getters.settings.delivery.timeDelta),n=parseInt(o.Z.getters.settings.delivery.speed),s=5*Math.round(e/n*60/5)+t,u=s>i?s-i:s,a=u+i;return{time:s,timeMin:u,timeMax:a}},render(e,t){for(var r in t)e=e.replace(`{{${r}}}`,t[r]);return e=e.replace(/{{\.}}/,"-"),e}};t["Z"]=i},2927:function(e,t,r){r.d(t,{Z:function(){return m}});var o=r(6252),i=r(3577),n=function(e){return(0,o.dD)("data-v-0e00b8d4"),e=e(),(0,o.Cn)(),e},s={class:"slide-title"},u=n((function(){return(0,o._)("div",{id:"hcat_widget_grid"},null,-1)}));function a(e,t,r,n,a,l){var d=(0,o.up)("ion-img"),c=(0,o.up)("ion-thumbnail"),p=(0,o.up)("swiper-slide"),g=(0,o.up)("swiper");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(g,{id:"hcat_widget_grid","slides-per-view":4.5,"space-between":10},{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.groupList,(function(t){return(0,o.wg)(),(0,o.j4)(p,{key:t.group_id,onClick:function(){return e.onClick(t.group_id)}},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{style:{width:"70px",height:"70px"}},{default:(0,o.w5)((function(){return[t.image_hash?((0,o.wg)(),(0,o.j4)(d,{key:0,style:{"border-radius":"10px",border:"1px solid #ddd"},src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.150.150.webp`},null,8,["src"])):(0,o.kq)("",!0)]})),_:2},1024),(0,o._)("div",s,(0,i.zw)(t.group_name),1)]})),_:2},1032,["onClick"])})),128))]})),_:1},8,["slides-per-view"]),u],64)}var l=r(8292),d=r(3181),c=(0,o.aZ)({components:{IonImg:l.Xz,IonThumbnail:l.Bs,Swiper:d.t,SwiperSlide:d.o},props:["groupList","onClick"]}),p=r(3744);const g=(0,p.Z)(c,[["render",a],["__scopeId","data-v-0e00b8d4"]]);var m=g},4966:function(e,t,r){r.d(t,{Z:function(){return h}});var o=r(6252),i=r(3577),n={key:0,style:{position:"relative"}},s=["src"],u=["src"];function a(e,t,r,a,l,d){var c=(0,o.up)("ion-icon"),p=(0,o.up)("ion-fab-button"),g=(0,o.up)("ion-fab"),m=(0,o.up)("swiper-slide"),_=(0,o.up)("swiper");return l.expanded?((0,o.wg)(),(0,o.iD)("div",n,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.imageList,(function(t){return(0,o.wg)(),(0,o.iD)("div",{key:t.image_hash,style:{border:"2px solid var(--ion-color-primary)"}},[(0,o._)("img",{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.1000.1000.webp`},null,8,s)])})),128)),(0,o.Wm)(g,{horizontal:"end",vertical:"top",slot:"fixed"},{default:(0,o.w5)((function(){return[(0,o.Wm)(p,{color:"light"},{default:(0,o.w5)((function(){return[(0,o.Wm)(c,{src:a.contract,size:"large",onClick:t[0]||(t[0]=function(e){return d.minimize()})},null,8,["src"])]})),_:1})]})),_:1})])):((0,o.wg)(),(0,o.j4)(_,{key:1,modules:a.modules,autoplay:{delay:3e3,disableOnInteraction:!1},loop:!0,effect:"fade",style:(0,i.j5)(`height: ${r.imgHeight||"100%"};`)},{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(r.imageList,(function(t){return(0,o.wg)(),(0,o.j4)(m,{key:t.image_hash},{default:(0,o.w5)((function(){return[(0,o._)("div",{class:(0,i.C_)(`${r.mode?r.mode:""} cropper`),style:(0,i.j5)(`height: ${r.imgHeight+"px"||0};`)},[(0,o._)("img",{style:(0,i.j5)(`min-height: ${r.imgHeight+"px;"||0}`),src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.${4*r.imgHeight||1200}.${4*r.imgHeight||1200}.webp`},null,12,u)],6)]})),_:2},1024)})),128))]})),_:1},8,["modules","style"]))}var l=r(8903),d=r(8292),c=r(702),p=r(3181),g={components:{Swiper:p.t,SwiperSlide:p.o,IonFab:d.IJ,IonFabButton:d.W4,IonIcon:d.gu},props:["imageList","imgHeight","mode"],setup(){return{modules:[c.pt,c.xW],expand:l.jnR,contract:l.LJB}},data(){return{expanded:!1,vh:0,vw:0}},methods:{maximize(){this.expanded=!0,this.vh=document.getElementsByTagName("ion-content")[0].clientHeight,this.vw=document.getElementsByTagName("ion-content")[0].clientWidth},minimize(){this.expanded=!1,this.vh=document.getElementsByTagName("ion-content")[0].clientHeight,this.vw=document.getElementsByTagName("ion-content")[0].clientWidth}}},m=r(3744);const _=(0,m.Z)(g,[["render",a],["__scopeId","data-v-57ad0950"]]);var h=_},7501:function(e,t,r){r.r(t),r.d(t,{default:function(){return F}});var o=r(6252),i=r(3577),n={style:{"background-color":"#1380c1","padding-bottom":"15px"}},s={class:"store-info-container"},u={class:"store-image-slider-container"},a=(0,o._)("div",{class:"overlay",style:{"background-image":"url(/img/store_menu_background_full.png)"}},null,-1),l={key:0,class:"avatar"},d=["alt","src"],c={key:1},p={key:2,class:"group-fixed-block hidden-block"},g=(0,o._)("h4",{style:{margin:"16px 16px 20px"}},[(0,o._)("b",null,"Онлайн меню")],-1),m={class:"product-container"},_={style:{margin:"0"}},h={class:"product_list_widget_grid"},f=["id"],w={class:"product_list_item_img"},v=["src"],y={class:"product-data"},b={class:"product-title"},k={key:0,style:{color:"var(--ion-color-medium)"}},I={key:1,style:{color:"var(--ion-color-medium)"}},x={class:"product-description"},S={class:"product-price"},$={style:{color:"var(--ion-color-primary)"}},C={key:0,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},Z={key:1,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},G={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},P=(0,o._)("div",null,[(0,o._)("h6",null,"НУЖНА ДОСТАВКА?"),(0,o._)("h4",null,"ВЫБИРАЙ TEZKEL")],-1),H=(0,o.Uk)("Перейти в приложение");function z(e,t,r,z,q,D){var j=(0,o.up)("ion-icon"),W=(0,o.up)("ion-toolbar"),L=(0,o.up)("image-slider-comp"),T=(0,o.up)("ion-label"),B=(0,o.up)("ion-segment-button"),O=(0,o.up)("ion-segment"),Y=(0,o.up)("group-list"),M=(0,o.up)("ion-col"),N=(0,o.up)("ion-img"),K=(0,o.up)("ion-row"),E=(0,o.up)("ion-grid"),R=(0,o.up)("swiper-slide"),A=(0,o.up)("swiper"),U=(0,o.up)("ion-button"),V=(0,o.up)("router-link"),F=(0,o.up)("ion-footer"),J=(0,o.up)("ion-content"),X=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(X,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(J,{class:(0,i.C_)("store-menu-page"),scrollEvents:!0,onIonScroll:D.onScroll},{default:(0,o.w5)((function(){return[(0,o.Wm)(W,null,{default:(0,o.w5)((function(){return[z.mainLogo?((0,o.wg)(),(0,o.j4)(j,{key:0,class:"toolbar_svg_logo",style:{color:"white"},icon:z.mainLogo},null,8,["icon"])):(0,o.kq)("",!0)]})),_:1}),(0,o._)("div",n,[(0,o._)("div",s,[(0,o._)("div",u,[(0,o.Wm)(L,{imageList:q.storeItem.images,imgHeight:250,mode:"crop-to-fit"},null,8,["imageList"]),a]),q.storeItem.avatarImage?((0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("img",{alt:q.storeItem.store_name,src:e.$heap.state.hostname+"image/get.php/"+q.storeItem.avatarImage+".200.200.webp"},null,8,d)])):((0,o.wg)(),(0,o.iD)("div",c,[(0,o._)("h2",null,(0,i.zw)(q.storeItem.store_name),1)])),q.storeGroups?((0,o.wg)(),(0,o.iD)("div",p,[(0,o.Wm)(O,{modelValue:q.groupSelectedParentId,"onUpdate:modelValue":t[0]||(t[0]=function(e){return q.groupSelectedParentId=e}),scrollable:"",class:"groups-container"},{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(q.storeGroups,(function(e){return(0,o.wg)(),(0,o.j4)(B,{key:e.group_id,value:e.group_id,onClick:function(t){return D.groupSelectParent(e.group_id,1)},ref_for:!0,ref:"group-tab-"+e.group_id},{default:(0,o.w5)((function(){return[(0,o.Wm)(T,null,{default:(0,o.w5)((function(){return[(0,o.Uk)((0,i.zw)(e.group_name),1)]})),_:2},1024)]})),_:2},1032,["value","onClick"])})),128))]})),_:1},8,["modelValue"])])):(0,o.kq)("",!0),g,q.storeGroups?((0,o.wg)(),(0,o.j4)(Y,{key:3,groupList:q.storeGroups,onClick:function(e){D.groupSelectParent(e,!0)}},null,8,["groupList","onClick"])):(0,o.kq)("",!0)]),(0,o._)("div",m,[q.storeGroups?((0,o.wg)(),(0,o.j4)(A,{key:0,pager:"true",initialSlide:0,speed:400,watchSlidesProgress:!1,grabCursor:!0,touchStartForcePreventDefault:!0,slidesPerView:1.1,pagination:!1,centeredSlides:!1,class:"product-list-slider",onSlideChange:t[1]||(t[1]=function(e){return D.groupSliderChanged(e)}),style:(0,i.j5)(`max-height: ${q.sliderMaxHeight}`)},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,i.zw)(q.storeGroups)+" ",1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(q.storeGroups,(function(t){return(0,o.wg)(),(0,o.j4)(R,{key:t.group_id},{default:(0,o.w5)((function(){return[(0,o.Wm)(E,{class:"product-list"},{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.children,(function(t){return(0,o.wg)(),(0,o.j4)(K,{key:t.group_id,ref_for:!0,ref:"group-"+t.group_id,"data-group_id":t.group_id},{default:(0,o.w5)((function(){return[(0,o.Wm)(M,{class:"group-title",size:"12"},{default:(0,o.w5)((function(){return[(0,o._)("h5",_,(0,i.zw)(t.group_name),1)]})),_:2},1024),(0,o.Wm)(M,{size:"12"},{default:(0,o.w5)((function(){return[(0,o._)("div",h,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(q.storeProducts[t.group_id],(function(t){return(0,o.wg)(),(0,o.iD)("div",{key:t.product_id},[(0,o._)("div",{class:(0,i.C_)(t.item_class+" product-item"),id:`product_list_item${t.product_id}`},[(0,o._)("div",w,[(0,o._)("img",{class:"blur-image",src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.200.200.webp`},null,8,v),(0,o.Wm)(N,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.200.200.webp`},null,8,["src"])]),(0,o._)("div",y,[(0,o._)("div",b,[(0,o.Uk)((0,i.zw)(t.product_name)+" ",1),"порция"==t.product_unit?((0,o.wg)(),(0,o.iD)("span",k," ("+(0,i.zw)(t.weight_in_gramms)+"г) ",1)):((0,o.wg)(),(0,o.iD)("span",I," ("+(0,i.zw)(t.product_unit)+") ",1)),(0,o._)("div",x,(0,i.zw)(t.product_description),1)]),(0,o._)("div",S,[(0,o._)("span",$,[t.product_net_price>0?((0,o.wg)(),(0,o.iD)("b",C,(0,i.zw)(t.product_net_price),1)):((0,o.wg)(),(0,o.iD)("b",Z,(0,i.zw)(t.product_final_price),1)),(0,o._)("b",G,(0,i.zw)(e.$heap.state.currencySign),1)])])])],10,f)])})),128))])]})),_:2},1024)]})),_:2},1032,["data-group_id"])})),128))]})),_:2},1024)]})),_:2},1024)})),128))]})),_:1},8,["slidesPerView","style"])):(0,o.kq)("",!0)])]),(0,o.Wm)(F,{style:{"background-image":"url(/img/bg3.ce15f59d.png)"}},{default:(0,o.w5)((function(){return[P,(0,o._)("div",null,[(0,o.Wm)(V,{to:`/catalog/store-${q.storeId}`},{default:(0,o.w5)((function(){return[(0,o.Wm)(U,null,{default:(0,o.w5)((function(){return[H]})),_:1})]})),_:1},8,["to"])])]})),_:1})]})),_:1},8,["onIonScroll"])]})),_:1})}var q=r(8439),D=r(6835),j=r(8534),W=r(8292),L=r(702),T=r(3181),B=r(8903),O=r(94),Y=r(4966),M=r(2927),N=r(9755),K=r.n(N),E=r(2008),R=r(4405),A={components:{IonPage:W._i,IonToolbar:W.sr,IonContent:W.W2,IonFooter:W.fr,IonCol:W.wI,IonIcon:W.gu,IonImg:W.Xz,IonRow:W.Nd,IonGrid:W.jY,ImageSliderComp:Y.Z,IonLabel:W.Q$,IonSegmentButton:W.GO,IonSegment:W.cJ,IonButton:W.YG,Swiper:T.t,SwiperSlide:T.o,GroupList:M.Z},setup(){return{mainLogo:O,search:B.yC4,settingsOutline:B.C$N,rocketOutline:B.G$D,compassOutline:B.gmD,slideModules:[L.pt]}},data(){return{storeId:this.$route.params.id,query:this.$route.query,searchRequest:"",storeItem:[],storeProducts:{},storeGroups:null,groupSelectedParentId:-1,offsetModificator:80,sliderMaxHeight:500,can_reload_at:0}},methods:{itemGet(){var e=this;return(0,j.Z)((0,D.Z)().mark((function t(){var r,o,i,n,s;return(0,D.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=Date.now(),!(e.can_reload_at>r)){t.next=3;break}return t.abrupt("return");case 3:return e.can_reload_at=r+1e4,t.prev=4,t.next=7,K().post(`${E.Z.state.hostname}Store/itemGet`,{store_id:e.storeId,distance_include:1});case 7:o=t.sent,e.storeItem=e.itemPrepare(o),e.storeId=o.store_id,e.groupTreeGet({store_id:e.storeId}),E.Z.commit("setCurrentStore",e.storeItem),t.next=24;break;case 14:t.prev=14,t.t0=t["catch"](4),s=null===t.t0||void 0===t.t0||null===(i=t.t0.responseJSON)||void 0===i||null===(n=i.messages)||void 0===n?void 0:n.error,t.t1=s,t.next="notfound"===t.t1?20:23;break;case 20:return e.$flash("Продавец не найден"),e.$router.push("/catalog"),t.abrupt("break",23);case 23:return t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t,null,[[4,14]])})))()},itemPrepare(e){e.member_of_groups.group_names&&(e.store_group_names=e.member_of_groups.group_names);try{e.deliveryTime=R.Z.deliveryTimeCalculate(e.locations[0].distance,e.store_time_preparation)}catch(t){}return e.avatarImage="",e.avatar.length>0&&(e.avatarImage=e.avatar[0].image_hash),e},productListGet(){var e=arguments,t=this;return(0,j.Z)((0,D.Z)().mark((function r(){var o,i,n;return(0,D.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(o=e.length>0&&void 0!==e[0]?e[0]:{},o.store_id=t.storeId,o.is_active=1,!o.name_query||""!=o.name_query){r.next=6;break}return t.groupTreeGet({store_id:t.storeId}),r.abrupt("return");case 6:return o.limit=200,i={},r.prev=8,r.next=11,K().post(E.Z.state.hostname+"Product/listGet",o);case 11:i=r.sent,r.next=16;break;case 14:r.prev=14,r.t0=r["catch"](8);case 16:t.productListPrepare(i.product_list),t.groupOtherAdd(),n=t,setTimeout((function(){n.groupSelect()}),0);case 20:case"end":return r.stop()}}),r,null,[[8,14]])})))()},productListPrepare(e){this.storeProducts={};var t,r=(0,q.Z)(e);try{for(r.s();!(t=r.n()).done;){var o,i,n,s=t.value;if(this.storeGroups)if(!this.storeProducts[null!==(i=s.group_id)&&void 0!==i?i:0])this.storeProducts[null!==(n=s.group_id)&&void 0!==n?n:0]=[];s.item_class="",s.deleted_at&&(s.item_class="deleted"),1==s.is_disabled&&(s.item_class="disabled"),1==s.is_counted&&s.product_quantity-s.product_quantity_reserved<1&&(s.item_class="absent"),s.weight_in_gramms=1e3*s.product_weight,this.storeProducts[null!==(o=s.group_id)&&void 0!==o?o:0].push(s)}}catch(u){r.e(u)}finally{r.f()}},productItemCreate(){var e=this;return(0,j.Z)((0,D.Z)().mark((function t(){var r,o;return(0,D.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r={store_id:e.storeId,product_name:"Новый товар",product_price:1e3,product_promo_price:1e3},t.next=4,K().post(`${E.Z.state.hostname}Product/itemCreate`,r);case 4:o=t.sent,e.$router.push(`product-edit-${o}`),e.$flash("Добавлен 'Новый товар' в категорию 'Другое'"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),e.$flash("Не удалось создать товар");case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},groupTreeGet(e){var t=this;return(0,j.Z)((0,D.Z)().mark((function r(){return(0,D.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,K().get(`${E.Z.state.hostname}Product/groupTreeGet`,{store_id:e.store_id});case 3:t.storeGroups=r.sent,t.productListGet(),r.next=9;break;case 7:r.prev=7,r.t0=r["catch"](0);case 9:case"end":return r.stop()}}),r,null,[[0,7]])})))()},groupOtherAdd(){this.storeProducts[0]&&(this.storeGroups[0]={group_id:"other",group_name:"Другое",image_hash:"",children:{0:{group_id:0,group_name:"другое",group_parent_id:0,group_path:"",image_hash:""}}})},groupSelect(){var e=this.query.parent_group_id,t=this.query.sub_group_id;if(t)e:for(var r in this.storeGroups)for(var o in this.storeGroups[r].children)if(o==t){e=r;break e}if(e||(e=Object.keys(this.storeGroups)[0]),this.groupSelectParent(e),t);},groupSelectParent(e){if(this.groupSelectedParentId!=e){this.groupSelectedParentId=e;var t=document.querySelector(".product-list-slider").swiper,r=Object.keys(this.storeGroups).indexOf(this.groupSelectedParentId);t.slideTo(r,100,!1),this.groupSliderAdjustHeight()}},groupSliderChanged(e){var t=e.activeIndex,r=Object.keys(this.storeGroups)[t];this.groupSelectParent(r,1)},groupSliderAdjustHeight(){var e,t=null===(e=document.querySelector(".product-list-slider .swiper-slide.swiper-slide-active"))||void 0===e?void 0:e.scrollHeight;document.querySelector(".product-list-slider.swiper").style.maxHeight=t>0?t+"px":""},onScroll(e){var t,r=null===(t=document.querySelector("#hcat_widget_grid"))||void 0===t?void 0:t.getBoundingClientRect().top;r<0?document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block"):document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block hidden-block");var o,i=document.querySelectorAll(".swiper-slide-active .product-list ion-row"),n=(0,q.Z)(i);try{for(n.s();!(o=n.n()).done;){var s=o.value;if(s.getBoundingClientRect().top-this.offsetModificator<=window.innerHeight-window.innerHeight/4&&s.getBoundingClientRect().bottom+this.offsetModificator>=window.innerHeight-window.innerHeight/4&&s.dataset.group_id)break}}catch(u){n.e(u)}finally{n.f()}}},mounted(){this.query=this.$route.query,this.itemGet()},watch:{$route(e){this.storeId=e.params.id}}},U=r(3744);const V=(0,U.Z)(A,[["render",z]]);var F=V}}]);
//# sourceMappingURL=7501-legacy.49ae5882.js.map