"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[813],{7208:function(t,e,a){a.d(e,{Z:function(){return h}});var i=a(6252),n=a(3577);const r={class:"ion-page"};function o(t,e,a,o,s,l){const d=(0,i.up)("ion-title"),u=(0,i.up)("ion-icon"),c=(0,i.up)("ion-toolbar"),m=(0,i.up)("ion-header"),_=(0,i.up)("ion-searchbar"),p=(0,i.up)("ion-skeleton-text"),h=(0,i.up)("ion-item"),g=(0,i.up)("ion-list"),f=(0,i.up)("ion-img"),y=(0,i.up)("ion-avatar"),w=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,{color:"secondary"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ "+(0,n.zw)(s.itemTypeName),1)])),_:1}),(0,i.Wm)(u,{icon:o.closeOutline,onClick:e[0]||(e[0]=t=>{l.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,i.Wm)(w,null,{default:(0,i.w5)((()=>{var a;return["acc"!=s.itemTypeLabel?((0,i.wg)(),(0,i.j4)(_,{key:0,modelValue:s.query,"onUpdate:modelValue":e[1]||(e[1]=t=>s.query=t),placeholder:"Ð¿Ð¾Ð¸ÑÐº",debounce:100,onIonInput:e[2]||(e[2]=t=>l.listGet())},null,8,["modelValue"])):(0,i.kq)("",!0),s.itemList?null!==(a=s.itemList)&&void 0!==a&&a.length?((0,i.wg)(),(0,i.j4)(g,{key:2},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.itemList,(e=>((0,i.wg)(),(0,i.j4)(h,{key:e.id,button:"",detail:"",onClick:t=>l.itemPick(e)},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{slot:"start"},{default:(0,i.w5)((()=>[e.image_hash?((0,i.wg)(),(0,i.j4)(f,{key:0,src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.50.50.webp`},null,8,["src"])):(0,i.kq)("",!0)])),_:2},1024),(0,i.Uk)(" "+(0,n.zw)(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):((0,i.wg)(),(0,i.j4)(g,{key:3},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Uk)(" ÐÐ¸Ñ‡ÐµÐ³Ð¾ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð¾ ")])),_:1})])),_:1})):((0,i.wg)(),(0,i.j4)(g,{key:1},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)([0,1,2,3,4,5,6,7,8,9],(t=>(0,i.Wm)(h,{key:t,button:"",detail:""},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{style:{height:"35px",width:"40px"},animated:""}),(0,i.Wm)(p,{style:{width:"100%"},animated:""})])),_:2},1024))),64))])),_:1}))]})),_:1})])}var s=a(8534),l=a(8903),d=a(6964),u=a(9755),c=a.n(u),m={props:["itemType"],components:{IonContent:d.W2,IonHeader:d.Gu,IonToolbar:d.sr,IonTitle:d.wd,IonIcon:d.gu,IonImg:d.Xz,IonList:d.q_,IonItem:d.Ie,IonSearchbar:d.VI,IonSkeletonText:d.CK,IonAvatar:d.BJ},setup(){return{closeOutline:l.fID}},data(){const t=this.itemType?this.itemType:"order";return{query:null,itemList:null,itemTypeLabel:t,itemTypeName:""}},mounted(){this.listGet()},methods:{listGet(){var t=this;return(0,s.Z)((function*(){"order"==t.itemTypeLabel?(t.itemTypeName="Ð—Ð°ÐºÐ°Ð·",t.ordersGet()):"store"==t.itemTypeLabel?(t.itemTypeName="ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ†",t.storesGet()):"courier"==t.itemTypeLabel?(t.itemTypeName="ÐšÑƒÑ€ÑŒÐµÑ€",t.couriersGet()):"acc"==t.itemTypeLabel?(t.itemTypeName="Ð¡Ñ‡ÐµÑ‚",t.accountsGet()):t.$flash("unknown item type "+t.itemTypeLabel)}))()},storesGet(){var t=this;return(0,s.Z)((function*(){const e={name_query:t.query,name_query_fields:"store_name",limit:10};try{let a=yield c().post(`${t.$heap.state.hostname}Store/listGet`,e);t.itemList=a.map((t=>(t.name=`Ð¿Ñ€Ð¾Ð´Ð°Ð²ÐµÑ† ${t.store_name}`,t.id=t.store_id,t)))}catch(a){}}))()},couriersGet(){var t=this;return(0,s.Z)((function*(){const e={name_query:t.query,name_query_fields:"user_name,user_phone",limit:10};try{let a=yield c().post(`${t.$heap.state.hostname}Courier/listGet`,e);t.itemList=a.map((t=>(t.name=`ÐºÑƒÑ€ÑŒÐµÑ€ ${t.user_name} ${t.user_phone}`,t.id=t.courier_id,t.image_hash=t.courier_photo_image_hash,t)))}catch(a){}}))()},ordersGet(){var t=this;return(0,s.Z)((function*(){const e={name_query:t.query,name_query_fields:"store_name,order_id,user_name",limit:10};try{let a=yield c().post(`${t.$heap.state.hostname}Order/listGet`,e);t.itemList=a.map((t=>(t.name=`Ð·Ð°ÐºÐ°Ð·#${t.order_id} ${t.store_name} > ${t.user_name}`,t.id=t.order_id,t)))}catch(a){}}))()},accountsGet(){var t=this;return(0,s.Z)((function*(){const e={group_table:"transaction_account_list"};try{let a=yield c().post(`${t.$heap.state.hostname}Admin/GroupManager/listGet`,e);t.itemList=a.map((t=>(t.name=`${t.group_name}`,t.type=t.group_type,t)))}catch(a){}}))()},itemPick(t){d.Fy.dismiss(t)},closeModal(){d.Fy.dismiss()}}},_=a(3744);const p=(0,_.Z)(m,[["render",o]]);var h=p},2813:function(t,e,a){a.r(e),a.d(e,{default:function(){return y}});var i=a(6252),n=a(3577);function r(t,e,a,r,o,s){const l=(0,i.up)("ion-label"),d=(0,i.up)("ion-input"),u=(0,i.up)("ion-item"),c=(0,i.up)("ion-select-option"),m=(0,i.up)("ion-select"),_=(0,i.up)("ion-icon"),p=(0,i.up)("ion-chip"),h=(0,i.up)("ion-text"),g=(0,i.up)("ion-textarea"),f=(0,i.up)("ion-toggle"),y=(0,i.up)("ion-note"),w=(0,i.up)("ion-list"),v=(0,i.up)("ion-button"),k=(0,i.up)("ion-col"),$=(0,i.up)("ion-row"),D=(0,i.up)("ion-grid"),b=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(b,{pageDefaultBackLink:"/user","page-title":"Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÐ¸"},{default:(0,i.w5)((()=>[o.transaction?((0,i.wg)(),(0,i.j4)(w,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(l,{position:"floating"},{default:(0,i.w5)((()=>[(0,i.Uk)("Ð”Ð°Ñ‚Ð°")])),_:1}),(0,i.Wm)(d,{modelValue:o.transaction.trans_date,"onUpdate:modelValue":e[0]||(e[0]=t=>o.transaction.trans_date=t),placeholder:"Ð´Ð°Ñ‚Ð°",type:"date"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(l,{position:"floating"},{default:(0,i.w5)((()=>[(0,i.Uk)("Ð¢Ð¸Ð¿ Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÐ¸")])),_:1}),(0,i.Wm)(m,{interface:"popover",placeholder:"Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚Ð¸Ð¿ Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÐ¸",modelValue:o.transaction.trans_role,"onUpdate:modelValue":e[1]||(e[1]=t=>o.transaction.trans_role=t),required:"",onIonChange:e[2]||(e[2]=t=>s.itemUpdateRole(1))},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.transTypes,(t=>((0,i.wg)(),(0,i.j4)(c,{key:t.trans_role,value:t.trans_role},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(t.trans_name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,i.Wm)(u,{lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(l,{position:"stacked"},{default:(0,i.w5)((()=>[(0,i.Uk)("Ð Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹")])),_:1}),(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(o.tagDict,((t,e)=>((0,i.wg)(),(0,i.j4)(p,{key:e,color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)("#"+(0,n.zw)(t)+" ",1),-1==e.indexOf("acc")?((0,i.wg)(),(0,i.j4)(_,{key:0,src:r.closeCircle,onClick:t=>s.tagDictRemove(e)},null,8,["src","onClick"])):(0,i.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.tagMissingNames,(t=>((0,i.wg)(),(0,i.j4)(p,{key:t,onClick:e=>s.tagDictPick(t),color:"medium"},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{src:r.addOutline},null,8,["src"]),(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ #"+(0,n.zw)(o.tagHolderNames[t]),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(l,{position:"floating"},{default:(0,i.w5)((()=>[(0,i.Uk)("Ð¡ÑƒÐ¼Ð¼Ð°")])),_:1}),(0,i.Wm)(d,{modelValue:o.transaction.trans_amount,"onUpdate:modelValue":e[3]||(e[3]=t=>o.transaction.trans_amount=t),placeholder:"ÑÑƒÐ¼Ð¼Ð°",inputmode:"decimal",autocomplete:"transaction-amount",min:"1"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(l,{position:"floating"},{default:(0,i.w5)((()=>[(0,i.Uk)("ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹")])),_:1}),(0,i.Wm)(g,{modelValue:o.transaction.trans_description,"onUpdate:modelValue":e[4]||(e[4]=t=>o.transaction.trans_description=t)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(u,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Uk)("ÐžÑ‚ÐºÐ»ÑŽÑ‡ÐµÐ½Ð°")])),_:1}),(0,i.Wm)(f,{modelValue:o.transaction.is_disabled,"onUpdate:modelValue":e[5]||(e[5]=t=>o.transaction.is_disabled=t)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(u,{lines:"none"},{default:(0,i.w5)((()=>[o.transaction.created_at?((0,i.wg)(),(0,i.j4)(y,{key:0},{default:(0,i.w5)((()=>[(0,i.Uk)(" Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ "+(0,n.zw)(o.transaction.created_user_name)+" "+(0,n.zw)(o.transaction.created_at),1)])),_:1})):(0,i.kq)("",!0),o.transaction.created_at?((0,i.wg)(),(0,i.j4)(y,{key:1},{default:(0,i.w5)((()=>[(0,i.Uk)(" Ð˜Ð·Ð¼ÐµÐ½ÐµÐ½Ð¾ "+(0,n.zw)(o.transaction.updated_user_name)+" "+(0,n.zw)(o.transaction.updated_at),1)])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1})):(0,i.kq)("",!0),o.transaction?((0,i.wg)(),(0,i.j4)(D,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)($,null,{default:(0,i.w5)((()=>[(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(v,{color:"medium",onClick:e[6]||(e[6]=t=>s.itemDelete()),expand:"block"},{default:(0,i.w5)((()=>[(0,i.Uk)("Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ")])),_:1})])),_:1}),(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(v,{color:"primary",onClick:e[7]||(e[7]=t=>s.itemSave()),expand:"block"},{default:(0,i.w5)((()=>[(0,i.Uk)("Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ")])),_:1})])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1})}var o=a(8534),s=(a(6699),a(4916),a(5306),a(8862),a(3123),a(3948),a(6964)),l=a(8903),d=a(9755),u=a.n(d),c=a(351),m=a(4405),_=a(7208);const p=[{trans_role:"profit->site",holder:["order","store","courier"],trans_name:"Ð¡Ð°Ð¹Ñ‚ Ð”Ð¾Ñ…Ð¾Ð´ Ð¾Ñ‚ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸",trans_description:"Ð”Ð¾Ñ…Ð¾Ð´ Ð¾Ñ‚ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸. Ð—Ð°ÐºÐ°Ð· â„–{{order_id}}"},{trans_role:"site->profit",holder:[],trans_name:"Ð¡Ð°Ð¹Ñ‚ Ð¡Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¼ÐµÑÑÑ‡Ð½Ð¾Ð¹ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»Ð¸",trans_description:"Ð¡Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¼ÐµÑÑÑ‡Ð½Ð¾Ð¹ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»Ð¸"},{trans_role:"site->supplier",holder:["store"],trans_name:"ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ† Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ð°",trans_description:"Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ð° Ð¿Ð¾ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñƒ Ð·Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°ÐºÐ°Ð·Ñ‹"},{trans_role:"site.->supplier",holder:["order","store"],trans_name:"ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ† Ð¨Ñ‚Ñ€Ð°Ñ„",trans_description:"Ð¡Ñ€ÐµÐ´ÑÑ‚Ð²Ð° Ð²Ð·Ð¸Ð¼Ð°ÐµÐ¼Ñ‹Ðµ Ñ ÐŸÑ€Ð¾Ð´Ð°Ð²Ñ†Ð° Ð´Ð»Ñ Ð²Ð¾Ð²Ñ€Ð°Ñ‚Ð° Ð¾Ð¿Ð»Ð°Ñ‚Ñ‹ ÐŸÐ¾ÐºÑƒÐ¿Ð°Ñ‚ÐµÐ»ÑŽ. Ð—Ð°ÐºÐ°Ð· â„–{{order_id}}"},{trans_role:"supplier->site",holder:["order","store"],trans_name:"ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ† ÐžÑ‚Ð³Ñ€ÑƒÐ·ÐºÐ° Ð·Ð°ÐºÐ°Ð·Ð°",trans_description:"Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ‚Ð¾Ð²Ð°Ñ€Ð°, Ð¾Ñ‚Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð½Ð¾Ð³Ð¾ ÐŸÐ¾ÐºÑƒÐ¿Ð°Ñ‚ÐµÐ»ÑŽ. Ð—Ð°ÐºÐ°Ð· â„–{{order_id}}"},{trans_role:"profit->supplier",holder:["order","store"],trans_name:"ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ† ÐšÐ¾Ð¼Ð¸ÑÑÐ¸Ñ ÑÐ°Ð¹Ñ‚Ð°",trans_description:"ÐšÐ¾Ð¼Ð¸ÑÑÐ¸Ñ ÑÐ°Ð¹Ñ‚Ð° Ð·Ð° Ð¿Ñ€ÐµÐ´Ð¾ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸. Ð—Ð°ÐºÐ°Ð· â„–{{order_id}}"},{trans_role:"supplier->site",holder:["store"],trans_name:"ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ† ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð°Ð²Ð°Ð½ÑÐ°",trans_description:"ÐÐ²Ð°Ð½Ñ Ð·Ð° ÑƒÑÐ»ÑƒÐ³Ð¸ ÑÐ°Ð¹Ñ‚Ð°"},{trans_role:"supplier->profit",holder:["store"],trans_name:"ÐŸÑ€Ð¾Ð´Ð°Ð²ÐµÑ† ÐÐ°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð±Ð¾Ð½ÑƒÑÐ° Ð¿Ñ€Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸",trans_description:"ÐÐ°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð±Ð¾Ð½ÑƒÑÐ° Ð½Ð° ÑƒÑÐ»ÑƒÐ³Ð¸ Ð¿Ñ€Ð¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð½Ð° ÑÐ°Ð¹Ñ‚Ðµ"},{trans_role:"site->courier",holder:["courier"],trans_name:"ÐšÑƒÑ€ÑŒÐµÑ€ Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ð°",trans_description:"Ð’Ñ‹Ð¿Ð»Ð°Ñ‚Ð° Ð¿Ð¾ Ð´Ð¾Ð³Ð¾Ð²Ð¾Ñ€Ñƒ Ð·Ð° Ð¾ÐºÐ°Ð·Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑÐ»ÑƒÐ³Ð¸"},{trans_role:"courier->profit",holder:["order","courier"],trans_name:"ÐšÑƒÑ€ÑŒÐµÑ€ ÐÐ°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð±Ð¾Ð½ÑƒÑÐ°",trans_description:"ÐÐ°Ñ‡Ð¸ÑÐ»ÐµÐ½Ð¸Ðµ Ð±Ð¾Ð½ÑƒÑÐ° Ð·Ð° Ð—Ð°ÐºÐ°Ð· â„–{{order_id}}"},{trans_role:"profit->courier",holder:["order","courier"],trans_name:"ÐšÑƒÑ€ÑŒÐµÑ€ Ð¨Ñ‚Ñ€Ð°Ñ„",trans_description:"Ð¨Ñ‚Ñ€Ð°Ñ„ Ð·Ð° Ð½Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ð—Ð°ÐºÐ°Ð·Ð° â„–{{order_id}}"}];var h={components:{IonInput:s.pK,IonIcon:s.gu,IonList:s.q_,IonItem:s.Ie,IonToggle:s.ho,IonLabel:s.Q$,IonSelect:s.t9,IonSelectOption:s.n0,IonTextarea:s.g2,IonButton:s.YG,IonGrid:s.jY,IonRow:s.Nd,IonCol:s.wI,IonNote:s.uN,IonChip:s.hM,IonText:s.yW},setup(){return{trashOutline:l.gtu,searchOutline:l.W6I,addOutline:l.s6O,closeCircle:l.XZx}},data(){return{transactionId:this.$route.params.id,transaction:null,transTypes:p,tagDict:{},tagHolderNames:{order:"Ð·Ð°ÐºÐ°Ð·",store:"Ð¿Ñ€Ð¾Ð´Ð°Ð²ÐµÑ†",courier:"ÐºÑƒÑ€ÑŒÐµÑ€",acc:"ÑÑ‡ÐµÑ‚"},tagOptionNames:{debit:"(+)",credit:"(-)"}}},computed:{tagRequired(){var t;return(null===(t=this.transTypeCurrent)||void 0===t?void 0:t.holder)||[]},tagMissingNames(){var t;return(null===(t=this.tagRequired)||void 0===t?void 0:t.filter((t=>!Object.keys(this.tagDict).join(":").includes(t))))||""},transTypeCurrent(){return this.transTypes.find((t=>t.trans_role==this.transaction.trans_role))||[]}},created(){const t=this;this.$topic.on("userGet",(()=>{t.init()})),c.Z.isAdmin()&&this.init()},methods:{init(){c.Z.isAdmin()||this.$router.replace("/"),this.itemGet()},itemGet(){var t=this;return(0,o.Z)((function*(){if(0==t.transactionId)return void(t.transaction={});let e={trans_id:t.transactionId};try{var a,i;if(t.transaction=yield m.Z.prePost(`${t.$heap.state.hostname}Transaction/itemGet`,e),t.transaction)t.transaction.trans_date=null===(i=t.transaction.trans_date)||void 0===i?void 0:i.substring(0,10),t.transaction.is_disabled=1*t.transaction.is_disabled,t.tagDictFill(t.transaction.tags);t.transaction=yield m.Z.post(`${t.$heap.state.hostname}Transaction/itemGet`,e),t.transaction.trans_date=null===(a=t.transaction.trans_date)||void 0===a?void 0:a.substring(0,10),t.transaction.is_disabled=1*t.transaction.is_disabled,t.tagDictFill(t.transaction.tags)}catch(o){var n,r;console.log(o);const e=null===o||void 0===o||null===(n=o.responseJSON)||void 0===n||null===(r=n.messages)||void 0===r?void 0:r.error;switch(e){case"forbidden":t.$flash("ÐÐµ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¿Ñ€Ð°Ð²");break;case"notfound":t.$flash("ÐŸÑ€Ð¾Ð²Ð¾Ð´ÐºÐ° Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ð°");break}return!1}}))()},validate(){return this.tagMissingNames.length>0?(this.$flash("ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹ Ð²ÑÐµ Ñ€Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ðµ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ñ‹"),!1):this.transaction.trans_role?this.transaction.trans_date?0!=this.transaction.trans_amount||(this.$flash("Ð¡ÑƒÐ¼Ð¼Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð½Ðµ Ñ€Ð°Ð²Ð½ÑÑ‚ÑŒÑÑ Ð½ÑƒÐ»ÑŽ"),!1):(this.$flash("Ð”Ð°Ñ‚Ð° Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð°"),!1):(this.$flash("Ð¢Ð¸Ð¿ Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÐ¸ Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½"),!1)},itemSave(){var t=this;return(0,o.Z)((function*(){var e;if(!t.validate())return;const a=Object.keys(null!==(e=t.tagDict)&&void 0!==e?e:{}).join(" "),i={tags:a,trans_id:t.transaction.trans_id,trans_date:t.transaction.trans_date,trans_amount:t.transaction.trans_amount,trans_role:t.transaction.trans_role,trans_description:t.transaction.trans_description,is_disabled:t.transaction.is_disabled};try{const e=i.trans_id?"itemUpdate":"itemCreate";yield u().post(`${t.$heap.state.hostname}Transaction/${e}`,JSON.stringify(i)),t.$flash("ðŸ’¾ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¾"),t.$router.go(-1)}catch(o){var n,r;const e=null===o||void 0===o||null===(n=o.responseJSON)||void 0===n||null===(r=n.messages)||void 0===r?void 0:r.error;switch(e){case"forbidden":t.$flash("ÐÐµ Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¿Ñ€Ð°Ð²");break}return t.$flash("ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐ¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÑƒ"),!1}}))()},itemUpdateRole(){var t=this;return(0,o.Z)((function*(){t.transTypeCurrent?t.tagDictTruncate():t.$flash("ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ñ‚Ð¸Ð¿ Ð¿Ñ€Ð¾Ð²Ð¾Ð´ÐºÐ¸")}))()},itemDescriptionRender(){if(!this.transTypeCurrent.trans_description)return;const t=this.transTypeCurrent.trans_description;let e=this.transaction;for(let a in this.tagDict){this.tagDict[a];const t=a.split(":"),i=t[0];e[`${i}_id`]=t[1]}this.transaction.trans_description=m.Z.render(t,e)},itemDelete(){var t=this;return(0,o.Z)((function*(){if(confirm("Ð’Ñ‹ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ñ‹?"))try{yield u().post(`${t.$heap.state.hostname}Transaction/itemDelete`,{trans_id:t.transactionId}),t.$router.go(-1)}catch(e){}}))()},tagDictPick(t){var e=this;return(0,o.Z)((function*(){var a,i,n,r;const o=yield s.Fy.create({component:_.Z,componentProps:{itemType:t},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});o.present(),e.$topic.on("dismissModal",(()=>{o.dismiss()}));const l=yield o.onDidDismiss();if(l.data){if(null!==(a=l.data.order_id)&&void 0!==a&&a){e.tagDictAdd([`order:${l.data.order_id}`,`Ð·Ð°ÐºÐ°Ð· ${l.data.order_id}`]);const t=yield u().post(`${e.$heap.state.hostname}Order/itemGet`,{order_id:l.data.order_id});var d;if(e.tagRequired.includes("store")&&t.order_store_id)e.tagDictNameRemove("store"),l.data.store_id=t.order_store_id,l.data.store_name=null===t||void 0===t||null===(d=t.store)||void 0===d?void 0:d.store_name;if(e.tagRequired.includes("courier")&&t.order_courier_id){const a=yield u().post(`${e.$heap.state.hostname}Courier/itemGet`,{courier_id:t.order_courier_id});e.tagDictNameRemove("courier"),l.data.courier_id=a.courier_id,l.data.courier_name=a.courier_name}}var c,m,p;if(null!==(i=l.data.store_id)&&void 0!==i&&i)e.tagDictAdd([`store:${l.data.store_id}`,`Ð¿Ñ€Ð¾Ð´Ð°Ð²ÐµÑ† ${null!==(c=l.data.store_name)&&void 0!==c?c:"?"}`]);if(null!==(n=l.data.courier_id)&&void 0!==n&&n)e.tagDictAdd([`courier:${l.data.courier_id}`,`ÐºÑƒÑ€ÑŒÐµÑ€ ${null!==(m=l.data.courier_name)&&void 0!==m?m:"?"}`]);if(null!==(r=l.data.type)&&void 0!==r&&r)e.tagDictAdd([`acc::${l.data.type}`,`ÑÑ‡ÐµÑ‚ ${null!==(p=l.data.name)&&void 0!==p?p:"?"}`])}}))()},tagDictAdd(t){var e;let a=null!==(e=this.tagDict)&&void 0!==e?e:{};a[t[0]]=t[1],this.tagDict=a,this.itemDescriptionRender()},tagDictRemove(t){var e;let a=null!==(e=this.tagDict)&&void 0!==e?e:{};a[t]&&delete a[t];const i=Object.keys(a).length;this.tagDict=i?a:{},this.itemDescriptionRender()},tagDictNameRemove(t){var e,a;let i=null!==(e=this.tagDict)&&void 0!==e?e:{};const n=null===(a=Object.keys(i))||void 0===a?void 0:a.find((e=>e.indexOf(t)>-1));this.tagDictRemove(n)},tagDictTruncate(){this.tagDict={},this.itemDescriptionRender()},tagDictFill(t){let e={};if(t)for(let n of t){var a,i;e[`${n.tag_name}:${n.tag_id}:${n.tag_type}:${n.tag_option}`]=`${this.tagHolderNames[n.tag_name]} ${null!==(a=this.tagOptionNames[n.tag_option])&&void 0!==a?a:""} ${null!==(i=n.tag_label)&&void 0!==i?i:"(?)"}`}this.tagDict=e,this.itemDescriptionRender()}}},g=a(3744);const f=(0,g.Z)(h,[["render",r]]);var y=f}}]);
//# sourceMappingURL=813-legacy.a8a56331.js.map