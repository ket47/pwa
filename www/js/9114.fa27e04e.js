"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[9114],{2559:function(t,e,l){l.d(e,{Z:function(){return S}});var a=l(6252),n=l(3577);const i=t=>((0,a.dD)("data-v-38c26abe"),t=t(),(0,a.Cn)(),t),o={slot:"end",style:{display:"grid","grid-template-columns":"120px"}},r={slot:"end",style:{display:"grid","grid-template-columns":"120px"}},s={class:"horizontalScroller"},d={key:1,class:"printDiv"},u={class:"table_head"},c=i((()=>(0,a._)("div",null,"Количество",-1))),p=i((()=>(0,a._)("div",null,"Скидка",-1))),v=i((()=>(0,a._)("div",null,"Сумма",-1))),_=i((()=>(0,a._)("div",null,"Вознаграждение",-1))),m=i((()=>(0,a._)("div",null,"К выплате",-1))),h={class:"table",style:{"overflow-x":"scroll"}},w=(0,a.uE)('<div class="table_h" data-v-38c26abe><div data-v-38c26abe>Время</div><div data-v-38c26abe>Заказ №</div><div data-v-38c26abe>Товар</div><div data-v-38c26abe>Цена</div><div data-v-38c26abe>Количество</div><div data-v-38c26abe>Скидка</div><div data-v-38c26abe>Сумма</div><div data-v-38c26abe>Вознаграждение %</div><div data-v-38c26abe>Доставка</div><div data-v-38c26abe>Оплата</div><div data-v-38c26abe>Чек</div></div>',1),f=["href"];function k(t,e,l,i,k,g){const y=(0,a.up)("ion-icon"),b=(0,a.up)("ion-text"),W=(0,a.up)("ion-item"),I=(0,a.up)("ion-input"),D=(0,a.up)("ion-list"),O=(0,a.up)("ion-accordion"),S=(0,a.up)("ion-accordion-group"),z=(0,a.up)("ion-label"),$=(0,a.up)("ion-chip"),x=(0,a.up)("ion-searchbar"),C=(0,a.up)("ion-skeleton-text");return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(S,null,{default:(0,a.w5)((()=>[(0,a.Wm)(O,{value:"period"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,{slot:"header"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{icon:i.calendarOutline,slot:"start"},null,8,["icon"]),(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Период "),(0,a._)("small",null,(0,n.zw)(k.start_at)+" до "+(0,n.zw)(k.finish_at),1)])),_:1})])),_:1}),(0,a.Wm)(D,{slot:"content"},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Начальная дата")])),_:1}),(0,a._)("div",o,[(0,a.Wm)(I,{type:"date",modelValue:k.start_at,"onUpdate:modelValue":e[0]||(e[0]=t=>k.start_at=t),onIonInput:e[1]||(e[1]=t=>g.reportGet())},null,8,["modelValue"])])])),_:1}),(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Конечная дата")])),_:1}),(0,a._)("div",r,[(0,a.Wm)(I,{type:"date",modelValue:k.finish_at,"onUpdate:modelValue":e[2]||(e[2]=t=>k.finish_at=t),onIonInput:e[3]||(e[3]=t=>g.reportGet())},null,8,["modelValue"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a._)("div",s,[(0,a.Wm)($,{onClick:e[4]||(e[4]=t=>g.reportExport()),color:"medium"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{src:i.downloadOutline},null,8,["src"]),(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Скачать")])),_:1})])),_:1}),(0,a.Wm)($,{onClick:e[5]||(e[5]=t=>g.reportGet()),color:"medium"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{src:i.reloadOutline},null,8,["src"]),(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Обновить")])),_:1})])),_:1})]),(0,a.Wm)(x,{modelValue:k.searchQuery,"onUpdate:modelValue":e[6]||(e[6]=t=>k.searchQuery=t),placeholder:"Поиск по товару",onIonInput:e[7]||(e[7]=t=>g.reportGet()),debounce:"500"},null,8,["modelValue"]),null==k.report?((0,a.wg)(),(0,a.j4)(D,{key:0},{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)([1,2,3],(t=>(0,a.Wm)(W,{key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{animated:"",style:{width:"50px"}})])),_:1}),(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(C,{animated:"",style:{width:"100%"}})])),_:1}),(0,a.Wm)(z,{slot:"end",color:"success"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{animated:"",style:{width:"50px"}})])),_:1})])),_:2},1024))),64))])),_:1})):k.report.body.length>0?((0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("div",u,[c,(0,a._)("div",null,(0,n.zw)(k.report.head.total_quantity),1),p,(0,a._)("div",null,(0,n.zw)(k.report.head.total_discount),1),v,(0,a._)("div",null,(0,n.zw)(k.report.head.total_sum),1),_,(0,a._)("div",null,(0,n.zw)(k.report.head.total_commission),1),m,(0,a._)("div",null,(0,n.zw)(k.report.head.total_topay),1)]),(0,a._)("div",h,[w,((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(k.report.body,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"table_r"},[(0,a._)("div",null,(0,n.zw)(t.created_at),1),(0,a._)("div",null,(0,n.zw)(t.order_id),1),(0,a._)("div",null,(0,n.zw)(t.entry_text),1),(0,a._)("div",null,(0,n.zw)(t.entry_price),1),(0,a._)("div",null,(0,n.zw)(t.entry_quantity),1),(0,a._)("div",null,(0,n.zw)(t.entry_discount),1),(0,a._)("div",null,(0,n.zw)(t.entry_sum),1),(0,a._)("div",null,(0,n.zw)(t.fee),1),(0,a._)("div",null,(0,n.zw)(t.delivery),1),(0,a._)("div",null,(0,n.zw)(t.payment_type),1),(0,a._)("div",null,[t.invoice_link?((0,a.wg)(),(0,a.iD)("a",{key:0,href:t.invoice_link,target:"_new"},"онлайн чек",8,f)):(0,a.kq)("",!0)])])))),128))])])):((0,a.wg)(),(0,a.j4)(D,{key:2},{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" Нет заказов в данном периоде ")])),_:1})])),_:1}))])}var g=l(4929),y=l(8903),b=l(9755),W=l.n(b),I={components:{IonIcon:g.gu,IonLabel:g.Q$,IonItem:g.Ie,IonInput:g.pK,IonList:g.q_,IonAccordion:g.We,IonAccordionGroup:g.eh,IonText:g.yW,IonSkeletonText:g.CK,IonSearchbar:g.VI,IonChip:g.hM},props:["store"],setup(){return{calendarOutline:y.rom,addOutline:y.s6O,closeCircle:y.XZx,pricetagOutline:y.TuG,downloadOutline:y.aO1,reloadOutline:y.Lk3,printOutline:y.x3A}},data(){console.log(this.query);const t=new Date,e=new Date(Date.parse(`${t.getFullYear()}-${t.getMonth()+1}-01Z`));return{start_at:e.toISOString().slice(0,10),finish_at:t.toISOString().slice(0,10),searchQuery:"",report:null,today:t}},watch:{store:function(){this.reportGet()}},methods:{async reportGet(){var t;if(null===(t=this.store)||void 0===t||!t.store_id)return this.report=null,void(this.head=null);try{var e;const t={store_id:null===(e=this.store)||void 0===e?void 0:e.store_id,start_at:this.start_at,finish_at:this.finish_at,searchQuery:this.searchQuery},l=await W().post(`${this.$heap.state.hostname}Statistics/sellReportProductGet`,t);this.report=l}catch(n){var l,a;const t=null===n||void 0===n||null===(l=n.responseJSON)||void 0===l||null===(a=l.messages)||void 0===a?void 0:a.error;switch(t){case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break;default:this.$flash("Ошибка получения выписки");break}return this.ledger=[],this.balance=0,!1}},reportPrint(){window.print()},async reportExport(){var t;if(null===(t=this.store)||void 0===t||!t.store_id)return this.report=null,void(this.head=null);try{var e;const t={store_id:null===(e=this.store)||void 0===e?void 0:e.store_id,start_at:this.start_at,finish_at:this.finish_at,searchQuery:this.searchQuery,output:"xlsx"},l=await W().post(`${this.$heap.state.hostname}Statistics/sellReportProductGet`,t),a=this.store.store_name.replace(/[^\wа-яА-Я]/gi,""),n=`${this.$heap.state.hostname}Statistics/download/${l}/sellReport_${a}_${this.start_at}.xlsx`,i=document.createElement("a");i.href=n,i.click()}catch(n){var l,a;const t=null===n||void 0===n||null===(l=n.responseJSON)||void 0===l||null===(a=l.messages)||void 0===a?void 0:a.error;switch(t){case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break;default:this.$flash("Ошибка получения выписки"),console.log(n);break}return this.ledger=[],this.balance=0,!1}},toLocDate(t){const e=new Date(Date.parse(t)),l={month:"short",day:"numeric"};return e.toLocaleDateString(void 0,l)}},mounted(){this.reportGet()}},D=l(3744);const O=(0,D.Z)(I,[["render",k],["__scopeId","data-v-38c26abe"]]);var S=O},5636:function(t,e,l){l.r(e),l.d(e,{default:function(){return h}});var a=l(6252),n=l(3577);const i={key:0},o={key:1};function r(t,e,l,r,s,d){const u=(0,a.up)("ion-segment-button"),c=(0,a.up)("ion-segment"),p=(0,a.up)("ion-icon"),v=(0,a.up)("ion-label"),_=(0,a.up)("ion-item"),m=(0,a.up)("ion-list"),h=(0,a.up)("ledger-comp"),w=(0,a.up)("statistics-seller-report"),f=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(f,{pageDefaultBackLink:"/user","page-title":"Бухгалтерия"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{"swipe-gesture":"true",modelValue:s.activeTab,"onUpdate:modelValue":e[0]||(e[0]=t=>s.activeTab=t),onIonInput:e[1]||(e[1]=e=>t.listTypeChanged(e))},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{value:"ledger"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Проводки ")])),_:1}),(0,a.Wm)(u,{value:"sellerReport"},{default:(0,a.w5)((()=>[(0,a.Uk)(" Отчет ")])),_:1})])),_:1},8,["modelValue"]),"ledger"==s.activeTab?((0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(_,{button:"",onClick:e[2]||(e[2]=t=>d.itemCreate())},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{slot:"start",src:r.addOutline},null,8,["src"]),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Добавить проводку")])),_:1})])),_:1})])),_:1}),(0,a.Wm)(h,{account:s.ledgerAccount,ref:"ledger"},null,8,["account"])])):(0,a.kq)("",!0),"sellerReport"==s.activeTab?((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[s.pickedStore?((0,a.wg)(),(0,a.j4)(_,{key:0,button:"",onClick:e[3]||(e[3]=t=>d.storePick()),color:"primary"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{slot:"start",src:r.storefrontOutline},null,8,["src"]),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(s.pickedStore.store_name),1)])),_:1})])),_:1})):((0,a.wg)(),(0,a.j4)(_,{key:1,button:"",onClick:e[4]||(e[4]=t=>d.storePick()),color:"warning"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{slot:"start",src:r.storefrontOutline},null,8,["src"]),(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Выбрать продавца")])),_:1})])),_:1}))])),_:1}),"sellerReport"==s.activeTab?((0,a.wg)(),(0,a.j4)(w,{key:0,store:s.pickedStore},null,8,["store"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)])),_:1})}var s=l(4929),d=l(8903),u=l(6561),c=l(2559),p=l(6852),v={components:{LedgerComp:u.Z,IonSegmentButton:s.GO,IonSegment:s.cJ,IonList:s.q_,IonItem:s.Ie,IonLabel:s.Q$,IonIcon:s.gu,StatisticsSellerReport:c.Z},setup(){return{addOutline:d.s6O,refreshOutline:d.D3P,storefrontOutline:d.qRG}},data(){return{activeTab:"ledger",ledgerAccount:"supplier",pickedStore:null}},computed:{},methods:{itemCreate(){this.$go("/admin/transaction-edit-0")},async storePick(){const t=await s.Fy.create({component:p.Z,componentProps:{itemType:"store"},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});t.present(),this.$topic.on("dismissModal",(()=>{t.dismiss()}));const e=await t.onDidDismiss();e.data&&(this.pickedStore=e.data)}},ionViewDidEnter(){this.$refs.ledger.listGet()}},_=l(3744);const m=(0,_.Z)(v,[["render",r],["__scopeId","data-v-3813af75"]]);var h=m}}]);
//# sourceMappingURL=9114.fa27e04e.js.map