"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[516],{6622:function(e,t,i){i.d(t,{Z:function(){return D}});var a=i(6252),l=i(3577);const o=(0,a.Uk)("Фотографии"),s={key:0,class:"image_grid"},n=["onClick"],r={key:0},d={key:1},c={key:0,class:"image_controls"},u=["id"];function m(e,t,i,m,h,p){const _=(0,a.up)("ion-label"),g=(0,a.up)("ion-icon"),f=(0,a.up)("ion-item"),k=(0,a.up)("ion-img"),w=(0,a.up)("ion-avatar");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",null,[(0,a.Wm)(f,{lines:"none",onClick:t[0]||(t[0]=e=>{h.editMode=!h.editMode,h.editMode&&p.load()})},{default:(0,a.w5)((()=>[(0,a.Wm)(_,{color:"imageList?.length?'':medium"},{default:(0,a.w5)((()=>[o])),_:1}),h.editMode?((0,a.wg)(),(0,a.j4)(g,{key:0,slot:"end",icon:m.settingsSharp,color:"primary"},null,8,["icon"])):((0,a.wg)(),(0,a.j4)(g,{key:1,slot:"end",icon:m.settingsOutline},null,8,["icon"]))])),_:1}),p.imageList?.length?((0,a.wg)(),(0,a.iD)("div",s,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(p.imageList,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t.image_id,style:{position:"relative"}},[(0,a._)("div",{style:{position:"absolute",top:"0px","background-color":"#fffc","font-size":"0.75em"},onClick:e=>p.imagePreview(t.image_hash)},[t.deleted_at?((0,a.wg)(),(0,a.iD)("div",r,"будет удалено")):1==t.is_disabled?((0,a.wg)(),(0,a.iD)("div",d,"на модерации")):(0,a.kq)("",!0)],8,n),(0,a.Wm)(w,{onClick:e=>p.imagePreview(t.image_hash),class:(0,l.C_)(t.class)},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),h.editMode?((0,a.wg)(),(0,a.iD)("div",c,[(0,a.Wm)(g,{icon:m.chevronBackCircleOutline,onClick:e=>p.back(t)},null,8,["icon","onClick"]),p.isAdmin&&1==t.is_disabled?((0,a.wg)(),(0,a.j4)(g,{key:0,icon:m.checkmarkCircle,color:"success",onClick:e=>p.enable(t)},null,8,["icon","onClick"])):(0,a.kq)("",!0),t.deleted_at?((0,a.wg)(),(0,a.j4)(g,{key:1,icon:m.addCircle,color:"success",onClick:e=>p.restore(t)},null,8,["icon","onClick"])):((0,a.wg)(),(0,a.j4)(g,{key:2,icon:m.trash,color:"danger",onClick:e=>p.remove(t)},null,8,["icon","onClick"])),(0,a.Wm)(g,{icon:m.chevronForwardCircleOutline,onClick:e=>p.forward(t)},null,8,["icon","onClick"])])):(0,a.kq)("",!0)])))),128))])):(0,a.kq)("",!0)]),(0,a._)("input",{type:"file",id:h.fileUploaderId,accept:"image/*",onChange:t[1]||(t[1]=e=>p.uploadImage(e)),style:{display:"none"}},null,40,u)],64)}var h=i(8903),p=i(4444);const _=(0,a.Uk)("Просмотр фотографии");function g(e,t,i,l,o,s){const n=(0,a.up)("ion-title"),r=(0,a.up)("ion-icon"),d=(0,a.up)("ion-toolbar"),c=(0,a.up)("ion-header"),u=(0,a.up)("ion-img"),m=(0,a.up)("ion-content");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[_])),_:1}),(0,a.Wm)(r,{icon:l.closeOutline,onClick:t[0]||(t[0]=e=>{l.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{src:e.$heap.state.hostname+"image/get.php/"+i.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var f={props:["image_hash"],components:{IonIcon:p.gu,IonToolbar:p.sr,IonHeader:p.Gu,IonImg:p.Xz,IonContent:p.W2,IonTitle:p.wd},setup(){const e=function(){p.Fy.dismiss()};return{closeModal:e,closeOutline:h.fID}}},k=i(3744);const w=(0,k.Z)(f,[["render",g]]);var I=w,y=i(9755),C=i.n(y),W=i(9042),b=i(351),v={props:["images","image_holder_id","controller"],components:{IonLabel:p.Q$,IonIcon:p.gu,IonItem:p.Ie,IonImg:p.Xz,IonAvatar:p.BJ},setup(){return{settingsOutline:h.C$N,settingsSharp:h.kiF,chevronBackCircleOutline:h.CK0,chevronForwardCircleOutline:h.esm,trash:h._Ij,addCircle:h.ZWo,checkmarkCircle:h.I1A}},data(){return{images_loaded:null,editMode:!1,fileUploaderId:this.controller+this.image_holder_id}},computed:{imageList(){let e=this.images_loaded||this.images,t=[];for(let i in e)e[i].deleted_at?(e[i].class=" deleted",this.editMode&&t.push(e[i])):1==e[i].is_disabled?(e[i].class=" disabled",this.editMode&&t.push(e[i])):t.push(e[i]);return t},isAdmin(){return b.Z.isAdmin()}},methods:{async back(e){try{await C().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),this.load()}catch{}},async forward(e){try{await C().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),this.load()}catch{}},async remove(e){try{await C().post(this.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено в корзину и будет удалено")}catch{}},async restore(e){try{await C().post(this.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено извлечено из корзины")}catch{}},async enable(e){try{await C().post(this.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),this.load()}catch{}},async load(){const e={image_holder_id:this.image_holder_id,image_holder:this.controller,is_disabled:1,is_deleted:1,is_active:1};this.images_loaded=await C().post(this.$heap.state.hostname+"Image/listGet",e)},async imagePreview(e){const t=await p.Fy.create({component:I,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[.5,1]}),i=function(){t.dismiss()};return W.Z.on("dismissModal",i),t.present()},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.image_holder_id);const i={url:this.$heap.state.hostname+this.controller+"/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await C().ajax(i),this.load()}catch(a){if("limit_exeeded"==a?.responseJSON?.messages?.error)return void this.$flash("Уже загружено максимальное количество фото");this.$flash("Не удалось загрузить фото")}},take_photo(){C()(`#${this.fileUploaderId}`).trigger("click"),this.editMode=!0}}};const U=(0,k.Z)(v,[["render",m],["__scopeId","data-v-43cc4d45"]]);var D=U},2516:function(e,t,i){i.r(t),i.d(t,{default:function(){return M}});var a=i(6252),l=i(3577);const o=e=>((0,a.dD)("data-v-f631d64c"),e=e(),(0,a.Cn)(),e),s={key:0},n=(0,a.Uk)("Пока вы не курьер"),r=(0,a.Uk)(" Подавая заявку вы даете согласие на условия "),d=o((()=>(0,a._)("a",{href:"#/page-courier_contract"},"Договор о предоставлении услуг",-1))),c=(0,a.Uk)("Стать курьером"),u={key:1},m=(0,a.Uk)(" Анкета активна. Вы можете открыть смену для приема заказов. "),h=(0,a.Uk)(" Удалено "),p=(0,a.Uk)(" На модерации "),_=(0,a.Uk)("Основные настройки"),g=(0,a.Uk)("Транспорт"),f=(0,a.Uk)("ИНН"),k=(0,a.Uk)("Коментарий"),w=(0,a.Uk)("Ваше фото"),I=(0,a.Uk)(" Добавить "),y=(0,a.Uk)("Информация"),C=(0,a.Uk)(" Оферта об оказании услуг доставки ");function W(e,t,i,o,W,b){const v=(0,a.up)("ion-label"),U=(0,a.up)("ion-item"),D=(0,a.up)("ion-text"),O=(0,a.up)("ion-checkbox"),$=(0,a.up)("ion-button"),V=(0,a.up)("ion-card"),Z=(0,a.up)("ion-card-content"),x=(0,a.up)("ion-icon"),T=(0,a.up)("ion-toggle"),M=(0,a.up)("ion-item-divider"),j=(0,a.up)("ion-input"),A=(0,a.up)("ion-textarea"),z=(0,a.up)("ion-list"),F=(0,a.up)("image-tile-comp"),S=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(S,{"page-title":"Анкета курьера","page-default-back-link":"/user-dashboard"},{default:(0,a.w5)((()=>[W.courier?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[n])),_:1})])),_:1}),(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[r,d])),_:1}),(0,a.Wm)(O,{modelValue:W.contractAccepted,"onUpdate:modelValue":t[0]||(t[0]=e=>W.contractAccepted=e),slot:"end"},null,8,["modelValue"])])),_:1}),(0,a.Wm)($,{expand:"full",onClick:t[1]||(t[1]=e=>b.itemCreate()),disabled:!W.contractAccepted},{default:(0,a.w5)((()=>[c])),_:1},8,["disabled"])])),_:1})])),W.courier?((0,a.wg)(),(0,a.iD)("div",u,[b.message?((0,a.wg)(),(0,a.j4)(V,{key:0,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:(0,l.C_)(b.messageClass)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(b.message),1)])),_:1},8,["class"])])),_:1})):((0,a.wg)(),(0,a.j4)(V,{key:1,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,a.w5)((()=>[m])),_:1})])),_:1})),(0,a._)("form",{onChange:t[9]||(t[9]=e=>b.updateCourier())},[(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,{src:o.trashOutline,color:"primary",slot:"start"},null,8,["src"]),h,(0,a.Wm)(T,{slot:"end",modelValue:W.is_deleted,"onUpdate:modelValue":t[2]||(t[2]=e=>W.is_deleted=e),color:"danger",onIonChange:t[3]||(t[3]=e=>b.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a.Wm)(x,{src:o.searchOutline,color:"primary",slot:"start"},null,8,["src"]),p,(0,a.Wm)(T,{slot:"end",modelValue:W.is_disabled,"onUpdate:modelValue":t[4]||(t[4]=e=>W.is_disabled=e),onIonChange:t[5]||(t[5]=e=>b.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[_])),_:1})])),_:1}),(0,a.Wm)(U,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{position:"stacked",color:"primary"},{default:(0,a.w5)((()=>[g])),_:1}),(0,a.Wm)(j,{modelValue:W.courier.courier_vehicle,"onUpdate:modelValue":t[6]||(t[6]=e=>W.courier.courier_vehicle=e),placeholder:"автомобиль, мопед, велосипед"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(U,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{position:"stacked",color:"primary"},{default:(0,a.w5)((()=>[f])),_:1}),(0,a.Wm)(j,{modelValue:W.courier.courier_tax_num,"onUpdate:modelValue":t[7]||(t[7]=e=>W.courier.courier_tax_num=e),placeholder:"Ваш ИНН"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(U,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{position:"stacked",color:"primary"},{default:(0,a.w5)((()=>[k])),_:1}),(0,a.Wm)(A,{modelValue:W.courier.courier_comment,"onUpdate:modelValue":t[8]||(t[8]=e=>W.courier.courier_comment=e),placeholder:"Цвет, номер авто"},null,8,["modelValue"])])),_:1})])),_:1})],32),W.courier?((0,a.wg)(),(0,a.j4)(z,{key:2},{default:(0,a.w5)((()=>[(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[w])),_:1})])),_:1}),(0,a.Wm)(F,{images:W.courier.images,image_holder_id:W.courier.courier_id,controller:"Courier",ref:"courierImgs"},null,8,["images","image_holder_id"]),(0,a.Wm)($,{onClick:t[10]||(t[10]=t=>e.$refs.courierImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{src:o.cameraOutline},null,8,["src"]),I])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(z,null,{default:(0,a.w5)((()=>[(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[y])),_:1})])),_:1}),(0,a.Wm)(U,{lines:"none",button:"",detail:"",onClick:t[11]||(t[11]=t=>e.$router.push("/page-courier_contract"))},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{src:o.documentTextOutline,slot:"start"},null,8,["src"]),(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[C])),_:1})])),_:1})])),_:1})])):(0,a.kq)("",!0)])),_:1})}var b=i(4444),v=i(8903),U=i(9755),D=i.n(U),O=i(2008),$=i(351),V=i(6622),Z={components:{imageTileComp:V.Z,IonTextarea:b.g2,IonInput:b.pK,IonCard:b.PM,IonCardContent:b.FN,IonLabel:b.Q$,IonItem:b.Ie,IonButton:b.YG,IonImg:b.Xz,IonThumbnail:b.Bs,IonList:b.q_,IonCheckbox:b.nz,IonText:b.yW,IonItemDivider:b.rH,IonItemGroup:b.Ub,IonToggle:b.ho,IonIcon:b.gu},setup(){return{cameraOutline:v.kuq,trashOutline:v.gtu,searchOutline:v.W6I,documentTextOutline:v.L82}},data(){return{courier:$.Z.courier.data,isAdmin:$.Z.isAdmin(),contractAccepted:0,is_deleted:0,is_disabled:0}},mounted(){this.itemGet()},computed:{message(){return this.courier.deleted_at?"Анкета не активна и будет удалена. Вы можете еще отменить удаление":1==this.courier.is_disabled?"Анкета не активна и находится на рассмотрении у администратора":null},messageClass(){return this.courier.deleted_at?"deleted":1==this.courier.is_disabled?"disabled":null},imageClass(){return 1==this.courier?.images[0]?.is_disabled?"image_disabled":""}},methods:{async itemGet(){try{this.courier=await $.Z.courier.get()}catch(e){const t=JSON.parse(e.responseJSON?.status);"404"==t&&this.$flash("Анкета не найдена")}this.itemParseFlags()},itemParseFlags(){this.is_deleted=null==this.courier.deleted_at?0:1,this.is_disabled=0==this.courier.is_disabled?0:1},async itemCreate(){try{await D().post(O.Z.state.hostname+"Courier/itemCreate"),await $.Z.get(),this.courier=$.Z.courier.data}catch{this.$flash("Не удалось зарегистрироваться как курьер")}},async itemDelete(e){const t=e?"itemDelete":"itemUnDelete";try{await D().post(O.Z.state.hostname+"Courier/"+t,{courier_id:this.courier.courier_id}),this.courier.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.courier.is_disabled!=e)try{await D().post(O.Z.state.hostname+"Courier/itemDisable",{courier_id:this.courier.courier_id,is_disabled:e}),this.courier.is_disabled=e}catch{this.itemGet()}},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.courier.courier_id);const i={url:O.Z.state.hostname+"Courier/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await D().ajax(i),this.itemGet()}catch(a){this.$flash("Не удалось загрузить фото")}},uploadImageTrigger(){D()("#courier_foto_upload").trigger("click")},async updateCourier(){try{return await D().post(O.Z.state.hostname+"Courier/itemUpdate",JSON.stringify(this.courier))}catch(e){const t=JSON.parse(e.responseJSON?.messages?.error);t.courier_tax_num&&this.$flash("Неверный формат ИНН")}}}},x=i(3744);const T=(0,x.Z)(Z,[["render",W],["__scopeId","data-v-f631d64c"]]);var M=T}}]);
//# sourceMappingURL=516.319389a0.js.map