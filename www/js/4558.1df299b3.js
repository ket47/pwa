"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[4558],{5552:function(t,e,a){a.d(e,{Z:function(){return x}});var l=a(6252),n=a(3577);const i=t=>((0,l.dD)("data-v-a33a6d3c"),t=t(),(0,l.Cn)(),t),o={slot:"end",style:{display:"grid","grid-template-columns":"120px"}},r={slot:"end",style:{display:"grid","grid-template-columns":"120px"}},d={class:"horizontalScroller"},s={key:1,style:{"overflow-x":"scroll"},class:"printDiv"},u={class:"table_head"},c=i((()=>(0,l._)("div",null,"Количество",-1))),p=i((()=>(0,l._)("div",null,"Скидка",-1))),v=i((()=>(0,l._)("div",null,"Сумма",-1))),_=i((()=>(0,l._)("div",null,"Вознаграждение",-1))),h=i((()=>(0,l._)("div",null,"К выплате",-1))),m={class:"table"},w=(0,l.uE)('<div class="table_h" data-v-a33a6d3c><div data-v-a33a6d3c>Время</div><div data-v-a33a6d3c>Заказ №</div><div data-v-a33a6d3c>Товар</div><div data-v-a33a6d3c>Цена</div><div data-v-a33a6d3c>Количество</div><div data-v-a33a6d3c>Скидка</div><div data-v-a33a6d3c>Сумма</div><div data-v-a33a6d3c>Вознаграждение %</div><div data-v-a33a6d3c>Доставка</div><div data-v-a33a6d3c>Оплата</div><div data-v-a33a6d3c>Чек</div></div>',1),f=["href"];function g(t,e,a,i,g,y){const k=(0,l.up)("ion-icon"),W=(0,l.up)("ion-text"),I=(0,l.up)("ion-item"),b=(0,l.up)("ion-input"),z=(0,l.up)("ion-list"),$=(0,l.up)("ion-accordion"),x=(0,l.up)("ion-accordion-group"),O=(0,l.up)("ion-label"),S=(0,l.up)("ion-chip"),D=(0,l.up)("ion-searchbar"),G=(0,l.up)("ion-skeleton-text");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(x,null,{default:(0,l.w5)((()=>[(0,l.Wm)($,{value:"period"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{slot:"header"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{icon:i.calendarOutline,slot:"start"},null,8,["icon"]),(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Период "),(0,l._)("small",null,(0,n.zw)(g.start_at)+" до "+(0,n.zw)(g.finish_at),1)])),_:1})])),_:1}),(0,l.Wm)(z,{slot:"content"},{default:(0,l.w5)((()=>[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Начальная дата")])),_:1}),(0,l._)("div",o,[(0,l.Wm)(b,{type:"date",modelValue:g.start_at,"onUpdate:modelValue":e[0]||(e[0]=t=>g.start_at=t),onIonInput:e[1]||(e[1]=t=>y.reportGet())},null,8,["modelValue"])])])),_:1}),(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Wm)(W,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Конечная дата")])),_:1}),(0,l._)("div",r,[(0,l.Wm)(b,{type:"date",modelValue:g.finish_at,"onUpdate:modelValue":e[2]||(e[2]=t=>g.finish_at=t),onIonInput:e[3]||(e[3]=t=>y.reportGet())},null,8,["modelValue"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,l._)("div",d,[(0,l.Wm)(S,{onClick:e[4]||(e[4]=t=>y.reportExport()),color:"medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:i.downloadOutline},null,8,["src"]),(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Скачать")])),_:1})])),_:1}),(0,l.Wm)(S,{onClick:e[5]||(e[5]=t=>y.reportPrint()),color:"medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:i.printOutline},null,8,["src"]),(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Напечатать")])),_:1})])),_:1}),(0,l.Wm)(S,{onClick:e[6]||(e[6]=t=>y.reportGet()),color:"medium"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{src:i.reloadOutline},null,8,["src"]),(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Uk)("Обновить")])),_:1})])),_:1})]),(0,l.Wm)(D,{modelValue:g.searchQuery,"onUpdate:modelValue":e[7]||(e[7]=t=>g.searchQuery=t),placeholder:"Поиск по товару",onIonInput:e[8]||(e[8]=t=>y.reportGet()),debounce:"500"},null,8,["modelValue"]),null==g.report?((0,l.wg)(),(0,l.j4)(z,{key:0},{default:(0,l.w5)((()=>[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)([1,2,3],(t=>(0,l.Wm)(I,{key:t},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{slot:"start"},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{animated:"",style:{width:"50px"}})])),_:1}),(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Wm)(G,{animated:"",style:{width:"100%"}})])),_:1}),(0,l.Wm)(O,{slot:"end",color:"success"},{default:(0,l.w5)((()=>[(0,l.Wm)(G,{animated:"",style:{width:"50px"}})])),_:1})])),_:2},1024))),64))])),_:1})):g.report.body.length>0?((0,l.wg)(),(0,l.iD)("div",s,[(0,l._)("div",u,[c,(0,l._)("div",null,(0,n.zw)(g.report.head.total_quantity),1),p,(0,l._)("div",null,(0,n.zw)(g.report.head.total_discount),1),v,(0,l._)("div",null,(0,n.zw)(g.report.head.total_sum),1),_,(0,l._)("div",null,(0,n.zw)(g.report.head.total_commission),1),h,(0,l._)("div",null,(0,n.zw)(g.report.head.total_topay),1)]),(0,l._)("div",m,[w,((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(g.report.body,((t,e)=>((0,l.wg)(),(0,l.iD)("div",{key:e,class:"table_r"},[(0,l._)("div",null,(0,n.zw)(t.created_at),1),(0,l._)("div",null,(0,n.zw)(t.order_id),1),(0,l._)("div",null,(0,n.zw)(t.entry_text),1),(0,l._)("div",null,(0,n.zw)(t.entry_price),1),(0,l._)("div",null,(0,n.zw)(t.entry_quantity),1),(0,l._)("div",null,(0,n.zw)(t.entry_discount),1),(0,l._)("div",null,(0,n.zw)(t.entry_sum),1),(0,l._)("div",null,(0,n.zw)(t.fee),1),(0,l._)("div",null,(0,n.zw)(t.delivery),1),(0,l._)("div",null,(0,n.zw)(t.payment_type),1),(0,l._)("div",null,[t.invoice_link?((0,l.wg)(),(0,l.iD)("a",{key:0,href:t.invoice_link,target:"_new"},"онлайн чек",8,f)):(0,l.kq)("",!0)])])))),128))])])):((0,l.wg)(),(0,l.j4)(z,{key:2},{default:(0,l.w5)((()=>[(0,l.Wm)(I,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" Нет заказов в данном периоде ")])),_:1})])),_:1}))])}var y=a(4929),k=a(8903),W=a(9755),I=a.n(W),b={components:{IonIcon:y.gu,IonLabel:y.Q$,IonItem:y.Ie,IonInput:y.pK,IonList:y.q_,IonAccordion:y.We,IonAccordionGroup:y.eh,IonText:y.yW,IonSkeletonText:y.CK,IonSearchbar:y.VI,IonChip:y.hM},props:["store"],setup(){return{calendarOutline:k.rom,addOutline:k.s6O,closeCircle:k.XZx,pricetagOutline:k.TuG,downloadOutline:k.aO1,reloadOutline:k.Lk3,printOutline:k.x3A}},data(){console.log(this.query);const t=new Date,e=new Date(Date.parse(`${t.getFullYear()}-${t.getMonth()+1}-01Z`));return{start_at:e.toISOString().slice(0,10),finish_at:t.toISOString().slice(0,10),searchQuery:"",report:null,today:t}},watch:{store:function(){this.reportGet()}},methods:{async reportGet(){var t;if(null===(t=this.store)||void 0===t||!t.store_id)return this.report=null,void(this.head=null);try{var e;const t={store_id:null===(e=this.store)||void 0===e?void 0:e.store_id,start_at:this.start_at,finish_at:this.finish_at,searchQuery:this.searchQuery},a=await I().post(`${this.$heap.state.hostname}Statistics/sellReportProductGet`,t);this.report=a}catch(n){var a,l;const t=null===n||void 0===n||null===(a=n.responseJSON)||void 0===a||null===(l=a.messages)||void 0===l?void 0:l.error;switch(t){case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break;default:this.$flash("Ошибка получения выписки");break}return this.ledger=[],this.balance=0,!1}},reportPrint(){window.print()},async reportExport(){var t;if(null===(t=this.store)||void 0===t||!t.store_id)return this.report=null,void(this.head=null);try{var e;const t={store_id:null===(e=this.store)||void 0===e?void 0:e.store_id,start_at:this.start_at,finish_at:this.finish_at,searchQuery:this.searchQuery,output:"xlsx"},a=await I().post(`${this.$heap.state.hostname}Statistics/sellReportProductGet`,t),l=this.store.store_name.replace(/[^\wа-яА-Я]/gi,""),n=`${this.$heap.state.hostname}Statistics/download/${a}/sellReport_${l}_${this.start_at}.xlsx`,i=document.createElement("a");i.href=n,i.click()}catch(n){var a,l;const t=null===n||void 0===n||null===(a=n.responseJSON)||void 0===a||null===(l=a.messages)||void 0===l?void 0:l.error;switch(t){case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break;default:this.$flash("Ошибка получения выписки"),console.log(n);break}return this.ledger=[],this.balance=0,!1}},toLocDate(t){const e=new Date(Date.parse(t)),a={month:"short",day:"numeric"};return e.toLocaleDateString(void 0,a)}},mounted(){this.reportGet()}},z=a(3744);const $=(0,z.Z)(b,[["render",g],["__scopeId","data-v-a33a6d3c"]]);var x=$},3974:function(t,e,a){a.r(e),a.d(e,{default:function(){return _}});var l=a(6252);function n(t,e,a,n,i,o){const r=(0,l.up)("ion-segment-button"),d=(0,l.up)("ion-segment"),s=(0,l.up)("ledger-comp"),u=(0,l.up)("statistics-seller-report"),c=(0,l.up)("base-layout");return(0,l.wg)(),(0,l.j4)(c,{pageTitle:"Статистика продавца",pageDefaultBackLink:"/user"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{"swipe-gesture":"true",modelValue:i.activeTab,"onUpdate:modelValue":e[0]||(e[0]=t=>i.activeTab=t),onIonChange:e[1]||(e[1]=e=>t.activeTabChanged(e))},{default:(0,l.w5)((()=>[(0,l.Wm)(r,{value:"sellerReport"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Отчет ")])),_:1}),(0,l.Wm)(r,{value:"ledger"},{default:(0,l.w5)((()=>[(0,l.Uk)(" Баланс ")])),_:1})])),_:1},8,["modelValue"]),"ledger"==i.activeTab?((0,l.wg)(),(0,l.j4)(s,{key:0,permanentTag:"acc::supplier"})):(0,l.kq)("",!0),"sellerReport"==i.activeTab?((0,l.wg)(),(0,l.j4)(u,{key:1,store:i.store},null,8,["store"])):(0,l.kq)("",!0)])),_:1})}var i=a(4929),o=a(8903),r=a(6561),d=a(5552),s=a(9755),u=a.n(s),c={components:{IonSegment:i.cJ,IonSegmentButton:i.GO,ledgerComp:r.Z,StatisticsSellerReport:d.Z},setup(){return{receiptOutline:o.d71}},data(){return{activeTab:"sellerReport",storeId:this.$route.params.id,store:null}},mounted(){this.storeGet(this.storeId)},methods:{async storeGet(t){const e={store_id:t};this.store=await u().post(`${this.$heap.state.hostname}Store/itemGet`,e)}}},p=a(3744);const v=(0,p.Z)(c,[["render",n]]);var _=v}}]);
//# sourceMappingURL=4558.1df299b3.js.map