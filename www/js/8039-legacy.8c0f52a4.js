"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[8039],{8039:function(e,t,o){o.r(t),o.d(t,{default:function(){return F}});var r=o(6252),i=o(3577);const s={style:{"background-color":"#1380c1","padding-bottom":"15px"}},u={class:"store-info-container"},n={class:"store-image-slider-container"},a=(0,r._)("div",{class:"overlay",style:{"background-image":"url(/img/store_menu_background_full.png)"}},null,-1),l={key:0,class:"avatar"},d=["alt","src"],c={key:1},p={key:2,class:"group-fixed-block hidden-block"},g=(0,r._)("h4",{style:{margin:"16px 16px 20px"}},[(0,r._)("b",null,"Онлайн меню")],-1),_={class:"product-container"},m={style:{margin:"0"}},h={class:"product_list_widget_grid"},w=["id"],f={class:"product_list_item_img"},y=["src"],v={class:"product-data"},k={class:"product-title"},I={class:"product-description"},S={key:0},b={class:"product-price"},G={key:0,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},$={key:1,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},P={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},q={key:0,style:{color:"var(--ion-color-light)"}},z={key:1,style:{color:"var(--ion-color-light)"}},C={key:0},D={key:1},x={key:2},L={key:3},H=(0,r._)("div",null,[(0,r._)("h6",null,"НУЖНА ДОСТАВКА?"),(0,r._)("h4",null,"ВЫБИРАЙ TEZKEL")],-1);function W(e,t,o,W,j,T){const M=(0,r.up)("ion-icon"),Z=(0,r.up)("ion-toolbar"),U=(0,r.up)("image-slider-comp"),O=(0,r.up)("ion-label"),Y=(0,r.up)("ion-segment-button"),K=(0,r.up)("ion-segment"),A=(0,r.up)("group-list"),B=(0,r.up)("ion-col"),N=(0,r.up)("ion-img"),R=(0,r.up)("ion-chip"),V=(0,r.up)("ion-row"),E=(0,r.up)("ion-grid"),F=(0,r.up)("swiper-slide"),J=(0,r.up)("swiper"),Q=(0,r.up)("ion-button"),X=(0,r.up)("router-link"),ee=(0,r.up)("ion-footer"),te=(0,r.up)("ion-content"),oe=(0,r.up)("ion-page");return(0,r.wg)(),(0,r.j4)(oe,null,{default:(0,r.w5)((()=>[(0,r.Wm)(te,{class:(0,i.C_)("store-menu-page"),scrollEvents:!0,onIonScroll:T.onScroll},{default:(0,r.w5)((()=>[(0,r.Wm)(Z,null,{default:(0,r.w5)((()=>[W.mainLogo?((0,r.wg)(),(0,r.j4)(M,{key:0,class:"toolbar_svg_logo",style:{color:"white"},icon:W.mainLogo},null,8,["icon"])):(0,r.kq)("",!0)])),_:1}),(0,r._)("div",s,[(0,r._)("div",u,[(0,r._)("div",n,[(0,r.Wm)(U,{imageList:j.storeItem.images,imgHeight:250,mode:"crop-to-fit"},null,8,["imageList"]),a]),j.storeItem.avatarImage?((0,r.wg)(),(0,r.iD)("div",l,[(0,r._)("img",{alt:j.storeItem.store_name,src:e.$heap.state.hostname+"image/get.php/"+j.storeItem.avatarImage+".200.200.webp"},null,8,d)])):((0,r.wg)(),(0,r.iD)("div",c,[(0,r._)("h2",null,(0,i.zw)(j.storeItem.store_name),1)])),j.storeGroups?((0,r.wg)(),(0,r.iD)("div",p,[(0,r.Wm)(K,{modelValue:j.groupSelectedParentId,"onUpdate:modelValue":t[0]||(t[0]=e=>j.groupSelectedParentId=e),scrollable:"",class:"groups-container"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(j.storeGroups,(e=>((0,r.wg)(),(0,r.j4)(Y,{key:e.group_id,value:e.group_id,onClick:t=>T.groupSelectParent(e.group_id,1),ref_for:!0,ref:"group-tab-"+e.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(O,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.group_name),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1},8,["modelValue"])])):(0,r.kq)("",!0),g,j.storeGroups?((0,r.wg)(),(0,r.j4)(A,{key:3,groupList:j.storeGroups,onClick:e=>{T.groupSelectParent(e,!0)}},null,8,["groupList","onClick"])):(0,r.kq)("",!0)]),(0,r._)("div",_,[j.storeGroups?((0,r.wg)(),(0,r.j4)(J,{key:0,pager:"true",initialSlide:0,speed:400,watchSlidesProgress:!1,grabCursor:!0,touchStartForcePreventDefault:!0,slidesPerView:1.1,pagination:!1,centeredSlides:!1,ref:"productListSlider",class:"product-list-slider",onSlideChange:t[1]||(t[1]=e=>T.groupSliderChanged(e)),style:(0,i.j5)(`max-height: ${j.sliderMaxHeight}`)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(j.storeGroups)+" ",1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(j.storeGroups,(t=>((0,r.wg)(),(0,r.j4)(F,{key:t.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(E,{class:"product-list"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.children,(t=>((0,r.wg)(),(0,r.j4)(V,{key:t.group_id,ref_for:!0,ref:"group-"+t.group_id,"data-group_id":t.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(B,{class:"group-title",size:"12"},{default:(0,r.w5)((()=>[(0,r._)("h5",m,(0,i.zw)(t.group_name),1)])),_:2},1024),(0,r.Wm)(B,{size:"12"},{default:(0,r.w5)((()=>[(0,r._)("div",h,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(j.storeProducts[t.group_id],(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.product_id},[(0,r._)("div",{class:(0,i.C_)(t.item_class+" product-item"),id:`product_list_item${t.product_id}`},[(0,r._)("div",f,[(0,r._)("img",{class:"blur-image",src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.200.200.webp`},null,8,y),(0,r.Wm)(N,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.200.200.webp`},null,8,["src"])]),(0,r._)("div",v,[(0,r._)("h4",k,(0,i.zw)(t.product_name),1),(0,r._)("p",I,(0,i.zw)(t.product_description),1),t.options?((0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.options,(t=>((0,r.wg)(),(0,r.j4)(R,{key:t.product_id,color:"primary"},{default:(0,r.w5)((()=>[(0,r.Wm)(O,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(t.product_option),1)])),_:2},1024),(0,r.Uk)(" "),t.product_final_price>0?((0,r.wg)(),(0,r.j4)(O,{key:0},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(t.product_final_price)+(0,i.zw)(e.$heap.state.currencySign),1)])),_:2},1024)):(0,r.kq)("",!0)])),_:2},1024)))),128))])):(0,r.kq)("",!0),(0,r._)("div",b,[(0,r._)("span",null,[t.product_net_price>0?((0,r.wg)(),(0,r.iD)("b",G,(0,i.zw)(t.product_net_price),1)):((0,r.wg)(),(0,r.iD)("b",$,(0,i.zw)(t.product_final_price),1)),(0,r._)("b",P,(0,i.zw)(e.$heap.state.currencySign),1)]),"порция"==t.product_unit?((0,r.wg)(),(0,r.iD)("span",q," /"+(0,i.zw)(t.weight_in_gramms)+"г ",1)):((0,r.wg)(),(0,r.iD)("span",z,[(0,r.Uk)(" / "),"порция"==t.product_unit?((0,r.wg)(),(0,r.iD)("span",C,(0,i.zw)(t.weight_in_gramms)+"г",1)):"порция мл"==t.product_unit?((0,r.wg)(),(0,r.iD)("span",D,(0,i.zw)(t.weight_in_gramms)+"мл",1)):"кг"==t.product_unit&&t.product_quantity_min<1?((0,r.wg)(),(0,r.iD)("span",x,(0,i.zw)(t.unit_in_gramms)+"г",1)):((0,r.wg)(),(0,r.iD)("span",L,(0,i.zw)(t.product_unit),1))]))])])],10,w)])))),128))])])),_:2},1024)])),_:2},1032,["data-group_id"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["style"])):(0,r.kq)("",!0)])]),(0,r.Wm)(ee,{style:{"background-image":"url(/img/bg3.ce15f59d.png)"}},{default:(0,r.w5)((()=>[H,(0,r._)("div",null,[(0,r.Wm)(X,{to:`/catalog/store-${j.storeId}`},{default:(0,r.w5)((()=>[(0,r.Wm)(Q,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Перейти в приложение")])),_:1})])),_:1},8,["to"])])])),_:1})])),_:1},8,["onIonScroll"])])),_:1})}o(3948),o(7658);var j=o(4929),T=o(702),M=o(3181),Z=o(8903),U=o(94),O=o(4846),Y=o(62),K=o(9755),A=o.n(K),B=o(2008),N=o(4405),R={components:{IonPage:j._i,IonToolbar:j.sr,IonContent:j.W2,IonFooter:j.fr,IonCol:j.wI,IonIcon:j.gu,IonImg:j.Xz,IonRow:j.Nd,IonGrid:j.jY,ImageSliderComp:O.Z,IonLabel:j.Q$,IonSegmentButton:j.GO,IonSegment:j.cJ,IonButton:j.YG,Swiper:M.t,SwiperSlide:M.o,GroupList:Y.Z,IonChip:j.hM},setup(){return{mainLogo:U,search:Z.yC4,settingsOutline:Z.C$N,rocketOutline:Z.G$D,compassOutline:Z.gmD,slideModules:[T.pt]}},data(){return{storeId:this.$route.params.id,query:this.$route.query,searchRequest:"",storeItem:[],storeProducts:{},storeGroups:null,groupSelectedParentId:-1,offsetModificator:80,sliderMaxHeight:500,can_reload_at:0}},computed:{weight_in_gramms(){return 1e3*this.productItem.product_weight},unit_in_gramms(){return Math.round(1e3*this.productItem.product_quantity_min)}},methods:{async itemGet(){const e=Date.now();if(!(this.can_reload_at>e)){this.can_reload_at=e+1e4;try{const e=await A().post(`${B.Z.state.hostname}Store/itemGet`,{store_id:this.storeId,distance_include:1});this.storeItem=this.itemPrepare(e),this.storeId=e.store_id,this.groupTreeGet({store_id:this.storeId}),B.Z.commit("setCurrentStore",this.storeItem)}catch(r){var t,o;const e=null===r||void 0===r||null===(t=r.responseJSON)||void 0===t||null===(o=t.messages)||void 0===o?void 0:o.error;switch(e){case"notfound":this.$flash("Продавец не найден"),this.$go("/catalog");break}return!1}}},itemPrepare(e){e.member_of_groups.group_names&&(e.store_group_names=e.member_of_groups.group_names);try{e.deliveryTime=N.Z.deliveryTimeCalculate(e.locations[0].distance,e.store_time_preparation)}catch(t){}return e.avatarImage="",e.avatar.length>0&&(e.avatarImage=e.avatar[0].image_hash),e},async productListGet(e={}){if(e.store_id=this.storeId,e.is_active=1,e.name_query&&""==e.name_query)return void this.groupTreeGet({store_id:this.storeId});e.limit=200;let t={};try{t=await A().post(B.Z.state.hostname+"Product/listGet",e)}catch(r){}this.productListPrepare(t.product_list),this.groupOtherAdd();let o=this;setTimeout((()=>{o.groupSelect()}),0)},productListPrepare(e){for(var t of(this.storeProducts={},e)){var o,r,i;if(this.storeGroups)if(!this.storeProducts[null!==(r=t.group_id)&&void 0!==r?r:0])this.storeProducts[null!==(i=t.group_id)&&void 0!==i?i:0]=[];t.item_class="",t.deleted_at&&(t.item_class="deleted"),1==t.is_disabled&&(t.item_class="disabled"),1==t.is_counted&&t.product_quantity-t.product_quantity_reserved<1&&(t.item_class="absent"),t.weight_in_gramms=1e3*t.product_weight,t.unit_in_gramms=Math.round(1e3*t.product_quantity_min),this.storeProducts[null!==(o=t.group_id)&&void 0!==o?o:0].push(t)}},async groupTreeGet(e){try{const t=await A().get(`${B.Z.state.hostname}Product/groupTreeGet`,{store_id:e.store_id});let o=[];for(let e in t)o[t[e].order]=t[e];this.storeGroups=o,this.productListGet()}catch(t){}},groupOtherAdd(){this.storeProducts[0]&&this.storeGroups.push({group_id:"other",group_name:"Другое",image_hash:"",children:{0:{group_id:0,group_name:"другое",group_parent_id:0,group_path:"",image_hash:""}}})},groupSelect(){if(this.groupSelectedParentId>-1)return;let e=this.query.parent_group_id,t=this.query.sub_group_id;if(t)e:for(let i in this.storeGroups)for(let o in this.storeGroups[i].children)if(o==t){e=i;break e}var o;e||(e=null===(o=this.storeGroups[0])||void 0===o?void 0:o.group_id);const r=!1;this.groupSelectParent(e,r)},groupSelectParent(e){if(this.groupSelectedParentId==e)return;if(this.groupSelectedParentId=e,void 0==this.$refs.productListSlider)return;const t=this.$refs.productListSlider.$el.swiper,o=this.storeGroups.findIndex((t=>t.group_id==e));o>=0&&(t.slideTo(o,100,!1),this.groupSliderAdjustHeight())},groupSliderChanged(e){const t=e.activeIndex,o=this.storeGroups[t].group_id;this.groupSelectParent(o,1)},groupSliderAdjustHeight(){var e;const t=null===(e=this.$refs.productListSlider.$el.querySelector(".swiper-slide-active"))||void 0===e?void 0:e.scrollHeight;this.$refs.productListSlider.$el.style.maxHeight=t>0?t+"px":""},onScroll(e){var t;const o=null===(t=document.querySelector("#hcat_widget_grid"))||void 0===t?void 0:t.getBoundingClientRect().top;o<0?document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block"):document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block hidden-block");var r=document.querySelectorAll(".swiper-slide-active .product-list ion-row");for(var i of r)if(i.getBoundingClientRect().top-this.offsetModificator<=window.innerHeight-window.innerHeight/4&&i.getBoundingClientRect().bottom+this.offsetModificator>=window.innerHeight-window.innerHeight/4&&i.dataset.group_id)break}},mounted(){this.query=this.$route.query,this.itemGet()},watch:{$route(e){this.storeId=e.params.id}}},V=o(3744);const E=(0,V.Z)(R,[["render",W]]);var F=E}}]);
//# sourceMappingURL=8039-legacy.8c0f52a4.js.map