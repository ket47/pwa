(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[3158],{4699:function(e,r,n){var t=n(9781),u=n(1702),a=n(1956),o=n(5656),s=n(5296).f,l=u(s),i=u([].push),p=function(e){return function(r){var n,u=o(r),s=a(u),p=s.length,c=0,d=[];while(p>c)n=s[c++],t&&!l(u,n)||i(d,e?[n,u[n]]:u[n]);return d}};e.exports={entries:p(!0),values:p(!1)}},2479:function(e,r,n){var t=n(2109),u=n(4699).values;t({target:"Object",stat:!0},{values:function(e){return u(e)}})},3158:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return S}});var t=n(6252),u=n(3577),a=n(9963),o=(0,t.Uk)(" Вы уже вошли в систему с номером телефона "),s=(0,t.Uk)(" Простая регистрация "),l=(0,t.Uk)(" Для регистрации необходим только ваш номер мобильного телефона и имя, чтобы мы знали как обращаться к вам. "),i={novalidate:""},p=(0,t.Uk)("Код"),c=(0,t.Uk)("+7 "),d=(0,t.Uk)("Мобильный телефон*"),f={"padding-left":""},_=(0,t.Uk)("Ваш псевдоним*"),m={"padding-left":""},h=(0,t.Uk)("Ваш е-маил (желательно заполнить)"),w=(0,t.Uk)(" Мы придумали пароль "),k=(0,t.Uk)(" для вас, но вы можете использовать свой вариант. Пароль будет сохранен на этом устройстве. "),v=(0,t.Uk)("Пароль (минимум 4 символа)*"),b={"padding-left":""},g=(0,t.Uk)("Зарегистрироваться"),W=(0,t.Uk)("Уже есть учетная запись?");function y(e,r,n,y,x,V){var I=(0,t.up)("ion-card-title"),U=(0,t.up)("ion-card-header"),$=(0,t.up)("ion-card-content"),q=(0,t.up)("ion-card"),C=(0,t.up)("ion-label"),S=(0,t.up)("ion-select-option"),z=(0,t.up)("ion-select"),O=(0,t.up)("ion-col"),j=(0,t.up)("ion-input"),Z=(0,t.up)("ion-row"),N=(0,t.up)("ion-grid"),F=(0,t.up)("ion-text"),J=(0,t.up)("ion-item"),D=(0,t.up)("ion-list"),G=(0,t.up)("ion-chip"),M=(0,t.up)("ion-button"),L=(0,t.up)("router-link"),B=(0,t.up)("base-layout");return(0,t.wg)(),(0,t.j4)(B,{"page-title":"Регистрация нового пользователя",pageDefaultBackLink:"/user"},{default:(0,t.w5)((function(){return[e.$heap.state.user.user_id>0?((0,t.wg)(),(0,t.j4)(q,{key:0,style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,t.w5)((function(){return[(0,t.Wm)(U,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(I,{color:"primary"},{default:(0,t.w5)((function(){return[(0,t.Uk)((0,u.zw)(e.$heap.state.user.user_name)+" "+(0,u.zw)(e.$heap.state.user.user_surname)+" "+(0,u.zw)(e.$heap.state.user.user_middlename),1)]})),_:1})]})),_:1}),(0,t.Wm)($,null,{default:(0,t.w5)((function(){return[o,(0,t._)("b",null,(0,u.zw)(e.$heap.state.user.user_phone),1)]})),_:1})]})),_:1})):((0,t.wg)(),(0,t.j4)(q,{key:1,color:"light"},{default:(0,t.w5)((function(){return[(0,t.Wm)(U,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(I,{color:"primary"},{default:(0,t.w5)((function(){return[s]})),_:1})]})),_:1}),(0,t.Wm)($,null,{default:(0,t.w5)((function(){return[l]})),_:1})]})),_:1})),(0,t._)("form",i,[(0,t.Wm)(D,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(J,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(N,{style:{width:"100%"}},{default:(0,t.w5)((function(){return[(0,t.Wm)(Z,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(O,{size:"4"},{default:(0,t.w5)((function(){return[(0,t.Wm)(C,{position:"stacked",color:"primary"},{default:(0,t.w5)((function(){return[p]})),_:1}),(0,t.Wm)(z,{value:x.user_phone_prefix},{default:(0,t.w5)((function(){return[(0,t.Wm)(S,{value:"7",selected:""},{default:(0,t.w5)((function(){return[c]})),_:1})]})),_:1},8,["value"])]})),_:1}),(0,t.Wm)(O,{size:"8"},{default:(0,t.w5)((function(){return[(0,t.Wm)(C,{position:"stacked",color:"primary"},{default:(0,t.w5)((function(){return[d]})),_:1}),(0,t.Wm)(j,{modelValue:x.user_phone,"onUpdate:modelValue":r[0]||(r[0]=function(e){return x.user_phone=e}),onIonChange:r[1]||(r[1]=function(e){return V.phoneFormat()}),name:"phone",type:"tel",inputmode:"tel",placeholder:"(xxx)xxxxxxxxx",required:""},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,t.Wm)(F,{color:"danger",slot:"helper"},{default:(0,t.w5)((function(){return[(0,t.wy)((0,t._)("p",f,"Неверный номер телефона",512),[[a.F8,!V.phoneValid&&1==x.submitted]])]})),_:1})]})),_:1}),(0,t.Wm)(J,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(C,{position:"stacked",color:"primary"},{default:(0,t.w5)((function(){return[_]})),_:1}),(0,t.Wm)(j,{modelValue:x.user_name,"onUpdate:modelValue":r[2]||(r[2]=function(e){return x.user_name=e}),name:"username",type:"text",placeholder:"как к вам обращаться?",required:""},null,8,["modelValue"]),(0,t.Wm)(F,{color:"danger",slot:"helper"},{default:(0,t.w5)((function(){return[(0,t.wy)((0,t._)("p",m,"Проверьте ваш псевдоним",512),[[a.F8,!V.usernameValid&&1==x.submitted]])]})),_:1})]})),_:1}),(0,t.Wm)(J,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(C,{position:"stacked",color:"primary"},{default:(0,t.w5)((function(){return[h]})),_:1}),(0,t.Wm)(j,{modelValue:x.user_email,"onUpdate:modelValue":r[3]||(r[3]=function(e){return x.user_email=e}),name:"email",type:"email",placeholder:"е-маил",required:""},null,8,["modelValue"])]})),_:1})]})),_:1}),x.user_pass==x.genpass?((0,t.wg)(),(0,t.j4)(q,{key:0,style:{"background-color":"var(--ion-color-primary-tint)"}},{default:(0,t.w5)((function(){return[(0,t.Wm)($,null,{default:(0,t.w5)((function(){return[w,(0,t.Wm)(G,{style:{"font-family":"monospace,serif"}},{default:(0,t.w5)((function(){return[(0,t.Uk)((0,u.zw)(x.user_pass),1)]})),_:1}),k]})),_:1})]})),_:1})):(0,t.kq)("",!0),(0,t.Wm)(J,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(C,{position:"stacked",color:"primary"},{default:(0,t.w5)((function(){return[v]})),_:1}),(0,t.Wm)(j,{modelValue:x.user_pass,"onUpdate:modelValue":r[4]||(r[4]=function(e){return x.user_pass=e}),name:"password",type:"text",autocorrect:"off",placeholder:"пароль (минимум 4 символа)",required:"",style:{"font-family":"monospace,serif"}},null,8,["modelValue"]),(0,t.Wm)(F,{color:"danger",slot:"helper"},{default:(0,t.w5)((function(){return[(0,t.wy)((0,t._)("p",b,"Пароль должен содержать не менее 4 символов.",512),[[a.F8,!V.passwordValid&&1==x.submitted]])]})),_:1})]})),_:1}),(0,t.Wm)(Z,{"responsive-sm":""},{default:(0,t.w5)((function(){return[(0,t.Wm)(O,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(M,{onClick:V.onSubmit,expand:"block"},{default:(0,t.w5)((function(){return[g]})),_:1},8,["onClick"])]})),_:1})]})),_:1}),(0,t.Wm)(Z,{"responsive-sm":""},{default:(0,t.w5)((function(){return[(0,t.Wm)(O,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(L,{to:"/user/sign-in"},{default:(0,t.w5)((function(){return[(0,t.Wm)(M,{color:"light",expand:"block"},{default:(0,t.w5)((function(){return[W]})),_:1})]})),_:1})]})),_:1})]})),_:1})])]})),_:1})}var x=n(6835),V=n(8534),I=(n(4916),n(5306),n(8862),n(2479),n(2066)),U=n(351),$=(n(9755),{components:{IonGrid:I.jY,IonRow:I.Nd,IonCol:I.wI,IonSelect:I.t9,IonSelectOption:I.n0,IonLabel:I.Q$,IonInput:I.pK,IonItem:I.Ie,IonText:I.yW,IonList:I.q_,IonButton:I.YG,IonCard:I.PM,IonCardHeader:I.Zi,IonCardTitle:I.Dq,IonCardContent:I.FN,IonChip:I.hM},data(){var e=this.passGenerate();return{submitted:!1,genpass:e,user_pass:e,user_pass_confirm:null,user_phone:null,user_phone_prefix:"7",user_name:null,user_email:null}},computed:{phoneValid(){var e;return 10==(null===(e=this.user_phone)||void 0===e?void 0:e.replace(/\D/g,"").length)},passwordValid(){var e;return(null===(e=this.user_pass)||void 0===e?void 0:e.length)>=4},usernameValid(){var e;return(null===(e=this.user_name)||void 0===e?void 0:e.length)>0}},methods:{onSubmit(){var e=this;return(0,V.Z)((0,x.Z)().mark((function r(){var n,t,u,a,o,s,l;return(0,x.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.submitted=!0,e.phoneValid&&e.passwordValid&&e.usernameValid){r.next=3;break}return r.abrupt("return");case 3:return t={user_phone:e.user_phone_prefix+e.user_phone,user_pass:e.user_pass,user_pass_confirm:e.user_pass,user_name:e.user_name,user_email:e.user_email,inviter_user_id:null!==(n=localStorage.inviter_user_id)&&void 0!==n?n:0},r.prev=4,r.next=7,U.Z.signUp(t);case 7:e.phoneVerify(),localStorage.signInData=JSON.stringify({user_phone:e.user_phone_prefix+e.user_phone,user_pass:e.user_pass}),r.next=39;break;case 11:if(r.prev=11,r.t0=r["catch"](4),o=null===r.t0||void 0===r.t0||null===(u=r.t0.responseJSON)||void 0===u||null===(a=u.messages)||void 0===a?void 0:a.error,"user_phone_unverified"!=o){r.next=17;break}return e.phoneVerify(),r.abrupt("return");case 17:o="unknown";try{s=Object.keys(JSON.parse(r.t0.responseJSON.messages.error))[0],l=Object.values(JSON.parse(r.t0.responseJSON.messages.error))[0],o=s+"_"+l}catch(i){}r.t1=o,r.next="user_phone_notunique"===r.t1?22:"user_phone_required"===r.t1||"user_phone_invalid"===r.t1||"user_phone_short"===r.t1?24:"user_name_required"===r.t1||"user_name_short"===r.t1?26:"user_email_invalid"===r.t1?28:"user_email_notunique"===r.t1?30:"user_pass_required"===r.t1?32:"user_pass_short"===r.t1?34:"user_pass_notmatches"===r.t1?36:38;break;case 22:return e.$flash("Пользователь с таким телефоном уже зарегистрирован"),r.abrupt("break",39);case 24:return e.$flash("Проверьте номер телефона"),r.abrupt("break",39);case 26:return e.$flash("Проверьте ваш псевдоним"),r.abrupt("break",39);case 28:return e.$flash("Проверьте ваш е-маил"),r.abrupt("break",39);case 30:return e.$flash("Такой е-маил уже используется"),r.abrupt("break",39);case 32:return e.$flash("Пароль обязателен для заполнения"),r.abrupt("break",39);case 34:return e.$flash("Пароль слишком короткий"),r.abrupt("break",39);case 36:return e.$flash("Пароль не совпадает с подтверждением"),r.abrupt("break",39);case 38:e.$flash("Не удалось войти зарегистрироваться");case 39:case"end":return r.stop()}}),r,null,[[4,11]])})))()},passGenerate(){for(var e="",r=4,n="abcdefghijklmnopqrstuvwxyz1234567890",t=0;t<r;t++){var u=Math.floor(Math.random()*n.length);e+=n[u]}return e},phoneFormat(){this.user_phone||(this.user_phone="");try{var e=this.user_phone.replace(/\D/g,"");e.length>10&&(e=e.substring(e.length-10)),this.user_phone=e}catch(r){}},phoneVerify(){var e=this;return(0,V.Z)((0,x.Z)().mark((function r(){var n;return(0,x.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:n={user_phone:e.user_phone_prefix+e.user_phone};try{e.$router.push({name:"UserVerifyPhone",params:n})}catch(t){e.$flash("Не удалось выслать смс с подтверждением")}case 2:case"end":return r.stop()}}),r)})))()}}}),q=n(3744);const C=(0,q.Z)($,[["render",y]]);var S=C}}]);
//# sourceMappingURL=3158-legacy.bde7d19c.js.map