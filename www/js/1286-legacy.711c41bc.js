"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[1286],{4535:function(t,e,n){n.d(e,{Z:function(){return $}});var u=n(6252),r=n(3577),a=(0,u.Uk)("Баланс"),l=(0,u.Uk)("Настройки"),o=(0,u.Uk)("Начальная дата"),i={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},c=(0,u.Uk)("Обороты"),s={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},d=(0,u.Uk)("Конечная дата"),m={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},f=(0,u.Uk)(" Нет операций в данном периоде ");function p(t,e,n,p,g,w){var _=(0,u.up)("ion-title"),h=(0,u.up)("ion-text"),k=(0,u.up)("ion-item"),y=(0,u.up)("ion-list"),v=(0,u.up)("ion-icon"),W=(0,u.up)("ion-input"),b=(0,u.up)("ion-accordion"),x=(0,u.up)("ion-accordion-group"),I=(0,u.up)("ion-searchbar"),$=(0,u.up)("ion-skeleton-text"),S=(0,u.up)("ion-label");return(0,u.wg)(),(0,u.iD)("div",null,[(0,u.Wm)(y,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(k,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(_,null,{default:(0,u.w5)((function(){return[a]})),_:1}),g.balance>0?((0,u.wg)(),(0,u.j4)(h,{key:0,slot:"end",color:"success"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(g.balance)+(0,r.zw)(t.$heap.state.currencySign),1)]})),_:1})):((0,u.wg)(),(0,u.j4)(h,{key:1,slot:"end"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(g.balance)+(0,r.zw)(t.$heap.state.currencySign),1)]})),_:1}))]})),_:1})]})),_:1}),(0,u.Wm)(x,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(b,null,{default:(0,u.w5)((function(){return[(0,u.Wm)(k,{slot:"header"},{default:(0,u.w5)((function(){return[(0,u.Wm)(v,{icon:p.settingsOutline,slot:"start"},null,8,["icon"]),(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[l]})),_:1})]})),_:1}),(0,u.Wm)(y,{slot:"content"},{default:(0,u.w5)((function(){return[(0,u.Wm)(k,{color:"light"},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[o]})),_:1}),(0,u._)("div",i,[(0,u.Wm)(W,{type:"date",modelValue:g.start_at,"onUpdate:modelValue":e[0]||(e[0]=function(t){return g.start_at=t}),onIonChange:e[1]||(e[1]=function(t){return w.listGet()})},null,8,["modelValue"]),g.meta.sum_start?((0,u.wg)(),(0,u.j4)(W,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${g.meta.sum_start}${t.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0)])]})),_:1}),(0,u.Wm)(k,{color:"light"},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[c]})),_:1}),(0,u._)("div",s,[g.meta.sum_debit?((0,u.wg)(),(0,u.j4)(W,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`+${g.meta.sum_debit}${t.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0),g.meta.sum_credit?((0,u.wg)(),(0,u.j4)(W,{key:1,type:"text",style:{"text-align":"right"},color:"medium",value:`-${g.meta.sum_credit}${t.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0)])]})),_:1}),(0,u.Wm)(k,{color:"light"},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[d]})),_:1}),(0,u._)("div",m,[(0,u.Wm)(W,{type:"date",modelValue:g.finish_at,"onUpdate:modelValue":e[2]||(e[2]=function(t){return g.finish_at=t})},null,8,["modelValue"]),g.meta.sum_finish?((0,u.wg)(),(0,u.j4)(W,{key:0,type:"text",style:{"text-align":"right"},color:"medium",value:`${g.meta.sum_finish}${t.$heap.state.currencySign}`,readonly:""},null,8,["value"])):(0,u.kq)("",!0)])]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,u.Wm)(I,{modelValue:g.q,"onUpdate:modelValue":e[3]||(e[3]=function(t){return g.q=t}),placeholder:"Поиск по сумме или описанию",onIonChange:e[4]||(e[4]=function(t){return w.listGet()})},null,8,["modelValue"]),null==g.ledger?((0,u.wg)(),(0,u.j4)(y,{key:0},{default:(0,u.w5)((function(){return[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)([1,2,3],(function(t){return(0,u.Wm)(k,{key:t},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,{slot:"start"},{default:(0,u.w5)((function(){return[(0,u.Wm)($,{animated:"",style:{width:"50px"}})]})),_:1}),(0,u.Wm)(S,null,{default:(0,u.w5)((function(){return[(0,u.Wm)($,{animated:"",style:{width:"100%"}})]})),_:1}),(0,u.Wm)(S,{slot:"end",color:"success"},{default:(0,u.w5)((function(){return[(0,u.Wm)($,{animated:"",style:{width:"50px"}})]})),_:1})]})),_:2},1024)})),64))]})),_:1})):g.ledger.length>0?((0,u.wg)(),(0,u.j4)(y,{key:1},{default:(0,u.w5)((function(){return[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(w.ledgerCalc,(function(t){return(0,u.wg)(),(0,u.j4)(k,{key:t.trans_id,onClick:function(e){return w.itemClick(t.trans_id)},detail:w.is_admin},{default:(0,u.w5)((function(){return[(0,u.Wm)(h,{slot:"start"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(t.date),1)]})),_:2},1024),(0,u.Wm)(h,null,{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(t.trans_description),1)]})),_:2},1024),1==t.is_debit?((0,u.wg)(),(0,u.j4)(S,{key:0,slot:"end",color:"success"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(t.trans_amount),1)]})),_:2},1024)):((0,u.wg)(),(0,u.j4)(S,{key:1,slot:"end",color:"danger"},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,r.zw)(t.trans_amount),1)]})),_:2},1024))]})),_:2},1032,["onClick","detail"])})),128))]})),_:1})):((0,u.wg)(),(0,u.j4)(y,{key:2},{default:(0,u.w5)((function(){return[(0,u.Wm)(k,null,{default:(0,u.w5)((function(){return[f]})),_:1})]})),_:1}))])}var g=n(6835),w=n(8534),_=n(8439),h=(n(7042),n(2066)),k=n(8903),y=n(9755),v=n.n(y),W=n(351),b={components:{IonIcon:h.gu,IonTitle:h.wd,IonLabel:h.Q$,IonItem:h.Ie,IonInput:h.pK,IonList:h.q_,IonAccordion:h.We,IonAccordionGroup:h.eh,IonText:h.yW,IonSkeletonText:h.CK,IonSearchbar:h.VI},props:["account"],setup(){return{settingsOutline:k.C$N}},data(){var t=new Date,e=new Date(Date.parse(`${t.getFullYear()}-${t.getMonth()+1}-1`));return{balance:"-",start_at:e.toISOString().slice(0,10),finish_at:t.toISOString().slice(0,10),q:"",ledger:null,meta:{},today:t}},computed:{ledgerCalc(){if(null==this.ledger)return null;var t,e=[],n=(0,_.Z)(this.ledger);try{for(n.s();!(t=n.n()).done;){var u=t.value;u.date=this.toLocDate(u.trans_date),e.push(u)}}catch(r){n.e(r)}finally{n.f()}return e},is_admin(){return W.Z.isAdmin()}},watch:{account:function(){this.listGet()}},methods:{listGet(){var t=this;return(0,w.Z)((0,g.Z)().mark((function e(){var n,u,r,a;return(0,g.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,n={start_at:t.start_at,finish_at:t.finish_at,account:t.account,q:t.q},e.next=4,v().post(`${t.$heap.state.hostname}Transaction/listGet`,n);case 4:u=e.sent,t.ledger=u.ledger,t.meta=u.meta,t.finish_at==t.today.toISOString().slice(0,10)&&(t.balance=u.meta.sum_finish),e.next=24;break;case 10:e.prev=10,e.t0=e["catch"](0),r=e.t0.responseJSON,a=r.messages.error,e.t1=a,e.next="no_account"===e.t1?17:"large_interval"===e.t1?19:21;break;case 17:return t.$flash("Ошибка получения выписки"),e.abrupt("break",21);case 19:return t.$flash("Период должен быть не больше 3 месяцев"),e.abrupt("break",21);case 21:return t.ledger=[],t.balance=0,e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[0,10]])})))()},toLocDate(t){var e=new Date(Date.parse(t)),n={month:"short",day:"numeric"};return e.toLocaleDateString(void 0,n)},itemClick(t){W.Z.isAdmin()&&this.$router.push(`/admin/transaction-edit-${t}`)}},mounted(){this.listGet()}},x=n(3744);const I=(0,x.Z)(b,[["render",p]]);var $=I},1286:function(t,e,n){n.r(e),n.d(e,{default:function(){return p}});var u=n(6252),r=(0,u.Uk)(" Баланс ");function a(t,e,n,a,l,o){var i=(0,u.up)("ion-segment-button"),c=(0,u.up)("ion-segment"),s=(0,u.up)("ledger-comp"),d=(0,u.up)("base-layout");return(0,u.wg)(),(0,u.j4)(d,{pageTitle:"Статистика продавца",pageDefaultBackLink:"/user"},{default:(0,u.w5)((function(){return[(0,u.Wm)(c,{"swipe-gesture":"true",modelValue:l.activeTab,"onUpdate:modelValue":e[0]||(e[0]=function(t){return l.activeTab=t}),onIonChange:e[1]||(e[1]=function(t){return o.activeTabChanged(t)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(i,{value:"ledger"},{default:(0,u.w5)((function(){return[r]})),_:1})]})),_:1},8,["modelValue"]),"ledger"==l.activeTab?((0,u.wg)(),(0,u.j4)(s,{key:0,account:"supplier"})):(0,u.kq)("",!0)]})),_:1})}var l=n(6835),o=n(8534),i=n(2066),c=n(8903),s=n(4535),d={components:{IonSegment:i.cJ,IonSegmentButton:i.GO,ledgerComp:s.Z},setup(){return{receiptOutline:c.d71}},data(){return{activeTab:"ledger"}},methods:{activeTabChanged(){return(0,o.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()}}},m=n(3744);const f=(0,m.Z)(d,[["render",a]]);var p=f}}]);
//# sourceMappingURL=1286-legacy.711c41bc.js.map