(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[7103],{7850:function(t,e,n){var i=n(111),a=n(4326),r=n(5112),o=r("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==a(t))}},3123:function(t,e,n){"use strict";var i=n(2104),a=n(6916),r=n(1702),o=n(7007),s=n(7850),l=n(9670),d=n(4488),u=n(6707),c=n(1530),m=n(7466),p=n(1340),_=n(8173),h=n(1589),g=n(7651),f=n(2261),v=n(2999),y=n(7293),w=v.UNSUPPORTED_Y,k=4294967295,$=Math.min,I=[].push,D=r(/./.exec),b=r(I),W=r("".slice),T=!y((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));o("split",(function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=p(d(this)),o=void 0===n?k:n>>>0;if(0===o)return[];if(void 0===t)return[r];if(!s(t))return a(e,r,t,o);var l,u,c,m=[],_=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),g=0,v=new RegExp(t.source,_+"g");while(l=a(f,v,r)){if(u=v.lastIndex,u>g&&(b(m,W(r,g,l.index)),l.length>1&&l.index<r.length&&i(I,m,h(l,1)),c=l[0].length,g=u,m.length>=o))break;v.lastIndex===l.index&&v.lastIndex++}return g===r.length?!c&&D(v,"")||b(m,""):b(m,W(r,g)),m.length>o?h(m,0,o):m}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:a(e,this,t,n)}:e,[function(e,n){var i=d(this),o=void 0==e?void 0:_(e,t);return o?a(o,e,i,n):a(r,p(i),e,n)},function(t,i){var a=l(this),o=p(t),s=n(r,a,o,i,r!==e);if(s.done)return s.value;var d=u(a,RegExp),_=a.unicode,h=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(w?"g":"y"),f=new d(w?"^(?:"+a.source+")":a,h),v=void 0===i?k:i>>>0;if(0===v)return[];if(0===o.length)return null===g(f,o)?[o]:[];var y=0,I=0,D=[];while(I<o.length){f.lastIndex=w?0:I;var T,C=g(f,w?W(o,I):o);if(null===C||(T=$(m(f.lastIndex+(w?I:0)),o.length))===y)I=c(o,I,_);else{if(b(D,W(o,y,I)),D.length===v)return D;for(var x=1;x<=C.length-1;x++)if(b(D,C[x]),D.length===v)return D;I=y=T}}return b(D,W(o,y)),D}]}),!T,w)},4405:function(t,e,n){"use strict";n(4916),n(5306);var i=n(2008);const a={deliveryCalculate(t){if(!t.locations||!t.locations[0]||!t.locations[0].distance)return null;const e=t.locations[0].distance,n=t.store_time_preparation||0;return a.deliveryTimeCalculate(e,n)},deliveryTimeCalculate(t,e){var n;e=parseInt(null!==(n=e)&&void 0!==n?n:i.Z.getters.settings.delivery.timePreparationDefault);const a=parseInt(i.Z.getters.settings.delivery.timeDelta),r=parseInt(i.Z.getters.settings.delivery.speed),o=5*Math.round(t/r*60/5)+e,s=o>a?o-a:o,l=s+a;return{time:o,timeMin:s,timeMax:l}},render(t,e){for(let n in e)t=t.replace(`{{${n}}}`,e[n]);return t=t.replace(/{{\.}}/,"-"),t}};e["Z"]=a},6321:function(t,e,n){"use strict";n.d(e,{Z:function(){return g}});var i=n(6252),a=n(3577);const r={class:"ion-page"},o=(0,i.Uk)(" Ничего не найдено ");function s(t,e,n,s,l,d){const u=(0,i.up)("ion-title"),c=(0,i.up)("ion-icon"),m=(0,i.up)("ion-toolbar"),p=(0,i.up)("ion-header"),_=(0,i.up)("ion-searchbar"),h=(0,i.up)("ion-skeleton-text"),g=(0,i.up)("ion-item"),f=(0,i.up)("ion-list"),v=(0,i.up)("ion-img"),y=(0,i.up)("ion-avatar"),w=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,{color:"secondary"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Выбрать "+(0,a.zw)(l.itemTypeName),1)])),_:1}),(0,i.Wm)(c,{icon:s.closeOutline,onClick:e[0]||(e[0]=t=>{d.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,i.Wm)(w,null,{default:(0,i.w5)((()=>{var n;return["acc"!=l.itemTypeLabel?((0,i.wg)(),(0,i.j4)(_,{key:0,modelValue:l.query,"onUpdate:modelValue":e[1]||(e[1]=t=>l.query=t),placeholder:"поиск",debounce:100,onIonChange:e[2]||(e[2]=t=>d.listGet())},null,8,["modelValue"])):(0,i.kq)("",!0),l.itemList?null!==(n=l.itemList)&&void 0!==n&&n.length?((0,i.wg)(),(0,i.j4)(f,{key:2},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(l.itemList,(e=>((0,i.wg)(),(0,i.j4)(g,{key:e.id,button:"",detail:"",onClick:t=>d.itemPick(e)},{default:(0,i.w5)((()=>[(0,i.Wm)(y,{slot:"start"},{default:(0,i.w5)((()=>[e.image_hash?((0,i.wg)(),(0,i.j4)(v,{key:0,src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.50.50.webp`},null,8,["src"])):(0,i.kq)("",!0)])),_:2},1024),(0,i.Uk)(" "+(0,a.zw)(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1})):((0,i.wg)(),(0,i.j4)(f,{key:3},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[o])),_:1})])),_:1})):((0,i.wg)(),(0,i.j4)(f,{key:1},{default:(0,i.w5)((()=>[((0,i.wg)(),(0,i.iD)(i.HY,null,(0,i.Ko)([0,1,2,3,4,5,6,7,8,9],(t=>(0,i.Wm)(g,{key:t,button:"",detail:""},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{style:{height:"35px",width:"40px"},animated:""}),(0,i.Wm)(h,{style:{width:"100%"},animated:""})])),_:2},1024))),64))])),_:1}))]})),_:1})])}var l=n(8534),d=n(8903),u=n(8292),c=n(9755),m=n.n(c),p={props:["itemType"],components:{IonContent:u.W2,IonHeader:u.Gu,IonToolbar:u.sr,IonTitle:u.wd,IonIcon:u.gu,IonImg:u.Xz,IonList:u.q_,IonItem:u.Ie,IonSearchbar:u.VI,IonSkeletonText:u.CK,IonAvatar:u.BJ},setup(){return{closeOutline:d.fID}},data(){const t=this.itemType?this.itemType:"order";return{query:null,itemList:null,itemTypeLabel:t,itemTypeName:""}},mounted(){this.listGet()},methods:{listGet(){var t=this;return(0,l.Z)((function*(){"order"==t.itemTypeLabel?(t.itemTypeName="Заказ",t.ordersGet()):"store"==t.itemTypeLabel?(t.itemTypeName="Продавец",t.storesGet()):"courier"==t.itemTypeLabel?(t.itemTypeName="Курьер",t.couriersGet()):"acc"==t.itemTypeLabel?(t.itemTypeName="Счет",t.accountsGet()):t.$flash("unknown item type "+t.itemTypeLabel)}))()},storesGet(){var t=this;return(0,l.Z)((function*(){const e={name_query:t.query,name_query_fields:"store_name",limit:10};try{let n=yield m().post(`${t.$heap.state.hostname}Store/listGet`,e);t.itemList=n.map((t=>(t.name=`продавец ${t.store_name}`,t.id=t.store_id,t)))}catch(n){}}))()},couriersGet(){var t=this;return(0,l.Z)((function*(){const e={name_query:t.query,name_query_fields:"user_name,user_phone",limit:10};try{let n=yield m().post(`${t.$heap.state.hostname}Courier/listGet`,e);t.itemList=n.map((t=>(t.name=`курьер ${t.user_name} ${t.user_phone}`,t.id=t.courier_id,t.image_hash=t.courier_photo_image_hash,t)))}catch(n){}}))()},ordersGet(){var t=this;return(0,l.Z)((function*(){const e={name_query:t.query,name_query_fields:"store_name,order_id,user_name",limit:10};try{let n=yield m().post(`${t.$heap.state.hostname}Order/listGet`,e);t.itemList=n.map((t=>(t.name=`заказ#${t.order_id} ${t.store_name} > ${t.user_name}`,t.id=t.order_id,t)))}catch(n){}}))()},accountsGet(){var t=this;return(0,l.Z)((function*(){const e={group_table:"transaction_account_list"};try{let n=yield m().post(`${t.$heap.state.hostname}Admin/GroupManager/listGet`,e);t.itemList=n.map((t=>(t.name=`${t.group_name}`,t.type=t.group_type,t)))}catch(n){}}))()},itemPick(t){u.Fy.dismiss(t)},closeModal(){u.Fy.dismiss()}}},_=n(3744);const h=(0,_.Z)(p,[["render",s]]);var g=h},7103:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return W}});var i=n(6252),a=n(3577);const r=(0,i.Uk)("Дата"),o=(0,i.Uk)("Тип проводки"),s=(0,i.Uk)("Родительские элементы"),l=(0,i.Uk)("Сумма"),d=(0,i.Uk)("Комментарий"),u=(0,i.Uk)("Отключена"),c=(0,i.Uk)("Удалить"),m=(0,i.Uk)("Сохранить");function p(t,e,n,p,_,h){const g=(0,i.up)("ion-label"),f=(0,i.up)("ion-input"),v=(0,i.up)("ion-item"),y=(0,i.up)("ion-select-option"),w=(0,i.up)("ion-select"),k=(0,i.up)("ion-icon"),$=(0,i.up)("ion-chip"),I=(0,i.up)("ion-text"),D=(0,i.up)("ion-textarea"),b=(0,i.up)("ion-toggle"),W=(0,i.up)("ion-note"),T=(0,i.up)("ion-list"),C=(0,i.up)("ion-button"),x=(0,i.up)("ion-col"),U=(0,i.up)("ion-row"),q=(0,i.up)("ion-grid"),G=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(G,{pageDefaultBackLink:"/user","page-title":"Редактирование проводки"},{default:(0,i.w5)((()=>[_.transaction?((0,i.wg)(),(0,i.j4)(T,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{position:"floating"},{default:(0,i.w5)((()=>[r])),_:1}),(0,i.Wm)(f,{modelValue:_.transaction.trans_date,"onUpdate:modelValue":e[0]||(e[0]=t=>_.transaction.trans_date=t),placeholder:"дата",type:"date"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{position:"floating"},{default:(0,i.w5)((()=>[o])),_:1}),(0,i.Wm)(w,{interface:"popover",placeholder:"Выберите тип проводки",modelValue:_.transaction.trans_role,"onUpdate:modelValue":e[1]||(e[1]=t=>_.transaction.trans_role=t),required:"",onIonChange:e[2]||(e[2]=t=>h.itemUpdateRole(1))},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(_.transTypes,(t=>((0,i.wg)(),(0,i.j4)(y,{key:t.trans_role,value:t.trans_role},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(t.trans_name),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,i.Wm)(v,{lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{position:"stacked"},{default:(0,i.w5)((()=>[s])),_:1}),(0,i.Wm)(I,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(_.tagDict,((t,e)=>((0,i.wg)(),(0,i.j4)($,{key:e,color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)("#"+(0,a.zw)(t)+" ",1),-1==e.indexOf("acc")?((0,i.wg)(),(0,i.j4)(k,{key:0,src:p.closeCircle,onClick:t=>h.tagDictRemove(e)},null,8,["src","onClick"])):(0,i.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(I,null,{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(h.tagMissingNames,(t=>((0,i.wg)(),(0,i.j4)($,{key:t,onClick:e=>h.tagDictPick(t),color:"medium"},{default:(0,i.w5)((()=>[(0,i.Wm)(k,{src:p.addOutline},null,8,["src"]),(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[(0,i.Uk)("Добавить #"+(0,a.zw)(_.tagHolderNames[t]),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{position:"floating"},{default:(0,i.w5)((()=>[l])),_:1}),(0,i.Wm)(f,{modelValue:_.transaction.trans_amount,"onUpdate:modelValue":e[3]||(e[3]=t=>_.transaction.trans_amount=t),placeholder:"сумма",inputmode:"decimal",autocomplete:"transaction-amount",min:"1"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(g,{position:"floating"},{default:(0,i.w5)((()=>[d])),_:1}),(0,i.Wm)(D,{modelValue:_.transaction.trans_description,"onUpdate:modelValue":e[4]||(e[4]=t=>_.transaction.trans_description=t)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,null,{default:(0,i.w5)((()=>[u])),_:1}),(0,i.Wm)(b,{modelValue:_.transaction.is_disabled,"onUpdate:modelValue":e[5]||(e[5]=t=>_.transaction.is_disabled=t)},null,8,["modelValue"])])),_:1}),(0,i.Wm)(v,{lines:"none"},{default:(0,i.w5)((()=>[_.transaction.created_at?((0,i.wg)(),(0,i.j4)(W,{key:0},{default:(0,i.w5)((()=>[(0,i.Uk)(" Создано "+(0,a.zw)(_.transaction.created_user_name)+" "+(0,a.zw)(_.transaction.created_at),1)])),_:1})):(0,i.kq)("",!0),_.transaction.created_at?((0,i.wg)(),(0,i.j4)(W,{key:1},{default:(0,i.w5)((()=>[(0,i.Uk)(" Изменено "+(0,a.zw)(_.transaction.updated_user_name)+" "+(0,a.zw)(_.transaction.updated_at),1)])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1})):(0,i.kq)("",!0),_.transaction?((0,i.wg)(),(0,i.j4)(q,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(U,null,{default:(0,i.w5)((()=>[(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(C,{color:"medium",onClick:e[6]||(e[6]=t=>h.itemDelete()),expand:"block"},{default:(0,i.w5)((()=>[c])),_:1})])),_:1}),(0,i.Wm)(x,null,{default:(0,i.w5)((()=>[(0,i.Wm)(C,{color:"primary",onClick:e[7]||(e[7]=t=>h.itemSave()),expand:"block"},{default:(0,i.w5)((()=>[m])),_:1})])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1})}var _=n(8534),h=(n(6699),n(4916),n(5306),n(8862),n(3123),n(3948),n(8292)),g=n(8903),f=n(9755),v=n.n(f),y=n(351),w=n(4405),k=n(6321);const $=[{trans_role:"profit->site",holder:["order","store","courier"],trans_name:"Сайт Доход от доставки",trans_description:"Доход от доставки. Заказ №{{order_id}}"},{trans_role:"site->profit",holder:["order"],trans_name:"Сайт Списание месячной прибыли",trans_description:"Списание месячной прибыли"},{trans_role:"site->supplier",holder:["store"],trans_name:"Продавец Выплата",trans_description:"Выплата по договору за выполненные заказы"},{trans_role:"site.->supplier",holder:["order","store"],trans_name:"Продавец Штраф",trans_description:"Средства взимаемые с Продавца для воврата оплаты Покупателю. Заказ №{{order_id}}"},{trans_role:"supplier->site",holder:["order","store"],trans_name:"Продавец Отгрузка заказа",trans_description:"Стоимость товара, отгруженного Покупателю. Заказ №{{order_id}}"},{trans_role:"profit->supplier",holder:["order","store"],trans_name:"Продавец Комиссия сайта",trans_description:"Комиссия сайта за предоставленные услуги. Заказ №{{order_id}}"},{trans_role:"supplier->site",holder:["store"],trans_name:"Продавец Получение аванса",trans_description:"Аванс за услуги сайта"},{trans_role:"supplier->profit",holder:["store"],trans_name:"Продавец Начисление бонуса при регистрации",trans_description:"Начисление бонуса на услуги при регистрации на сайте"},{trans_role:"site->courier",holder:["courier"],trans_name:"Курьер Выплата",trans_description:"Выплата по договору за оказанные услуги"},{trans_role:"courier->profit",holder:["order","courier"],trans_name:"Курьер Начисление бонуса",trans_description:"Начисление бонуса за Заказ №{{order_id}}"},{trans_role:"profit->courier",holder:["order","courier"],trans_name:"Курьер Штраф",trans_description:"Штраф за не выполнение Заказа №{{order_id}}"}];var I={components:{IonInput:h.pK,IonIcon:h.gu,IonList:h.q_,IonItem:h.Ie,IonToggle:h.ho,IonLabel:h.Q$,IonSelect:h.t9,IonSelectOption:h.n0,IonTextarea:h.g2,IonButton:h.YG,IonGrid:h.jY,IonRow:h.Nd,IonCol:h.wI,IonNote:h.uN,IonChip:h.hM,IonText:h.yW},setup(){return{trashOutline:g.gtu,searchOutline:g.W6I,addOutline:g.s6O,closeCircle:g.XZx}},data(){return{transactionId:this.$route.params.id,transaction:null,transTypes:$,tagDict:{},tagHolderNames:{order:"заказ",store:"продавец",courier:"курьер",acc:"счет"},tagOptionNames:{debit:"(+)",credit:"(-)"}}},computed:{tagRequired(){var t;return(null===(t=this.transTypeCurrent)||void 0===t?void 0:t.holder)||[]},tagMissingNames(){var t;return(null===(t=this.tagRequired)||void 0===t?void 0:t.filter((t=>!Object.keys(this.tagDict).join(":").includes(t))))||""},transTypeCurrent(){return this.transTypes.find((t=>t.trans_role==this.transaction.trans_role))||[]}},created(){const t=this;this.$topic.on("userGet",(()=>{t.init()})),y.Z.isAdmin()&&this.init()},methods:{init(){y.Z.isAdmin()||this.$router.replace("/"),this.itemGet()},itemGet(){var t=this;return(0,_.Z)((function*(){if(0==t.transactionId)return void(t.transaction={});let e={trans_id:t.transactionId};try{var n;t.transaction=yield v().post(`${t.$heap.state.hostname}Transaction/itemGet`,e),t.transaction.trans_date=null===(n=t.transaction.trans_date)||void 0===n?void 0:n.substring(0,10),t.transaction.is_disabled=1*t.transaction.is_disabled,t.tagDictFill(t.transaction.tags)}catch(r){var i,a;const e=null===r||void 0===r||null===(i=r.responseJSON)||void 0===i||null===(a=i.messages)||void 0===a?void 0:a.error;switch(e){case"forbidden":t.$flash("Не достаточно прав");break;case"notfound":t.$flash("Проводка не найдена");break}return!1}}))()},validate(){return this.tagMissingNames.length>0?(this.$flash("Не выбраны все родительские элементы"),!1):this.transaction.trans_role?this.transaction.trans_date?0!=this.transaction.trans_amount||(this.$flash("Сумма должна не равняться нулю"),!1):(this.$flash("Дата не выбрана"),!1):(this.$flash("Тип проводки не выбран"),!1)},itemSave(){var t=this;return(0,_.Z)((function*(){var e;if(!t.validate())return;const n=Object.keys(null!==(e=t.tagDict)&&void 0!==e?e:{}).join(" "),i={tags:n,trans_id:t.transaction.trans_id,trans_date:t.transaction.trans_date,trans_amount:t.transaction.trans_amount,trans_role:t.transaction.trans_role,trans_description:t.transaction.trans_description,is_disabled:t.transaction.is_disabled};try{const e=i.trans_id?"itemUpdate":"itemCreate";yield v().post(`${t.$heap.state.hostname}Transaction/${e}`,JSON.stringify(i)),t.$flash("💾 сохранено"),t.$router.go(-1)}catch(o){var a,r;const e=null===o||void 0===o||null===(a=o.responseJSON)||void 0===a||null===(r=a.messages)||void 0===r?void 0:r.error;switch(e){case"forbidden":t.$flash("Не достаточно прав");break}return t.$flash("Не удалось сохранить проводку"),!1}}))()},itemUpdateRole(){var t=this;return(0,_.Z)((function*(){t.transTypeCurrent?t.tagDictTruncate():t.$flash("Неверный тип проводки")}))()},itemDescriptionRender(){if(!this.transTypeCurrent.trans_description)return;const t=this.transTypeCurrent.trans_description;let e=this.transaction;for(let n in this.tagDict){this.tagDict[n];const t=n.split(":"),i=t[0];e[`${i}_id`]=t[1]}this.transaction.trans_description=w.Z.render(t,e)},itemDelete(){var t=this;return(0,_.Z)((function*(){if(confirm("Вы уверенны?"))try{yield v().post(`${t.$heap.state.hostname}Transaction/itemDelete`,{trans_id:t.transactionId}),t.$router.go(-1)}catch(e){}}))()},tagDictPick(t){var e=this;return(0,_.Z)((function*(){var n,i,a,r;const o=yield h.Fy.create({component:k.Z,componentProps:{itemType:t},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});o.present(),e.$topic.on("dismissModal",(()=>{o.dismiss()}));const s=yield o.onDidDismiss();if(s.data){if(null!==(n=s.data.order_id)&&void 0!==n&&n){e.tagDictAdd([`order:${s.data.order_id}`,`заказ ${s.data.order_id}`]);const t=yield v().post(`${e.$heap.state.hostname}Order/itemGet`,{order_id:s.data.order_id});var l;if(e.tagRequired.includes("store")&&t.order_store_id)e.tagDictNameRemove("store"),s.data.store_id=t.order_store_id,s.data.store_name=null===t||void 0===t||null===(l=t.store)||void 0===l?void 0:l.store_name;if(e.tagRequired.includes("courier")&&t.order_courier_id){const n=yield v().post(`${e.$heap.state.hostname}Courier/itemGet`,{courier_id:t.order_courier_id});e.tagDictNameRemove("courier"),s.data.courier_id=n.courier_id,s.data.courier_name=n.courier_name}}var d,u,c;if(null!==(i=s.data.store_id)&&void 0!==i&&i)e.tagDictAdd([`store:${s.data.store_id}`,`продавец ${null!==(d=s.data.store_name)&&void 0!==d?d:"?"}`]);if(null!==(a=s.data.courier_id)&&void 0!==a&&a)e.tagDictAdd([`courier:${s.data.courier_id}`,`курьер ${null!==(u=s.data.courier_name)&&void 0!==u?u:"?"}`]);if(null!==(r=s.data.type)&&void 0!==r&&r)e.tagDictAdd([`acc::${s.data.type}`,`счет ${null!==(c=s.data.name)&&void 0!==c?c:"?"}`])}}))()},tagDictAdd(t){var e;let n=null!==(e=this.tagDict)&&void 0!==e?e:{};n[t[0]]=t[1],this.tagDict=n,this.itemDescriptionRender()},tagDictRemove(t){var e;let n=null!==(e=this.tagDict)&&void 0!==e?e:{};n[t]&&delete n[t];const i=Object.keys(n).length;this.tagDict=i?n:{},this.itemDescriptionRender()},tagDictNameRemove(t){var e,n;let i=null!==(e=this.tagDict)&&void 0!==e?e:{};const a=null===(n=Object.keys(i))||void 0===n?void 0:n.find((e=>e.indexOf(t)>-1));this.tagDictRemove(a)},tagDictTruncate(){this.tagDict={},this.itemDescriptionRender()},tagDictFill(t){let e={};if(t)for(let a of t){var n,i;e[`${a.tag_name}:${a.tag_id}:${a.tag_type}:${a.tag_option}`]=`${this.tagHolderNames[a.tag_name]} ${null!==(n=this.tagOptionNames[a.tag_option])&&void 0!==n?n:""} ${null!==(i=a.tag_label)&&void 0!==i?i:"(?)"}`}this.tagDict=e,this.itemDescriptionRender()}}},D=n(3744);const b=(0,D.Z)(I,[["render",p]]);var W=b}}]);
//# sourceMappingURL=7103-legacy.26a368d2.js.map