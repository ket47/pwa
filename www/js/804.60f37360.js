"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[804],{804:function(e,t,n){n.r(t),n.d(t,{default:function(){return I}});var i=n(641);const l={class:"horizontalScroller"},o={slot:"end",style:{display:"grid","grid-template-columns":"120px 100px"}},a={id:"userMetricPage"},u={key:0},r=["innerHTML"],d={key:1};function s(e,t,n,s,c,p){const _=(0,i.g2)("ion-icon"),g=(0,i.g2)("ion-label"),m=(0,i.g2)("ion-chip"),f=(0,i.g2)("ion-text"),h=(0,i.g2)("ion-input"),k=(0,i.g2)("ion-item"),b=(0,i.g2)("ion-select-option"),I=(0,i.g2)("ion-select"),y=(0,i.g2)("ion-toggle"),F=(0,i.g2)("ion-list"),v=(0,i.g2)("ion-infinite-scroll-content"),L=(0,i.g2)("ion-infinite-scroll"),C=(0,i.g2)("base-layout");return(0,i.uX)(),(0,i.Wv)(C,{pageTitle:"Общая статистика",pageDefaultBackLink:"/user"},{default:(0,i.k6)(()=>[(0,i.Lk)("div",l,[(0,i.bF)(m,{onClick:t[0]||(t[0]=e=>p.reportPrint()),color:"medium"},{default:(0,i.k6)(()=>[(0,i.bF)(_,{src:s.printOutline},null,8,["src"]),(0,i.bF)(g,null,{default:(0,i.k6)(()=>t[6]||(t[6]=[(0,i.eW)("Напечатать")])),_:1,__:[6]})]),_:1}),(0,i.bF)(m,{onClick:t[1]||(t[1]=e=>p.listGet()),color:"medium"},{default:(0,i.k6)(()=>[(0,i.bF)(_,{src:s.reloadOutline},null,8,["src"]),(0,i.bF)(g,null,{default:(0,i.k6)(()=>t[7]||(t[7]=[(0,i.eW)("Обновить")])),_:1,__:[7]})]),_:1})]),(0,i.bF)(F,null,{default:(0,i.k6)(()=>[(0,i.bF)(k,null,{default:(0,i.k6)(()=>[(0,i.bF)(f,{color:"medium"},{default:(0,i.k6)(()=>t[8]||(t[8]=[(0,i.eW)("Дата")])),_:1,__:[8]}),(0,i.Lk)("div",o,[(0,i.bF)(h,{onIonInput:p.listGet,type:"date",modelValue:c.finish_at,"onUpdate:modelValue":t[2]||(t[2]=e=>c.finish_at=e)},null,8,["onIonInput","modelValue"])])]),_:1}),(0,i.bF)(k,null,{default:(0,i.k6)(()=>[(0,i.bF)(I,{modelValue:c.user_group,"onUpdate:modelValue":t[3]||(t[3]=e=>c.user_group=e),onIonChange:p.listGet,label:"Группа пользователей",placeholder:"Выберите группу...",multiple:!0},{default:(0,i.k6)(()=>[(0,i.bF)(b,{value:"guest"},{default:(0,i.k6)(()=>t[9]||(t[9]=[(0,i.eW)("Гость")])),_:1,__:[9]}),(0,i.bF)(b,{value:"customer"},{default:(0,i.k6)(()=>t[10]||(t[10]=[(0,i.eW)("Покупатель")])),_:1,__:[10]}),(0,i.bF)(b,{value:"courier"},{default:(0,i.k6)(()=>t[11]||(t[11]=[(0,i.eW)("Курьер")])),_:1,__:[11]}),(0,i.bF)(b,{value:"supplier"},{default:(0,i.k6)(()=>t[12]||(t[12]=[(0,i.eW)("Продавец")])),_:1,__:[12]}),(0,i.bF)(b,{value:"admin"},{default:(0,i.k6)(()=>t[13]||(t[13]=[(0,i.eW)("Администратор")])),_:1,__:[13]})]),_:1},8,["modelValue","onIonChange"])]),_:1}),(0,i.bF)(k,null,{default:(0,i.k6)(()=>[(0,i.bF)(y,{onIonChange:t[4]||(t[4]=e=>{c.order_only=e.target.checked,p.listGet()}),justify:"space-between"},{default:(0,i.k6)(()=>t[14]||(t[14]=[(0,i.eW)("Только заказавшие")])),_:1,__:[14]})]),_:1})]),_:1}),(0,i.Lk)("div",a,[c.data.length>0?((0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("div",{innerHTML:c.data},null,8,r),(0,i.bF)(L,{onIonInfinite:t[5]||(t[5]=e=>p.listLoadMore(e)),id:"user-metric-infinite-scroll"},{default:(0,i.k6)(()=>[(0,i.bF)(v,{"loading-spinner":"bubbles","loading-text":"Загрузка..."})]),_:1})])):((0,i.uX)(),(0,i.CE)("div",d,t[15]||(t[15]=[(0,i.Lk)("div",{style:{padding:"1em 2em"}},[(0,i.Lk)("h4",null,"Ничего не найдено"),(0,i.Lk)("p",{style:{"font-size":"14px",margin:"0"}},"Нет активности за выбранный период")],-1)])))])]),_:1})}var c=n(5634),p=n(5480),_=n(2311),g=n.n(_),m=n(3201),f=n(8701),h={components:{IonChip:c.ZB,IonLabel:c.he,IonIcon:c.iq,IonList:c.nf,IonItem:c.uz,IonInput:c.$w,IonText:c.IO,IonSelect:c.Nm,IonSelectOption:c.Ip,IonInfiniteScroll:c.Ax,IonInfiniteScrollContent:c.Hp,IonToggle:c.BY},setup(){return{printOutline:p.SfY,calendarOutline:p.RXF,addOutline:p.EKF,calculatorOutline:p.N0h,reloadOutline:p.QMU}},data(){const e=m.A.date.today();return{data:[],finish_at:m.A.date.toIso(e),user_group:["guest","admin","courier","customer","supplier"],order_only:!1,currentPage:0}},computed:{is_admin(){return f.A.isAdmin()},finish_at_dmy(){return m.A.date.isoToDmy(this.finish_at)}},async mounted(){this.listGet()},methods:{async listLoadMore(e){await this.listGet("append"),e.target.complete()},async listGet(e=""){const t={finish_at:this.finish_at,user_group:this.user_group,order_only:this.order_only};"append"==e?this.currentPage++:this.currentPage=0,t.page=this.currentPage;const n=await g().post(this.$heap.state.hostname+"Metric/buildView",t);n&&("append"==e?this.data+=n:this.data=n)},reportPrint(){var e;null===(e=document.getElementById("printPage"))||void 0===e||e.remove(),document.body.setAttribute("class","print");let t=document.getElementById("userMetricPage"),n=document.createElement("DIV");n.setAttribute("id","printPage"),n.innerHTML=t.innerHTML,document.body.appendChild(n),setTimeout(window.print(),500)}}},k=n(6262);const b=(0,k.A)(h,[["render",s]]);var I=b}}]);
//# sourceMappingURL=804.60f37360.js.map