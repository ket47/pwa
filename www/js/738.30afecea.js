"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[738],{3738:function(e,s,a){a.r(s),a.d(s,{default:function(){return q}});var l=a(6252),r=a(3577),t=a(9963);const u=(0,l.Uk)(" Вы уже вошли в систему с номером телефона "),n=(0,l.Uk)(" Простая регистрация "),o=(0,l.Uk)(" Для регистрации необходим только ваш номер мобильного телефона "),i={novalidate:""},p=(0,l.Uk)("Код"),d=(0,l.Uk)("+7 "),_=(0,l.Uk)("Мобильный телефон*"),m={"padding-left":""},h=(0,l.Uk)("Пароль (Минимум 4 символа)*"),c={"padding-left":""},f=(0,l.Uk)("Повтор пароля*"),w={"padding-left":""},k=(0,l.Uk)("Ваш псевдоним*"),W={"padding-left":""},y=(0,l.Uk)("Ваш е-маил (не обязательно)"),g=(0,l.Uk)("Зарегистрироваться"),b=(0,l.Uk)("Уже есть учетная запись?");function V(e,s,a,V,x,I){const U=(0,l.up)("ion-card-title"),$=(0,l.up)("ion-card-header"),v=(0,l.up)("ion-card-content"),q=(0,l.up)("ion-card"),C=(0,l.up)("ion-label"),S=(0,l.up)("ion-select-option"),z=(0,l.up)("ion-select"),O=(0,l.up)("ion-col"),F=(0,l.up)("ion-input"),N=(0,l.up)("ion-row"),j=(0,l.up)("ion-grid"),J=(0,l.up)("ion-text"),D=(0,l.up)("ion-item"),T=(0,l.up)("ion-list"),Z=(0,l.up)("ion-button"),G=(0,l.up)("router-link"),L=(0,l.up)("base-layout");return(0,l.wg)(),(0,l.j4)(L,{"page-title":"Регистрация нового пользователя","page-default-back-link":"/home"},{default:(0,l.w5)((()=>[e.$heap.state.user.user_id>0?((0,l.wg)(),(0,l.j4)(q,{key:0,style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,l.w5)((()=>[(0,l.Wm)($,null,{default:(0,l.w5)((()=>[(0,l.Wm)(U,{color:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,r.zw)(e.$heap.state.user.user_name)+" "+(0,r.zw)(e.$heap.state.user.user_surname)+" "+(0,r.zw)(e.$heap.state.user.user_middlename),1)])),_:1})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[u,(0,l._)("b",null,(0,r.zw)(e.$heap.state.user.user_phone),1)])),_:1})])),_:1})):((0,l.wg)(),(0,l.j4)(q,{key:1},{default:(0,l.w5)((()=>[(0,l.Wm)($,null,{default:(0,l.w5)((()=>[(0,l.Wm)(U,{color:"primary"},{default:(0,l.w5)((()=>[n])),_:1})])),_:1}),(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[o])),_:1})])),_:1})),(0,l._)("form",i,[(0,l.Wm)(T,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(j,{style:{width:"100%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(N,null,{default:(0,l.w5)((()=>[(0,l.Wm)(O,{size:"5"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[p])),_:1}),(0,l.Wm)(z,{value:x.user_phone_prefix},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{value:"7",selected:""},{default:(0,l.w5)((()=>[d])),_:1})])),_:1},8,["value"])])),_:1}),(0,l.Wm)(O,{size:"7"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[_])),_:1}),(0,l.Wm)(F,{modelValue:x.user_phone,"onUpdate:modelValue":s[0]||(s[0]=e=>x.user_phone=e),onIonChange:s[1]||(s[1]=e=>I.phoneFormat()),name:"phone",type:"tel",inputmode:"tel",placeholder:"(xxx)xxxxxxxxx",required:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(J,{color:"danger",slot:"helper"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("p",m,"Неверный номер телефона",512),[[t.F8,!I.phoneValid&&1==x.submitted]])])),_:1})])),_:1}),(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[h])),_:1}),(0,l.Wm)(F,{modelValue:x.user_pass,"onUpdate:modelValue":s[2]||(s[2]=e=>x.user_pass=e),name:"password",type:"password",autocorrect:"off",placeholder:"Пароль (Минимум 4 символа)",required:""},null,8,["modelValue"]),(0,l.Wm)(J,{color:"danger",slot:"helper"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("p",c,"Пароль должен содержать не менее 4 символов.",512),[[t.F8,!I.passwordValid&&1==x.submitted]])])),_:1})])),_:1}),(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[f])),_:1}),(0,l.Wm)(F,{modelValue:x.user_pass_confirm,"onUpdate:modelValue":s[3]||(s[3]=e=>x.user_pass_confirm=e),type:"password",autocorrect:"off",placeholder:"Повтор пароля",required:""},null,8,["modelValue"]),(0,l.Wm)(J,{color:"danger",slot:"helper"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("p",w,"Пароль не совпадает с подтверждением",512),[[t.F8,x.user_pass!=x.user_pass_confirm&&1==x.submitted]])])),_:1})])),_:1}),(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[k])),_:1}),(0,l.Wm)(F,{modelValue:x.user_name,"onUpdate:modelValue":s[4]||(s[4]=e=>x.user_name=e),name:"username",type:"text",placeholder:"как к вам обращаться?",required:""},null,8,["modelValue"]),(0,l.Wm)(J,{color:"danger",slot:"helper"},{default:(0,l.w5)((()=>[(0,l.wy)((0,l._)("p",W,"Проверьте ваш псевдоним",512),[[t.F8,!I.usernameValid&&1==x.submitted]])])),_:1})])),_:1}),(0,l.Wm)(D,null,{default:(0,l.w5)((()=>[(0,l.Wm)(C,{position:"stacked",color:"primary"},{default:(0,l.w5)((()=>[y])),_:1}),(0,l.Wm)(F,{modelValue:x.user_email,"onUpdate:modelValue":s[5]||(s[5]=e=>x.user_email=e),name:"email",type:"email",placeholder:"е-маил",required:""},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(N,{"responsive-sm":""},{default:(0,l.w5)((()=>[(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{onClick:I.onSubmit,expand:"block"},{default:(0,l.w5)((()=>[g])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,l.Wm)(N,{"responsive-sm":""},{default:(0,l.w5)((()=>[(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Wm)(G,{to:"/sign-in"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{color:"light",expand:"block"},{default:(0,l.w5)((()=>[b])),_:1})])),_:1})])),_:1})])),_:1})])])),_:1})}var x=a(1716),I=a(351),U=(a(9755),{components:{IonGrid:x.jY,IonRow:x.Nd,IonCol:x.wI,IonSelect:x.t9,IonSelectOption:x.n0,IonLabel:x.Q$,IonInput:x.pK,IonItem:x.Ie,IonText:x.yW,IonList:x.q_,IonButton:x.YG,IonCard:x.PM,IonCardHeader:x.Zi,IonCardTitle:x.Dq,IonCardContent:x.FN},data(){return{submitted:!1,user_pass:null,user_pass_confirm:null,user_phone:null,user_phone_prefix:"7",user_name:null,user_email:null}},computed:{phoneValid(){return 10==this.user_phone?.replace(/\D/g,"").length},passwordValid(){return this.user_pass?.length>=4},usernameValid(){return this.user_name?.length>0}},methods:{async onSubmit(){if(this.submitted=!0,this.user_pass!=this.user_pass_confirm||!this.phoneValid||!this.passwordValid||!this.usernameValid)return;let e={user_phone:this.user_phone_prefix+this.user_phone,user_pass:this.user_pass,user_pass_confirm:this.user_pass_confirm,user_name:this.user_name,user_email:this.user_email};try{await I.Z.signUp(e),localStorage.signInData=JSON.stringify({user_phone:this.user_phone_prefix+this.user_phone,user_pass:this.user_pass}),this.phoneVerify()}catch(s){let e="unknown";try{const a=Object.keys(JSON.parse(s.responseJSON.messages.error))[0],l=Object.values(JSON.parse(s.responseJSON.messages.error))[0];e=a+"_"+l}catch{}switch(e){case"user_phone_notunique":this.$flash("Пользователь с таким телефоном уже зарегистрирован");break;case"user_phone_required":case"user_phone_invalid":case"user_phone_short":this.$flash("Проверьте номер телефона");break;case"user_name_required":case"user_name_short":this.$flash("Проверьте ваш псевдоним");break;case"user_email_invalid":this.$flash("Проверьте ваш е-маил");break;case"user_email_notunique":this.$flash("Такой е-маил уже используется");break;case"user_pass_required":this.$flash("Пароль обязателен для заполнения");break;case"user_pass_short":this.$flash("Пароль слишком короткий");break;case"user_pass_notmatches":this.$flash("Пароль не совпадает с подтверждением");break;default:this.$flash("Не удалось войти зарегистрироваться")}}},phoneFormat(){this.user_phone||(this.user_phone="");try{let e=this.user_phone.replace(/\D/g,"");e.length>10&&(e=e.substring(e.length-10)),this.user_phone=e}catch{}},async phoneVerify(){let e={user_phone:this.user_phone_prefix+this.user_phone};try{this.$router.push({name:"UserVerifyPhone",params:e})}catch{this.$flash("Не удалось выслать смс с подтверждением")}}}}),$=a(3744);const v=(0,$.Z)(U,[["render",V]]);var q=v}}]);
//# sourceMappingURL=738.30afecea.js.map