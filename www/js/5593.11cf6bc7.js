"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[5593],{5593:function(t,e,n){n.r(e),n.d(e,{default:function(){return g}});var a=n(6252),l=n(3577),o=n(9963);const i={key:2},s={class:"is_main"};function r(t,e,n,r,c,u){const d=(0,a.up)("ion-label"),m=(0,a.up)("ion-item-divider"),h=(0,a.up)("ion-item"),p=(0,a.up)("ion-icon"),_=(0,a.up)("ion-toggle"),f=(0,a.up)("ion-list"),w=(0,a.up)("ion-skeleton-text"),g=(0,a.up)("ion-img"),k=(0,a.up)("ion-chip"),y=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(y,{pageTitle:"Мои способы оплаты"},{default:(0,a.w5)((()=>{var t;return[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{style:{"margin-top":"0px","box-shadow":"none"}},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Настройки")])),_:1})])),_:1}),(0,a.Wm)(h,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Сохранение карты при оплате заказа")])),_:1})])),_:1}),(0,a.Wm)(h,{lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{src:r.cardOutline,slot:"start"},null,8,["src"]),(0,a.Wm)(_,{modelValue:c.enable_auto_cof,"onUpdate:modelValue":e[0]||(e[0]=t=>c.enable_auto_cof=t),onIonChange:e[1]||(e[1]=t=>u.saveAutoCof())},{default:(0,a.w5)((()=>[(0,a.Uk)(" Автоматически сохранять ")])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(m,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Сохраненные карты")])),_:1})])),_:1})])),_:1}),null==c.cardList?((0,a.wg)(),(0,a.j4)(f,{key:0},{default:(0,a.w5)((()=>[((0,a.wg)(),(0,a.iD)(a.HY,null,(0,a.Ko)([1,2],(t=>(0,a.Wm)(h,{key:t},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{style:{"background-color":"var(--ion-color-light)"},slot:"start"}),(0,a.Wm)(w,{animated:"",style:{width:"100%"}}),(0,a.Wm)(p,{style:{"background-color":"var(--ion-color-light)"},slot:"end"})])),_:2},1024))),64))])),_:1})):(null===(t=c.cardList)||void 0===t?void 0:t.length)>0?((0,a.wg)(),(0,a.j4)(f,{key:1},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(c.cardList,((t,e)=>((0,a.wg)(),(0,a.j4)(h,{key:t.order_id,button:"","detail-icon":"",onClick:n=>0!=e&&u.itemMainSet(t.card_id)},{default:(0,a.w5)((()=>[t.card_type?((0,a.wg)(),(0,a.j4)(g,{key:0,class:"card_type",src:`/img/icons/card-${t.card_type}.svg`,slot:"start"},null,8,["src"])):((0,a.wg)(),(0,a.j4)(p,{key:1,src:r.cardOutline,slot:"start",color:"primary"},null,8,["src"])),0==e?((0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("h6",s,(0,l.zw)(t.label),1),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Основной способ")])),_:1})])):((0,a.wg)(),(0,a.j4)(d,{key:3,color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,l.zw)(t.label),1)])),_:2},1024)),(0,a.Wm)(p,{icon:r.trashOutline,slot:"end",onClick:(0,o.iM)((e=>u.itemDelete(t.card_id)),["stop"])},null,8,["icon","onClick"])])),_:2},1032,["onClick"])))),128))])),_:1})):((0,a.wg)(),(0,a.j4)(f,{key:2,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(d,{color:"medium"},{default:(0,a.w5)((()=>[(0,a.Uk)("Сохраненных карт нет")])),_:1})])),_:1})])),_:1})),(0,a.Wm)(h,{lines:"none",button:"","detail-icon":""},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{color:"primary",onClick:e[2]||(e[2]=t=>u.cardRegistrationOpen())},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{icon:r.addOutline},null,8,["icon"]),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Uk)("Добавить карту")])),_:1})])),_:1}),(0,a.Wm)(k,{color:"medium",onClick:e[3]||(e[3]=t=>u.cardRegistrationCheck())},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{icon:r.refreshOutline},null,8,["icon"]),(0,a.Wm)(d,null,{default:(0,a.w5)((()=>[(0,a.Uk)("обновить")])),_:1})])),_:1})])),_:1})]})),_:1})}var c=n(4929),u=n(8903),d=n(9914),m=n(9042),h=n(9755),p=n.n(h),_={components:{IonList:c.q_,IonItem:c.Ie,IonSkeletonText:c.CK,IonLabel:c.Q$,IonIcon:c.gu,IonImg:c.Xz,IonToggle:c.ho,IonChip:c.hM,IonItemDivider:c.rH},setup(){return{cardOutline:u.pvm,addOutline:u.s6O,trashOutline:u.gtu,refreshOutline:u.D3P,saveOutline:u.Z8j}},data(){return{cardList:null,isOpen:!1,enable_auto_cof:1==localStorage.disable_auto_cof?0:1}},methods:{async listGet(){try{let t=await p().post(this.$heap.state.hostname+"UserCards/listGet");if(t&&t.length>0)for(let e in t)t[e].label=`${t[e].card_type.toUpperCase()} - ${t[e].card_mask.split("*").pop()}`;this.cardList=t}catch{}},async itemMainSet(t){const e={card_id:t};try{await p().post(`${this.$heap.state.hostname}UserCards/itemMainSet`,e),this.$topic.publish("userMainPaymentMethodSet"),this.listGet()}catch{}},async itemDelete(t){if(!confirm("Вы уверенны?"))return;const e={card_id:t};try{await p().post(`${this.$heap.state.hostname}UserCards/itemDelete`,e),this.listGet()}catch{this.$flash("Не удалось открепить карту")}},saveAutoCof(){localStorage.disable_auto_cof=this.enable_auto_cof?0:1},async cardRegistrationOpen(){const t=document.querySelector("ion-router-outlet"),e="card_registering",n=this,a=await c.Fy.create({component:d.Z,componentProps:{order_data:e},presentingElement:t}),l=function(){a.dismiss()};return m.Z.on("dismissModal",l),a.onDidDismiss().then((()=>{n.cardRegistrationCheck()})),a.present()},async cardRegistrationCheck(){try{const t=await p().post(this.$heap.state.hostname+"CardAcquirer/cardRegisteredSync");"ok"==t&&(this.listGet(),this.$topic.publish("userMainPaymentMethodSet"))}catch(t){}}},mounted(){this.listGet()}},f=n(3744);const w=(0,f.Z)(_,[["render",r],["__scopeId","data-v-689e904d"]]);var g=w}}]);
//# sourceMappingURL=5593.11cf6bc7.js.map