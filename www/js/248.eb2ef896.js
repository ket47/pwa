"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[248],{1248:function(e,t,i){i.r(t),i.d(t,{default:function(){return v}});var a=i(6252),o=i(3577);const r={key:0},s=(0,a.Uk)("Пока вы не курьер"),l=(0,a.Uk)("Подайте заявку, чтобы стать курьером"),u=(0,a.Uk)("Стать курьером"),n={key:1},d=(0,a.Uk)(" Анкета активна "),c=(0,a.Uk)("Загрузить фото"),m=(0,a.Uk)("Транспорт"),_=(0,a.Uk)("ИНН"),p=(0,a.Uk)("Коментарий"),h=(0,a.Uk)("Восстановить"),w=(0,a.Uk)("Удалить анкету"),f=(0,a.Uk)("Заблокировать анкету"),g=(0,a.Uk)("Утвердить анкету");function k(e,t,i,k,b,y){const C=(0,a.up)("ion-label"),W=(0,a.up)("ion-item"),U=(0,a.up)("ion-note"),I=(0,a.up)("ion-button"),D=(0,a.up)("ion-card"),Z=(0,a.up)("ion-card-content"),v=(0,a.up)("ion-img"),j=(0,a.up)("ion-thumbnail"),N=(0,a.up)("ion-input"),V=(0,a.up)("ion-textarea"),x=(0,a.up)("ion-list"),T=(0,a.up)("base-layout");return(0,a.wg)(),(0,a.j4)(T,{"page-title":"Анкета курьера","page-default-back-link":"/user-dashboard"},{default:(0,a.w5)((()=>[!1===b.courier?((0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(D,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Wm)(C,null,{default:(0,a.w5)((()=>[s])),_:1})])),_:1}),(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[l])),_:1})])),_:1}),(0,a.Wm)(I,{expand:"full",onClick:t[0]||(t[0]=e=>y.itemCreate())},{default:(0,a.w5)((()=>[u])),_:1})])),_:1})])):(0,a.kq)("",!0),b.courier?((0,a.wg)(),(0,a.iD)("div",n,[y.message?((0,a.wg)(),(0,a.j4)(D,{key:0,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{class:(0,o.C_)(y.messageClass)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(y.message),1)])),_:1},8,["class"])])),_:1})):((0,a.wg)(),(0,a.j4)(D,{key:1,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,{style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,a.w5)((()=>[d])),_:1})])),_:1})),(0,a._)("form",{onChange:t[10]||(t[10]=e=>y.updateCourier())},[(0,a.Wm)(x,null,{default:(0,a.w5)((()=>[(0,a.Wm)(W,{lines:"full"},{default:(0,a.w5)((()=>[b.courier?.images[0]?((0,a.wg)(),(0,a.j4)(j,{key:0,slot:"start"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{style:{"border-radius":"10px"},class:(0,o.C_)(y.imageClass),src:e.$heap.state.hostname+"image/get.php/"+b.courier.images[0].image_hash+".100.100.webp"},null,8,["class","src"])])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(I,{slot:"end",onClick:t[1]||(t[1]=e=>y.uploadImageTrigger())},{default:(0,a.w5)((()=>[c])),_:1}),(0,a._)("input",{type:"file",id:"courier_foto_upload",accept:"image/*",onChange:t[2]||(t[2]=e=>y.uploadImage(e)),style:{display:"none"}},null,32)])),_:1}),(0,a.Wm)(W,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{position:"stacked",color:"primary"},{default:(0,a.w5)((()=>[m])),_:1}),(0,a.Wm)(N,{modelValue:b.courier.courier_vehicle,"onUpdate:modelValue":t[3]||(t[3]=e=>b.courier.courier_vehicle=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(W,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{position:"stacked",color:"primary"},{default:(0,a.w5)((()=>[_])),_:1}),(0,a.Wm)(N,{modelValue:b.courier.courier_tax_num,"onUpdate:modelValue":t[4]||(t[4]=e=>b.courier.courier_tax_num=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(W,{lines:"full"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{position:"stacked",color:"primary"},{default:(0,a.w5)((()=>[p])),_:1}),(0,a.Wm)(V,{modelValue:b.courier.courier_comment,"onUpdate:modelValue":t[5]||(t[5]=e=>b.courier.courier_comment=e)},null,8,["modelValue"])])),_:1}),b.courier.deleted_at?((0,a.wg)(),(0,a.j4)(W,{key:0,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{slot:"end",onClick:t[6]||(t[6]=e=>y.itemUnDelete()),color:"success"},{default:(0,a.w5)((()=>[h])),_:1})])),_:1})):((0,a.wg)(),(0,a.j4)(W,{key:1,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{slot:"end",color:"danger",onClick:t[7]||(t[7]=e=>y.itemDelete())},{default:(0,a.w5)((()=>[w])),_:1})])),_:1})),y.showDisable?((0,a.wg)(),(0,a.j4)(W,{key:2,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{slot:"end",onClick:t[8]||(t[8]=e=>y.itemDisable()),color:"dark"},{default:(0,a.w5)((()=>[f])),_:1})])),_:1})):(0,a.kq)("",!0),y.showEnable?((0,a.wg)(),(0,a.j4)(W,{key:3,lines:"none"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{slot:"end",onClick:t[9]||(t[9]=e=>y.itemEnable()),color:"success"},{default:(0,a.w5)((()=>[g])),_:1})])),_:1})):(0,a.kq)("",!0)])),_:1})],32)])):(0,a.kq)("",!0)])),_:1})}var b=i(9755),y=i.n(b),C=i(2008),W=i(351),U=i(8973),I={components:{IonTextarea:U.g2,IonInput:U.pK,IonCard:U.PM,IonCardContent:U.FN,IonLabel:U.Q$,IonItem:U.Ie,IonNote:U.uN,IonButton:U.YG,IonImg:U.Xz,IonThumbnail:U.Bs,IonList:U.q_},data(){return{courier:W.Z.courier.data,isAdmin:W.Z.isAdmin()}},mounted(){},computed:{message(){return this.courier.deleted_at?"Анкета не активна и будет удалена. Вы можете еще отменить удаление":1==this.courier.is_disabled?"Анкета не активна и находится на рассмотрении у администратора":null},messageClass(){return this.courier.deleted_at?"deleted":1==this.courier.is_disabled?"disabled":null},imageClass(){return 1==this.courier?.images[0]?.is_disabled?"image_disabled":""},showDisable(){return!(0!=this.courier.is_disabled||!W.Z.isAdmin())},showEnable(){return!(1!=this.courier.is_disabled||!W.Z.isAdmin())},showDelete(){return!this.courier.deleted_at},showUnDelete(){return-1!=this.courier.deleted_at&&!this.courier.deleted_at}},methods:{async load(){try{this.courier=await W.Z.courier.get()}catch(e){JSON.parse(e.responseJSON?.status)}},async itemCreate(){try{await y().post(C.Z.state.hostname+"Courier/itemCreate"),await W.Z.get(),this.courier=W.Z.courier.data}catch{this.$flash("Не удалось зарегистрироваться как курьер")}},async itemDelete(){try{await y().post(C.Z.state.hostname+"Courier/itemDelete",{courier_id:this.courier.courier_id}),this.load()}catch(e){const t=e.responseJSON?.messages?.error;"invalid_status"==t&&this.$flash("Надо сначала закрыть смену")}},itemUnDelete(){const e=this;y().post(C.Z.state.hostname+"Courier/itemUnDelete",{courier_id:this.courier.courier_id}).done((()=>{e.load()}))},itemDisable(){const e=this;y().post(C.Z.state.hostname+"Courier/itemDisable",{courier_id:this.courier.courier_id,is_disabled:1}).done((()=>{e.load()}))},itemEnable(){const e=this;y().post(C.Z.state.hostname+"Courier/itemDisable",{courier_id:this.courier.courier_id,is_disabled:0}).done((()=>{e.load()}))},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.courier.courier_id);const i={url:C.Z.state.hostname+"Courier/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await y().ajax(i),this.load()}catch(a){this.$flash("Не удалось загрузить фото")}},uploadImageTrigger(){y()("#courier_foto_upload").trigger("click")},async updateCourier(){try{return await y().post(C.Z.state.hostname+"Courier/itemUpdate",JSON.stringify(this.courier))}catch(e){const t=JSON.parse(e.responseJSON?.messages?.error);t.courier_tax_num&&this.$flash("Неверный формат ИНН")}}}},D=i(3744);const Z=(0,D.Z)(I,[["render",k],["__scopeId","data-v-1e53b10b"]]);var v=Z}}]);
//# sourceMappingURL=248.eb2ef896.js.map