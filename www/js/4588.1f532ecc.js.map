{"version":3,"file":"js/4588.1f532ecc.js","mappings":"8mBACIA,EAAAA,EAAAA,IA+CcC,EAAA,CA/CDC,oBAAoB,QAAQ,aAAW,2B,kBACjB,IAgF8c,CAhF7dC,EAAAC,c,WAAhBJ,EAAAA,EAAAA,IAuCWK,EAAA,CAAAC,IAAA,I,iBAtCP,IAEW,EAFXC,EAAAA,EAAAA,IAEWC,EAAA,M,iBADP,IAA8H,EAA9HD,EAAAA,EAAAA,IAA8HE,EAAA,C,WAA1GN,EAAAC,YAAYM,W,qCAAZP,EAAAC,YAAYM,WAAUC,GAAEC,MAAM,OAAOC,eAAe,WAAWC,YAAY,OAAOC,KAAK,Q,gCAE/GR,EAAAA,EAAAA,IAIWC,EAAA,M,iBAHP,IAEa,EAFbD,EAAAA,EAAAA,IAEaS,EAAA,CAFDC,UAAU,UAAUH,YAAY,wB,WAAiCX,EAAAC,YAAYc,W,qCAAZf,EAAAC,YAAYc,WAAUP,GAAEC,MAAM,eAAeC,eAAe,WAAWM,SAAA,GAAUC,YAASC,EAAA,KAAAA,EAAA,GAAAV,GAAEW,EAAAC,eAAe,K,kBACjK,IAA2B,G,aAA9CC,EAAAA,EAAAA,IAAyIC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAAtGvB,EAAAwB,WAATC,K,WAA1B5B,EAAAA,EAAAA,IAAyI6B,EAAA,CAAzFvB,IAAKsB,EAAMV,WAAaY,MAAOF,EAAMV,Y,kBAAY,IAAoB,E,iBAAlBU,EAAMG,YAAU,K,+DAG3HxB,EAAAA,EAAAA,IAKWC,EAAA,CALDwB,MAAM,QAAM,C,iBAClB,IAA8E,EAA9EzB,EAAAA,EAAAA,IAA8E0B,EAAA,CAAnEC,SAAS,UAAUC,MAAM,U,kBAAS,IAAqBd,EAAA,KAAAA,EAAA,K,QAArB,4B,cAC7Cd,EAAAA,EAAAA,IAEW6B,EAAA,M,iBADG,IAAiC,G,aAA3CZ,EAAAA,EAAAA,IAAkMC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAA/JvB,EAAAkC,QAAO,CAAxBC,EAASC,M,WAA3BvC,EAAAA,EAAAA,IAAkMwC,EAAA,CAArJlC,IAAKiC,EAAKJ,MAAM,W,kBAAU,IAAC,E,QAAD,KAACM,EAAAA,EAAAA,IAAEH,GAAU,IAAC,IAA2B,GAAXC,EAAIG,QAAQ,S,WAA5B1C,EAAAA,EAAAA,IAAkG2C,EAAA,C,MAAzDC,IAAKC,EAAAC,YAAcC,QAAKpC,GAAEW,EAAA0B,cAAcT,I,iFAG9KhC,EAAAA,EAAAA,IAMWC,EAAA,M,iBALP,IAIW,EAJXD,EAAAA,EAAAA,IAIW6B,EAAA,M,iBAHG,IAAoC,G,aAA9CZ,EAAAA,EAAAA,IAEWC,EAAAA,GAAA,MAAAC,EAAAA,EAAAA,IAFmBJ,EAAA2B,gBAAbC,K,WAAjBlD,EAAAA,EAAAA,IAEWwC,EAAA,CAFqClC,IAAK4C,EAAYH,QAAKpC,GAAEW,EAAA6B,YAAYD,GAAYf,MAAM,U,kBAClG,IAA6B,EAA7B5B,EAAAA,EAAAA,IAA6BoC,EAAA,CAAlBC,IAAKC,EAAAO,YAAU,iBAAG7C,EAAAA,EAAAA,IAA8D0B,EAAA,M,iBAAnD,IAAU,E,QAAV,cAAUQ,EAAAA,EAAAA,IAAEtC,EAAAkD,eAAeH,IAAS,K,6DAIxF3C,EAAAA,EAAAA,IAEWC,EAAA,M,iBADP,IAA8M,EAA9MD,EAAAA,EAAAA,IAA8ME,EAAA,CAAlM6C,QAAKjC,EAAA,KAAAA,EAAA,IAAAkC,EAAAA,EAAAA,IAAA5C,GAAQW,EAAAkC,WAAQ,Y,WAAarD,EAAAC,YAAYqD,a,qCAAZtD,EAAAC,YAAYqD,aAAY9C,GAAEC,MAAM,QAAQC,eAAe,WAAWC,YAAY,QAAQ4C,UAAU,UAAUC,aAAa,qBAAqBC,IAAI,K,gCAElMrD,EAAAA,EAAAA,IAEWC,EAAA,M,iBADP,IAAmH,EAAnHD,EAAAA,EAAAA,IAAmHsD,EAAA,C,WAA5F1D,EAAAC,YAAY0D,kB,qCAAZ3D,EAAAC,YAAY0D,kBAAiBnD,GAAEC,MAAM,cAAcC,eAAe,Y,gCAE7FN,EAAAA,EAAAA,IAEWC,EAAA,CAFDwB,MAAM,QAAM,C,iBAClB,IAAoE,EAApEzB,EAAAA,EAAAA,IAAoEwD,EAAA,C,WAA/C5D,EAAAC,YAAY4D,Y,qCAAZ7D,EAAAC,YAAY4D,YAAWrD,I,kBAAE,IAASU,EAAA,MAAAA,EAAA,M,QAAT,gB,uCAErBlB,EAAAC,YAAY6D,a,WAAzCjE,EAAAA,EAAAA,IAGWQ,EAAA,C,MAHDwB,MAAM,Q,kBACZ,IAAsF,EAAtFzB,EAAAA,EAAAA,IAAsF0B,EAAA,CAA3EE,MAAM,UAAQ,C,iBAAC,IAAQ,C,uBAAR,cAAQ+B,EAAAA,EAAAA,IAAwC,UAAAzB,EAAAA,EAAAA,IAAnCtC,EAAAC,YAAY+D,mBAAiB,K,eACpE5D,EAAAA,EAAAA,IAA8D6B,EAAA,CAApDD,MAAM,UAAQ,C,iBAAC,IAA0B,E,iBAAxBhC,EAAAC,YAAY6D,YAAU,K,+BAExB9D,EAAAC,YAAYgE,a,WAAzCpE,EAAAA,EAAAA,IAGWQ,EAAA,C,MAHDwB,MAAM,Q,kBACZ,IAAuF,EAAvFzB,EAAAA,EAAAA,IAAuF0B,EAAA,CAA5EE,MAAM,UAAQ,C,iBAAC,IAAS,C,uBAAT,eAAS+B,EAAAA,EAAAA,IAAwC,UAAAzB,EAAAA,EAAAA,IAAnCtC,EAAAC,YAAYiE,mBAAiB,K,eACrE9D,EAAAA,EAAAA,IAA8D6B,EAAA,CAApDD,MAAM,UAAQ,C,iBAAC,IAA0B,E,iBAAxBhC,EAAAC,YAAYgE,YAAU,K,wDAGzCjE,EAAAC,c,WAAhBJ,EAAAA,EAAAA,IAKWsE,EAAA,CAAAhE,IAAA,I,iBAJP,IAGU,EAHVC,EAAAA,EAAAA,IAGUgE,EAAA,M,iBAFN,IAAoH,EAApHhE,EAAAA,EAAAA,IAAoHiE,EAAA,M,iBAA3G,IAAiG,EAAjGjE,EAAAA,EAAAA,IAAiGkE,EAAA,CAArFtC,MAAM,SAAUY,QAAK1B,EAAA,KAAAA,EAAA,GAAAV,GAAEW,EAAAoD,cAAcC,OAAO,QAAQC,KAAK,S,kBAAQ,IAAOvD,EAAA,MAAAA,EAAA,M,QAAP,c,uBACtFd,EAAAA,EAAAA,IAAwGiE,EAAA,M,iBAA/F,IAAqF,EAArFjE,EAAAA,EAAAA,IAAqFkE,EAAA,CAAzEtC,MAAM,UAAWY,QAAK1B,EAAA,KAAAA,EAAA,GAAAV,GAAEW,EAAAkC,YAAYmB,OAAO,S,kBAAQ,IAAStD,EAAA,MAAAA,EAAA,M,QAAT,gB,+JAmCxF,MAAMM,EAAW,CACb,CACI,WAAa,eACb,OAAS,CAAC,QAAQ,QAAQ,WAC1B,WAAa,yBACb,kBAAoB,0CAExB,CACI,WAAa,eACb,OAAS,GACT,WAAa,iCACb,kBAAoB,6BAExB,CACI,WAAa,iBACb,OAAS,CAAC,SACV,WAAa,mBACb,kBAAoB,6CAExB,CACI,WAAa,kBACb,OAAS,CAAC,QAAQ,SAClB,WAAa,iBACb,kBAAoB,oFAExB,CACI,WAAa,iBACb,OAAS,CAAC,QAAQ,SAClB,WAAa,2BACb,kBAAoB,kEAExB,CACI,WAAa,kBACb,OAAS,CAAC,SACV,WAAa,4BACb,kBAAoB,yBAExB,CACI,WAAa,mBACb,OAAS,CAAC,QAAQ,SAClB,WAAa,0BACb,kBAAoB,iEAExB,CACI,WAAa,mBACb,OAAS,CAAC,SACV,WAAa,6BACb,kBAAoB,iCAExB,CACI,WAAa,gBACb,OAAS,CAAC,WACV,WAAa,iBACb,kBAAoB,2CAExB,CACI,WAAa,kBACb,OAAS,CAAC,QAAQ,WAClB,WAAa,2BACb,kBAAoB,4CAExB,CACI,WAAa,kBACb,OAAS,CAAC,QAAQ,WAClB,WAAa,eACb,kBAAoB,gDAI5B,OACIkD,WAAY,CACRC,SAAQ,KACRC,QAAO,KACPC,QAAO,KACPC,QAAO,KACPC,UAAS,KACTC,SAAQ,KACRC,UAAS,KACTC,gBAAe,KACfC,YAAW,KACXC,UAAS,KACTC,QAAO,KACPC,OAAM,KACNC,OAAM,KACNC,QAAO,KACPC,QAAOA,EAAAA,IAEXC,KAAAA,GACI,MAAO,CACHC,aAAY,MACZC,cAAa,MACb3C,WAAU,MACVN,YAAWA,EAAAA,IAEnB,EACAkD,IAAAA,GACI,MAAM,CACFC,cAAeC,KAAKC,OAAOC,OAAOC,GAClCjG,YAAY,KACZuB,aACAU,QAAQ,CAAC,EACTgB,eAAe,CACXiD,MAAM,QACNC,MAAM,WACNC,QAAQ,SACRC,IAAI,QAERC,eAAe,CACXC,MAAM,MACNC,OAAO,OAGnB,EACAC,SAAS,CACLC,WAAAA,GAAa,IAAAC,EACT,OAA4B,QAArBA,EAAAb,KAAKc,wBAAgB,IAAAD,OAAA,EAArBA,EAAuBE,SAAQ,EAC1C,EACAhE,eAAAA,GAAiB,IAAAiE,EACb,OAAuB,QAAhBA,EAAAhB,KAAKY,mBAAW,IAAAI,OAAA,EAAhBA,EAAkBC,OAAOF,IAASG,OAAOC,KAAKnB,KAAK7D,SAASiF,KAAK,KAAKC,SAASN,MAAU,EACpG,EACAD,gBAAAA,GACI,OAAOd,KAAKvE,WAAW6F,KAAKC,GAAcA,EAAWvG,YAAYgF,KAAK9F,YAAYc,aAAa,EACnG,GAEJwG,OAAAA,GACI,MAAMC,EAAKzB,KACXA,KAAK0B,OAAOC,GAAG,UAAU,KACrBF,EAAKG,SAELC,EAAAA,EAAKC,WACL9B,KAAK4B,MAEb,EACAG,QAAQ,CACJH,IAAAA,GACSC,EAAAA,EAAKC,WACN9B,KAAKgC,QAAQC,QAAQ,KAEzBjC,KAAKkC,SACT,EACA,aAAMA,GACF,GAAuB,GAApBlC,KAAKD,cAIJ,YAHAC,KAAK9F,YAAY,CACbM,WAAW2H,EAAAA,EAAMC,KAAKC,MAAMF,EAAAA,EAAMC,KAAKE,WAI/C,IAAIC,EAAQ,CACRC,SAASxC,KAAKD,eAElB,IAAG,IAAA0C,EAEqBC,EAApB,GADA1C,KAAK9F,kBAAkBiI,EAAAA,EAAMQ,QAAQ,GAAG3C,KAAK4C,MAAMC,MAAMC,8BAA8BP,GACpFvC,KAAK9F,YACJ8F,KAAK9F,YAAYM,WAAsC,QAA5BkI,EAAC1C,KAAK9F,YAAYM,kBAAU,IAAAkI,OAAA,EAA3BA,EAA6BK,UAAU,EAAE,IACrE/C,KAAK9F,YAAY4D,YAAyC,EAA7BkC,KAAK9F,YAAY4D,YAC9CkC,KAAKgD,YAAYhD,KAAK9F,YAAY+I,MAGtCjD,KAAK9F,kBAAkBiI,EAAAA,EAAMe,KAAK,GAAGlD,KAAK4C,MAAMC,MAAMC,8BAA8BP,GACpFvC,KAAK9F,YAAYM,WAAsC,QAA5BiI,EAACzC,KAAK9F,YAAYM,kBAAU,IAAAiI,OAAA,EAA3BA,EAA6BM,UAAU,EAAE,IACrE/C,KAAK9F,YAAY4D,YAAyC,EAA7BkC,KAAK9F,YAAY4D,YAC9CkC,KAAKgD,YAAYhD,KAAK9F,YAAY+I,KACtC,CACA,MAAME,GAAI,IAAAC,EAAAC,EACN,MAAMC,EAAkB,OAAHH,QAAG,IAAHA,GAAiB,QAAdC,EAAHD,EAAKI,oBAAY,IAAAH,GAAU,QAAVC,EAAjBD,EAAmBI,gBAAQ,IAAAH,OAAxB,EAAHA,EAA6BI,MAClD,OAAOH,GACH,IAAK,YACDtD,KAAK0D,OAAO,sBACZ,MACJ,IAAK,WACD1D,KAAK0D,OAAO,uBACZ,MAER,OAAO,CACX,CACJ,EACAC,QAAAA,GACI,OAAI3D,KAAKjD,gBAAgB6G,OAAO,GAC5B5D,KAAK0D,OAAO,yCACL,GAEL1D,KAAK9F,YAAYc,WAIjBgF,KAAK9F,YAAYM,aAIjBwF,KAAK9F,YAAYqD,eACnByC,KAAK0D,OAAO,mCACL,IALP1D,KAAK0D,OAAO,oBACL,IALP1D,KAAK0D,OAAO,2BACL,EAWf,EACA,cAAMpG,GACF,IAAI0C,KAAK2D,WACL,OAEJ,MAAMV,EAAK/B,OAAOC,KAAKnB,KAAK7D,SAAS,CAAC,GAAGiF,KAAK,KACxCmB,EAAQ,CACVU,OACAT,SAASxC,KAAK9F,YAAYsI,SAC1BhI,WAAWwF,KAAK9F,YAAYM,WAC5B+C,aAAayC,KAAK9F,YAAYqD,aAC9BvC,WAAWgF,KAAK9F,YAAYc,WAC5B4C,kBAAkBoC,KAAK9F,YAAY0D,kBACnCE,YAAYkC,KAAK9F,YAAY4D,YAAY,EAAE,GAE/C,IACI,MAAM+F,EAAetB,EAAQC,SAAS,aAAa,mBAC7CsB,IAAAA,KAAY,GAAG9D,KAAK4C,MAAMC,MAAMC,uBAAuBe,IAAiBtB,GAC9EvC,KAAK0D,OAAO,gBACZ1D,KAAKgC,QAAQ+B,IAAI,EACrB,CACA,MAAMZ,GAAI,IAAAa,EAAAC,EACN,MAAMX,EAAkB,OAAHH,QAAG,IAAHA,GAAiB,QAAda,EAAHb,EAAKI,oBAAY,IAAAS,GAAU,QAAVC,EAAjBD,EAAmBR,gBAAQ,IAAAS,OAAxB,EAAHA,EAA6BR,MAClD,OAAOH,GACH,IAAK,YACDtD,KAAK0D,OAAO,sBACZ,MAGR,OADA1D,KAAK0D,OAAO,kCACL,CACX,CACJ,EACA,oBAAMrI,GACG2E,KAAKc,iBAIVd,KAAKkE,kBAHDlE,KAAK0D,OAAO,wBAIpB,EACAS,qBAAAA,GACI,IAAInE,KAAKc,iBAAiBlD,kBACtB,OAEJ,MAAMwG,EAASpE,KAAKc,iBAAiBlD,kBACrC,IAAIyG,EAAQrE,KAAK9F,YACjB,IAAI,IAAImC,KAAO2D,KAAK7D,QAAQ,CACR6D,KAAK7D,QAAQE,GAA7B,MACMiI,EAAUjI,EAAIkI,MAAM,KACpBC,EAASF,EAAU,GACzBD,EAAQ,GAAGG,QAAeF,EAAU,EACxC,CACAtE,KAAK9F,YAAY0D,kBAAkBuE,EAAAA,EAAMsC,OAAOL,EAASC,EAC7D,EACA,gBAAM7F,GACF,GAAIkG,QAAQ,eAGZ,UACUZ,IAAAA,KAAY,GAAG9D,KAAK4C,MAAMC,MAAMC,iCAAiC,CAACN,SAASxC,KAAKD,gBACtFC,KAAKgC,QAAQ+B,IAAI,EACrB,CAAC,MAAY,CACjB,EACA,iBAAM9G,CAAa0H,GACf,MAAMC,QAAcC,EAAAA,GAAgBC,OAAO,CACvCC,UAAWC,EAAAA,EACXC,eAAe,CAACN,YAChBO,kBAAmB,IACnBC,YAAa,CAAC,IAAM,GACpBC,aAAY,IAEhBR,EAAMS,UACNrF,KAAK0B,OAAOC,GAAG,eAAe,KAC1BiD,EAAMU,YAEV,MAAMC,QAAWX,EAAMY,eACvB,GAAID,EAAKzF,KAAT,CAGA,GAAGyF,EAAKzF,KAAK2F,SAAY,CACrBzF,KAAK0F,WAAW,CAAC,SAASH,EAAKzF,KAAK2F,WAAW,SAASF,EAAKzF,KAAK2F,aAClE,MAAMrF,QAAY0D,IAAAA,KAAY,GAAG9D,KAAK4C,MAAMC,MAAMC,wBAAwB,CAAC2C,SAASF,EAAKzF,KAAK2F,WAC9B,IAAAE,EAAhE,GAAI3F,KAAKY,YAAYS,SAAS,UAAYjB,EAAMwF,eAC5C5F,KAAK6F,kBAAkB,SACvBN,EAAKzF,KAAKgG,SAAS1F,EAAMwF,eACzBL,EAAKzF,KAAKiG,WAAgB,OAAL3F,QAAK,IAALA,GAAY,QAAPuF,EAALvF,EAAOC,aAAK,IAAAsF,OAAP,EAALA,EAAcI,WAEvC,GAAI/F,KAAKY,YAAYS,SAAS,YAAcjB,EAAM4F,iBAAkB,CAChE,MAAM1F,QAAcwD,IAAAA,KAAY,GAAG9D,KAAK4C,MAAMC,MAAMC,0BAA0B,CAACmD,WAAW7F,EAAM4F,mBAChGhG,KAAK6F,kBAAkB,WACvBN,EAAKzF,KAAKmG,WAAW3F,EAAQ2F,WAC7BV,EAAKzF,KAAKoG,aAAa5F,EAAQ4F,YACnC,CACJ,CACGX,EAAKzF,KAAKgG,UACT9F,KAAK0F,WAAW,CAAC,SAASH,EAAKzF,KAAKgG,WAAW,YAAYP,EAAKzF,KAAKiG,YAAY,QAElFR,EAAKzF,KAAKmG,YACTjG,KAAK0F,WAAW,CAAC,WAAWH,EAAKzF,KAAKmG,aAAa,UAAUV,EAAKzF,KAAKoG,cAAc,QAEtFX,EAAKzF,KAAKjF,MACTmF,KAAK0F,WAAW,CAAC,QAAQH,EAAKzF,KAAKjF,OAAO,QAAQ0K,EAAKzF,KAAKqG,MAAM,OAvBtE,CAyBJ,EACAT,UAAAA,CAAWrJ,GACP,IAAI+J,EAAKpG,KAAK7D,SAAS,CAAC,EACxBiK,EAAK/J,EAAI,IAAIA,EAAI,GACjB2D,KAAK7D,QAAQiK,EACbpG,KAAKmE,uBACT,EACArH,aAAAA,CAAcT,GACV,IAAI+J,EAAKpG,KAAK7D,SAAS,CAAC,EACxBiK,EAAK/J,WAAe+J,EAAK/J,GACzB,MAAMgK,EAAOnF,OAAOC,KAAKiF,GAAMxC,OAC/B5D,KAAK7D,QAAQkK,EAAKD,EAAK,CAAC,EACxBpG,KAAKmE,uBACT,EACA0B,iBAAAA,CAAkBrB,GAAS,IAAA8B,EACvB,IAAIF,EAAKpG,KAAK7D,SAAS,CAAC,EACxB,MAAME,EAAqB,QAAlBiK,EAACpF,OAAOC,KAAKiF,UAAK,IAAAE,OAAA,EAAjBA,EAAmBhF,KAAKjF,GAAKA,EAAIG,QAAQgI,IAAW,GAC9DxE,KAAKlD,cAAcT,EACvB,EACA6H,eAAAA,GACIlE,KAAK7D,QAAQ,CAAC,EACd6D,KAAKmE,uBACT,EACAnB,WAAAA,CAAYC,GACR,IAAImD,EAAK,CAAC,EACV,GAAGnD,EACC,IAAI,IAAI5G,KAAO4G,EACXmD,EAAK,GAAG/J,EAAImI,YAAYnI,EAAIkK,UAAUlK,EAAImK,YAAYnK,EAAIoK,cAAc,GAAGzG,KAAK7C,eAAed,EAAImI,aAAaxE,KAAKQ,eAAenE,EAAIoK,aAAa,MAAMpK,EAAIqK,WAAW,QAGlL1G,KAAK7D,QAAQiK,EACbpG,KAAKmE,uBACT,I,UCnZR,MAAMwC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASlC,KAEpE,O","sources":["webpack://tezkel/./src/views/admin/TransactionEdit.vue","webpack://tezkel/./src/views/admin/TransactionEdit.vue?5133"],"sourcesContent":["<template>\r\n    <base-layout pageDefaultBackLink=\"/user\" page-title=\"Редактирование проводки\">\r\n        <ion-list v-if=\"transaction\">\r\n            <ion-item>\r\n                <ion-input v-model=\"transaction.trans_date\" label=\"Дата\" labelPlacement=\"floating\" placeholder=\"дата\" type=\"date\"></ion-input>\r\n            </ion-item>\r\n            <ion-item>\r\n                <ion-select interface=\"popover\" placeholder=\"Выберите тип проводки\" v-model=\"transaction.trans_role\" label=\"Тип проводки\" labelPlacement=\"floating\" required @ionChange=\"itemUpdateRole(1)\">\r\n                    <ion-select-option v-for=\"trans in transTypes\" :key=\"trans.trans_role\" :value=\"trans.trans_role\">{{trans.trans_name}}</ion-select-option>\r\n                </ion-select>\r\n            </ion-item>\r\n            <ion-item lines=\"none\">\r\n                <ion-label position=\"stacked\" color=\"medium\">Родительские элементы</ion-label>\r\n                <ion-text>\r\n                    <ion-chip v-for=\"(tagLabel,tag) in tagDict\" :key=\"tag\" color=\"primary\">#{{tagLabel}} <ion-icon v-if=\"tag.indexOf('acc')==-1\" :src=\"closeCircle\" @click=\"tagDictRemove(tag)\"></ion-icon></ion-chip>\r\n                </ion-text>\r\n            </ion-item>\r\n            <ion-item>\r\n                <ion-text>\r\n                    <ion-chip v-for=\"tagHolder in tagMissingNames\" :key=\"tagHolder\" @click=\"tagDictPick(tagHolder)\" color=\"medium\">\r\n                        <ion-icon :src=\"addOutline\"/><ion-label>Добавить #{{tagHolderNames[tagHolder]}}</ion-label>\r\n                    </ion-chip>\r\n                </ion-text>\r\n            </ion-item>\r\n            <ion-item>\r\n                <ion-input @keyup.enter=\"itemSave()\" v-model=\"transaction.trans_amount\" label=\"Сумма\" labelPlacement=\"floating\" placeholder=\"сумма\" inputmode=\"decimal\" autocomplete=\"transaction-amount\" min=\"1\"></ion-input>\r\n            </ion-item>\r\n            <ion-item>\r\n                <ion-textarea v-model=\"transaction.trans_description\" label=\"Комментарий\" labelPlacement=\"floating\"></ion-textarea>\r\n            </ion-item>\r\n            <ion-item lines=\"full\">\r\n                <ion-toggle v-model=\"transaction.is_disabled\">Отключена</ion-toggle>\r\n            </ion-item>\r\n            <ion-item lines=\"none\" v-if=\"transaction.created_at\">\r\n                <ion-label color=\"medium\">Создано <b>{{transaction.created_user_name}}</b></ion-label>\r\n                <ion-text color=\"medium\">{{transaction.created_at}}</ion-text>\r\n            </ion-item>\r\n            <ion-item lines=\"none\" v-if=\"transaction.updated_at\">\r\n                <ion-label color=\"medium\">Изменено <b>{{transaction.updated_user_name}}</b></ion-label>\r\n                <ion-text color=\"medium\">{{transaction.updated_at}}</ion-text>\r\n            </ion-item>\r\n        </ion-list>\r\n        <ion-grid v-if=\"transaction\">\r\n            <ion-row>\r\n                <ion-col><ion-button color=\"danger\" @click=\"itemDelete()\" expand=\"block\" fill=\"clear\">Удалить</ion-button></ion-col>\r\n                <ion-col><ion-button color=\"primary\" @click=\"itemSave()\" expand=\"block\">Сохранить</ion-button></ion-col>\r\n            </ion-row>\r\n        </ion-grid>\r\n    </base-layout>\r\n</template>\r\n<script >\r\nimport {\r\n  IonInput,\r\n  IonIcon,\r\n  IonList,\r\n  IonItem,\r\n  IonToggle,\r\n  IonLabel,\r\n  IonSelect,\r\n  IonSelectOption,\r\n  IonTextarea,\r\n  IonButton,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n  IonChip,\r\n  IonText,\r\n  modalController,\r\n}                          from '@ionic/vue';\r\nimport {\r\n    trashOutline,\r\n    searchOutline,\r\n    addOutline,\r\n    closeCircle,\r\n}                          from 'ionicons/icons'\r\nimport jquery              from 'jquery'\r\nimport User                from '@/scripts/User.js'\r\nimport Utils               from '@/scripts/Utils.js'\r\nimport ItemPicker          from '@/components/ItemPicker.vue'\r\n\r\nconst transTypes=[\r\n    {\r\n        'trans_role':'profit->site',\r\n        'holder':['order','store','courier'],\r\n        'trans_name':'Сайт Доход от доставки',\r\n        'trans_description':'Доход от доставки. Заказ №{{order_id}}',\r\n    },\r\n    {\r\n        'trans_role':'site->profit',\r\n        'holder':[],\r\n        'trans_name':'Сайт Списание месячной прибыли',\r\n        'trans_description':'Списание месячной прибыли',\r\n    },\r\n    {\r\n        'trans_role':'site->supplier',\r\n        'holder':['store'],\r\n        'trans_name':'Продавец Выплата',\r\n        'trans_description':'Выплата по договору за выполненные заказы',\r\n    },\r\n    {\r\n        'trans_role':'site.->supplier',\r\n        'holder':['order','store'],\r\n        'trans_name':'Продавец Штраф',\r\n        'trans_description':'Средства взимаемые с Продавца для воврата оплаты Покупателю. Заказ №{{order_id}}',\r\n    },\r\n    {\r\n        'trans_role':'supplier->site',\r\n        'holder':['order','store'],\r\n        'trans_name':'Продавец Отгрузка заказа',\r\n        'trans_description':'Стоимость товара, отгруженного Покупателю. Заказ №{{order_id}}',\r\n    },\r\n    {\r\n        'trans_role':'supplier->site.',\r\n        'holder':['store'],\r\n        'trans_name':'Продавец Получение аванса',\r\n        'trans_description':'Аванс за услуги сайта',\r\n    },\r\n    {\r\n        'trans_role':'profit->supplier',\r\n        'holder':['order','store'],\r\n        'trans_name':'Продавец Комиссия сайта',\r\n        'trans_description':'Комиссия сайта за предоставленные услуги. Заказ №{{order_id}}',\r\n    },\r\n    {\r\n        'trans_role':'supplier->profit',\r\n        'holder':['store'],\r\n        'trans_name':'Продавец Начисление бонуса',\r\n        'trans_description':'Начисление бонуса на продавцу',\r\n    },\r\n    {\r\n        'trans_role':'site->courier',\r\n        'holder':['courier'],\r\n        'trans_name':'Курьер Выплата',\r\n        'trans_description':'Выплата по договору за оказанные услуги',\r\n    },\r\n    {\r\n        'trans_role':'courier->profit',\r\n        'holder':['order','courier'],\r\n        'trans_name':'Курьер Начисление бонуса',\r\n        'trans_description':'Начисление бонуса за Заказ №{{order_id}}',\r\n    },\r\n    {\r\n        'trans_role':'profit->courier',\r\n        'holder':['order','courier'],\r\n        'trans_name':'Курьер Штраф',\r\n        'trans_description':'Штраф за не выполнение Заказа №{{order_id}}',\r\n    },\r\n]\r\n\r\nexport default {\r\n    components: {\r\n        IonInput,\r\n        IonIcon,\r\n        IonList,\r\n        IonItem,\r\n        IonToggle,\r\n        IonLabel,\r\n        IonSelect,\r\n        IonSelectOption,\r\n        IonTextarea,\r\n        IonButton,\r\n        IonGrid,\r\n        IonRow,\r\n        IonCol,\r\n        IonChip,\r\n        IonText,\r\n    },\r\n    setup(){\r\n        return {\r\n            trashOutline,\r\n            searchOutline,\r\n            addOutline,\r\n            closeCircle,\r\n            }\r\n    },\r\n    data(){\r\n        return{\r\n            transactionId: this.$route.params.id,\r\n            transaction:null,\r\n            transTypes,\r\n            tagDict:{},\r\n            tagHolderNames:{\r\n                order:'заказ',\r\n                store:'продавец',\r\n                courier:'курьер',\r\n                acc:'счет',\r\n            },\r\n            tagOptionNames:{\r\n                debit:\"(+)\",\r\n                credit:\"(-)\",\r\n            },\r\n        }\r\n    },\r\n    computed:{\r\n        tagRequired(){\r\n            return this.transTypeCurrent?.holder||[]\r\n        },\r\n        tagMissingNames(){\r\n            return this.tagRequired?.filter(holder=>!Object.keys(this.tagDict).join(':').includes(holder))||''\r\n        },\r\n        transTypeCurrent(){\r\n            return this.transTypes.find(trans_type => trans_type.trans_role==this.transaction.trans_role)||[];\r\n        }\r\n    },\r\n    created(){\r\n        const self=this\r\n        this.$topic.on('userGet',()=>{\r\n            self.init()\r\n        })\r\n        if( User.isAdmin() ){\r\n            this.init()\r\n        }\r\n    },\r\n    methods:{\r\n        init(){\r\n            if( !User.isAdmin() ){\r\n                this.$router.replace('/')\r\n            }\r\n            this.itemGet();\r\n        },\r\n        async itemGet(){\r\n            if(this.transactionId==0){\r\n                this.transaction={\r\n                    trans_date:Utils.date.toIso(Utils.date.today())\r\n                }\r\n                return\r\n            }\r\n            let request={\r\n                trans_id:this.transactionId\r\n            };\r\n            try{\r\n                this.transaction=await Utils.prePost(`${this.$heap.state.hostname}Transaction/itemGet`,request)\r\n                if(this.transaction){\r\n                    this.transaction.trans_date=this.transaction.trans_date?.substring(0,10)\r\n                    this.transaction.is_disabled=this.transaction.is_disabled*1\r\n                    this.tagDictFill(this.transaction.tags)\r\n                }\r\n\r\n                this.transaction=await Utils.post(`${this.$heap.state.hostname}Transaction/itemGet`,request)\r\n                this.transaction.trans_date=this.transaction.trans_date?.substring(0,10)\r\n                this.transaction.is_disabled=this.transaction.is_disabled*1\r\n                this.tagDictFill(this.transaction.tags)\r\n            }\r\n            catch(err){\r\n                const exception_code=err?.responseJSON?.messages?.error;\r\n                switch(exception_code){\r\n                    case 'forbidden':\r\n                        this.$flash(\"Не достаточно прав\");\r\n                        break;\r\n                    case 'notfound':\r\n                        this.$flash(\"Проводка не найдена\");\r\n                        break;\r\n                }\r\n                return false\r\n            }\r\n        },\r\n        validate(){\r\n            if( this.tagMissingNames.length>0 ){\r\n                this.$flash(\"Не выбраны все родительские элементы\")\r\n                return false\r\n            }\r\n            if( !(this.transaction.trans_role) ){\r\n                this.$flash(\"Тип проводки не выбран\")\r\n                return false\r\n            }\r\n            if( !(this.transaction.trans_date) ){\r\n                this.$flash(\"Дата не выбрана\")\r\n                return false\r\n            }\r\n            if( !(this.transaction.trans_amount) ){\r\n                this.$flash(\"Сумма должна не равняться нулю\")\r\n                return false\r\n            }\r\n            return true\r\n        },\r\n        async itemSave(){\r\n            if(!this.validate()){\r\n                return;\r\n            }\r\n            const tags=Object.keys(this.tagDict??{}).join(' ')\r\n            const request={\r\n                tags,\r\n                trans_id:this.transaction.trans_id,\r\n                trans_date:this.transaction.trans_date,\r\n                trans_amount:this.transaction.trans_amount,\r\n                trans_role:this.transaction.trans_role,\r\n                trans_description:this.transaction.trans_description,\r\n                is_disabled:this.transaction.is_disabled?1:0,\r\n            }\r\n            try{\r\n                const remoteFunction=request.trans_id?'itemUpdate':'itemCreate'\r\n                await jquery.post(`${this.$heap.state.hostname}Transaction/${remoteFunction}`,request)\r\n                this.$flash(\"💾 сохранено\")\r\n                this.$router.go(-1);\r\n            }\r\n            catch(err){\r\n                const exception_code=err?.responseJSON?.messages?.error;\r\n                switch(exception_code){\r\n                    case 'forbidden':\r\n                        this.$flash(\"Не достаточно прав\");\r\n                        break;\r\n                }\r\n                this.$flash(\"Не удалось сохранить проводку\")\r\n                return false\r\n            }\r\n        },\r\n        async itemUpdateRole(){\r\n            if( !this.transTypeCurrent ){\r\n                this.$flash(\"Неверный тип проводки\")\r\n                return\r\n            }\r\n            this.tagDictTruncate()\r\n        },\r\n        itemDescriptionRender(){\r\n            if(!this.transTypeCurrent.trans_description){\r\n                return\r\n            }\r\n            const template=this.transTypeCurrent.trans_description\r\n            let context=this.transaction\r\n            for(let tag in this.tagDict){\r\n                const tag_label=this.tagDict[tag]\r\n                const tag_array=tag.split(':');\r\n                const tag_name=tag_array[0]\r\n                context[`${tag_name}_id`]=tag_array[1]//order_id,courier_id etc\r\n            }\r\n            this.transaction.trans_description=Utils.render(template,context)\r\n        },\r\n        async itemDelete(){\r\n            if(!confirm(\"Вы уверены?\")){\r\n                return\r\n            }\r\n            try{\r\n                await jquery.post(`${this.$heap.state.hostname}Transaction/itemDelete`,{trans_id:this.transactionId})\r\n                this.$router.go(-1);\r\n            }catch{/** */}\r\n        },\r\n        async tagDictPick( itemType ){\r\n            const modal = await modalController.create({\r\n                component: ItemPicker,\r\n                componentProps:{itemType},\r\n                initialBreakpoint: 0.75,\r\n                breakpoints: [0.75, 1],\r\n                canDissmiss:true,\r\n            });\r\n            modal.present()\r\n            this.$topic.on('dismissModal',()=>{\r\n                modal.dismiss()\r\n            });\r\n            const item=await modal.onDidDismiss();\r\n            if(!item.data){\r\n                return\r\n            }\r\n            if(item.data.order_id??0){\r\n                this.tagDictAdd([`order:${item.data.order_id}`,`заказ ${item.data.order_id}`])\r\n                const order=await jquery.post(`${this.$heap.state.hostname}Order/itemGet`,{order_id:item.data.order_id})\r\n                if( this.tagRequired.includes('store') && order.order_store_id ){\r\n                    this.tagDictNameRemove('store')\r\n                    item.data.store_id=order.order_store_id\r\n                    item.data.store_name=order?.store?.store_name\r\n                }\r\n                if( this.tagRequired.includes('courier') && order.order_courier_id ){\r\n                    const courier=await jquery.post(`${this.$heap.state.hostname}Courier/itemGet`,{courier_id:order.order_courier_id})\r\n                    this.tagDictNameRemove('courier')\r\n                    item.data.courier_id=courier.courier_id\r\n                    item.data.courier_name=courier.courier_name\r\n                }\r\n            }\r\n            if(item.data.store_id??0){\r\n                this.tagDictAdd([`store:${item.data.store_id}`,`продавец ${item.data.store_name??'?'}`])\r\n            }\r\n            if(item.data.courier_id??0){\r\n                this.tagDictAdd([`courier:${item.data.courier_id}`,`курьер ${item.data.courier_name??'?'}`])\r\n            }\r\n            if(item.data.type??0){\r\n                this.tagDictAdd([`acc::${item.data.type}`,`счет ${item.data.name??'?'}`])\r\n            }\r\n        },\r\n        tagDictAdd(tag){\r\n            let dict=this.tagDict??{}\r\n            dict[tag[0]]=tag[1]\r\n            this.tagDict=dict\r\n            this.itemDescriptionRender()\r\n        },\r\n        tagDictRemove(tag){\r\n            let dict=this.tagDict??{}\r\n            dict[tag] && delete dict[tag]\r\n            const size = Object.keys(dict).length\r\n            this.tagDict=size?dict:{}\r\n            this.itemDescriptionRender()\r\n        },\r\n        tagDictNameRemove(tag_name){\r\n            let dict=this.tagDict??{}\r\n            const tag=Object.keys(dict)?.find(tag=>tag.indexOf(tag_name)>-1)\r\n            this.tagDictRemove(tag)\r\n        },\r\n        tagDictTruncate(){\r\n            this.tagDict={}\r\n            this.itemDescriptionRender()\r\n        },\r\n        tagDictFill(tags){\r\n            let dict={}\r\n            if(tags){\r\n                for(let tag of tags){\r\n                    dict[`${tag.tag_name}:${tag.tag_id}:${tag.tag_type}:${tag.tag_option}`]=`${this.tagHolderNames[tag.tag_name]} ${this.tagOptionNames[tag.tag_option]??''} ${tag.tag_label??'(?)'}`\r\n                }\r\n            }\r\n            this.tagDict=dict\r\n            this.itemDescriptionRender()\r\n        }\r\n    },\r\n}\r\n</script>","import { render } from \"./TransactionEdit.vue?vue&type=template&id=7d615cd2\"\nimport script from \"./TransactionEdit.vue?vue&type=script&lang=js\"\nexport * from \"./TransactionEdit.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createBlock","_component_base_layout","pageDefaultBackLink","$data","transaction","_component_ion_list","key","_createVNode","_component_ion_item","_component_ion_input","trans_date","$event","label","labelPlacement","placeholder","type","_component_ion_select","interface","trans_role","required","onIonChange","_cache","$options","itemUpdateRole","_createElementBlock","_Fragment","_renderList","transTypes","trans","_component_ion_select_option","value","trans_name","lines","_component_ion_label","position","color","_component_ion_text","tagDict","tagLabel","tag","_component_ion_chip","_toDisplayString","indexOf","_component_ion_icon","src","$setup","closeCircle","onClick","tagDictRemove","tagMissingNames","tagHolder","tagDictPick","addOutline","tagHolderNames","onKeyup","_withKeys","itemSave","trans_amount","inputmode","autocomplete","min","_component_ion_textarea","trans_description","_component_ion_toggle","is_disabled","created_at","_createElementVNode","created_user_name","updated_at","updated_user_name","_component_ion_grid","_component_ion_row","_component_ion_col","_component_ion_button","itemDelete","expand","fill","components","IonInput","IonIcon","IonList","IonItem","IonToggle","IonLabel","IonSelect","IonSelectOption","IonTextarea","IonButton","IonGrid","IonRow","IonCol","IonChip","IonText","setup","trashOutline","searchOutline","data","transactionId","this","$route","params","id","order","store","courier","acc","tagOptionNames","debit","credit","computed","tagRequired","_this$transTypeCurren","transTypeCurrent","holder","_this$tagRequired","filter","Object","keys","join","includes","find","trans_type","created","self","$topic","on","init","User","isAdmin","methods","$router","replace","itemGet","Utils","date","toIso","today","request","trans_id","_this$transaction$tra2","_this$transaction$tra","prePost","$heap","state","hostname","substring","tagDictFill","tags","post","err","_err$responseJSON","_err$responseJSON$mes","exception_code","responseJSON","messages","error","$flash","validate","length","remoteFunction","jquery","go","_err$responseJSON2","_err$responseJSON2$me","tagDictTruncate","itemDescriptionRender","template","context","tag_array","split","tag_name","render","confirm","itemType","modal","modalController","create","component","ItemPicker","componentProps","initialBreakpoint","breakpoints","canDissmiss","present","dismiss","item","onDidDismiss","order_id","tagDictAdd","_order$store","order_store_id","tagDictNameRemove","store_id","store_name","order_courier_id","courier_id","courier_name","name","dict","size","_Object$keys","tag_id","tag_type","tag_option","tag_label","__exports__"],"sourceRoot":""}