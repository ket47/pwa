"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[5851],{5851:function(e,t,l){l.r(t),l.d(t,{default:function(){return V}});var i=l(641),a=l(33);const n={key:0},s={key:1},o={style:{"font-size":"14px"}},r={class:"max-two-lines"},u={style:{"max-height":"200px",overflow:"hidden","border-radius":"5px","margin-top":"5px"}},d=["src"],c=["src"],m={class:"ion-margin-vertical ion-text-center"},g={style:{"max-height":"200px",overflow:"hidden","margin-bottom":"10px"}},p=["src"],_={style:{"margin-top":"10px"},class:"max-two-lines"},h={class:"ion-padding"},k={key:0},f={key:0,class:"ion-text-center ion-margin-vertical"},b={key:0},v={key:1},y={key:1,class:"ion-text-center ion-margin-vertical"};function F(e,t,l,F,x,C){const I=(0,i.g2)("ion-loading"),w=(0,i.g2)("ion-icon"),W=(0,i.g2)("ion-toggle"),O=(0,i.g2)("ion-item"),$=(0,i.g2)("ion-input"),S=(0,i.g2)("ion-select-option"),L=(0,i.g2)("ion-select"),V=(0,i.g2)("ion-item-divider"),X=(0,i.g2)("ion-label"),A=(0,i.g2)("ion-button"),D=(0,i.g2)("ion-chip"),G=(0,i.g2)("ion-list"),j=(0,i.g2)("ion-textarea"),U=(0,i.g2)("image-tile-comp"),z=(0,i.g2)("ion-card-content"),Q=(0,i.g2)("ion-card"),E=(0,i.g2)("ion-col"),T=(0,i.g2)("ion-avatar"),M=(0,i.g2)("ion-note"),K=(0,i.g2)("ion-card-header"),N=(0,i.g2)("ion-row"),B=(0,i.g2)("ion-card-title"),P=(0,i.g2)("ion-skeleton-text"),J=(0,i.g2)("ion-grid"),R=(0,i.g2)("base-layout");return(0,i.uX)(),(0,i.Wv)(R,{pageDefaultBackLink:"/admin/mailing-list","page-title":"–°–æ–æ–±—â–µ–Ω–∏–µ"},{default:(0,i.k6)(()=>[(0,i.bF)(I,{message:"Dismissing after 3 seconds..."}),(0,i.bF)(G,null,{default:(0,i.k6)(()=>[(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.layersOutline},null,8,["src"]),(0,i.bF)(W,{onIonChange:t[0]||(t[0]=e=>{e.target.checked?x.mailing.regular_group="signin":x.mailing.regular_group="0",x.mailing.is_delayed=!1,C.itemSave()}),checked:"0"!=x.mailing.regular_group},{default:(0,i.k6)(()=>t[26]||(t[26]=[(0,i.eW)(" –†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ ")])),_:1,__:[26]},8,["checked"])]),_:1}),"0"==x.mailing.regular_group?((0,i.uX)(),(0,i.CE)("div",n,[(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.alarmOutline},null,8,["src"]),(0,i.bF)(W,{onIonChange:t[1]||(t[1]=e=>x.mailing.is_delayed=e.target.checked),checked:x.mailing.is_delayed},{default:(0,i.k6)(()=>t[27]||(t[27]=[(0,i.eW)("–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ—Ç–æ–º")])),_:1,__:[27]},8,["checked"])]),_:1}),x.mailing.is_delayed?((0,i.uX)(),(0,i.Wv)(O,{key:0},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.alarmOutline},null,8,["src"]),(0,i.bF)($,{modelValue:x.mailing.start_at,"onUpdate:modelValue":t[2]||(t[2]=e=>x.mailing.start_at=e),type:"datetime-local",min:(new Date).toISOString().slice(0,-8),label:"–ö–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å?",onIonChange:t[3]||(t[3]=e=>C.itemSave())},null,8,["modelValue","min"])]),_:1})):(0,i.Q3)("",!0)])):((0,i.uX)(),(0,i.CE)("div",s,[(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(L,{placeholder:"–ì—Ä—É–ø–ø–∞ —Ä–∞—Å—Å—ã–ª–æ–∫",label:"–ì—Ä—É–ø–ø–∞ —Ä–∞—Å—Å—ã–ª–æ–∫",modelValue:x.mailing.regular_group,"onUpdate:modelValue":t[4]||(t[4]=e=>x.mailing.regular_group=e),onIonChange:t[5]||(t[5]=e=>C.itemSave())},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(x.regularGroupTranslation,(e,t)=>((0,i.uX)(),(0,i.Wv)(S,{value:t,key:e},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(e),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.alarmOutline},null,8,["src"]),(0,i.bF)($,{modelValue:x.mailing.start_at,"onUpdate:modelValue":t[6]||(t[6]=e=>x.mailing.start_at=e),type:"time",label:"–í–æ —Å–∫–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å?",onIonChange:t[7]||(t[7]=e=>C.itemSave())},null,8,["modelValue"])]),_:1})])),(0,i.bF)(V,null,{default:(0,i.k6)(()=>t[28]||(t[28]=[(0,i.eW)(" –§–∏–ª—å—Ç—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π ")])),_:1,__:[28]}),(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.callOutline},null,8,["src"]),(0,i.bF)($,{modelValue:x.mailing.user_filter.phones,"onUpdate:modelValue":t[8]||(t[8]=e=>x.mailing.user_filter.phones=e),name:"user_filter.phones",label:"–¢–µ–ª–µ—Ñ–æ–Ω—ã",onIonChange:t[9]||(t[9]=e=>C.itemSave(e)),placeholder:"xxxxxxxxxxx,..."},null,8,["modelValue"])]),_:1}),x.mailing.user_filter.location?((0,i.uX)(),(0,i.Wv)(O,{key:2},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.locationOutline},null,8,["src"]),(0,i.bF)(X,{style:{"white-space":"normal",cursor:"pointer"}},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(x.mailing.user_filter.location.location_address),1)]),_:1}),(0,i.bF)(w,{slot:"end",icon:F.trash,onClick:t[10]||(t[10]=e=>C.locationDelete(`${x.mailing.user_filter.location.location_id}`))},null,8,["icon"])]),_:1})):((0,i.uX)(),(0,i.Wv)(O,{key:3},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.locationOutline},null,8,["src"]),(0,i.bF)(X,null,{default:(0,i.k6)(()=>t[29]||(t[29]=[(0,i.eW)("–õ–æ–∫–∞—Ü–∏—è")])),_:1,__:[29]}),x.mailing.user_filter.location?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.Wv)(A,{key:0,onClick:t[11]||(t[11]=e=>C.modalLocationCreate()),color:"light",expand:"block"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{src:F.locationOutline},null,8,["src"]),t[30]||(t[30]=(0,i.eW)(" –î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å "))]),_:1,__:[30]}))]),_:1})),x.mailing.user_filter.location?((0,i.uX)(),(0,i.Wv)(O,{key:4,lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.locateOutline},null,8,["src"]),(0,i.bF)($,{modelValue:x.mailing.user_filter.radius,"onUpdate:modelValue":t[12]||(t[12]=e=>x.mailing.user_filter.radius=e),name:"user_filter.radius",label:"–†–∞–¥–∏—É—Å –≤–æ–∫—Ä—É–≥ –ª–æ–∫–∞—Ü–∏–∏ –∫–º"},null,8,["modelValue"])]),_:1})):(0,i.Q3)("",!0),(0,i.bF)(O,{lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.pieChartOutline},null,8,["src"]),x.mailing.recieverCount.all>0?((0,i.uX)(),(0,i.Wv)(D,{key:0},{default:(0,i.k6)(()=>[(0,i.eW)("–í—Å–µ–≥–æ "+(0,a.v_)(x.mailing.recieverCount.all),1)]),_:1})):(0,i.Q3)("",!0),x.mailing.recieverCount.sent>0?((0,i.uX)(),(0,i.Wv)(D,{key:1,color:"success"},{default:(0,i.k6)(()=>[(0,i.eW)("–ü–æ—Å–ª–∞–Ω–æ "+(0,a.v_)(x.mailing.recieverCount.sent),1)]),_:1})):(0,i.Q3)("",!0),x.mailing.recieverCount.failed>0?((0,i.uX)(),(0,i.Wv)(D,{key:2,color:"danger"},{default:(0,i.k6)(()=>[(0,i.eW)("–û—à–∏–±–∫–∞ "+(0,a.v_)(x.mailing.recieverCount.failed),1)]),_:1})):(0,i.Q3)("",!0)]),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)(()=>t[31]||(t[31]=[(0,i.eW)(" –°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏ ")])),_:1,__:[31]}),(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.mailOutline},null,8,["src"]),(0,i.bF)(L,{label:"–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç",modelValue:x.mailing.transport,"onUpdate:modelValue":t[13]||(t[13]=e=>x.mailing.transport=e),onIonChange:t[14]||(t[14]=e=>C.itemSave())},{default:(0,i.k6)(()=>[(0,i.bF)(S,{value:"push"},{default:(0,i.k6)(()=>t[32]||(t[32]=[(0,i.eW)("üñºÔ∏è Push")])),_:1,__:[32]}),(0,i.bF)(S,{value:"email"},{default:(0,i.k6)(()=>t[33]||(t[33]=[(0,i.eW)("üìß Email")])),_:1,__:[33]}),(0,i.bF)(S,{value:"sms"},{default:(0,i.k6)(()=>t[34]||(t[34]=[(0,i.eW)("üí¨ Sms")])),_:1,__:[34]}),(0,i.bF)(S,{value:"telegram"},{default:(0,i.k6)(()=>t[35]||(t[35]=[(0,i.eW)("üñ∫ Telegram")])),_:1,__:[35]})]),_:1},8,["modelValue"])]),_:1}),(0,i.bF)(V,null,{default:(0,i.k6)(()=>t[36]||(t[36]=[(0,i.eW)(" –°–æ–¥–µ—Ä–∂–∏–º–æ–µ ")])),_:1,__:[36]})]),_:1}),(0,i.bF)(J,null,{default:(0,i.k6)(()=>[(0,i.bF)(N,null,{default:(0,i.k6)(()=>[(0,i.bF)(E,{size:"12","size-sm":"6"},{default:(0,i.k6)(()=>[(0,i.bF)(Q,null,{default:(0,i.k6)(()=>[(0,i.bF)(z,null,{default:(0,i.k6)(()=>[(0,i.Lk)("form",{onChange:t[21]||(t[21]=(...e)=>C.itemSave&&C.itemSave(...e))},[(0,i.bF)(G,{lines:"full"},{default:(0,i.k6)(()=>{var e,l;return[(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)($,{modelValue:x.mailing.subject_template,"onUpdate:modelValue":t[15]||(t[15]=e=>x.mailing.subject_template=e),ref:"subject_template",placeholder:"–ó–∞–≥–æ–ª–æ–≤–æ–∫",label:"–ó–∞–≥–æ–ª–æ–≤–æ–∫","label-placement":"stacked",disabled:C.isSubjectDisabled},null,8,["modelValue","disabled"])]),_:1}),(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(j,{modelValue:x.mailing.text_template,"onUpdate:modelValue":t[16]||(t[16]=e=>x.mailing.text_template=e),ref:"text_template",placeholder:"–¢–µ–∫—Å—Ç (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)",label:"–¢–µ–∫—Å—Ç","label-placement":"stacked"},null,8,["modelValue"])]),_:1}),(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)($,{modelValue:x.mailing.link,"onUpdate:modelValue":t[17]||(t[17]=e=>x.mailing.link=e),label:"–°—Å—ã–ª–∫–∞",ref:"link","label-placement":"stacked",disabled:C.isLinkDisabled},null,8,["modelValue","disabled"])]),_:1}),(0,i.bF)(O,null,{default:(0,i.k6)(()=>[(0,i.bF)(L,{onIonChange:t[18]||(t[18]=e=>C.itemSave()),label:"–†–∏–Ω–≥—Ç–æ–Ω","label-placement":"stacked",modelValue:x.mailing.sound,"onUpdate:modelValue":t[19]||(t[19]=e=>x.mailing.sound=e),value:"default",disabled:C.isRingtoneDisabled},{default:(0,i.k6)(()=>[(0,i.bF)(S,{value:""},{default:(0,i.k6)(()=>t[37]||(t[37]=[(0,i.eW)("-")])),_:1,__:[37]}),(0,i.bF)(S,{value:"default"},{default:(0,i.k6)(()=>t[38]||(t[38]=[(0,i.eW)("—Å—Ç–∞–Ω–¥–∞—Ä—Ç")])),_:1,__:[38]}),(0,i.bF)(S,{value:"short.wav"},{default:(0,i.k6)(()=>t[39]||(t[39]=[(0,i.eW)("–ö–æ—Ä–æ—Ç–∫–∏–π")])),_:1,__:[39]}),(0,i.bF)(S,{value:"medium.wav"},{default:(0,i.k6)(()=>t[40]||(t[40]=[(0,i.eW)("–°—Ä–µ–¥–Ω–∏–π")])),_:1,__:[40]}),(0,i.bF)(S,{value:"long.wav"},{default:(0,i.k6)(()=>t[41]||(t[41]=[(0,i.eW)("–î–ª–∏–Ω–Ω—ã–π")])),_:1,__:[41]})]),_:1},8,["modelValue","disabled"])]),_:1}),(0,i.bF)(U,{images:null===(e=x.mailing)||void 0===e?void 0:e.images,image_holder:"mailing",image_holder_id:null===(l=x.mailing)||void 0===l?void 0:l.mailing_id,hide_if_empty:"true",controller:"Admin/Mailing",ref:"mailingImgs",onOnChange:C.imageChange},null,8,["images","image_holder_id","onOnChange"]),(0,i.bF)(O,{lines:"none",onClick:t[20]||(t[20]=e=>this.$refs.mailingImgs.take_photo())},{default:(0,i.k6)(()=>[(0,i.bF)(w,{src:F.addOutline,slot:"start"},null,8,["src"]),t[42]||(t[42]=(0,i.eW)(" –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ "))]),_:1,__:[42]})]}),_:1})],32)]),_:1})]),_:1})]),_:1}),(0,i.bF)(E,{size:"12","size-sm":"6"},{default:(0,i.k6)(()=>[t[47]||(t[47]=(0,i.Lk)("h4",null,"–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–∫–∞–∑",-1)),"push"==x.mailing.transport||"telegram"==x.mailing.transport?((0,i.uX)(),(0,i.Wv)(Q,{key:0,class:"preview-card"},{default:(0,i.k6)(()=>[(0,i.bF)(z,null,{default:(0,i.k6)(()=>[(0,i.bF)(O,{class:"ion-no-padding",lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(T,{slot:"start",style:{"--border-radius":"5px",width:"25px",height:"25px"}},{default:(0,i.k6)(()=>t[43]||(t[43]=[(0,i.Lk)("img",{src:"/img/icons/monochrome.png"},null,-1)])),_:1,__:[43]}),(0,i.bF)(X,null,{default:(0,i.k6)(()=>[(0,i.bF)(M,{style:{"font-size":"12px"}},{default:(0,i.k6)(()=>t[44]||(t[44]=[(0,i.eW)("Tezkel 00:00")])),_:1,__:[44]}),(0,i.Lk)("div",null,[(0,i.Lk)("b",o,(0,a.v_)(x.mailing.subject_template),1),(0,i.Lk)("span",r,(0,a.v_)(x.mailing.text_template),1)])]),_:1})]),_:1}),(0,i.Lk)("div",u,[x.mailing.image?((0,i.uX)(),(0,i.CE)("img",{key:0,src:x.mailing.image},null,8,d)):(0,i.Q3)("",!0)])]),_:1})]),_:1})):(0,i.Q3)("",!0),"email"==x.mailing.transport?((0,i.uX)(),(0,i.Wv)(Q,{key:1,class:"preview-card"},{default:(0,i.k6)(()=>[(0,i.bF)(K,null,{default:(0,i.k6)(()=>[(0,i.bF)(O,{class:"ion-no-padding",lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(T,{slot:"start",style:{"--border-radius":"5px",width:"25px",height:"25px"}},{default:(0,i.k6)(()=>t[45]||(t[45]=[(0,i.Lk)("img",{src:"/img/logo-full.png"},null,-1)])),_:1,__:[45]}),(0,i.bF)(X,null,{default:(0,i.k6)(()=>[(0,i.bF)(M,{style:{"font-size":"12px"}},{default:(0,i.k6)(()=>[(0,i.eW)("Tezkel ‚óã "+(0,a.v_)(x.mailing.start_at),1)]),_:1})]),_:1})]),_:1})]),_:1}),(0,i.bF)(z,{style:{"padding-left":"55px"}},{default:(0,i.k6)(()=>[(0,i.bF)(N,{class:"ion-justify-content-center"},{default:(0,i.k6)(()=>[(0,i.Lk)("img",{src:`${e.$heap.state.hostname}img/tezbanner.jpg`,width:"450px"},null,8,c)]),_:1}),(0,i.bF)(N,{class:"ion-justify-content-center ion-margin-vertical"},{default:(0,i.k6)(()=>[(0,i.bF)(B,{style:{"font-size":"14px"}},{default:(0,i.k6)(()=>[(0,i.Lk)("b",null,(0,a.v_)(x.mailing.subject_template),1)]),_:1})]),_:1}),(0,i.Lk)("div",m,[(0,i.Lk)("div",g,[x.mailing.image?((0,i.uX)(),(0,i.CE)("img",{key:0,style:{height:"200px","border-radius":"5px"},src:x.mailing.image},null,8,p)):(0,i.Q3)("",!0)]),(0,i.Lk)("span",_,(0,a.v_)(x.mailing.text_template),1)]),(0,i.bF)(N,{class:"ion-justify-content-center"},{default:(0,i.k6)(()=>[(0,i.bF)(P,{animated:!0,style:{width:"80%"}})]),_:1}),(0,i.bF)(N,{class:"ion-justify-content-center"},{default:(0,i.k6)(()=>[(0,i.bF)(P,{animated:!0,style:{width:"50%"}})]),_:1})]),_:1})]),_:1})):(0,i.Q3)("",!0),"sms"==x.mailing.transport?((0,i.uX)(),(0,i.Wv)(Q,{key:2,class:"preview-card"},{default:(0,i.k6)(()=>[(0,i.bF)(K,null,{default:(0,i.k6)(()=>[(0,i.bF)(O,{class:"ion-no-padding",lines:"none"},{default:(0,i.k6)(()=>[(0,i.bF)(X,{slot:"start"},{default:(0,i.k6)(()=>t[46]||(t[46]=[(0,i.Lk)("b",null,"Tezkel",-1)])),_:1,__:[46]}),(0,i.bF)(X,{slot:"end"},{default:(0,i.k6)(()=>[(0,i.bF)(M,{style:{"font-size":"12px"}},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(x.mailing.start_at),1)]),_:1})]),_:1})]),_:1})]),_:1}),(0,i.bF)(z,{style:{"padding-top":"0"}},{default:(0,i.k6)(()=>[(0,i.bF)(B,{style:{"font-size":"14px"}},{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(x.mailing.text_template),1)]),_:1})]),_:1})]),_:1})):(0,i.Q3)("",!0)]),_:1,__:[47]})]),_:1})]),_:1}),(0,i.Lk)("div",h,[x.mailing.transport?((0,i.uX)(),(0,i.CE)("div",k,["0"==x.mailing.regular_group?((0,i.uX)(),(0,i.CE)("div",f,["0"==x.mailing.is_started?((0,i.uX)(),(0,i.Wv)(A,{key:0,onClick:t[22]||(t[22]=e=>C.itemStart()),expand:"block"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.playOutline},null,8,["src"]),x.mailing.is_delayed?((0,i.uX)(),(0,i.CE)("span",b,"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å")):((0,i.uX)(),(0,i.CE)("span",v,"–û—Ç–ø—Ä–∞–≤–∏—Ç—å"))]),_:1})):((0,i.uX)(),(0,i.Wv)(A,{key:1,onClick:t[23]||(t[23]=e=>C.itemStart("restart")),color:"warning",expand:"block"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.refreshOutline},null,8,["src"]),t[48]||(t[48]=(0,i.eW)(" –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å "))]),_:1,__:[48]}))])):((0,i.uX)(),(0,i.CE)("div",y,[(0,i.bF)(A,{onClick:t[24]||(t[24]=e=>C.itemStart()),expand:"block"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{slot:"start",src:F.saveOutline},null,8,["src"]),t[49]||(t[49]=(0,i.eW)(" –°–æ—Ö—Ä–∞–Ω–∏—Ç—å "))]),_:1,__:[49]})]))])):(0,i.Q3)("",!0),(0,i.bF)(A,{onClick:t[25]||(t[25]=e=>C.itemDelete()),color:"danger",fill:"clear",expand:"block"},{default:(0,i.k6)(()=>t[50]||(t[50]=[(0,i.eW)("–£–¥–∞–ª–∏—Ç—å")])),_:1,__:[50]})])]),_:1})}l(8111),l(116);var x=l(5634),C=l(5480),I=l(2311),w=l.n(I),W=l(4933),O=l(8926),$={components:{ImageTileComp:W.A,IonList:x.nf,IonItem:x.uz,IonLabel:x.he,IonIcon:x.iq,IonButton:x.Jm,IonInput:x.$w,IonTextarea:x.nc,IonCard:x.b_,IonCardTitle:x.tN,IonCardHeader:x.ME,IonCardContent:x.I9,IonSelect:x.Nm,IonSelectOption:x.Ip,IonGrid:x.lO,IonRow:x.ln,IonCol:x.hU,IonChip:x.ZB,IonToggle:x.BY,IonAvatar:x.mC,IonNote:x.JI,IonSkeletonText:x.ds,IonLoading:x.rQ,IonItemDivider:x.Dg},setup(){return{addOutline:C.EKF,refreshOutline:C.mVv,imageOutline:C.ETD,closeOutline:C.xfX,playOutline:C.zsx,saveOutline:C.oc8,locationOutline:C.UN$,trash:C.dco,callOutline:C.bNN,locateOutline:C.jew,mailOutline:C.SM1,pieChartOutline:C.p1S,alarmOutline:C.WYB,layersOutline:C.z8i}},data(){return{openedAccordion:"message",mailingId:this.$route.params.id,mailing:{transport:"push",regular_group:0,is_started:0,sound:null,user_filter:{},recieverCount:0},saveClock:null,regularGroupTranslation:{cart23:"–ö–æ—Ä–∑–∏–Ω–∞ –±—Ä–æ—à–µ–Ω–∞ —Å—É—Ç–∫–∏","promo-10":"–î–æ –∫–æ–Ω—Ü–∞ —Å–∫–∏–¥–∫–∏ 10 –¥–Ω–µ–π","promo-3":"–î–æ –∫–æ–Ω—Ü–∞ —Å–∫–∏–¥–∫–∏ 3 –¥–Ω—è","promo-1":"–î–æ –∫–æ–Ω—Ü–∞ —Å–∫–∏–¥–∫–∏ 1 –¥–µ–Ω—å",forgot14:"–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ 2 –Ω–µ–¥–µ–ª–∏ –Ω–∞–∑–∞–¥",forgot30:"–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ –º–µ—Å—è—Ü –Ω–∞–∑–∞–¥",forgot90:"–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥ 3 –º–µ—Å—è—Ü–∞ –Ω–∞–∑–∞–¥",every_monday:"–ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫",every_tuesday:"–ö–∞–∂–¥—ã–π –≤—Ç–æ—Ä–Ω–∏–∫",every_wednesday:"–ö–∞–∂–¥—É—é —Å—Ä–µ–¥—É",every_thursday:"–ö–∞–∂–¥—ã–π —á–µ—Ç–≤–µ—Ä–≥",every_friday:"–ö–∞–∂–¥—É—é –ø—è—Ç–Ω–∏—Ü—É",every_saturday:"–ö–∞–∂–¥—É—é —Å—É–±–±–æ—Ç—É",every_sunday:"–ö–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"}}},computed:{isPhotoDisabled(){return"sms"==this.mailing.transport},isSubjectDisabled(){return"sms"==this.mailing.transport},isRingtoneDisabled(){return"sms"==this.mailing.transport||"email"==this.mailing.transport},isLinkDisabled(){return"sms"==this.mailing.transport}},methods:{async itemGet(){let e={mailing_id:this.mailingId};try{const t=await w().post(`${this.$heap.state.hostname}Admin/Mailing/itemGet`,e);t.user_filter??={},"0"!==t.regular_group?t.start_at=new Date(t.start_at).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit"}):t.is_delayed=new Date(t.start_at)>new Date,this.mailing=t}catch{}},async itemSave(e){clearTimeout(this.saveClock),this.saveClock=setTimeout(async()=>{var t,l;await this.itemUpdate(),e&&(null===(t=e.target)||void 0===t||null===(l=t.name)||void 0===l?void 0:l.indexOf("user_filter"))>-1&&this.recieverListCreate()},500)},async imageChange(e){if(e){this.mailing.image="";var t=e.find(e=>null==e.deleted_at);t&&t.length>0&&(this.mailing.image=`${this.$heap.state.hostname}image/get.php/${t[0].image_hash}.500.500.webp`)}},async itemUpdate(){var e;let t=this.mailing;"0"!==t.regular_group&&(null===(e=t.start_at)||void 0===e?void 0:e.length)<10&&(t.start_at="1999-07-01 "+t.start_at+":00");try{await w().post(`${this.$heap.state.hostname}Admin/Mailing/itemUpdate`,JSON.stringify(t)),this.$flash("üíæ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ"),this.itemGet()}catch{this.$flash("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")}},async itemDelete(){if(!confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã?"))return;const e={mailing_id:this.mailing.mailing_id};try{await w().post(`${this.$heap.state.hostname}Admin/Mailing/itemDelete`,e),this.$go({name:"MailingList"})}catch{}},itemValidate(){var e,t;if(!this.mailing.is_delayed||this.mailing.start_at)if(0!=this.mailing.regular_group||null!==(e=this.mailing)&&void 0!==e&&null!==(t=e.user_filter)&&void 0!==t&&t.phones)if(this.mailing.subject_template||"email"!=this.mailing.transport){if(!this.mailing.text_template)return this.$refs.text_template.$el.classList.add("ion-invalid"),void alert("–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ");if(this.mailing.transport)return!0;alert("–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω")}else alert("–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω");else alert("–ü–æ–ª—É—á–∞—Ç–µ–ª–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã");else alert("–ù–∞—á–∞–ª–æ —Ä–∞—Å—Å—ã–ª–∫–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ")},async itemStart(e=""){if(!this.itemValidate()||!confirm(`–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞—Å—Å—ã–ª–∫—É –≤ ${this.mailing.start_at}?`))return;const t={mailing_id:this.mailing.mailing_id,mode:e};try{await w().post(`${this.$heap.state.hostname}Admin/Mailing/itemStart`,t),this.itemGet()}catch(a){var l,i;const e=null===a||void 0===a||null===(l=a.responseJSON)||void 0===l||null===(i=l.messages)||void 0===i?void 0:i.error;switch(e){case"empty_recievers":this.$flash("–ù–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π —Ä–∞—Å—Å—ã–ª–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä");break;default:this.$flash("–û—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å")}return!1}},async modalLocationCreate(){if(!this.$heap.state.user.user_id)return this.$flash("–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∞–¥—Ä–µ—Å–∞ —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É"),void this.$go({name:"UserSignIn"});var e="—Ä–∞–±–æ—á–∏–π";const t=await x.OZ.create({component:O.A,showBackdrop:!0,backdropDismiss:!0,componentProps:{location_group_name_low:e}});await t.present();const l=await t.onDidDismiss();l&&(this.mailing.user_filter.location=l.data,this.recieverListCreate())},async locationDelete(e){try{this.mailing.user_filter.location=null,this.recieverListCreate()}catch{this.$flash("–£–¥–∞–ª–∏—Ç—å –∞–¥—Ä–µ—Å –Ω–µ —É–¥–∞–ª–æ—Å—å")}},async recieverListCreate(){try{const e={mailing_id:this.mailing.mailing_id};await this.itemUpdate();const t=await w().post(this.$heap.state.hostname+"Admin/Mailing/recieverListCreate",e);this.$flash(`–í —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–æ ${t} –∑–∞–ø–∏—Å—å`),this.itemGet(this.mailing.mailing_id)}catch{this.$flash("–°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –Ω–µ —É–¥–∞–ª–æ—Å—å")}}},mounted(){this.itemGet()}},S=l(6262);const L=(0,S.A)($,[["render",F],["__scopeId","data-v-4a267516"]]);var V=L},8926:function(e,t,l){l.d(t,{A:function(){return y}});var i=l(641),a=l(33),n=l(3751);const s={style:{position:"absolute",bottom:"10px",width:"100%"}},o={style:{"margin-left":"12px","margin-right":"12px","background-color":"#ffffffdd","--ion-item-background":"#ffffff00","border-top-left-radius":"10px","border-top-right-radius":"10px"}},r={key:0},u={key:1},d={slot:"end",style:{color:"#666"}},c={style:{width:"100%"}},m={style:{display:"grid","grid-template-columns":"1fr 1fr"}};function g(e,t,l,g,p,_){const h=(0,i.g2)("ymap-marker"),k=(0,i.g2)("yandex-map"),f=(0,i.g2)("ion-item"),b=(0,i.g2)("ion-searchbar"),v=(0,i.g2)("ion-content"),y=(0,i.g2)("ion-img"),F=(0,i.g2)("ion-label"),x=(0,i.g2)("ion-segment-button"),C=(0,i.g2)("ion-segment"),I=(0,i.g2)("ion-input"),w=(0,i.g2)("ion-icon"),W=(0,i.g2)("ion-button"),O=(0,i.g2)("ion-toolbar");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(v,null,{default:(0,i.k6)(()=>[p.showed?((0,i.uX)(),(0,i.Wv)(k,{key:0,onClick:t[0]||(t[0]=e=>{_.onClick(e)}),style:{height:"100%"},coords:p.coords,zoom:16,settings:p.settings,controls:["zoomControl"]},{default:(0,i.k6)(()=>[(0,i.bF)(h,{coords:p.coords,"marker-id":"1",properties:_.placemarkProperties},null,8,["coords","properties"])]),_:1},8,["coords","settings"])):(0,i.Q3)("",!0),(0,i.Lk)("div",s,[(0,i.Lk)("div",o,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.suggestions,(e,t)=>((0,i.uX)(),(0,i.Wv)(f,{key:t,onClick:t=>_.suggestionSelect(`${e.subtitle.text}, ${e.title.text}`,e.uri),lines:"full"},{default:(0,i.k6)(()=>[0==t?((0,i.uX)(),(0,i.CE)("p",r,[(0,i.Lk)("b",null,(0,a.v_)(e.subtitle.text)+" "+(0,a.v_)(e.title.text),1)])):((0,i.uX)(),(0,i.CE)("p",u,(0,a.v_)(e.subtitle.text)+" "+(0,a.v_)(e.title.text),1)),(0,i.Lk)("span",d,(0,a.v_)(e.distance.text),1)]),_:2},1032,["onClick"]))),128))]),(0,i.bF)(b,{debounce:"500",modelValue:p.addressSearchQuery,"onUpdate:modelValue":t[1]||(t[1]=e=>p.addressSearchQuery=e),onIonInput:t[2]||(t[2]=e=>_.suggestionsGet()),onKeyup:t[3]||(t[3]=(0,n.jR)(e=>_.pickAddress(),["enter"])),placeholder:"–ø–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É",class:"search"},null,8,["modelValue"])])]),_:1}),(0,i.bF)(O,{style:{"--background":"white"}},{default:(0,i.k6)(()=>[(0,i.Lk)("div",c,[p.locationGroups?((0,i.uX)(),(0,i.Wv)(C,{key:0,mode:"ios",modelValue:p.locationGroup,"onUpdate:modelValue":t[4]||(t[4]=e=>p.locationGroup=e)},{default:(0,i.k6)(()=>[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(p.locationGroups,t=>((0,i.uX)(),(0,i.Wv)(x,{key:t.group_id,value:t},{default:(0,i.k6)(()=>[(0,i.bF)(y,{src:`${e.$heap.state.hostname}/image/get.php/${t.image_hash}.40.40.png`,style:{height:"18px"}},null,8,["src"]),(0,i.bF)(F,null,{default:(0,i.k6)(()=>[(0,i.eW)((0,a.v_)(t.group_name),1)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])):(0,i.Q3)("",!0),(0,i.bF)(I,{label:"–∫–≤–∞—Ä—Ç–∏—Ä–∞, –¥–æ–º, —ç—Ç–∞–∂, –ø–æ–¥—ä–µ–∑–¥","label-placement":"floating",modelValue:p.addressComment,"onUpdate:modelValue":t[5]||(t[5]=e=>p.addressComment=e)},null,8,["modelValue"]),(0,i.Lk)("div",m,[(0,i.bF)(W,{onClick:t[6]||(t[6]=e=>g.closeModal()),color:"light",expand:"block"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{src:g.closeOutline,slot:"start"},null,8,["src"]),t[8]||(t[8]=(0,i.eW)(" –ó–∞–∫—Ä—ã—Ç—å "))]),_:1,__:[8]}),(0,i.bF)(W,{strong:!0,onClick:t[7]||(t[7]=e=>_.pickAddress()),color:"primary",expand:"block"},{default:(0,i.k6)(()=>[(0,i.bF)(w,{src:g.checkmark,slot:"start"},null,8,["src"]),t[9]||(t[9]=(0,i.eW)("–û–∫ "))]),_:1,__:[9]})])])]),_:1})],64)}l(4114),l(8111),l(116);var p=l(5634),_=l(5221),h=l(5480),k=l(8701),f={components:{IonContent:p.W9,IonToolbar:p.ai,IonButton:p.Jm,IonSearchbar:p.S1,IonIcon:p.iq,IonItem:p.uz,IonInput:p.$w,IonSegment:p.Gp,IonSegmentButton:p.eP,IonImg:p.KW,IonLabel:p.he,yandexMap:_.IK,ymapMarker:_.cT},setup(){const e=function(){p.OZ.dismiss()};return{closeModal:e,locationOutline:h.UN$,closeOutline:h.xfX,checkmark:h.AIp}},props:["location_group_name_low","locationGroupList"],data(){var e;let t=this.$heap.state.settings.location,l=JSON.parse(t.mapCenter);return{settings:{apiKey:t.ymapApiKey,lang:"ru_RU",coordorder:"latlong",version:"2.1"},suggestions:[],addressSearchQuery:null,markDeviceOnMap:!0,locationGroup:(null===(e=this.locationGroupList)||void 0===e?void 0:e[0])??null,locationGroups:this.locationGroupList??null,locSettings:t,selectedPlacemark:0,selectedAddress:"",selectedCoords:[],coords:l,addressComment:"",showed:1}},computed:{locationType(){return this.locationGroup?this.locationGroup.group_name+" –∞–¥—Ä–µ—Å":this.location_group_name_low??"–∞–¥—Ä–µ—Å"},placemarkProperties(){return{iconCaption:this.locationType}}},methods:{async pickAddress(){var e;try{if(this.suggestions[0]&&(console.log(this.coords),await this.suggestionSelect(this.suggestions[0].title.text,this.suggestions[0].uri),console.log(this.coords)),!this.selectedAddress){var t;const e=await window.ymaps.geocode(this.coords);this.selectedAddress=null===(t=e.geoObjects.get(0))||void 0===t?void 0:t.getAddressLine()}}catch(i){console.log(i)}var l={location_group_id:(null===(e=this.locationGroup)||void 0===e?void 0:e.group_id)??null,location_address:this.filterAddress(this.selectedAddress),location_latitude:this.coords[0],location_longitude:this.coords[1],location_comment:this.addressComment};p.OZ.dismiss(l)},filterAddress(e){const t=this.locSettings.addressErase.split(", "),l=e.split(", ");let i=[];for(const a of l)t.find(e=>e==a)||i.push(a);return i.reverse().join(", ")},onClick(e){e&&e.get&&(this.markDeviceOnMap=!1,this.suggestions=[],this.selectedAddress=null,this.coords=e.get("coords"))},async suggestionsGet(){if(this.markDeviceOnMap=!1,this.addressSearchQuery)try{const e=this.$heap.state.settings.location.ymapSuggestionApiKey,t=this.coords.slice().reverse().join(","),l=await fetch(`https://suggest-maps.yandex.ru/v1/suggest?apikey=${e}&results=3&lang=ru_RU&ll=${t}&spn=1,1&attrs=uri&types=house&results=5&text=${this.addressSearchQuery}`),i=await l.json();this.suggestions=i.results||[]}catch{}else this.suggestions=[]},async suggestionSelect(e,t){this.selectedAddress=e,this.addressSearchQuery=e,await this.geocode(t)},async geocode(e){try{this.suggestions=[];const t=this.$heap.state.settings.location.ymapApiKey,l=await fetch(`https://geocode-maps.yandex.ru/1.x?apikey=${t}&format=json&results=1&uri=${e}`),i=await l.json(),a=i.response.GeoObjectCollection.featureMember[0].GeoObject;this.coords=a.Point.pos.split(" ").reverse()}catch(t){console.log(t)}}},async mounted(){this.showed=0,setTimeout(async()=>{await(0,_.wc)(),this.showed=1,document.querySelectorAll(".search input")[0].focus();const e=k.A.geo.lastStoredGet();null!==e&&void 0!==e&&e.location_latitude&&(this.coords=[e.location_latitude,e.location_longitude]);const t=await k.A.geo.get();if(this.markDeviceOnMap&&t){const{coords:e}=t;this.coords=[e.latitude,e.longitude],this.$flash("–ù–∞ –∫–∞—Ä—Ç–µ –æ—Ç–º–µ—á–µ–Ω–æ –≤–∞—à–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ")}},100)}},b=l(6262);const v=(0,b.A)(f,[["render",g],["__scopeId","data-v-ed952a3e"]]);var y=v}}]);
//# sourceMappingURL=5851.2edeba7d.js.map