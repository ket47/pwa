"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[5208],{5208:function(t,e,o){o.r(e),o.d(e,{default:function(){return _t}});var r=o(641),i=o(33);const s={style:{"background-color":"#1380c1","padding-bottom":"15px"}},u={class:"store-info-container"},n={class:"store-image-slider-container"},d=(0,r.Lk)("div",{class:"overlay",style:{"background-image":"url(/img/store_menu_background_full.png)"}},null,-1),a={key:0,class:"avatar"},c=["alt","src"],l={key:1},p={key:2,class:"group-fixed-block hidden-block"},_=(0,r.Lk)("h4",{style:{margin:"16px 16px 20px"}},[(0,r.Lk)("b",null,"Онлайн меню")],-1),g={class:"product-container"},m={style:{margin:"0"}},h={class:"product_list_widget_grid"},k=["onClick"],v=["id"],f={class:"product_list_item_img"},I=["src"],y={class:"product-data"},b={class:"product-title"},C={class:"product-description"},w={key:0},S={class:"product-price"},L={key:0,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},X={key:1,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},$={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},q={key:0,style:{color:"var(--ion-color-light)"}},E={key:1,style:{color:"var(--ion-color-light)"}},P={key:0},G={key:1},F={key:2},x={key:3},W=(0,r.Lk)("div",null,[(0,r.Lk)("h6",null,"НУЖНА ДОСТАВКА?"),(0,r.Lk)("h4",null,"ВЫБИРАЙ TEZKEL")],-1);function M(t,e,o,M,A,T){const H=(0,r.g2)("ion-icon"),O=(0,r.g2)("ion-toolbar"),z=(0,r.g2)("image-slider-comp"),B=(0,r.g2)("ion-label"),K=(0,r.g2)("ion-segment-button"),Q=(0,r.g2)("ion-segment"),R=(0,r.g2)("group-list"),D=(0,r.g2)("ion-col"),Z=(0,r.g2)("ion-img"),N=(0,r.g2)("ion-chip"),V=(0,r.g2)("ion-row"),j=(0,r.g2)("ion-grid"),J=(0,r.g2)("swiper-slide"),U=(0,r.g2)("swiper"),Y=(0,r.g2)("ion-button"),tt=(0,r.g2)("router-link"),et=(0,r.g2)("ion-footer"),ot=(0,r.g2)("ion-content"),rt=(0,r.g2)("ion-page");return(0,r.uX)(),(0,r.Wv)(rt,null,{default:(0,r.k6)((()=>[(0,r.bF)(ot,{class:(0,i.C4)("store-menu-page"),scrollEvents:!0,onIonScroll:T.onScroll},{default:(0,r.k6)((()=>[(0,r.bF)(O,null,{default:(0,r.k6)((()=>[M.mainLogo?((0,r.uX)(),(0,r.Wv)(H,{key:0,class:"toolbar_svg_logo",style:{color:"white"},icon:M.mainLogo},null,8,["icon"])):(0,r.Q3)("",!0)])),_:1}),(0,r.Lk)("div",s,[(0,r.Lk)("div",u,[(0,r.Lk)("div",n,[(0,r.bF)(z,{imageList:A.storeItem.images,imgHeight:250,mode:"crop-to-fit"},null,8,["imageList"]),d]),A.storeItem.avatarImage?((0,r.uX)(),(0,r.CE)("div",a,[(0,r.Lk)("img",{alt:A.storeItem.store_name,src:t.$heap.state.hostname+"image/get.php/"+A.storeItem.avatarImage+".200.200.webp"},null,8,c)])):((0,r.uX)(),(0,r.CE)("div",l,[(0,r.Lk)("h2",null,(0,i.v_)(A.storeItem.store_name),1)])),A.storeGroups?((0,r.uX)(),(0,r.CE)("div",p,[(0,r.bF)(Q,{modelValue:A.groupSelectedParentId,"onUpdate:modelValue":e[0]||(e[0]=t=>A.groupSelectedParentId=t),scrollable:"",class:"groups-container"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(A.storeGroups,(t=>((0,r.uX)(),(0,r.Wv)(K,{key:t.group_id,value:t.group_id,onClick:e=>T.groupSelectParent(t.group_id,1),ref_for:!0,ref:"group-tab-"+t.group_id},{default:(0,r.k6)((()=>[(0,r.bF)(B,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(t.group_name),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1},8,["modelValue"])])):(0,r.Q3)("",!0),_,A.storeGroups?((0,r.uX)(),(0,r.Wv)(R,{key:3,groupList:A.storeGroups,onClick:t=>{T.groupSelectParent(t,!0)}},null,8,["groupList","onClick"])):(0,r.Q3)("",!0)]),(0,r.Lk)("div",g,[A.storeGroups?((0,r.uX)(),(0,r.Wv)(U,{key:0,pager:"true",initialSlide:0,speed:400,watchSlidesProgress:!1,grabCursor:!0,touchStartForcePreventDefault:!0,slidesPerView:1.1,pagination:!1,centeredSlides:!1,ref:"productListSlider",class:"product-list-slider",onSlideChange:e[1]||(e[1]=t=>T.groupSliderChanged(t)),style:(0,i.Tr)(`max-height: ${A.sliderMaxHeight}`)},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(A.storeGroups)+" ",1),((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(A.storeGroups,(e=>((0,r.uX)(),(0,r.Wv)(J,{key:e.group_id},{default:(0,r.k6)((()=>[(0,r.bF)(j,{class:"product-list"},{default:(0,r.k6)((()=>[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.children,(e=>((0,r.uX)(),(0,r.Wv)(V,{key:e.group_id,ref_for:!0,ref:"group-"+e.group_id,"data-group_id":e.group_id},{default:(0,r.k6)((()=>[(0,r.bF)(D,{class:"group-title",size:"12"},{default:(0,r.k6)((()=>[(0,r.Lk)("h5",m,(0,i.v_)(e.group_name),1)])),_:2},1024),(0,r.bF)(D,{size:"12"},{default:(0,r.k6)((()=>[(0,r.Lk)("div",h,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(A.storeProducts[e.group_id],(e=>((0,r.uX)(),(0,r.CE)("div",{key:e.product_id,onClick:t=>T.showProductModal(e)},[(0,r.Lk)("div",{class:(0,i.C4)(e.item_class+" product-item"),id:`product_list_item${e.product_id}`},[(0,r.Lk)("div",f,[(0,r.Lk)("img",{class:"blur-image",src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.200.200.webp`},null,8,I),(0,r.bF)(Z,{src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.200.200.webp`},null,8,["src"])]),(0,r.Lk)("div",y,[(0,r.Lk)("h4",b,(0,i.v_)(e.product_name),1),(0,r.Lk)("p",C,(0,i.v_)(e.product_description),1),e.options?((0,r.uX)(),(0,r.CE)("div",w,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(e.options,(e=>((0,r.uX)(),(0,r.Wv)(N,{key:e.product_id,color:"primary"},{default:(0,r.k6)((()=>[(0,r.bF)(B,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(e.product_option),1)])),_:2},1024),(0,r.eW)(" "),e.product_final_price>0?((0,r.uX)(),(0,r.Wv)(B,{key:0},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(e.product_final_price)+(0,i.v_)(t.$heap.state.currencySign),1)])),_:2},1024)):(0,r.Q3)("",!0)])),_:2},1024)))),128))])):(0,r.Q3)("",!0),(0,r.Lk)("div",S,[(0,r.Lk)("span",null,[e.product_net_price>0?((0,r.uX)(),(0,r.CE)("b",L,(0,i.v_)(e.product_net_price),1)):((0,r.uX)(),(0,r.CE)("b",X,(0,i.v_)(e.product_final_price),1)),(0,r.Lk)("b",$,(0,i.v_)(t.$heap.state.currencySign),1)]),"порция"==e.product_unit?((0,r.uX)(),(0,r.CE)("span",q," /"+(0,i.v_)(e.weight_in_gramms)+"г ",1)):((0,r.uX)(),(0,r.CE)("span",E,[(0,r.eW)(" / "),"порция"==e.product_unit?((0,r.uX)(),(0,r.CE)("span",P,(0,i.v_)(e.weight_in_gramms)+"г",1)):"порция мл"==e.product_unit?((0,r.uX)(),(0,r.CE)("span",G,(0,i.v_)(e.weight_in_gramms)+"мл",1)):"кг"==e.product_unit&&e.product_quantity_min<1?((0,r.uX)(),(0,r.CE)("span",F,(0,i.v_)(e.unit_in_gramms)+"г",1)):((0,r.uX)(),(0,r.CE)("span",x,(0,i.v_)(e.product_unit),1))]))])])],10,v)],8,k)))),128))])])),_:2},1024)])),_:2},1032,["data-group_id"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["style"])):(0,r.Q3)("",!0)])]),(0,r.bF)(et,{style:{"background-image":"url(/img/bg3.ce15f59d.png)"}},{default:(0,r.k6)((()=>[W,(0,r.Lk)("div",null,[(0,r.bF)(tt,{to:`/catalog/store-${A.storeId}`},{default:(0,r.k6)((()=>[(0,r.bF)(Y,null,{default:(0,r.k6)((()=>[(0,r.eW)("Перейти в приложение")])),_:1})])),_:1},8,["to"])])])),_:1})])),_:1},8,["onIonScroll"])])),_:1})}o(4114);var A=o(972),T=o(5680),H=o(8935),O=o(5480),z=o(7138),B=o(5648),K=o(9163),Q=o(2311),R=o.n(Q),D=o(5538),Z=o(3201);const N=["alt","src"],V={key:0},j={class:"product-price ion-text-right"},J={key:0,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},U={key:1,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},Y={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},tt={key:0,style:{color:"var(--ion-color-medium)"}},et={key:1,style:{color:"var(--ion-color-medium)"}},ot={key:0},rt={key:1},it={key:2},st={key:3};function ut(t,e,o,s,u,n){const d=(0,r.g2)("ion-card-title"),a=(0,r.g2)("ion-card-header"),c=(0,r.g2)("ion-label"),l=(0,r.g2)("ion-chip"),p=(0,r.g2)("ion-card-content"),_=(0,r.g2)("ion-card"),g=(0,r.g2)("ion-icon"),m=(0,r.g2)("ion-button");return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",{class:(0,i.C4)(n.item_class)},[(0,r.bF)(_,{class:"ion-text-center"},{default:(0,r.k6)((()=>[(0,r.Lk)("img",{class:"product_item_img",alt:o.productItem.product_name,src:`${t.$heap.state.hostname}image/get.php/${o.productItem.image_hash}.380.380.webp`},null,8,N),(0,r.bF)(a,{class:"ion-text-left"},{default:(0,r.k6)((()=>[(0,r.bF)(d,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(o.productItem.product_name),1)])),_:1})])),_:1}),(0,r.bF)(p,{class:"ion-text-left"},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(o.productItem.product_description)+" ",1),(0,r.Lk)("div",null,[o.productItem.options?((0,r.uX)(),(0,r.CE)("div",V,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.productItem.options,(e=>((0,r.uX)(),(0,r.Wv)(l,{key:e.product_id,color:"primary"},{default:(0,r.k6)((()=>[(0,r.bF)(c,null,{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(e.product_option),1)])),_:2},1024),(0,r.eW)(" "),e.product_final_price>0?((0,r.uX)(),(0,r.Wv)(c,{key:0},{default:(0,r.k6)((()=>[(0,r.eW)((0,i.v_)(e.product_final_price)+(0,i.v_)(t.$heap.state.currencySign),1)])),_:2},1024)):(0,r.Q3)("",!0)])),_:2},1024)))),128))])):(0,r.Q3)("",!0),(0,r.Lk)("div",j,[(0,r.Lk)("span",null,[o.productItem.product_net_price>0?((0,r.uX)(),(0,r.CE)("b",J,(0,i.v_)(o.productItem.product_net_price),1)):((0,r.uX)(),(0,r.CE)("b",U,(0,i.v_)(o.productItem.product_final_price),1)),(0,r.Lk)("b",Y,(0,i.v_)(t.$heap.state.currencySign),1)]),"порция"==o.productItem.product_unit?((0,r.uX)(),(0,r.CE)("span",tt," / "+(0,i.v_)(o.productItem.weight_in_gramms)+"г ",1)):((0,r.uX)(),(0,r.CE)("span",et,[(0,r.eW)(" / "),"порция"==o.productItem.product_unit?((0,r.uX)(),(0,r.CE)("span",ot,(0,i.v_)(o.productItem.weight_in_gramms)+"г",1)):"порция мл"==o.productItem.product_unit?((0,r.uX)(),(0,r.CE)("span",rt,(0,i.v_)(o.productItem.weight_in_gramms)+"мл",1)):"кг"==o.productItem.product_unit&&o.productItem.product_quantity_min<1?((0,r.uX)(),(0,r.CE)("span",it,(0,i.v_)(o.productItem.unit_in_gramms)+"г",1)):((0,r.uX)(),(0,r.CE)("span",st,(0,i.v_)(o.productItem.product_unit),1))]))])])])),_:1})])),_:1})],2),(0,r.bF)(m,{fill:"clear",expand:"block",onClick:e[0]||(e[0]=t=>{n.closeModal()}),color:"light",size:"large"},{default:(0,r.k6)((()=>[(0,r.bF)(g,{slot:"icon-only",icon:s.closeOutline},null,8,["icon"])])),_:1})],64)}var nt={components:{IonIcon:A.iq,IonChip:A.ZB,IonCard:A.b_,IonCardContent:A.I9,IonCardTitle:A.tN,IonCardHeader:A.ME,IonLabel:A.he,IonButton:A.Jm},props:["productItem"],setup(){return{layersOutline:O.z8i,closeOutline:O.xfX}},computed:{item_class(){return this.productItem.deleted_at?"deleted":this.productItem.product_final_price!=this.productItem.product_price?"promo":1==this.productItem.is_disabled?"disabled":1!=this.productItem.is_counted||this.productItem.product_quantity-this.productItem.product_quantity_reserved>0?"":"absent"},discount(){return Math.round(this.productItem.product_final_price/this.productItem.product_price*100-100)},weight_in_gramms(){return 1e3*this.productItem.product_weight},unit_in_gramms(){return Math.round(1e3*this.productItem.product_quantity_min)},product_price(){return"кг"==this.productItem.product_unit&&this.productItem.product_quantity_min<1?Math.round(this.productItem.product_price*this.productItem.product_quantity_min):this.productItem.product_price},product_final_price(){return"кг"==this.productItem.product_unit&&this.productItem.product_quantity_min<1?Math.round(this.productItem.product_final_price*this.productItem.product_quantity_min):this.productItem.product_final_price}},methods:{closeModal(){A.OZ.dismiss()}}},dt=o(6262);const at=(0,dt.A)(nt,[["render",ut],["__scopeId","data-v-088db628"]]);var ct=at,lt={components:{IonPage:A.AO,IonToolbar:A.ai,IonContent:A.W9,IonFooter:A.M0,IonCol:A.hU,IonIcon:A.iq,IonImg:A.KW,IonRow:A.ln,IonGrid:A.lO,ImageSliderComp:B.A,IonLabel:A.he,IonSegmentButton:A.eP,IonSegment:A.Gp,IonButton:A.Jm,Swiper:H.R,SwiperSlide:H.q,GroupList:K.A,IonChip:A.ZB},setup(){return{mainLogo:z,search:O.$P,settingsOutline:O.s8q,rocketOutline:O.hGQ,compassOutline:O.Hy9,slideModules:[T.Ij]}},data(){return{storeId:this.$route.params.id,query:this.$route.query,searchRequest:"",storeItem:[],storeProducts:{},storeGroups:null,groupSelectedParentId:-1,offsetModificator:80,sliderMaxHeight:500,can_reload_at:0}},computed:{weight_in_gramms(){return 1e3*this.productItem.product_weight},unit_in_gramms(){return Math.round(1e3*this.productItem.product_quantity_min)}},methods:{async itemGet(){const t=Date.now();if(!(this.can_reload_at>t)){this.can_reload_at=t+1e4;try{const t=await R().post(`${D.A.state.hostname}Store/itemGet`,{store_id:this.storeId,distance_include:1});this.storeItem=this.itemPrepare(t),this.storeId=t.store_id,this.groupTreeGet({store_id:this.storeId}),D.A.commit("setCurrentStore",this.storeItem)}catch(r){var e,o;const t=null===r||void 0===r||null===(e=r.responseJSON)||void 0===e||null===(o=e.messages)||void 0===o?void 0:o.error;switch(t){case"notfound":this.$flash("Продавец не найден"),this.$go("/catalog");break}return!1}}},itemPrepare(t){t.member_of_groups.group_names&&(t.store_group_names=t.member_of_groups.group_names);try{t.deliveryTime=Z.A.deliveryTimeCalculate(t.locations[0].distance,t.store_time_preparation)}catch{}return t.avatarImage="",t.avatar.length>0&&(t.avatarImage=t.avatar[0].image_hash),t},async productListGet(t={}){if(t.store_id=this.storeId,t.is_active=1,t.name_query&&""==t.name_query)return void this.groupTreeGet({store_id:this.storeId});t.limit=200;let e={};try{e=await R().post(D.A.state.hostname+"Product/listGet",t)}catch(r){}this.productListPrepare(e.product_list),this.groupOtherAdd();let o=this;setTimeout((()=>{o.groupSelect()}),0)},productListPrepare(t){for(var e of(this.storeProducts={},t)){var o,r,i;if(this.storeGroups)if(!this.storeProducts[null!==(r=e.group_id)&&void 0!==r?r:0])this.storeProducts[null!==(i=e.group_id)&&void 0!==i?i:0]=[];e.item_class="",e.deleted_at&&(e.item_class="deleted"),1==e.is_disabled&&(e.item_class="disabled"),1!=e.is_counted||e.product_quantity-e.product_quantity_reserved>0||(e.item_class="absent"),e.weight_in_gramms=1e3*e.product_weight,e.unit_in_gramms=Math.round(1e3*e.product_quantity_min),this.storeProducts[null!==(o=e.group_id)&&void 0!==o?o:0].push(e)}},async groupTreeGet(t){try{const e=await R().get(`${D.A.state.hostname}Product/groupTreeGet`,{store_id:t.store_id});let o=[];for(let t in e)o[e[t].order]=e[t];this.storeGroups=o,this.productListGet()}catch(e){}},groupOtherAdd(){this.storeProducts[0]&&this.storeGroups.push({group_id:"other",group_name:"Другое",image_hash:"",children:{0:{group_id:0,group_name:"другое",group_parent_id:0,group_path:"",image_hash:""}}})},groupSelect(){if(this.groupSelectedParentId>-1)return;let t=this.query.parent_group_id,e=this.query.sub_group_id;if(e)t:for(let i in this.storeGroups)for(let o in this.storeGroups[i].children)if(o==e){t=i;break t}var o;t||(t=null===(o=this.storeGroups[0])||void 0===o?void 0:o.group_id);const r=!1;this.groupSelectParent(t,r)},groupSelectParent(t){if(this.groupSelectedParentId==t)return;if(this.groupSelectedParentId=t,void 0==this.$refs.productListSlider)return;const e=this.$refs.productListSlider.$el.swiper,o=this.storeGroups.findIndex((e=>e.group_id==t));o>=0&&(e.slideTo(o,100,!1),this.groupSliderAdjustHeight())},groupSliderChanged(t){const e=t.activeIndex,o=this.storeGroups[e].group_id;this.groupSelectParent(o,1)},groupSliderAdjustHeight(){var t;const e=null===(t=this.$refs.productListSlider.$el.querySelector(".swiper-slide-active"))||void 0===t?void 0:t.scrollHeight;this.$refs.productListSlider.$el.style.maxHeight=e>0?e+"px":""},onScroll(t){var e;const o=null===(e=document.querySelector("#hcat_widget_grid"))||void 0===e?void 0:e.getBoundingClientRect().top;o<0?document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block"):document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block hidden-block");var r=document.querySelectorAll(".swiper-slide-active .product-list ion-row");for(var i of r)if(i.getBoundingClientRect().top-this.offsetModificator<=window.innerHeight-window.innerHeight/4&&i.getBoundingClientRect().bottom+this.offsetModificator>=window.innerHeight-window.innerHeight/4&&i.dataset.group_id)break},async showProductModal(t){const e=await A.OZ.create({component:ct,id:"product-modal",componentProps:{productItem:t},handleBehavior:"cycle",canDissmiss:!0});e.present(),this.$topic.on("dismissModal",(()=>e.dismiss()));const o=await e.onDidDismiss();this.$emit("react",o.data)}},mounted(){this.query=this.$route.query,this.itemGet()},watch:{$route(t){this.storeId=t.params.id}}};const pt=(0,dt.A)(lt,[["render",M]]);var _t=pt}}]);
//# sourceMappingURL=5208.b8f6cfc6.js.map