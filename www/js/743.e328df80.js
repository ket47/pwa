"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[743],{7327:function(e,i,t){t.d(i,{Z:function(){return m}});var o=t(6252),a=t(3577);const l=(0,o.Uk)("Просмотр фотографии");function r(e,i,t,r,n,s){const d=(0,o.up)("ion-title"),c=(0,o.up)("ion-icon"),u=(0,o.up)("ion-toolbar"),m=(0,o.up)("ion-header"),h=(0,o.up)("ion-button"),_=(0,o.up)("ion-col"),p=(0,o.up)("ion-row"),g=(0,o.up)("ion-grid"),w=(0,o.up)("ion-img"),k=(0,o.up)("ion-content");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,{color:"secondary"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[l])),_:1}),(0,o.Wm)(c,{icon:r.closeOutline,onClick:i[0]||(i[0]=e=>{r.closeModal()}),slot:"end",size:"large"},null,8,["icon"])])),_:1})])),_:1}),(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[t.actions?((0,o.wg)(),(0,o.j4)(g,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.actions,((e,i)=>((0,o.wg)(),(0,o.j4)(_,{key:i},{default:(0,o.w5)((()=>[e[0]?((0,o.wg)(),(0,o.j4)(h,{key:0,onClick:t=>s.actionCreate(i,e[1]),expand:"block",color:e[1]??"primary"},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(e[0]),1)])),_:2},1032,["onClick","color"])):(0,o.kq)("",!0)])),_:2},1024)))),128))])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(w,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var n=t(8903),s=t(3741),d={props:["image_hash","actions"],components:{IonIcon:s.gu,IonToolbar:s.sr,IonHeader:s.Gu,IonImg:s.Xz,IonContent:s.W2,IonTitle:s.wd,IonButton:s.YG,IonCol:s.wI,IonRow:s.Nd,IonGrid:s.jY},setup(){const e=function(){s.Fy.dismiss()};return{closeModal:e,closeOutline:n.fID}},methods:{actionCreate(e,i){("danger"!=i||confirm("Вы уверены?"))&&s.Fy.dismiss(null,e)}}},c=t(3744);const u=(0,c.Z)(d,[["render",r]]);var m=u},5611:function(e,i,t){t.d(i,{Z:function(){return W}});var o=t(6252),a=t(3577);const l=(0,o.Uk)("Фотографии"),r={key:0,class:"image_grid"},n=["onClick"],s={key:0},d={key:1},c={key:0,class:"image_controls"},u=["id"];function m(e,i,t,m,h,_){const p=(0,o.up)("ion-label"),g=(0,o.up)("ion-icon"),w=(0,o.up)("ion-item"),k=(0,o.up)("ion-img"),f=(0,o.up)("ion-avatar");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",null,[(0,o.Wm)(w,{lines:"none",onClick:i[0]||(i[0]=e=>{h.editMode=!h.editMode,h.editMode&&_.load()})},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{color:"imageList?.length?'':medium"},{default:(0,o.w5)((()=>[l])),_:1}),h.editMode?((0,o.wg)(),(0,o.j4)(g,{key:0,slot:"end",icon:m.settingsSharp,color:"primary"},null,8,["icon"])):((0,o.wg)(),(0,o.j4)(g,{key:1,slot:"end",icon:m.settingsOutline},null,8,["icon"]))])),_:1}),_.imageList?.length?((0,o.wg)(),(0,o.iD)("div",r,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(_.imageList,(i=>((0,o.wg)(),(0,o.iD)("div",{key:i.image_id,style:{position:"relative"}},[(0,o._)("div",{style:{position:"absolute",top:"0px","background-color":"#fffc","font-size":"0.75em"},onClick:e=>_.imagePreview(i.image_hash)},[i.deleted_at?((0,o.wg)(),(0,o.iD)("div",s,"будет удалено")):1==i.is_disabled?((0,o.wg)(),(0,o.iD)("div",d,"на модерации")):(0,o.kq)("",!0)],8,n),(0,o.Wm)(f,{onClick:e=>_.imagePreview(i.image_hash),class:(0,a.C_)(i.class)},{default:(0,o.w5)((()=>[(0,o.Wm)(k,{src:e.$heap.state.hostname+"image/get.php/"+i.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),h.editMode?((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(g,{icon:m.chevronBackCircleOutline,onClick:e=>_.back(i)},null,8,["icon","onClick"]),_.isAdmin&&1==i.is_disabled?((0,o.wg)(),(0,o.j4)(g,{key:0,icon:m.checkmarkCircle,color:"success",onClick:e=>_.enable(i)},null,8,["icon","onClick"])):(0,o.kq)("",!0),i.deleted_at?((0,o.wg)(),(0,o.j4)(g,{key:1,icon:m.addCircle,color:"success",onClick:e=>_.restore(i)},null,8,["icon","onClick"])):((0,o.wg)(),(0,o.j4)(g,{key:2,icon:m.trash,color:"danger",onClick:e=>_.remove(i)},null,8,["icon","onClick"])),(0,o.Wm)(g,{icon:m.chevronForwardCircleOutline,onClick:e=>_.forward(i)},null,8,["icon","onClick"])])):(0,o.kq)("",!0)])))),128))])):(0,o.kq)("",!0)]),(0,o._)("input",{type:"file",id:h.fileUploaderId,accept:"image/*",onChange:i[1]||(i[1]=e=>_.uploadImage(e)),style:{display:"none"}},null,40,u)],64)}var h=t(8903),_=t(3741),p=t(7327),g=t(9755),w=t.n(g),k=t(9042),f=t(351),y={props:["images","image_holder_id","controller"],components:{IonLabel:_.Q$,IonIcon:_.gu,IonItem:_.Ie,IonImg:_.Xz,IonAvatar:_.BJ},setup(){return{settingsOutline:h.C$N,settingsSharp:h.kiF,chevronBackCircleOutline:h.CK0,chevronForwardCircleOutline:h.esm,trash:h._Ij,addCircle:h.ZWo,checkmarkCircle:h.I1A}},data(){return{images_loaded:null,editMode:!1,fileUploaderId:this.controller+this.image_holder_id}},computed:{imageList(){let e=this.images_loaded||this.images,i=[];for(let t in e)e[t].deleted_at?(e[t].class=" deleted",this.editMode&&i.push(e[t])):1==e[t].is_disabled?(e[t].class=" disabled",this.editMode&&i.push(e[t])):i.push(e[t]);return i},isAdmin(){return f.Z.isAdmin()}},methods:{async back(e){try{await w().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),this.load()}catch{}},async forward(e){try{await w().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),this.load()}catch{}},async remove(e){try{await w().post(this.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено в корзину и будет удалено")}catch{}},async restore(e){try{await w().post(this.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),this.load(),this.$flash("Фото перемещено извлечено из корзины")}catch{}},async enable(e){try{await w().post(this.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),this.load()}catch{}},async load(){const e={image_holder_id:this.image_holder_id,image_holder:this.controller,is_disabled:1,is_deleted:1,is_active:1};this.images_loaded=await w().post(this.$heap.state.hostname+"Image/listGet",e)},async imagePreview(e){const i=await _.Fy.create({component:p.Z,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[.5,1]}),t=function(){i.dismiss()};return k.Z.on("dismissModal",t),i.present()},async uploadImage(e){let i=new FormData;i.append("files[]",e.target.files[0]),i.set("image_holder_id",this.image_holder_id);const t={url:this.$heap.state.hostname+this.controller+"/fileUpload",type:"POST",data:i,processData:!1,contentType:!1};try{await w().ajax(t),this.load()}catch(o){if("limit_exeeded"==o?.responseJSON?.messages?.error)return void this.$flash("Уже загружено максимальное количество фото");this.$flash("Не удалось загрузить фото")}},take_photo(){w()(`#${this.fileUploaderId}`).trigger("click"),this.editMode=!0}}},C=t(3744);const I=(0,C.Z)(y,[["render",m],["__scopeId","data-v-43cc4d45"]]);var W=I},3743:function(e,i,t){t.r(i),t.d(i,{default:function(){return x}});var o=t(6252),a=t(3577);const l={key:0},r=(0,o.Uk)("Подача заявки"),n=(0,o.Uk)(" Подавая заявку вы даете согласие на условия "),s=(0,o.Uk)("Стать курьером"),d={key:1},c=(0,o.Uk)(" Анкета активна. Вы можете открыть смену для приема заказов. "),u=(0,o.Uk)(" Удалено "),m=(0,o.Uk)(" На модерации "),h=(0,o.Uk)("Основные настройки"),_=(0,o.Uk)("Транспорт"),p=(0,o.Uk)("ИНН"),g=(0,o.Uk)("Коментарий"),w=(0,o.Uk)("Ваше фото"),k=(0,o.Uk)(" Добавить "),f=(0,o.Uk)("Информация"),y=(0,o.Uk)(" Оферта об оказании услуг доставки ");function C(e,i,t,C,I,W){const b=(0,o.up)("ion-label"),v=(0,o.up)("ion-item"),U=(0,o.up)("ion-text"),D=(0,o.up)("ion-checkbox"),$=(0,o.up)("ion-button"),O=(0,o.up)("ion-card"),Z=(0,o.up)("ion-card-content"),V=(0,o.up)("ion-icon"),x=(0,o.up)("ion-toggle"),j=(0,o.up)("ion-item-divider"),q=(0,o.up)("ion-input"),M=(0,o.up)("ion-textarea"),T=(0,o.up)("ion-list"),G=(0,o.up)("image-tile-comp"),A=(0,o.up)("base-layout");return(0,o.wg)(),(0,o.j4)(A,{"page-title":"Анкета курьера","page-default-back-link":"/user-dashboard"},{default:(0,o.w5)((()=>[I.courier?(0,o.kq)("",!0):((0,o.wg)(),(0,o.iD)("div",l,[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[r])),_:1})])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[n,(0,o._)("a",{href:"#/page-courier_contract",onClick:i[0]||(i[0]=i=>e.$router.push("/page-courier_contract"))},"Оферта об оказании услуг доставки")])),_:1}),(0,o.Wm)(D,{modelValue:I.contractAccepted,"onUpdate:modelValue":i[1]||(i[1]=e=>I.contractAccepted=e),slot:"end"},null,8,["modelValue"])])),_:1}),(0,o.Wm)($,{expand:"full",onClick:i[2]||(i[2]=e=>W.itemCreate()),disabled:!I.contractAccepted},{default:(0,o.w5)((()=>[s])),_:1},8,["disabled"])])),_:1})])),I.courier?((0,o.wg)(),(0,o.iD)("div",d,[W.message?((0,o.wg)(),(0,o.j4)(O,{key:0,lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)(Z,{class:(0,a.C_)(W.messageClass)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,a.zw)(W.message),1)])),_:1},8,["class"])])),_:1})):((0,o.wg)(),(0,o.j4)(O,{key:1,lines:"none"},{default:(0,o.w5)((()=>[(0,o.Wm)(Z,{style:{"background-color":"var(--ion-color-success-tint)"}},{default:(0,o.w5)((()=>[c])),_:1})])),_:1})),(0,o._)("form",{onChange:i[10]||(i[10]=e=>W.updateCourier())},[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(V,{src:C.trashOutline,color:"primary",slot:"start"},null,8,["src"]),u,(0,o.Wm)(x,{slot:"end",modelValue:I.is_deleted,"onUpdate:modelValue":i[3]||(i[3]=e=>I.is_deleted=e),color:"danger",onIonChange:i[4]||(i[4]=e=>W.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,null,{default:(0,o.w5)((()=>[(0,o.Wm)(V,{src:C.searchOutline,color:"primary",slot:"start"},null,8,["src"]),m,(0,o.Wm)(x,{slot:"end",modelValue:I.is_disabled,"onUpdate:modelValue":i[5]||(i[5]=e=>I.is_disabled=e),onIonChange:i[6]||(i[6]=e=>W.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,o.Wm)(j,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[h])),_:1})])),_:1}),(0,o.Wm)(v,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[_])),_:1}),(0,o.Wm)(q,{modelValue:I.courier.courier_vehicle,"onUpdate:modelValue":i[7]||(i[7]=e=>I.courier.courier_vehicle=e),placeholder:"автомобиль, мопед, велосипед"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[p])),_:1}),(0,o.Wm)(q,{modelValue:I.courier.courier_tax_num,"onUpdate:modelValue":i[8]||(i[8]=e=>I.courier.courier_tax_num=e),placeholder:"Ваш ИНН"},null,8,["modelValue"])])),_:1}),(0,o.Wm)(v,{lines:"full"},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{position:"stacked",color:"primary"},{default:(0,o.w5)((()=>[g])),_:1}),(0,o.Wm)(M,{modelValue:I.courier.courier_comment,"onUpdate:modelValue":i[9]||(i[9]=e=>I.courier.courier_comment=e),placeholder:"Цвет, номер авто"},null,8,["modelValue"])])),_:1})])),_:1})],32),I.courier?((0,o.wg)(),(0,o.j4)(T,{key:2},{default:(0,o.w5)((()=>[(0,o.Wm)(j,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[w])),_:1})])),_:1}),(0,o.Wm)(G,{images:I.courier.images,image_holder_id:I.courier.courier_id,controller:"Courier",ref:"courierImgs"},null,8,["images","image_holder_id"]),(0,o.Wm)($,{onClick:i[11]||(i[11]=i=>e.$refs.courierImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{src:C.cameraOutline},null,8,["src"]),k])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(j,null,{default:(0,o.w5)((()=>[(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[f])),_:1})])),_:1}),(0,o.Wm)(v,{lines:"none",button:"",detail:"",onClick:i[12]||(i[12]=i=>e.$router.push("/page-courier_contract"))},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{src:C.documentTextOutline,slot:"start"},null,8,["src"]),(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[y])),_:1})])),_:1})])),_:1})])):(0,o.kq)("",!0)])),_:1})}var I=t(3741),W=t(8903),b=t(9755),v=t.n(b),U=t(2008),D=t(351),$=t(5611),O={components:{imageTileComp:$.Z,IonTextarea:I.g2,IonInput:I.pK,IonCard:I.PM,IonCardContent:I.FN,IonLabel:I.Q$,IonItem:I.Ie,IonButton:I.YG,IonList:I.q_,IonCheckbox:I.nz,IonText:I.yW,IonItemDivider:I.rH,IonToggle:I.ho,IonIcon:I.gu},setup(){return{cameraOutline:W.kuq,trashOutline:W.gtu,searchOutline:W.W6I,documentTextOutline:W.L82}},data(){return{other_courier_id:this.$route?.query?.courier_id,courier:null,isAdmin:D.Z.isAdmin(),contractAccepted:0,is_deleted:0,is_disabled:0}},ionViewDidEnter(){this.other_courier_id!=this.$route?.query?.courier_id&&(this.other_courier_id=this.$route?.query?.courier_id,this.itemGet())},mounted(){this.itemGet()},computed:{message(){return this.courier.deleted_at?"Анкета не активна и будет удалена. Вы можете еще отменить удаление":1==this.courier.is_disabled?"Анкета не активна и находится на рассмотрении у администратора":null},messageClass(){return this.courier.deleted_at?"deleted":1==this.courier.is_disabled?"disabled":null},imageClass(){return 1==this.courier?.images[0]?.is_disabled?"image_disabled":""}},methods:{async itemGet(){this.other_courier_id?this.courier=await v().post(U.Z.state.hostname+"Courier/itemGet",{courier_id:this.other_courier_id}):this.courier=await D.Z.courier.get(),this.itemParseFlags()},itemParseFlags(){this.courier&&(this.is_deleted=null==this.courier.deleted_at?0:1,this.is_disabled=0==this.courier.is_disabled?0:1)},async itemCreate(){try{await v().post(U.Z.state.hostname+"Courier/itemCreate"),await D.Z.get("full"),this.courier=D.Z.courier.data}catch{this.$flash("Не удалось зарегистрироваться как курьер")}},async itemDelete(e){const i=e?"itemDelete":"itemUnDelete";try{await v().post(U.Z.state.hostname+"Courier/"+i,{courier_id:this.courier.courier_id}),this.courier.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.courier.is_disabled!=e)try{await v().post(U.Z.state.hostname+"Courier/itemDisable",{courier_id:this.courier.courier_id,is_disabled:e}),this.courier.is_disabled=e}catch{this.itemGet()}},async uploadImage(e){let i=new FormData;i.append("files[]",e.target.files[0]),i.set("image_holder_id",this.courier.courier_id);const t={url:U.Z.state.hostname+"Courier/fileUpload",type:"POST",data:i,processData:!1,contentType:!1};try{await v().ajax(t),this.itemGet()}catch(o){this.$flash("Не удалось загрузить фото")}},uploadImageTrigger(){v()("#courier_foto_upload").trigger("click")},async updateCourier(){try{return await v().post(U.Z.state.hostname+"Courier/itemUpdate",JSON.stringify(this.courier))}catch(e){const i=JSON.parse(e.responseJSON?.messages?.error);i.courier_tax_num&&this.$flash("Неверный формат ИНН")}}}},Z=t(3744);const V=(0,Z.Z)(O,[["render",C],["__scopeId","data-v-51283fb2"]]);var x=V}}]);
//# sourceMappingURL=743.e328df80.js.map