"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[9655],{8384:function(t,e,o){o.d(e,{A:function(){return m}});var a=o(641),n=o(33);const i={style:{"font-size":"22px"}},s={key:1,class:"ion-padding ion-text-center"};function l(t,e,o,l,r,u){const d=(0,a.g2)("ion-card-subtitle"),c=(0,a.g2)("ion-icon"),p=(0,a.g2)("ion-label"),h=(0,a.g2)("ion-chip"),m=(0,a.g2)("ion-card-title"),_=(0,a.g2)("ion-card-header"),b=(0,a.g2)("apexchart"),k=(0,a.g2)("ion-card-content"),g=(0,a.g2)("ion-card");return(0,a.uX)(),(0,a.Wv)(g,{style:{contain:"initial",overflow:"visible"}},{default:(0,a.k6)(()=>[(0,a.bF)(_,{style:{"padding-bottom":"0"}},{default:(0,a.k6)(()=>[(0,a.bF)(d,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,n.v_)(o.label),1)]),_:1}),(0,a.bF)(m,null,{default:(0,a.k6)(()=>[(0,a.Lk)("div",null,[(0,a.Lk)("b",i,(0,n.v_)(u.mainValue),1),0!=u.dynamicsData.value?((0,a.uX)(),(0,a.Wv)(h,{key:0,outline:!0,color:u.dynamicsData.color,class:"ion-no-margin",style:{"font-size":"12px",border:"none"}},{default:(0,a.k6)(()=>[(0,a.bF)(c,{icon:u.dynamicsData.icon},null,8,["icon"]),(0,a.bF)(p,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,n.v_)(u.dynamicsData.value)+"%",1)]),_:1})]),_:1},8,["color"])):(0,a.Q3)("",!0)])]),_:1})]),_:1}),(0,a.bF)(k,{class:"ion-no-padding"},{default:(0,a.k6)(()=>[o.data.series.length>1?((0,a.uX)(),(0,a.Wv)(b,{key:0,type:"area",height:"70",options:r.chartOptions,series:r.series,ref:"apexChart"},null,8,["options","series"])):((0,a.uX)(),(0,a.CE)("div",s,e[0]||(e[0]=[(0,a.Lk)("h2",null,"Недостаточно данных",-1),(0,a.Lk)("p",null,"для показа статистики",-1)])))]),_:1})]),_:1})}var r=o(5634),u=o(5480),d=o(5564),c={components:{IonIcon:r.iq,IonLabel:r.he,IonCard:r.b_,IonCardHeader:r.ME,IonCardTitle:r.tN,IonCardSubtitle:r.HW,IonCardContent:r.I9,IonChip:r.ZB,apexchart:d.A},props:["label","data","format","color","dates"],setup(){return{calendarOutline:u.RXF,caretUpOutline:u.rHB,caretDownOutline:u.mF9,caretForwardOutline:u.d2Q}},data(){return{value:0,series:[{name:this.label,data:this.data.series}],chartOptions:{chart:{height:70,type:"area",zoom:{enabled:!1},toolbar:{show:!1},parentHeightOffset:0,sparkline:{enabled:!0}},stroke:{width:2},colors:["#008FFB"],legend:{show:!1},fill:{type:"gradient",gradient:{opacityFrom:.6,opacityTo:.4}},dataLabels:{enabled:!1},grid:{padding:{left:-10,right:-10,top:-15,bottom:-15},yaxis:{lines:{show:!1}}},xaxis:{show:!1,labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1},categories:[]},yaxis:{min:0,show:!1,labels:{show:!1},axisBorder:{show:!1},axisTicks:{show:!1}}}}},computed:{mainValue(){const t=this.data.value??0;return"integer"==this.format?new Intl.NumberFormat("ru-RU").format(Math.round(t)):"float"==this.format?new Intl.NumberFormat("ru-RU",{maximumSignificantDigits:2}).format(parseFloat(t).toFixed(2)):"currency"==this.format?new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(parseFloat(t).toFixed(2)):null},dynamicsData(){const t=1*this.data.avg??0,e=1*this.data.value??0,o=((e-t)/((e+t)/2)*100||0).toFixed(2);var a="medium",n=u.d2Q;return o>0&&(a="success",n=u.rHB),o<0&&(a="danger",n=u.mF9),{value:o,color:a,icon:n}},datesParsed(){return this.getDates(this.dates)}},methods:{initChart(){this.$refs.apexChart&&(this.$refs.apexChart.updateSeries(this.series),this.$refs.apexChart.updateOptions({xaxis:{categories:this.datesParsed}}))},getDates(t){let e=[];for(let o=0;o<t.length;o++)e.unshift(new Date(t[o]).toLocaleString("ru",{day:"numeric",month:"long"}));return e}},mounted(){this.chartOptions.colors=[this.color]??0,setTimeout(()=>{this.initChart()},10)},updated(){setTimeout(()=>{this.initChart()},10)}},p=o(6262);const h=(0,p.A)(c,[["render",l]]);var m=h},9655:function(t,e,o){o.r(e),o.d(e,{default:function(){return w}});var a=o(641),n=o(33);const i={style:{color:"#999"}},s={key:0},l={key:1},r={key:3};function u(t,e,o,u,d,c){const p=(0,a.g2)("ion-segment-button"),h=(0,a.g2)("ion-segment"),m=(0,a.g2)("ion-icon"),_=(0,a.g2)("ion-text"),b=(0,a.g2)("ion-item"),k=(0,a.g2)("ion-list"),g=(0,a.g2)("ion-skeleton-text"),v=(0,a.g2)("promo-statistics"),f=(0,a.g2)("base-layout");return(0,a.uX)(),(0,a.Wv)(f,{pageTitle:"Мои бонусы",pageDefaultBackLink:"/user"},{default:(0,a.k6)(()=>[(0,a.bF)(h,{"swipe-gesture":"true",modelValue:d.promoType,"onUpdate:modelValue":e[0]||(e[0]=t=>d.promoType=t),onIonChange:e[1]||(e[1]=t=>c.listTypeChanged(t))},{default:(0,a.k6)(()=>[(0,a.bF)(p,{value:"bonuses"},{default:(0,a.k6)(()=>e[4]||(e[4]=[(0,a.eW)(" Бонусы ")])),_:1,__:[4]}),(0,a.bF)(p,{value:"active"},{default:(0,a.k6)(()=>e[5]||(e[5]=[(0,a.eW)(" Скидки ")])),_:1,__:[5]}),(0,a.bF)(p,{value:"inactive"},{default:(0,a.k6)(()=>e[6]||(e[6]=[(0,a.eW)(" Архив ")])),_:1,__:[6]})]),_:1},8,["modelValue"]),"active"==d.promoType?((0,a.uX)(),(0,a.Wv)(k,{key:0},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.compPromoList,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.promo_id},[(0,a.bF)(b,{lines:"none"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{slot:"start",icon:u.giftOutline,color:"primary"},null,8,["icon"]),(0,a.bF)(_,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,n.v_)(e.promo_name)+" ",1),(0,a.Lk)("p",i,"мин. заказ "+(0,n.v_)(e.min_order_sum_product)+(0,n.v_)(t.$heap.state.currencySign)+"; до "+(0,n.v_)(e.expiration),1)]),_:2},1024),(0,a.bF)(_,{slot:"end",color:"success"},{default:(0,a.k6)(()=>[(0,a.Lk)("b",null,(0,n.v_)(e.promo_value)+(0,n.v_)(t.$heap.state.currencySign),1)]),_:2},1024)]),_:2},1024)]))),128))]),_:1})):(0,a.Q3)("",!0),"inactive"==d.promoType?((0,a.uX)(),(0,a.Wv)(k,{key:1},{default:(0,a.k6)(()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.compPromoList,o=>((0,a.uX)(),(0,a.CE)("div",{key:o.promo_id},[(0,a.bF)(b,{lines:"none"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{slot:"start",icon:u.giftOutline,color:"medium"},null,8,["icon"]),(0,a.bF)(_,null,{default:(0,a.k6)(()=>[(0,a.eW)((0,n.v_)(o.promo_name)+" до "+(0,n.v_)(o.exp_date_time),1)]),_:2},1024),(0,a.bF)(_,{slot:"end"},{default:(0,a.k6)(()=>[(0,a.Lk)("b",null,(0,n.v_)(o.promo_value)+(0,n.v_)(t.$heap.state.currencySign),1)]),_:2},1024)]),_:2},1024),(0,a.bF)(b,null,{default:(0,a.k6)(()=>[1==o.is_expired?((0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(_,{color:"danger"},{default:(0,a.k6)(()=>e[7]||(e[7]=[(0,a.eW)("просрочена")])),_:1,__:[7]})])):1==o.is_disabled?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.bF)(_,{color:"warning",style:{cursor:"pointer"},onClick:e[2]||(e[2]=t=>c.helpNotActive())},{default:(0,a.k6)(()=>e[8]||(e[8]=[(0,a.eW)("не активирована")])),_:1,__:[8]}),(0,a.bF)(m,{color:"warning",icon:u.helpCircle,onClick:e[3]||(e[3]=t=>c.helpNotActive()),style:{cursor:"pointer"}},null,8,["icon"])])):(0,a.Q3)("",!0),o.promo_order_id?((0,a.uX)(),(0,a.Wv)(_,{key:2},{default:(0,a.k6)(()=>[(0,a.eW)("использована в заказе #"+(0,n.v_)(o.promo_order_id),1)]),_:2},1024)):(0,a.Q3)("",!0)]),_:2},1024)]))),128))]),_:1})):(0,a.Q3)("",!0),null==d.promoList?((0,a.uX)(),(0,a.Wv)(k,{key:2},{default:(0,a.k6)(()=>[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([1,2,3],t=>(0,a.Lk)("div",{key:t},[(0,a.bF)(b,{lines:"none"},{default:(0,a.k6)(()=>[(0,a.bF)(m,{slot:"start",icon:u.giftOutline,color:"medium"},null,8,["icon"]),(0,a.bF)(g,{style:{width:"70%"}}),(0,a.bF)(g,{slot:"end",style:{width:"50px"}})]),_:1}),(0,a.bF)(b,null,{default:(0,a.k6)(()=>[(0,a.bF)(g,{style:{width:"70%"}})]),_:1})])),64))]),_:1})):(0,a.Q3)("",!0),"bonuses"==d.promoType?((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(v)])):(0,a.Q3)("",!0)]),_:1})}o(4114);var d=o(5634),c=o(5480),p=o(2311),h=o.n(p),m=o(962);const _={class:"promo-total"},b={class:"promo-value"},k={slot:"start"},g={key:0};function v(t,e,o,i,s,l){const r=(0,a.g2)("ion-label"),u=(0,a.g2)("ion-item"),d=(0,a.g2)("ion-accordion"),c=(0,a.g2)("ion-accordion-group"),p=(0,a.g2)("statistics-card"),h=(0,a.g2)("ion-col"),m=(0,a.g2)("ion-row"),v=(0,a.g2)("ion-grid");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",null,[(0,a.Lk)("div",_,[e[1]||(e[1]=(0,a.Lk)("div",{class:"promo-text"},[(0,a.Lk)("h4",null,"Мои бонусы"),(0,a.Lk)("p",null,"Доступные к использованию")],-1)),(0,a.Lk)("div",b,[(0,a.Lk)("h2",k,(0,n.v_)(s.bonusTotal),1),e[0]||(e[0]=(0,a.Lk)("img",{src:"/img/crystal.png",width:"25px"},null,-1))])])]),(0,a.bF)(c,null,{default:(0,a.k6)(()=>[(0,a.bF)(d,{value:"first"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{slot:"header",color:"light"},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>e[2]||(e[2]=[(0,a.eW)("Как "),(0,a.Lk)("b",null,"получить",-1),(0,a.eW)(" бонусы?")])),_:1,__:[2]})]),_:1}),e[3]||(e[3]=(0,a.Lk)("div",{class:"ion-padding",slot:"content",style:{color:"#666"}},[(0,a.Lk)("p",null,[(0,a.eW)(" При "),(0,a.Lk)("b",null,"покупке"),(0,a.eW)(" товаров со значком изумруда "),(0,a.Lk)("span",null,[(0,a.Lk)("img",{class:"bonus-chip",src:"/img/crystal.png",width:"14px"})]),(0,a.eW)(", вы получаете на свой счёт соответствующее количество бонусов. ")]),(0,a.Lk)("p",null," Бонусы действуют 6 месяцев. ")],-1))]),_:1,__:[3]}),(0,a.bF)(d,{value:"second"},{default:(0,a.k6)(()=>[(0,a.bF)(u,{slot:"header",color:"light"},{default:(0,a.k6)(()=>[(0,a.bF)(r,null,{default:(0,a.k6)(()=>e[4]||(e[4]=[(0,a.eW)("Как "),(0,a.Lk)("b",null,"потратить",-1),(0,a.eW)(" бонусы?")])),_:1,__:[4]})]),_:1}),e[5]||(e[5]=(0,a.Lk)("div",{class:"ion-padding",slot:"content",style:{color:"#666"}},[(0,a.Lk)("p",null,[(0,a.eW)(" Вы можете "),(0,a.Lk)("b",null,"потратить"),(0,a.eW)(" бонусы на реальные покупки. При этом "),(0,a.Lk)("b",null,"1 изумруд = 1 рубль"),(0,a.eW)(". ")]),(0,a.Lk)("p",null,[(0,a.eW)(" Так вы можете оплатить до "),(0,a.Lk)("b",null,"100%"),(0,a.eW)(" следующего заказа! Товары, со значком изумруда "),(0,a.Lk)("span",null,[(0,a.Lk)("img",{class:"bonus-chip",src:"/img/crystal.png",width:"14px"})]),(0,a.eW)(", можно купить по цене до 1 рубля. ")])],-1))]),_:1,__:[5]})]),_:1}),s.dataset.bonus_gained||s.dataset.bonus_spent?((0,a.uX)(),(0,a.CE)("div",g,[e[6]||(e[6]=(0,a.Lk)("div",{class:"ion-padding-horizontal"},[(0,a.Lk)("h5",null,"Статистика бонусов"),(0,a.Lk)("p",{style:{"margin-top":"0"}},"За последние 30 дней")],-1)),(0,a.bF)(v,null,{default:(0,a.k6)(()=>[(0,a.bF)(m,null,{default:(0,a.k6)(()=>[(0,a.bF)(h,{size:"12","size-sm":"4"},{default:(0,a.k6)(()=>[s.dataset.bonus_gained?((0,a.uX)(),(0,a.Wv)(p,{key:0,label:"Заработано",data:s.dataset.bonus_gained,format:"integer",color:"#008FFB",dates:s.statisticsDates},null,8,["data","dates"])):(0,a.Q3)("",!0)]),_:1}),(0,a.bF)(h,{size:"12","size-sm":"4"},{default:(0,a.k6)(()=>[s.dataset.bonus_spent?((0,a.uX)(),(0,a.Wv)(p,{key:0,label:"Потрачено",data:s.dataset.bonus_spent,format:"integer",color:"#04e398",dates:s.statisticsDates},null,8,["data","dates"])):(0,a.Q3)("",!0)]),_:1})]),_:1})]),_:1})])):(0,a.Q3)("",!0)],64)}var f=o(8384),y={components:{IonAccordionGroup:d.YH,IonAccordion:d.xk,IonLabel:d.he,IonChip:d.ZB,IonItem:d.uz,IonGrid:d.lO,IonRow:d.ln,IonCol:d.hU,IonText:d.IO,StatisticsCard:f.A},setup(){return{timeOutline:c.CVk,searchOutline:c.jBE}},data(){return{dataset:{},bonusTotal:0,statisticsDates:[]}},computed:{},methods:{async listGet(){try{const t={user_id:this.$heap.state.user.user_id,point_span:3,point_num:10},e=await h().post(`${this.$heap.state.hostname}Statistics/bonusParametersGet`,t);e.body.reverse(),this.bonusTotal=e.head.bonus_total??0,this.statisticsDates=this.parseDates(e),this.parseStatisticResponse(e),console.log(this.dataset)}catch{}},parseStatisticResponse(t){const e={bonus_gained:!0,bonus_spent:!0};for(var o in e){let e={[o]:{value:0,series:[]}};for(var a in t.body)t.body[a][o]&&(e[o].series.push(t.body[a][o]),e[o].value+=1*t.body[a][o]);e[o].series.length&&(this.dataset=e)}},parseDates(t){let e=[];for(var o in t.body)e.unshift(t.body[o].point_finish);return e}},mounted(){this.listGet()},activated(){this.listGet()}},F=o(6262);const L=(0,F.A)(y,[["render",v],["__scopeId","data-v-ec9c5372"]]);var I=L,C={components:{IonIcon:d.iq,IonTitle:d.BC,IonList:d.nf,IonItem:d.uz,IonText:d.IO,IonSegment:d.Gp,IonSegmentButton:d.eP,IonCard:d.b_,IonCardHeader:d.ME,IonCardTitle:d.tN,IonCardContent:d.I9,IonButton:d.Jm,IonSkeletonText:d.ds,IonAccordion:d.xk,IonAccordionGroup:d.YH,PromoStatistics:I},setup(){return{giftOutline:c.Lsq,closeOutline:c.xfX,banOutline:c.Av6,helpCircle:c.MGW,arrowRedoOutline:c.Kgq}},data(){return{promoType:"bonuses",promoList:null}},mounted(){this.listGet()},computed:{compPromoList(){let t=[];if(this.promoList)for(let e of this.promoList)e.exp_date_time=this.toLocDate(e.expired_at),e.date_time=this.toLocDate(e.created_at),t.push(e);return t}},methods:{async listGet(){try{this.promoList=[];const t={user_id:this.$heap.state.user.user_id,type:this.promoType};this.promoList=await h().post(`${this.$heap.state.hostname}Promo/listGet`,t)}catch{}},listTypeChanged(t){const e=t.target.value;this.listGet(e)},toLocDate(t){const e=new Date(Date.parse(t)),o={month:"short",day:"numeric",year:"numeric"};return e.toLocaleDateString(void 0,o)},async shareInvitation(){try{const t=this.$heap.state.settings.app_title,e="Присоединяйтесь и получите 5 сертификатов по 200руб",o=await m.S.canShare(),a=`${this.$heap.getters.settings.app.frontendUrl}invitation.html?inviter_user_id=${this.$heap.state.user.user_id}`;o?await m.S.share({title:t,text:e,url:a,dialogTitle:t}):navigator.clipboard?(await navigator.clipboard.writeText(a),this.$alert("Теперь вы можете поделиться ей с друзьями в социальных сетях или мессенджерах.","Ссылка на страницу скопирована")):this.$alert("Устройство не поддерживает функцию поделиться","")}catch(t){}},helpNotActive(){this.$alert("Эта скидка будет активирована, когда приглашённый вами друг воспользуется начисленной ему скидкой. Не забудьте напомнить😉")}}};const x=(0,F.A)(C,[["render",u]]);var w=x}}]);
//# sourceMappingURL=9655.7e27d044.js.map