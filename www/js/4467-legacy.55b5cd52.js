"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[4467],{1817:function(e,t,o){var n=o(2109),i=o(9781),s=o(7854),r=o(1702),l=o(2597),a=o(614),u=o(7976),c=o(1340),d=o(3070).f,m=o(9920),p=s.Symbol,_=p&&p.prototype;if(i&&a(p)&&(!("description"in _)||void 0!==p().description)){var w={},g=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:c(arguments[0]),t=u(_,this)?new p(e):void 0===e?p():p(e);return""===e&&(w[t]=!0),t};m(g,p),g.prototype=_,_.constructor=g;var h="Symbol(test)"==String(p("test")),f=r(_.toString),k=r(_.valueOf),y=/^Symbol\((.*)\)[^)]+$/,v=r("".replace),I=r("".slice);d(_,"description",{configurable:!0,get:function(){var e=k(this),t=f(e);if(l(w,e))return"";var o=h?I(t,7,-1):v(t,y,"$1");return""===o?void 0:o}}),n({global:!0,constructor:!0,forced:!0},{Symbol:g})}},4405:function(e,t,o){o(4916),o(5306);var n=o(2008);const i={deliveryCalculate(e){if(!e.locations||!e.locations[0]||!e.locations[0].distance)return null;const t=e.locations[0].distance,o=e.store_time_preparation||0;return i.deliveryTimeCalculate(t,o)},deliveryTimeCalculate(e,t){var o;t=parseInt(null!==(o=t)&&void 0!==o?o:n.Z.getters.settings.delivery.timePreparationDefault);const i=parseInt(n.Z.getters.settings.delivery.timeDelta),s=parseInt(n.Z.getters.settings.delivery.speed),r=5*Math.round(e/s*60/5)+t,l=r>i?r-i:r,a=l+i;return{time:r,timeMin:l,timeMax:a}},render(e,t){for(let o in t)e=e.replace(`{{${o}}}`,t[o]);return e=e.replace(/{{\.}}/,"-"),e}};t["Z"]=i},6181:function(e,t,o){o.d(t,{Z:function(){return y}});var n=o(6252),i=o(3577);const s=(0,n.Uk)(" ◉ "),r={key:0},l=(0,n.Uk)(" ◉ "),a=(0,n.Uk)("Временно не работает"),u={key:1},c=(0,n.Uk)(" ◉ "),d={key:2},m=(0,n.Uk)(" ◉ "),p=(0,n.Uk)("Закрыт");function _(e,t,o,_,w,g){const h=(0,n.up)("ion-text"),f=(0,n.up)("ion-chip");return 1==o.storeItem.is_opened?((0,n.wg)(),(0,n.j4)(f,{key:0,color:"medium"},{default:(0,n.w5)((()=>[(0,n._)("label",null,[(0,n.Wm)(h,{color:"success"},{default:(0,n.w5)((()=>[s])),_:1}),(0,n.Uk)("Открыт до "+(0,i.zw)(o.storeItem.store_time_closes)+":00",1)])])),_:1})):((0,n.wg)(),(0,n.j4)(f,{key:1,color:"medium"},{default:(0,n.w5)((()=>[0==o.storeItem.is_working?((0,n.wg)(),(0,n.iD)("label",r,[(0,n.Wm)(h,{color:"medium"},{default:(0,n.w5)((()=>[l])),_:1}),a])):o.storeItem.store_next_time_opens>0?((0,n.wg)(),(0,n.iD)("label",u,[(0,n.Wm)(h,{color:"danger"},{default:(0,n.w5)((()=>[c])),_:1}),(0,n.Uk)("Закрыт до "+(0,i.zw)(o.storeItem.store_next_time_opens)+":00",1)])):((0,n.wg)(),(0,n.iD)("label",d,[(0,n.Wm)(h,{color:"danger"},{default:(0,n.w5)((()=>[m])),_:1}),p]))])),_:1}))}var w=o(8292),g=o(8903),h={props:["storeItem"],components:{IonChip:w.hM,IonText:w.yW},setup(){return{ellipse:g.Hpm}}},f=o(3744);const k=(0,f.Z)(h,[["render",_]]);var y=k},2692:function(e,t,o){o.d(t,{Z:function(){return f}});var n=o(6252),i=o(3577);const s=(0,n.Uk)("Адрес доставки заказа");function r(e,t,o,r,l,a){const u=(0,n.up)("ion-icon"),c=(0,n.up)("ion-text"),d=(0,n.up)("ion-item"),m=(0,n.up)("ion-list"),p=(0,n.up)("ion-textarea");return(0,n.wg)(),(0,n.iD)(n.HY,null,[a.isMainLocationSet?((0,n.wg)(),(0,n.j4)(m,{key:0},{default:(0,n.w5)((()=>[(0,n.Wm)(d,{lines:"none",onClick:t[0]||(t[0]=e=>a.selectDeliveryAddress())},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{slot:"start",icon:r.chevronDownOutline},null,8,["icon"]),(0,n.Wm)(c,{color:"medium"},{default:(0,n.w5)((()=>[s])),_:1})])),_:1}),(0,n.Wm)(d,{lines:"none"},{default:(0,n.w5)((()=>[(0,n.Wm)(u,{slot:"start",color:"primary",icon:r.locationOutline},null,8,["icon"]),(0,n.Wm)(c,{color:"dark"},{default:(0,n.w5)((()=>{var t,o;return[(0,n.Uk)((0,i.zw)(null===(t=e.$heap.state.user)||void 0===t||null===(o=t.location_main)||void 0===o?void 0:o.location_address),1)]})),_:1})])),_:1})])),_:1})):(0,n.kq)("",!0),o.showComment&&e.$heap.state.user.location_main?((0,n.wg)(),(0,n.j4)(m,{key:1},{default:(0,n.w5)((()=>[(0,n.Wm)(d,null,{default:(0,n.w5)((()=>[(0,n.Wm)(p,{rows:"1",placeholder:"комментарий к адресу",onChange:t[1]||(t[1]=e=>a.locationCommentChanged()),modelValue:e.$heap.state.user.location_main.location_comment,"onUpdate:modelValue":t[2]||(t[2]=t=>e.$heap.state.user.location_main.location_comment=t)},null,8,["modelValue"])])),_:1})])),_:1})):(0,n.kq)("",!0)],64)}var l=o(8534),a=(o(8862),o(8292)),u=o(8903),c=o(2008),d=o(422),m=o(9042),p=o(9755),_=o.n(p),w={props:["deliveryTime","showComment"],components:{IonIcon:a.gu,IonTextarea:a.g2,IonText:a.yW,IonNote:a.uN,IonLabel:a.Q$,IonItem:a.Ie,IonList:a.q_},setup(){return{locationOutline:u.Iv7,chevronDownOutline:u.Y$3}},data(){return{location_main:c.Z.state.user.location_main}},created(){let e=this;m.Z.on("userMainLocationSet",(t=>{e.location_main=t})),m.Z.on("userGet",(t=>{e.location_main=t.location_main}))},methods:{selectDeliveryAddress(){d.Z.push("/user/user-addresses")},locationCommentChanged(){var e=this;return(0,l.Z)((function*(){const t={location_id:c.Z.state.user.location_main.location_id,location_comment:c.Z.state.user.location_main.location_comment};_().post(e.$heap.state.hostname+"Location/itemUpdate",JSON.stringify(t))}))()}},computed:{isSignedIn(){return c.Z.state.user.user_id&&c.Z.state.user.user_id>-1},isMainLocationSet(){return this.location_main?1:0}}},g=o(3744);const h=(0,g.Z)(w,[["render",r],["__scopeId","data-v-1cc119ea"]]);var f=h},4467:function(e,t,o){o.r(t),o.d(t,{default:function(){return F}});var n=o(6252);function i(e,t,o,i,s,r){const l=(0,n.up)("home-slider"),a=(0,n.up)("user-address-widget"),u=(0,n.up)("geo-permission-comp"),c=(0,n.up)("store-list"),d=(0,n.up)("base-layout");return(0,n.wg)(),(0,n.j4)(d,{pageLogo:i.mainLogo},{default:(0,n.w5)((()=>[(0,n.Wm)(l),(0,n.Wm)(a,{deliveryTime:s.primaryDeliveryTime},null,8,["deliveryTime"]),(0,n.Wm)(u),(0,n.Wm)(c,{ref:"homeStoreList"},null,512)])),_:1},8,["pageLogo"])}o(1817);var s=o(3577);const r={class:"home_slide"},l={style:{"font-size":"3em"}};function a(e,t,o,i,a,u){const c=(0,n.up)("ion-img"),d=(0,n.up)("swiper-slide"),m=(0,n.up)("swiper");return(0,n.wg)(),(0,n.j4)(m,{modules:e.modules,autoplay:{delay:6e3,disableOnInteraction:!1},loop:!0,class:"home-swiper"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.home_slides,(e=>((0,n.wg)(),(0,n.j4)(d,{key:e.title,style:(0,s.j5)(`background-color:${e.color};`)},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{src:e.image,class:"home_slide_img",alt:e.alt},null,8,["src","alt"]),(0,n._)("div",r,[(0,n._)("h1",l,(0,s.zw)(e.title),1),(0,n._)("p",null,(0,s.zw)(e.description),1)])])),_:2},1032,["style"])))),128))])),_:1},8,["modules"])}var u=o(9755),c=o.n(u),d=o(702),m=o(3181),p=o(8292),_=(0,n.aZ)({components:{Swiper:m.t,SwiperSlide:m.o,IonImg:p.Xz},setup(){return{modules:[d.pt]}},data(){return{home_slides:[],error:""}},created(){this.getSlideList()},methods:{getSlideList(){var e=this;c().get("/assets/homeslider/conf.json").done((function(t){e.home_slides=t.slides})).fail((function(t){e.error=t.responseJSON.messages.error}))}}}),w=o(3744);const g=(0,w.Z)(_,[["render",a],["__scopeId","data-v-40079abe"]]);var h=g;const f=e=>((0,n.dD)("data-v-41a6a411"),e=e(),(0,n.Cn)(),e),k=f((()=>(0,n._)("div",{class:"crop-to-fit",style:{"background-color":"var(--ion-color-light)"}},null,-1))),y=(0,n.Uk)("Вне зоны обслуживания"),v=(0,n.Uk)(" Поблизости к адресу "),I=(0,n.Uk)(", который вы выбрали, пока нет нет подходящих ресторанов и магазинов. Попробуйте другой адрес. "),W=f((()=>(0,n._)("h5",{class:"section-title"},"Магазины и рестораны",-1))),Z={class:"crop-to-fit"},C={class:"perk-title"},b={class:"perk-label"};function L(e,t,o,i,r,l){const a=(0,n.up)("ion-skeleton-text"),u=(0,n.up)("ion-chip"),c=(0,n.up)("ion-item"),d=(0,n.up)("ion-card"),m=(0,n.up)("ion-list"),p=(0,n.up)("ion-card-title"),_=(0,n.up)("ion-card-header"),w=(0,n.up)("ion-card-content"),g=(0,n.up)("ion-col"),h=(0,n.up)("ion-icon"),f=(0,n.up)("ion-row"),L=(0,n.up)("ion-grid"),j=(0,n.up)("ion-img"),S=(0,n.up)("router-link"),z=(0,n.up)("store-opened-indicator"),D=(0,n.up)("swiper-slide"),$=(0,n.up)("swiper");return(0,n.wg)(),(0,n.iD)(n.HY,null,[r.storeList?0==r.storeList.length?((0,n.wg)(),(0,n.j4)(d,{key:1,color:"warning"},{default:(0,n.w5)((()=>[(0,n.Wm)(_,null,{default:(0,n.w5)((()=>[(0,n.Wm)(p,null,{default:(0,n.w5)((()=>[y])),_:1})])),_:1}),(0,n.Wm)(w,null,{default:(0,n.w5)((()=>{var t;return[v,(0,n._)("b",null,(0,s.zw)(null!==(t=e.$heap.state.user.location_main.location_address)&&void 0!==t?t:"доставки заказа"),1),I]})),_:1})])),_:1})):(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(m,{key:0,class:"store-list"},{default:(0,n.w5)((()=>[((0,n.wg)(),(0,n.iD)(n.HY,null,(0,n.Ko)([1,1,1,1],(e=>(0,n.Wm)(d,{button:"",key:e},{default:(0,n.w5)((()=>[k,(0,n.Wm)(u,{color:"medium"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{style:{width:"130px"},animated:""})])),_:1}),(0,n.Wm)(u,{color:"primary"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{style:{width:"100px"},animated:""})])),_:1}),(0,n.Wm)(c,{lines:"none"},{default:(0,n.w5)((()=>[(0,n.Wm)(a,{style:{width:"70%",height:"1.5em"},animated:""})])),_:1})])),_:2},1024))),64))])),_:1})),r.storeList&&r.storeList.length>0?((0,n.wg)(),(0,n.j4)(L,{key:2,class:"ion-justify-content-between ion-align-items-center",style:{padding:"0 16px"}},{default:(0,n.w5)((()=>[(0,n.Wm)(f,null,{default:(0,n.w5)((()=>[(0,n.Wm)(g,{size:"10"},{default:(0,n.w5)((()=>[W])),_:1}),(0,n.Wm)(g,{size:"2",class:"ion-align-self-end"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{style:{"font-size":"20px"},icon:i.searchOutline},null,8,["icon"])])),_:1})])),_:1})])),_:1})):(0,n.kq)("",!0),r.storeList&&r.storeList.length>0?((0,n.wg)(),(0,n.j4)(m,{key:3,class:"store-list"},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(r.storeList,((t,o)=>((0,n.wg)(),(0,n.j4)(d,{style:{position:"relative"},key:t.store_id,class:(0,s.C_)(0==t.is_opened?"closed":"")},{default:(0,n.w5)((()=>[(0,n.Wm)(S,{to:`/catalog/store-${t.store_id}`},{default:(0,n.w5)((()=>[(0,n._)("div",Z,[t.image_hash?((0,n.wg)(),(0,n.j4)(j,{key:0,src:e.$heap.state.hostname+"/image/get.php/"+t.image_hash+".500.500.webp"},null,8,["src"])):(0,n.kq)("",!0)])])),_:2},1032,["to"]),l.store_perks[o].length>0?((0,n.wg)(),(0,n.iD)("div",{key:0,class:"perk-row",style:(0,s.j5)(`width:${50*l.store_perks[o].length}px`)},[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.store_perks[o],(t=>((0,n.wg)(),(0,n.iD)("span",{key:t.image_hash,class:"perk"},[t.image_hash?((0,n.wg)(),(0,n.j4)(j,{key:0,src:""+(e.$heap.state.hostname+"/image/get.php/"+t.image_hash+".80.80.png")},null,8,["src"])):((0,n.wg)(),(0,n.j4)(j,{key:1,src:`/img/perks/${t.image_url}`},null,8,["src"]))])))),128))],4)):(0,n.kq)("",!0),(0,n.Wm)(S,{to:`/catalog/store-${t.store_id}`,style:{"text-decoration":"none"}},{default:(0,n.w5)((()=>[(0,n.Wm)(c,{lines:"none",class:"store-title"},{default:(0,n.w5)((()=>[(0,n._)("b",null,(0,s.zw)(t.store_name),1)])),_:2},1024),(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Wm)(f,{class:"ion-justify-content-between"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{size:"auto"},{default:(0,n.w5)((()=>[(0,n.Wm)(z,{storeItem:t},null,8,["storeItem"])])),_:2},1024),(0,n.Wm)(g,{size:"auto"},{default:(0,n.w5)((()=>[t.deliveryTime.timeMin?((0,n.wg)(),(0,n.j4)(u,{key:0,color:"medium",background:"transparent"},{default:(0,n.w5)((()=>[(0,n.Wm)(h,{icon:i.timeOutline},null,8,["icon"]),(0,n._)("label",null,(0,s.zw)(t.deliveryTime.timeMin)+"-"+(0,s.zw)(t.deliveryTime.timeMax)+"мин",1)])),_:2},1024)):(0,n.kq)("",!0)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["to"]),l.store_perks_slider[o].length>0?((0,n.wg)(),(0,n.j4)($,{key:1,class:"perk-slider",modules:i.modules,speed:400,slidesPerView:1,navigation:!0},{default:(0,n.w5)((()=>[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.store_perks_slider[o],((t,o)=>((0,n.wg)(),(0,n.j4)(D,{key:o},{default:(0,n.w5)((()=>[(0,n.Wm)(L,null,{default:(0,n.w5)((()=>[(0,n.Wm)(f,{class:"ion-justify-content-around ion-align-items-center"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{size:"3"},{default:(0,n.w5)((()=>[t.image_hash?((0,n.wg)(),(0,n.j4)(j,{key:0,class:"perk-image",src:""+(e.$heap.state.hostname+"/image/get.php/"+t.image_hash+".100.100.webp")},null,8,["src"])):(0,n.kq)("",!0)])),_:2},1024),(0,n.Wm)(g,{size:"7"},{default:(0,n.w5)((()=>[(0,n._)("b",C,(0,s.zw)(t.perk_title),1)])),_:2},1024),(0,n.Wm)(g,{size:"2"},{default:(0,n.w5)((()=>[(0,n._)("b",b,(0,s.zw)(t.perk_label),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1032,["modules"])):(0,n.kq)("",!0)])),_:2},1032,["class"])))),128))])),_:1})):(0,n.kq)("",!0)],64)}var j=o(8534),S=o(8903),z=o(2008),D=o(4405),$=o(6181),x={components:{IonList:p.q_,IonImg:p.Xz,IonChip:p.hM,IonGrid:p.jY,IonRow:p.Nd,IonCol:p.wI,IonItem:p.Ie,IonCard:p.PM,IonIcon:p.gu,IonCardHeader:p.Zi,IonCardTitle:p.Dq,IonCardContent:p.FN,IonSkeletonText:p.CK,Swiper:m.t,SwiperSlide:m.o,StoreOpenedIndicator:$.Z},setup(){return{modules:[d.pt,d.W_],timeOutline:S.bdY,searchOutline:S.W6I}},data(){return{storeList:null,can_reload_at:0}},computed:{store_perks(){return this.storeList.map((function(e){return e.perks.filter((e=>"perk"==e.slot))}))},store_perks_slider(){return this.storeList.map((function(e){return e.perks.filter((e=>"slider"==e.slot))}))}},methods:{listGet(){var e=this;return(0,j.Z)((function*(){var t=z.Z.state.user.location_main;if(!t)return;const o=Date.now();if(!(e.can_reload_at>o)){e.can_reload_at=o+2e3;try{const o=yield c().post(z.Z.state.hostname+"Store/listNearGet",{location_id:t.location_id});e.storeList=e.storeListCalculate(o)}catch(n){}}}))()},storeListCalculate(e){for(let t in e)e[t].deliveryTime=D.Z.deliveryTimeCalculate(e[t].distance,e[t].store_time_preparation);return e}},mounted(){this.$topic.on("userGet",(()=>{this.listGet()})),this.$topic.on("userMainLocationSet",(e=>{this.can_reload_at=0,this.listGet()})),this.listGet()}};const U=(0,w.Z)(x,[["render",L],["__scopeId","data-v-41a6a411"]]);var O=U,T=o(2692);const q=(0,n.Uk)(" Используется адрес по умолчанию "),M=(0,n.Uk)("Искать около меня"),G=(0,n.Uk)(" Используется адрес по умолчанию. Вы блокировали доступ к местоположению ");function Y(e,t,o,i,s,r){const l=(0,n.up)("ion-icon"),a=(0,n.up)("ion-text"),u=(0,n.up)("ion-button"),c=(0,n.up)("ion-item"),d=(0,n.up)("ion-list");return(0,n.wg)(),(0,n.j4)(d,null,{default:(0,n.w5)((()=>["prompt"==s.permission?((0,n.wg)(),(0,n.j4)(c,{key:0,lines:"none"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{src:i.warningOutline,color:"warning",slot:"start"},null,8,["src"]),(0,n.Wm)(a,null,{default:(0,n.w5)((()=>[q])),_:1}),(0,n.Wm)(u,{onClick:t[0]||(t[0]=e=>r.locate())},{default:(0,n.w5)((()=>[M])),_:1})])),_:1})):(0,n.kq)("",!0),"denied"==s.permission?((0,n.wg)(),(0,n.j4)(c,{key:1,lines:"none"},{default:(0,n.w5)((()=>[(0,n.Wm)(l,{src:i.warningOutline,color:"danger",slot:"start"},null,8,["src"]),(0,n.Wm)(a,null,{default:(0,n.w5)((()=>[G])),_:1})])),_:1})):(0,n.kq)("",!0)])),_:1})}var H=o(351),N={components:{IonButton:p.YG,IonCard:p.PM,IonCardContent:p.FN,IonIcon:p.gu,IonItem:p.Ie,IonText:p.yW,IonList:p.q_},setup(){return{locationOutline:S.Iv7,warningOutline:S.OoB}},data(){return{permission:"notsupported"}},mounted(){var e=this;return(0,j.Z)((function*(){e.check()}))()},methods:{locate(){var e=this;return(0,j.Z)((function*(){if(e.check(),"granted"!=e.permission)if("denied"!=e.permission){try{const t=yield H.Z.geo.get(),o={location_latitude:t.coords.latitude,location_longitude:t.coords.longitude,location_address:"Текущее местоположение",timestamp:t.timestamp};e.$heap.commit("setUserCurrentLocation",o)}catch(t){}e.check()}else e.$flash("Вы блокировали доступ к местоположению");else H.Z.geo.trackingStart()}))()},check(){var e=this;return(0,j.Z)((function*(){e.permission=yield H.Z.geo.permissionCheck()}))()}}};const K=(0,w.Z)(N,[["render",Y]]);var P=K,V=o(94),A={setup(){return{mainLogo:V}},components:{HomeSlider:h,StoreList:O,UserAddressWidget:T.Z,GeoPermissionComp:P},data(){return{primaryDeliveryTime:null}},ionViewDidEnter(){this.$refs.homeStoreList.listGet()}};const B=(0,w.Z)(A,[["render",i]]);var F=B}}]);
//# sourceMappingURL=4467-legacy.55b5cd52.js.map