"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[2515],{4480:function(t,e,r){var n=r(2109),u=r(2092).filter,o=r(1194),i=o("filter");n({target:"Array",proto:!0,forced:!i},{filter:function(t){return u(this,t,arguments.length>1?arguments[1]:void 0)}})},3123:function(t,e,r){var n=r(2104),u=r(6916),o=r(1702),i=r(7007),c=r(7850),l=r(9670),a=r(4488),d=r(6707),p=r(1530),s=r(7466),m=r(1340),_=r(8173),f=r(1589),h=r(7651),w=r(2261),k=r(2999),v=r(7293),g=k.UNSUPPORTED_Y,I=4294967295,W=Math.min,y=[].push,b=o(/./.exec),U=o(y),x=o("".slice),Z=!v((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));i("split",(function(t,e,r){var o;return o="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,r){var o=m(a(this)),i=void 0===r?I:r>>>0;if(0===i)return[];if(void 0===t)return[o];if(!c(t))return u(e,o,t,i);var l,d,p,s=[],_=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,k=new RegExp(t.source,_+"g");while(l=u(w,k,o)){if(d=k.lastIndex,d>h&&(U(s,x(o,h,l.index)),l.length>1&&l.index<o.length&&n(y,s,f(l,1)),p=l[0].length,h=d,s.length>=i))break;k.lastIndex===l.index&&k.lastIndex++}return h===o.length?!p&&b(k,"")||U(s,""):U(s,x(o,h)),s.length>i?f(s,0,i):s}:"0".split(void 0,0).length?function(t,r){return void 0===t&&0===r?[]:u(e,this,t,r)}:e,[function(e,r){var n=a(this),i=void 0==e?void 0:_(e,t);return i?u(i,e,n,r):u(o,m(n),e,r)},function(t,n){var u=l(this),i=m(t),c=r(o,u,i,n,o!==e);if(c.done)return c.value;var a=d(u,RegExp),_=u.unicode,f=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(g?"g":"y"),w=new a(g?"^(?:"+u.source+")":u,f),k=void 0===n?I:n>>>0;if(0===k)return[];if(0===i.length)return null===h(w,i)?[i]:[];var v=0,y=0,b=[];while(y<i.length){w.lastIndex=g?0:y;var Z,V=h(w,g?x(i,y):i);if(null===V||(Z=W(s(w.lastIndex+(g?y:0)),i.length))===v)y=p(i,y,_);else{if(U(b,x(i,v,y)),b.length===k)return b;for(var C=1;C<=V.length-1;C++)if(U(b,V[C]),b.length===k)return b;y=v=Z}}return U(b,x(i,v)),b}]}),!Z,g)},6175:function(t,e,r){r.r(e),r.d(e,{default:function(){return vt}});r(4916),r(5306);var n=r(6252),u=r(3577),o=function(t){return(0,n.dD)("data-v-43fd9045"),t=t(),(0,n.Cn)(),t},i={key:0},c={key:0},l=(0,n.Uk)("Обратите внимание на то, что поля "),a=o((function(){return(0,n._)("ul",null,[(0,n._)("li",null,"Название (больше 5 букв), "),(0,n._)("li",null,"Цена, "),(0,n._)("li",null,"Актуальный остаток (если ведется учет), "),(0,n._)("li",null,"Изображения товара")],-1)})),d=(0,n.Uk)(" обязательные "),p=[l,a,d],s=(0,n.Uk)(" Удалено "),m=(0,n.Uk)(" Отключено "),_=(0,n.Uk)(" Вести учет остатков "),f=(0,n.Uk)(" Имеет варианты "),h=(0,n.Uk)(" Родительский товар "),w=(0,n.Uk)("Вариант*"),k={style:{display:"grid","grid-template-columns":"1fr 1fr"}},v=(0,n.Uk)("Вариант*"),g=(0,n.Uk)("добавить"),I={key:2},W=(0,n.Uk)(" Показать товар "),y=(0,n.Uk)(" Показать в магазине "),b=(0,n.Uk)(" Управление магазином "),U=(0,n.Uk)("Основные настройки"),x=(0,n.Uk)("Название*"),Z=(0,n.Uk)("Описание*"),V=(0,n.Uk)("Артикул"),C=(0,n.Uk)("Штрихкод"),G=(0,n.Uk)("Остаток "),O={key:0},D=(0,n.Uk)("Мин. заказ*"),$={key:0},q=(0,n.Uk)("Единица*"),L=(0,n.Uk)("штука"),P=(0,n.Uk)("порция вес"),j=(0,n.Uk)("порция объем"),z=(0,n.Uk)("килограмм"),S=(0,n.Uk)("метр"),F=(0,n.Uk)("литр"),M=(0,n.Uk)("Объем л*"),B=(0,n.Uk)("Цена"),T=(0,n.Uk)("Цена*"),H=(0,n.Uk)("Цена в меню/на полке"),Y=(0,n.Uk)("Цена акционная"),N=(0,n.Uk)("Начало акции"),A=(0,n.Uk)("Конец акции"),E=(0,n.Uk)("Изображения товара*"),J=(0,n.Uk)(" Добавить фото на витрину "),K=(0,n.Uk)("Категории товара*"),X=(0,n.Uk)("Без категории (в разделе 'Другое')"),Q=(0,n.Uk)("Добавить в категорию");function R(t,e,r,o,l,a){var d,R,tt=(0,n.up)("ion-progress-bar"),et=(0,n.up)("ion-card-title"),rt=(0,n.up)("ion-card-header"),nt=(0,n.up)("ion-text"),ut=(0,n.up)("ion-card-content"),ot=(0,n.up)("ion-card"),it=(0,n.up)("ion-icon"),ct=(0,n.up)("ion-toggle"),lt=(0,n.up)("ion-item"),at=(0,n.up)("ion-card-subtitle"),dt=(0,n.up)("ion-img"),pt=(0,n.up)("ion-label"),st=(0,n.up)("ion-input"),mt=(0,n.up)("ion-chip"),_t=(0,n.up)("ion-button"),ft=(0,n.up)("ion-item-divider"),ht=(0,n.up)("ion-list"),wt=(0,n.up)("ion-textarea"),kt=(0,n.up)("ion-select-option"),vt=(0,n.up)("ion-select"),gt=(0,n.up)("ion-item-group"),It=(0,n.up)("image-tile-comp"),Wt=(0,n.up)("base-layout");return(0,n.wg)(),(0,n.j4)(Wt,{"page-title":null!==(d=null===(R=l.productItem)||void 0===R?void 0:R.product_name)&&void 0!==d?d:"Товар",pageDefaultBackLink:"/catalog"},{default:(0,n.w5)((function(){var r,d;return[l.is_option_child?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",i,[(0,n.Wm)(ot,{color:(null===(r=l.productItem)||void 0===r?void 0:r.validity)<l.validity_min?"danger":""},{default:(0,n.w5)((function(){var t;return[(0,n.Wm)(rt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(et,null,{default:(0,n.w5)((function(){var t,e,r;return[(0,n.Uk)(" Форма заполнена на "+(0,u.zw)(null!==(t=null===(e=l.productItem)||void 0===e?void 0:e.validity)&&void 0!==t?t:0)+"% ",1),(0,n.Wm)(tt,{value:(null===(r=l.productItem)||void 0===r?void 0:r.validity)/100},null,8,["value"])]})),_:1})]})),_:1}),(null===(t=l.productItem)||void 0===t?void 0:t.validity)<l.validity_min?((0,n.wg)(),(0,n.j4)(ut,{key:0},{default:(0,n.w5)((function(){return[(0,n.Wm)(nt,null,{default:(0,n.w5)((function(){var t;return[(0,n.Uk)(" Вам необходимо заполнить анкету не меньше чем на "+(0,u.zw)(l.validity_min)+"% для рассмотрения модератором ",1),0==(null===(t=l.productItem)||void 0===t?void 0:t.validity)?((0,n.wg)(),(0,n.iD)("p",c,p)):(0,n.kq)("",!0)]})),_:1})]})),_:1})):(0,n.kq)("",!0)]})),_:1},8,["color"]),a.message&&(null===(d=l.productItem)||void 0===d?void 0:d.validity)>l.validity_min?((0,n.wg)(),(0,n.j4)(ot,{key:0},{default:(0,n.w5)((function(){return[(0,n.Wm)(ut,{class:(0,u.C_)(a.messageClass)},{default:(0,n.w5)((function(){return[(0,n.Wm)(nt,null,{default:(0,n.w5)((function(){return[(0,n.Uk)((0,u.zw)(a.message),1)]})),_:1})]})),_:1},8,["class"])]})),_:1})):(0,n.kq)("",!0)])),l.productItem?((0,n.wg)(),(0,n.j4)(ht,{key:1},{default:(0,n.w5)((function(){return[(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.trashOutline,color:"primary",slot:"start"},null,8,["src"]),s,(0,n.Wm)(ct,{slot:"end",modelValue:l.is_deleted,"onUpdate:modelValue":e[0]||(e[0]=function(t){return l.is_deleted=t}),color:"danger",onIonChange:e[1]||(e[1]=function(t){return a.itemDelete(t.target.checked?1:0)})},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.banOutline,color:"primary",slot:"start"},null,8,["src"]),m,(0,n.Wm)(ct,{slot:"end",modelValue:l.is_disabled,"onUpdate:modelValue":e[2]||(e[2]=function(t){return l.is_disabled=t}),onIonChange:e[3]||(e[3]=function(t){return a.itemDisable(t.target.checked?1:0)})},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.pizzaOutline,color:"primary",slot:"start"},null,8,["src"]),_,l.productItem?((0,n.wg)(),(0,n.j4)(ct,{key:0,slot:"end",modelValue:l.is_counted,"onUpdate:modelValue":e[4]||(e[4]=function(t){return l.is_counted=t}),onIonChange:e[5]||(e[5]=function(t){return a.save("is_counted",t.target.checked?1:0)})},null,8,["modelValue"])):(0,n.kq)("",!0)]})),_:1}),l.is_option_child?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(lt,{key:0},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.layersOutline,color:"primary",slot:"start"},null,8,["src"]),f,l.productItem?((0,n.wg)(),(0,n.j4)(ct,{key:0,slot:"end",modelValue:l.is_option_parent,"onUpdate:modelValue":e[6]||(e[6]=function(t){return l.is_option_parent=t}),onIonChange:e[7]||(e[7]=function(t){a.itemOptionSet(t.target.checked)})},null,8,["modelValue"])):(0,n.kq)("",!0)]})),_:1})),l.optionData?((0,n.wg)(),(0,n.iD)("div",{key:1,onChange:e[12]||(e[12]=function(){return a.saveForm&&a.saveForm.apply(a,arguments)})},[(0,n.Wm)(ot,{onClick:e[9]||(e[9]=function(e){return t.$router.replace(`product-edit-${l.optionData.parent.product_id}?refreshOptions=1`)}),color:l.productId==l.optionData.parent.product_id?"primary":"light"},{default:(0,n.w5)((function(){return[(0,n.Wm)(rt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(at,null,{default:(0,n.w5)((function(){return[h]})),_:1})]})),_:1}),(0,n.Wm)(ut,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(lt,{color:"light",lines:"none"},{default:(0,n.w5)((function(){return[(0,n.Wm)(dt,{slot:"start",style:{height:"70px"},src:`${t.$heap.state.hostname}image/get.php/${l.optionData.parent.image_hash}.70.70.webp`},null,8,["src"]),(0,n.Uk)(" "+(0,u.zw)(l.optionData.parent.product_name),1)]})),_:1}),l.productId==l.optionData.parent.product_id?((0,n.wg)(),(0,n.j4)(lt,{key:0,color:"light"},{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{position:"stacked"},{default:(0,n.w5)((function(){return[w]})),_:1}),(0,n.Wm)(st,{name:"product_option",modelValue:l.productItem.product_option,"onUpdate:modelValue":e[8]||(e[8]=function(t){return l.productItem.product_option=t})},null,8,["modelValue"])]})),_:1})):((0,n.wg)(),(0,n.j4)(lt,{key:1,lines:"none",color:"light"},{default:(0,n.w5)((function(){return[(0,n.Wm)(mt,null,{default:(0,n.w5)((function(){return[(0,n.Uk)("["+(0,u.zw)(l.optionData.parent.product_option)+"]",1)]})),_:1})]})),_:1}))]})),_:1})]})),_:1},8,["color"]),(0,n._)("div",k,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(l.optionData.children,(function(r){return(0,n.wg)(),(0,n.j4)(ot,{onClick:function(e){return t.$router.replace(`product-edit-${r.product_id}?refreshOptions=1`)},key:r.product_id,color:l.productItem.product_id==r.product_id?"primary":""},{default:(0,n.w5)((function(){return[(0,n.Wm)(ut,null,{default:(0,n.w5)((function(){return[l.productItem.product_id==r.product_id?((0,n.wg)(),(0,n.j4)(lt,{key:0,color:l.productItem.deleted_at?"danger":""},{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{position:"stacked"},{default:(0,n.w5)((function(){return[v]})),_:1}),(0,n.Wm)(st,{name:"product_option",modelValue:l.productItem.product_option,"onUpdate:modelValue":e[10]||(e[10]=function(t){return l.productItem.product_option=t})},null,8,["modelValue"])]})),_:1},8,["color"])):((0,n.wg)(),(0,n.j4)(lt,{key:1,lines:"none"},{default:(0,n.w5)((function(){return[(0,n.Wm)(mt,{color:r.deleted_at?"danger":""},{default:(0,n.w5)((function(){return[(0,n.Uk)("["+(0,u.zw)(r.product_option)+"]",1)]})),_:2},1032,["color"])]})),_:2},1024))]})),_:2},1024)]})),_:2},1032,["onClick","color"])})),128)),(0,n.Wm)(ot,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(ut,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(_t,{color:"light",expand:"block",onClick:e[11]||(e[11]=function(t){return a.itemOptionCreate()})},{default:(0,n.w5)((function(){return[g]})),_:1})]})),_:1})]})),_:1})])],32)):(0,n.kq)("",!0),l.is_option_child?(0,n.kq)("",!0):((0,n.wg)(),(0,n.iD)("div",I,[(0,n.Wm)(ft),(0,n.Wm)(lt,{button:"",onClick:e[13]||(e[13]=function(e){return t.$router.push("product-"+l.productItem.product_id)})},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.chevronBack,slot:"start"},null,8,["src"]),W]})),_:1}),(0,n.Wm)(lt,{button:"",onClick:e[14]||(e[14]=function(t){return a.showProductInStore()})},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.chevronBack,slot:"start"},null,8,["src"]),y]})),_:1}),(0,n.Wm)(lt,{button:"",onClick:e[15]||(e[15]=function(e){return t.$router.push("/catalog/store-edit-"+l.productItem.store_id)})},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.chevronBack,slot:"start"},null,8,["src"]),b]})),_:1})]))]})),_:1})):(0,n.kq)("",!0),l.productItem?((0,n.wg)(),(0,n.iD)("form",{key:2,onChange:e[29]||(e[29]=function(){return a.saveForm&&a.saveForm.apply(a,arguments)})},[(0,n.Wm)(ht,{lines:"full"},{default:(0,n.w5)((function(){return[(0,n.Wm)(gt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(ft,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[U]})),_:1})]})),_:1}),l.is_option_child?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(lt,{key:0},{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{position:"stacked",color:"primary"},{default:(0,n.w5)((function(){return[x]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_name,"onUpdate:modelValue":e[16]||(e[16]=function(t){return l.productItem.product_name=t}),name:"product_name",placeholder:"полное название товара",clearInput:"true"},null,8,["modelValue"])]})),_:1})),l.is_option_child?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(lt,{key:1},{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{position:"stacked",color:"primary"},{default:(0,n.w5)((function(){return[Z]})),_:1}),(0,n.Wm)(wt,{modelValue:l.productItem.product_description,"onUpdate:modelValue":e[17]||(e[17]=function(t){return l.productItem.product_description=t}),name:"product_description",rows:"6",placeholder:"характеристики, свойства, состав товара"},null,8,["modelValue"])]})),_:1})),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[V]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_code,"onUpdate:modelValue":e[18]||(e[18]=function(t){return l.productItem.product_code=t}),name:"product_code",slot:"end",placeholder:"код товара"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[C]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_barcode,"onUpdate:modelValue":e[19]||(e[19]=function(t){return l.productItem.product_barcode=t}),name:"product_barcode",slot:"end",placeholder:"штрихкод"},null,8,["modelValue"])]})),_:1}),l.is_counted?((0,n.wg)(),(0,n.j4)(lt,{key:2},{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[G,l.productItem.product_unit?((0,n.wg)(),(0,n.iD)("span",O,"("+(0,u.zw)(l.productItem.product_unit)+")",1)):(0,n.kq)("",!0)]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_quantity,"onUpdate:modelValue":e[20]||(e[20]=function(t){return l.productItem.product_quantity=t}),name:"product_quantity",slot:"end",placeholder:"в наличии"},null,8,["modelValue"])]})),_:1})):(0,n.kq)("",!0),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[D,l.productItem.product_unit?((0,n.wg)(),(0,n.iD)("span",$,"("+(0,u.zw)(l.productItem.product_unit)+")",1)):(0,n.kq)("",!0)]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_quantity_min,"onUpdate:modelValue":e[21]||(e[21]=function(t){return l.productItem.product_quantity_min=t}),name:"product_quantity_min",type:"number",inputmode:"numeric",pattern:"\\d\\.",slot:"end"},null,8,["modelValue"])]})),_:1}),l.is_option_child?(0,n.kq)("",!0):((0,n.wg)(),(0,n.j4)(lt,{key:3},{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[q]})),_:1}),(0,n.Wm)(vt,{modelValue:l.productItem.product_unit,"onUpdate:modelValue":e[22]||(e[22]=function(t){return l.productItem.product_unit=t}),name:"product_unit",slot:"end",onIonChange:a.saveForm},{default:(0,n.w5)((function(){return[(0,n.Wm)(kt,{value:"шт"},{default:(0,n.w5)((function(){return[L]})),_:1}),(0,n.Wm)(kt,{value:"порция"},{default:(0,n.w5)((function(){return[P]})),_:1}),(0,n.Wm)(kt,{value:"порция мл"},{default:(0,n.w5)((function(){return[j]})),_:1}),(0,n.Wm)(kt,{value:"кг"},{default:(0,n.w5)((function(){return[z]})),_:1}),(0,n.Wm)(kt,{value:"м"},{default:(0,n.w5)((function(){return[S]})),_:1}),(0,n.Wm)(kt,{value:"л"},{default:(0,n.w5)((function(){return[F]})),_:1})]})),_:1},8,["modelValue","onIonChange"])]})),_:1})),"кг"!=l.productItem.product_unit?((0,n.wg)(),(0,n.j4)(lt,{key:4},{default:(0,n.w5)((function(){return["порция мл"==l.productItem.product_unit?((0,n.wg)(),(0,n.j4)(pt,{key:0},{default:(0,n.w5)((function(){return[M]})),_:1})):((0,n.wg)(),(0,n.j4)(pt,{key:1},{default:(0,n.w5)((function(){return[(0,n.Uk)("Вес 1"+(0,u.zw)(l.productItem.product_unit)+" (кг)*",1)]})),_:1})),(0,n.Wm)(st,{modelValue:l.productItem.product_weight,"onUpdate:modelValue":e[23]||(e[23]=function(t){return l.productItem.product_weight=t}),name:"product_weight",type:"number",step:"0.1",inputmode:"numeric",pattern:"\\d\\.",slot:"end"},null,8,["modelValue"])]})),_:1})):(0,n.kq)("",!0)]})),_:1})]})),_:1}),(0,n.Wm)(ht,{lines:"full"},{default:(0,n.w5)((function(){return[(0,n.Wm)(gt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(ft,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[B]})),_:1})]})),_:1})]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[T]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_price,"onUpdate:modelValue":e[24]||(e[24]=function(t){return l.productItem.product_price=t}),name:"product_price",type:"number",inputmode:"numeric",slot:"end"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[H]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_net_price,"onUpdate:modelValue":e[25]||(e[25]=function(t){return l.productItem.product_net_price=t}),name:"product_net_price",type:"number",inputmode:"numeric",slot:"end"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{color:"success"},{default:(0,n.w5)((function(){return[Y]})),_:1}),(0,n.Wm)(st,{modelValue:l.productItem.product_promo_price,"onUpdate:modelValue":e[26]||(e[26]=function(t){return l.productItem.product_promo_price=t}),name:"product_promo_price",type:"number",inputmode:"numeric",slot:"end",color:"success"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{color:"success"},{default:(0,n.w5)((function(){return[N]})),_:1}),(0,n.Wm)(st,{type:"date",modelValue:l.productItem.product_promo_start,"onUpdate:modelValue":e[27]||(e[27]=function(t){return l.productItem.product_promo_start=t}),name:"product_promo_start",slot:"end"},null,8,["modelValue"])]})),_:1}),(0,n.Wm)(lt,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,{color:"success"},{default:(0,n.w5)((function(){return[A]})),_:1}),(0,n.Wm)(st,{type:"date",modelValue:l.productItem.product_promo_finish,"onUpdate:modelValue":e[28]||(e[28]=function(t){return l.productItem.product_promo_finish=t}),name:"product_promo_finish",slot:"end"},null,8,["modelValue"])]})),_:1})]})),_:1})],32)):(0,n.kq)("",!0),l.productItem&&!l.is_option_child?((0,n.wg)(),(0,n.j4)(ht,{key:3},{default:(0,n.w5)((function(){return[(0,n.Wm)(ft,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[E]})),_:1})]})),_:1}),(0,n.Wm)(It,{images:l.productItem.images,image_holder_id:l.productItem.product_id,title:"Витрина товара 5 фото",controller:"Product",ref:"productImgs"},null,8,["images","image_holder_id"]),(0,n.Wm)(_t,{onClick:e[30]||(e[30]=function(e){return t.$refs.productImgs.take_photo()}),color:"light",expand:"block"},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.cameraOutline,slot:"start"},null,8,["src"]),J]})),_:1})]})),_:1})):(0,n.kq)("",!0),l.productItem&&a.categoryList&&!l.is_option_child?((0,n.wg)(),(0,n.j4)(ht,{key:4},{default:(0,n.w5)((function(){return[(0,n.Wm)(ft,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[K]})),_:1})]})),_:1}),0==a.categoryList.length?((0,n.wg)(),(0,n.j4)(lt,{key:0,color:"light"},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.compassOutline,slot:"start",color:"danger"},null,8,["src"]),(0,n.Wm)(pt,{color:"danger"},{default:(0,n.w5)((function(){return[X]})),_:1})]})),_:1})):(0,n.kq)("",!0),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(a.categoryList,(function(t){return(0,n.wg)(),(0,n.j4)(lt,{key:t.group_id},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.compassOutline,slot:"start",color:"primary"},null,8,["src"]),(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[(0,n.Uk)((0,u.zw)(t.group_name),1)]})),_:2},1024),(0,n.Wm)(it,{src:o.trashOutline,slot:"end",onClick:function(e){return a.categoryDelete(t.group_id,t.group_name)}},null,8,["src","onClick"])]})),_:2},1024)})),128)),(0,n.Wm)(lt,{button:"",onClick:e[31]||(e[31]=function(t){return a.categoryAdd()})},{default:(0,n.w5)((function(){return[(0,n.Wm)(it,{src:o.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,n.Wm)(pt,null,{default:(0,n.w5)((function(){return[Q]})),_:1})]})),_:1})]})),_:1})):(0,n.kq)("",!0)]})),_:1},8,["page-title"])}var tt=r(6835),et=r(8534),rt=(r(3123),r(8862),r(6699),r(2023),r(7042),r(2066)),nt=r(8903),ut=r(2226),ot=(0,n.Uk)("Категории"),it=(0,n.Uk)("Готово");function ct(t,e,r,o,i,c){var l=(0,n.up)("ion-title"),a=(0,n.up)("ion-icon"),d=(0,n.up)("ion-toolbar"),p=(0,n.up)("ion-button"),s=(0,n.up)("ion-header"),m=(0,n.up)("ion-img"),_=(0,n.up)("ion-avatar"),f=(0,n.up)("ion-label"),h=(0,n.up)("ion-checkbox"),w=(0,n.up)("ion-item"),k=(0,n.up)("ion-item-divider"),v=(0,n.up)("ion-list"),g=(0,n.up)("ion-content");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n.Wm)(s,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(d,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(l,null,{default:(0,n.w5)((function(){return[ot]})),_:1}),(0,n.Wm)(a,{slot:"end",onClick:e[0]||(e[0]=function(t){c.closeModal()}),icon:o.closeCircle,size:"large",color:"medium"},null,8,["icon"])]})),_:1}),(0,n.Wm)(p,{onClick:e[1]||(e[1]=function(t){c.closeModal()}),color:"medium",expand:"full"},{default:(0,n.w5)((function(){return[it]})),_:1})]})),_:1}),(0,n.Wm)(g,null,{default:(0,n.w5)((function(){return[i.groupList?((0,n.wg)(),(0,n.j4)(v,{key:0},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(i.groupList,(function(e){return(0,n.wg)(),(0,n.iD)("div",{key:e.group_id},[e.group_parent_id>0?((0,n.wg)(),(0,n.j4)(w,{key:0},{default:(0,n.w5)((function(){return[(0,n.Wm)(_,{slot:"start"},{default:(0,n.w5)((function(){return[(0,n.Wm)(m,{src:t.$heap.state.hostname+"image/get.php/"+e.image_hash+".50.50.webp"},null,8,["src"])]})),_:2},1024),(0,n.Wm)(f,null,{default:(0,n.w5)((function(){return[(0,n.Uk)((0,u.zw)(e.group_name),1)]})),_:2},1024),(0,n.Wm)(h,{slot:"end",checked:e.is_marked,onClick:function(t){return c.mimickChage(t.target,e.group_id)}},null,8,["checked","onClick"])]})),_:2},1024)):((0,n.wg)(),(0,n.j4)(k,{key:1},{default:(0,n.w5)((function(){return[(0,n.Wm)(f,null,{default:(0,n.w5)((function(){return[(0,n._)("b",null,(0,u.zw)(e.group_name),1)]})),_:2},1024)]})),_:2},1024))])})),128))]})),_:1})):(0,n.kq)("",!0)]})),_:1})],64)}var lt=r(8439),at=(r(4480),r(1539),r(9755)),dt=r.n(at),pt={props:["controller","memberId","memberOfIds","memberLimit"],components:{IonCheckbox:rt.nz,IonContent:rt.W2,IonHeader:rt.Gu,IonToolbar:rt.sr,IonTitle:rt.wd,IonIcon:rt.gu,IonButton:rt.YG,IonImg:rt.Xz,IonAvatar:rt.BJ,IonLabel:rt.Q$,IonItemDivider:rt.rH,IonList:rt.q_,IonItem:rt.Ie},setup(){return{closeCircle:nt.XZx}},data(){return{groupList:null,checkedGroupList:[]}},created(){this.listGroupGet(),this.checkedGroupList=this.memberOfIds||[]},methods:{listGroupGet(){var t=this;return(0,et.Z)((0,tt.Z)().mark((function e(){return(0,tt.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,dt().get(t.$heap.state.hostname+t.controller+"/listGroupGet");case 2:t.groupList=e.sent,t.itemMarkGroups();case 4:case"end":return e.stop()}}),e)})))()},itemMarkGroups(){if(this.groupList)try{var t,e=(0,lt.Z)(this.groupList);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.is_marked=this.checkedGroupList.includes(r.group_id)?1:0}}catch(n){e.e(n)}finally{e.f()}}catch(u){}},itemUpdateGroup(t,e){var r=this;return(0,et.Z)((0,tt.Z)().mark((function n(){var u;return(0,tt.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return u={[r.controller.toLowerCase()+"_id"]:r.memberId,is_joined:t,group_id:e},n.prev=1,n.next=4,dt().post(r.$heap.state.hostname+r.controller+"/itemUpdateGroup",u);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),r.$flash("Не удалось сохранить изменение");case 9:case"end":return n.stop()}}),n,null,[[1,6]])})))()},mimickChage(t,e){var r=this;setTimeout((function(){r.groupChanged(t,e)}),0)},groupChanged(t,e){var r=this;return(0,et.Z)((0,tt.Z)().mark((function n(){var u;return(0,tt.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(u=t.checked?1:0,!u){n.next=10;break}if(!(r.checkedGroupList.length>=r.memberLimit)){n.next=6;break}return r.$flash(`Можно выбрать не больше ${r.memberLimit} категорий`),t.checked=0,n.abrupt("return");case 6:1==r.memberLimit&&r.closeModal(),r.checkedGroupList.push(e),n.next=11;break;case 10:r.checkedGroupList=r.checkedGroupList.filter((function(t,r,n){return t!=e}));case 11:r.itemUpdateGroup(u,e);case 12:case"end":return n.stop()}}),n)})))()},closeModal(){rt.Fy.dismiss(this.checkedGroupList)}}},st=r(3744);const mt=(0,st.Z)(pt,[["render",ct]]);var _t=mt,ft=r(2008),ht=r(9042),wt={components:{IonInput:rt.pK,IonTextarea:rt.g2,IonCard:rt.PM,IonCardContent:rt.FN,IonCardHeader:rt.Zi,IonToggle:rt.ho,IonIcon:rt.gu,IonItem:rt.Ie,IonList:rt.q_,IonLabel:rt.Q$,IonItemDivider:rt.rH,IonItemGroup:rt.Ub,IonButton:rt.YG,IonProgressBar:rt.X7,IonText:rt.yW,IonSelect:rt.t9,IonSelectOption:rt.n0,IonImg:rt.Xz,IonChip:rt.hM,IonCardTitle:rt.Dq,IonCardSubtitle:rt.tO,imageTileComp:ut.Z},setup(){return{cameraOutline:nt.kuq,trashOutline:nt.gtu,banOutline:nt.L6S,personOutline:nt.QJ7,addOutline:nt.s6O,pizzaOutline:nt.fqo,compassOutline:nt.gmD,chevronBack:nt.Mny,layersOutline:nt.Y1P}},data(){return{productId:this.$route.params.id,productItem:null,productGroupList:null,validity:0,validity_min:80,optionData:null,refreshOptions:this.$route.query.refreshOptions,is_option_parent:!1,is_option_child:!1,is_groups_marked:0,is_deleted:0,is_disabled:0,is_counted:0}},computed:{message(){var t,e,r;return null!==(t=this.productItem)&&void 0!==t&&t.deleted_at?"Товар не активен и будет удален. Вы еще можете отменить удаление":1==(null===(e=this.productItem)||void 0===e?void 0:e.is_disabled)?"Товар не активен и находится на рассмотрении у администратора":1!=(null===(r=this.productItem)||void 0===r?void 0:r.is_counted)?"Товар активен и готов к продаже. Учет остатков товара не ведется":"Товар активен и готов к продаже."},messageClass(){var t,e,r;return null!==(t=this.productItem)&&void 0!==t&&t.deleted_at?"deleted":1==(null===(e=this.productItem)||void 0===e?void 0:e.is_disabled)?"disabled":1!=(null===(r=this.productItem)||void 0===r?void 0:r.is_counted)?"primary":"active"},categoryList(){var t=[];try{var e=this.productItem.member_of_groups.group_ids.split(","),r=this.productItem.member_of_groups.group_names.split(",");for(var n in e)t.push({group_id:e[n],group_name:r[n]})}catch(u){}return t}},created(){this.listGroupGet(),this.itemGet()},ionViewDidEnter(){var t;this.refreshOptions&&null!==(t=this.productItem)&&void 0!==t&&t.product_parent_id&&this.itemOptionGet()},methods:{itemGet(){var t=this;return(0,et.Z)((0,tt.Z)().mark((function e(){var r;return(0,tt.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt().post(ft.Z.state.hostname+"Product/itemGet",{product_id:t.productId});case 3:return r=e.sent,t.productItem=t.itemPrepare(r),t.itemParseFlags(),t.is_option_child=t.productItem.product_parent_id&&t.productItem.product_parent_id!=t.productItem.product_id,t.is_option_parent=t.productItem.product_parent_id&&t.productItem.product_parent_id==t.productItem.product_id,e.next=10,t.itemOptionGet();case 10:e.next=14;break;case 12:e.prev=12,e.t0=e["catch"](0);case 14:case"end":return e.stop()}}),e,null,[[0,12]])})))()},itemPrepare(t){return t.product_promo_start&&(t.product_promo_start=t.product_promo_start.split(" ")[0]),t.product_promo_finish&&(t.product_promo_finish=t.product_promo_finish.split(" ")[0]),t},itemParseFlags(){this.is_deleted=null==this.productItem.deleted_at?0:1,this.is_disabled=0==this.productItem.is_disabled?0:1,this.is_counted=0==this.productItem.is_counted?0:1},itemDelete(t){var e=this;return(0,et.Z)((0,tt.Z)().mark((function r(){var n;return(0,tt.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n=t?"itemDelete":"itemUnDelete",r.prev=1,r.next=4,dt().post(ft.Z.state.hostname+"Product/"+n,{product_id:e.productId});case 4:e.productItem.deleted_at=t?1:null,(e.is_option_child||e.is_option_parent)&&e.itemOptionGet(),r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](1),e.itemGet();case 11:case"end":return r.stop()}}),r,null,[[1,8]])})))()},itemDisable(t){var e=this;return(0,et.Z)((0,tt.Z)().mark((function r(){return(0,tt.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.productItem.is_disabled!=t){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,dt().post(ft.Z.state.hostname+"Product/itemDisable",{product_id:e.productId,is_disabled:t});case 5:e.productItem.is_disabled=t,r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](2),e.itemGet();case 11:case"end":return r.stop()}}),r,null,[[2,8]])})))()},itemUpdate(t){var e=this;return(0,et.Z)((0,tt.Z)().mark((function r(){var n;return(0,tt.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,dt().post(ft.Z.state.hostname+"Product/itemUpdate",JSON.stringify(t));case 3:return e.$flash("сохранено"),r.abrupt("return",!0);case 7:return r.prev=7,r.t0=r["catch"](0),n=r.t0.responseJSON.messages.error,null!==n&&void 0!==n&&n.includes("product_description")?e.$flash("Описание слишком короткое"):null!==n&&void 0!==n&&n.includes("product_name")?e.$flash("Название слишком короткое"):e.$flash("Изменение не сохранено"),e.itemGet(),r.abrupt("return",!1);case 13:case"end":return r.stop()}}),r,null,[[0,7]])})))()},itemOptionGet(){var t=this;return(0,et.Z)((0,tt.Z)().mark((function e(){var r,n;return(0,tt.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.productItem.product_parent_id||(t.optionData=null),r={product_parent_id:t.productItem.product_parent_id},e.next=4,dt().post(`${t.$heap.state.hostname}Product/itemOptionGet`,r);case 4:n=e.sent,t.optionData={parent:n[0],children:n.slice(1)};case 6:case"end":return e.stop()}}),e)})))()},itemOptionCreate(){var t=this;return(0,et.Z)((0,tt.Z)().mark((function e(){var r,n,u,o,i;return(0,tt.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=null!==(r=null===(n=t.optionData)||void 0===n||null===(u=n.children)||void 0===u?void 0:u.length)&&void 0!==r?r:0,i={is_disabled:1,store_id:t.productItem.store_id,product_parent_id:t.productItem.product_parent_id,product_name:"OPTION",product_price:0,product_option:`Вариант#${o}`},e.prev=2,e.next=5,dt().post(`${t.$heap.state.hostname}Product/itemCreate`,i);case 5:t.itemOptionGet(),e.next=10;break;case 8:e.prev=8,e.t0=e["catch"](2);case 10:case"end":return e.stop()}}),e,null,[[2,8]])})))()},itemOptionSet(t){var e=this;return(0,et.Z)((0,tt.Z)().mark((function r(){return(0,tt.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!t){r.next=5;break}return r.next=3,e.itemOptionSave(e.productId,e.productId);case 3:r.next=7;break;case 5:return r.next=7,e.itemOptionDelete(e.productId);case 7:e.itemGet();case 8:case"end":return r.stop()}}),r)})))()},itemOptionUpdate(t){return(0,et.Z)((0,tt.Z)().mark((function t(){return(0,tt.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()},itemOptionSave(t,e){var r=this;return(0,et.Z)((0,tt.Z)().mark((function n(){return(0,tt.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,dt().post(`${r.$heap.state.hostname}Product/itemOptionSave`,{product_id:t,product_parent_id:e});case 3:n.next=7;break;case 5:n.prev=5,n.t0=n["catch"](0);case 7:case"end":return n.stop()}}),n,null,[[0,5]])})))()},itemOptionDelete(t){var e=this;return(0,et.Z)((0,tt.Z)().mark((function r(){return(0,tt.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(confirm("Удалить разновидности товара?")){r.next=2;break}return r.abrupt("return");case 2:return r.prev=2,r.next=5,dt().post(`${e.$heap.state.hostname}Product/itemOptionDelete`,{product_id:t});case 5:e.itemOptionGet(),r.next=10;break;case 8:r.prev=8,r.t0=r["catch"](2);case 10:case"end":return r.stop()}}),r,null,[[2,8]])})))()},checkPromoPrice(t){if(this.productItem.product_price>0&&this.productItem.product_promo_price>0&&this.productItem.product_price<=this.productItem.product_promo_price){"product_promo_price"==t&&(this.productItem.product_price=Number(this.productItem.product_promo_price)+1),"product_price"==t&&(this.productItem.product_promo_price=Number(this.productItem.product_price)-1);var e={product_id:this.productId,product_promo_price:this.productItem.product_promo_price,product_price:this.productItem.product_price};return this.itemUpdate(e),this.$flash("Акционная цена должна быть ниже основной. Внимание цена изменена!"),!1}return!0},saveForm(t){var e=t.target.name,r=this.productItem[e]=t.target.value;this.checkPromoPrice(e)&&this.save(e,r)},save(t,e){var r=this;return(0,et.Z)((0,tt.Z)().mark((function n(){var u;return(0,tt.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r.productItem.product_id){n.next=2;break}return n.abrupt("return");case 2:u={product_id:r.productItem.product_id,[t]:e},r.itemUpdate(u)&&(r.productItem[t]=e,r.itemParseFlags());case 4:case"end":return n.stop()}}),n)})))()},categoryDelete(t,e){if(confirm("Исключить товар из категории "+e+"?"))try{this.itemUpdateGroup(0,t)}catch(r){}},categoryAdd(){var t=this;return(0,et.Z)((0,tt.Z)().mark((function e(){var r,n,u,o,i;return(0,tt.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=(null===(r=t.productItem)||void 0===r||null===(n=r.member_of_groups)||void 0===n||null===(u=n.group_ids)||void 0===u?void 0:u.split(","))||[],e.next=3,rt.Fy.create({component:_t,componentProps:{controller:"Product",memberId:t.productId,memberOfIds:o,memberLimit:1},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});case 3:return i=e.sent,i.present(),ht.Z.on("dismissModal",(function(){i.dismiss()})),e.next=8,i.onDidDismiss();case 8:t.itemGet();case 9:case"end":return e.stop()}}),e)})))()},itemUpdateGroup(t,e){var r=this;return(0,et.Z)((0,tt.Z)().mark((function n(){var u;return(0,tt.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return u={product_id:r.productId,is_joined:t,group_id:e},n.prev=1,n.next=4,dt().post(ft.Z.state.hostname+"Product/itemUpdateGroup",u);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),r.$flash("Не удалось сохранить изменение");case 9:r.itemGet();case 10:case"end":return n.stop()}}),n,null,[[1,6]])})))()},listGroupGet(){var t=this;return(0,et.Z)((0,tt.Z)().mark((function e(){return(0,tt.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt().get(ft.Z.state.hostname+"Product/listGroupGet");case 3:t.productGroupList=e.sent,t.itemMarkGroups(),e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})))()},showProductInStore(){var t=0;try{t=this.productItem.member_of_groups.group_ids.split(",")[0]}catch(e){}this.$router.push({path:"store-"+this.productItem.store_id,query:{sub_group_id:t}})}}};const kt=(0,st.Z)(wt,[["render",R],["__scopeId","data-v-43fd9045"]]);var vt=kt}}]);
//# sourceMappingURL=2515-legacy.4434bba7.js.map