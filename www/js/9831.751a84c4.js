"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[9831],{9831:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var a=n(641),l=n(33),o=n(3751);const i={key:2},s={class:"is_main"};function r(e,t,n,r,c,u){const d=(0,a.g2)("ion-label"),k=(0,a.g2)("ion-item-divider"),h=(0,a.g2)("ion-item"),_=(0,a.g2)("ion-icon"),f=(0,a.g2)("ion-toggle"),b=(0,a.g2)("ion-list"),m=(0,a.g2)("ion-skeleton-text"),p=(0,a.g2)("ion-img"),g=(0,a.g2)("ion-chip"),y=(0,a.g2)("base-layout");return(0,a.uX)(),(0,a.Wv)(y,{pageTitle:"Мои способы оплаты"},{default:(0,a.k6)((()=>{var e;return[(0,a.bF)(b,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{style:{"margin-top":"0px","box-shadow":"none"}},{default:(0,a.k6)((()=>[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)("Настройки")])),_:1})])),_:1}),(0,a.bF)(h,{lines:"none"},{default:(0,a.k6)((()=>[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)("Сохранение карты при оплате заказа")])),_:1})])),_:1}),(0,a.bF)(h,{lines:"none"},{default:(0,a.k6)((()=>[(0,a.bF)(_,{src:r.cardOutline,slot:"start"},null,8,["src"]),(0,a.bF)(f,{modelValue:c.enable_auto_cof,"onUpdate:modelValue":t[0]||(t[0]=e=>c.enable_auto_cof=e),onIonChange:t[1]||(t[1]=e=>u.saveAutoCof())},{default:(0,a.k6)((()=>[(0,a.eW)(" Автоматически сохранять ")])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(k,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)("Сохраненные карты")])),_:1})])),_:1})])),_:1}),null==c.cardList?((0,a.uX)(),(0,a.Wv)(b,{key:0},{default:(0,a.k6)((()=>[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([1,2],(e=>(0,a.bF)(h,{key:e},{default:(0,a.k6)((()=>[(0,a.bF)(_,{style:{"background-color":"var(--ion-color-light)"},slot:"start"}),(0,a.bF)(m,{animated:"",style:{width:"100%"}}),(0,a.bF)(_,{style:{"background-color":"var(--ion-color-light)"},slot:"end"})])),_:2},1024))),64))])),_:1})):(null===(e=c.cardList)||void 0===e?void 0:e.length)>0?((0,a.uX)(),(0,a.Wv)(b,{key:1},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.cardList,((e,t)=>((0,a.uX)(),(0,a.Wv)(h,{key:e.order_id,button:"","detail-icon":"",onClick:t=>u.itemMainSet(e.card_id)},{default:(0,a.k6)((()=>[e.card_type?((0,a.uX)(),(0,a.Wv)(p,{key:0,class:"card_type",src:`/img/icons/card-${e.card_type}.svg`,slot:"start"},null,8,["src"])):((0,a.uX)(),(0,a.Wv)(_,{key:1,src:r.cardOutline,slot:"start",color:"primary"},null,8,["src"])),0==t?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("h6",s,(0,l.v_)(e.label),1),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)("Основной способ")])),_:1})])):((0,a.uX)(),(0,a.Wv)(d,{key:3,color:"medium"},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(e.label),1)])),_:2},1024)),(0,a.bF)(_,{icon:r.trashOutline,slot:"end",onClick:(0,o.D$)((t=>u.itemDelete(e.card_id)),["stop"])},null,8,["icon","onClick"])])),_:2},1032,["onClick"])))),128))])),_:1})):((0,a.uX)(),(0,a.Wv)(b,{key:2,lines:"none"},{default:(0,a.k6)((()=>[(0,a.bF)(h,null,{default:(0,a.k6)((()=>[(0,a.bF)(d,{color:"medium"},{default:(0,a.k6)((()=>[(0,a.eW)("Сохраненных карт нет")])),_:1})])),_:1})])),_:1})),(0,a.bF)(h,{lines:"none",button:"","detail-icon":""},{default:(0,a.k6)((()=>[(0,a.bF)(g,{color:"primary",onClick:t[2]||(t[2]=e=>u.cardRegistrationOpen())},{default:(0,a.k6)((()=>[(0,a.bF)(_,{icon:r.addOutline},null,8,["icon"]),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)("Добавить карту")])),_:1})])),_:1}),(0,a.bF)(g,{color:"medium",onClick:t[3]||(t[3]=e=>u.cardRegistrationCheck())},{default:(0,a.k6)((()=>[(0,a.bF)(_,{icon:r.refreshOutline},null,8,["icon"]),(0,a.bF)(d,null,{default:(0,a.k6)((()=>[(0,a.eW)("обновить")])),_:1})])),_:1})])),_:1})]})),_:1})}var c=n(5654),u=n(5480),d=n(9369),k=n(6859),h=n(2311),_=n.n(h),f={components:{IonList:c.nf,IonItem:c.uz,IonSkeletonText:c.ds,IonLabel:c.he,IonIcon:c.iq,IonImg:c.KW,IonToggle:c.BY,IonChip:c.ZB,IonItemDivider:c.Dg},setup(){return{cardOutline:u.VR9,addOutline:u.EKF,trashOutline:u.P1A,refreshOutline:u.mVv,saveOutline:u.oc8}},data(){return{cardList:null,isOpen:!1,enable_auto_cof:1==localStorage.disable_auto_cof?0:1}},methods:{async listGet(){try{let e=await _().post(this.$heap.state.hostname+"UserCards/listGet");if(e&&e.length>0)for(let t in e)e[t].label=`${e[t].card_type.toUpperCase()} - ${e[t].card_mask.split("*").pop()}`;this.cardList=e}catch{}},async itemMainSet(e){const t={card_id:e};try{await _().post(`${this.$heap.state.hostname}UserCards/itemMainSet`,t),this.$topic.publish("userMainPaymentMethodSet"),this.$router.go(-1)}catch{}},async itemDelete(e){if(!confirm("Вы уверенны?"))return;const t={card_id:e};try{await _().post(`${this.$heap.state.hostname}UserCards/itemDelete`,t),this.listGet()}catch{this.$flash("Не удалось открепить карту")}},saveAutoCof(){localStorage.disable_auto_cof=this.enable_auto_cof?0:1},async cardRegistrationOpen(){const e=document.querySelector("ion-router-outlet"),t="card_registering",n=this,a=await c.OZ.create({component:d.A,componentProps:{order_data:t},presentingElement:e}),l=function(){a.dismiss()};return k.A.on("dismissModal",l),a.onDidDismiss().then((()=>{n.cardRegistrationCheck()})),a.present()},async cardRegistrationCheck(){try{const e=await _().post(this.$heap.state.hostname+"CardAcquirer/cardRegisteredSync");"ok"==e&&(this.listGet(),this.$topic.publish("userMainPaymentMethodSet"))}catch(e){}}},mounted(){this.listGet()}},b=n(6262);const m=(0,b.A)(f,[["render",r],["__scopeId","data-v-7c123fd6"]]);var p=m}}]);
//# sourceMappingURL=9831.751a84c4.js.map