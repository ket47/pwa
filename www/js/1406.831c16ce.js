"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[1406],{5474:function(e,t,l){l.d(t,{A:function(){return O}});var a=l(641),n=l(33);const i=e=>((0,a.Qi)("data-v-38c26abe"),e=e(),(0,a.jt)(),e),o={slot:"end",style:{display:"grid","grid-template-columns":"120px"}},r={slot:"end",style:{display:"grid","grid-template-columns":"120px"}},s={class:"horizontalScroller"},d={key:1,class:"printDiv"},u={class:"table_head"},c=i((()=>(0,a.Lk)("div",null,"Количество",-1))),v=i((()=>(0,a.Lk)("div",null,"Скидка",-1))),p=i((()=>(0,a.Lk)("div",null,"Сумма",-1))),k=i((()=>(0,a.Lk)("div",null,"Вознаграждение",-1))),_=i((()=>(0,a.Lk)("div",null,"К выплате",-1))),h={class:"table",style:{"overflow-x":"scroll"}},b=(0,a.Fv)('<div class="table_h" data-v-38c26abe><div data-v-38c26abe>Время</div><div data-v-38c26abe>Заказ №</div><div data-v-38c26abe>Товар</div><div data-v-38c26abe>Цена</div><div data-v-38c26abe>Количество</div><div data-v-38c26abe>Скидка</div><div data-v-38c26abe>Сумма</div><div data-v-38c26abe>Вознаграждение %</div><div data-v-38c26abe>Доставка</div><div data-v-38c26abe>Оплата</div><div data-v-38c26abe>Чек</div></div>',1),f=["href"];function m(e,t,l,i,m,g){const y=(0,a.g2)("ion-icon"),F=(0,a.g2)("ion-text"),I=(0,a.g2)("ion-item"),L=(0,a.g2)("ion-input"),w=(0,a.g2)("ion-list"),S=(0,a.g2)("ion-accordion"),O=(0,a.g2)("ion-accordion-group"),C=(0,a.g2)("ion-label"),$=(0,a.g2)("ion-chip"),x=(0,a.g2)("ion-searchbar"),W=(0,a.g2)("ion-skeleton-text");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(O,null,{default:(0,a.k6)((()=>[(0,a.bF)(S,{value:"period"},{default:(0,a.k6)((()=>[(0,a.bF)(I,{slot:"header"},{default:(0,a.k6)((()=>[(0,a.bF)(y,{icon:i.calendarOutline,slot:"start"},null,8,["icon"]),(0,a.bF)(F,null,{default:(0,a.k6)((()=>[(0,a.eW)("Период "),(0,a.Lk)("small",null,(0,n.v_)(m.start_at)+" до "+(0,n.v_)(m.finish_at),1)])),_:1})])),_:1}),(0,a.bF)(w,{slot:"content"},{default:(0,a.k6)((()=>[(0,a.bF)(I,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,null,{default:(0,a.k6)((()=>[(0,a.eW)("Начальная дата")])),_:1}),(0,a.Lk)("div",o,[(0,a.bF)(L,{type:"date",modelValue:m.start_at,"onUpdate:modelValue":t[0]||(t[0]=e=>m.start_at=e),onIonInput:t[1]||(t[1]=e=>g.reportGet())},null,8,["modelValue"])])])),_:1}),(0,a.bF)(I,null,{default:(0,a.k6)((()=>[(0,a.bF)(F,null,{default:(0,a.k6)((()=>[(0,a.eW)("Конечная дата")])),_:1}),(0,a.Lk)("div",r,[(0,a.bF)(L,{type:"date",modelValue:m.finish_at,"onUpdate:modelValue":t[2]||(t[2]=e=>m.finish_at=e),onIonInput:t[3]||(t[3]=e=>g.reportGet())},null,8,["modelValue"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Lk)("div",s,[(0,a.bF)($,{onClick:t[4]||(t[4]=e=>g.reportExport()),color:"medium"},{default:(0,a.k6)((()=>[(0,a.bF)(y,{src:i.downloadOutline},null,8,["src"]),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.eW)("Скачать")])),_:1})])),_:1}),(0,a.bF)($,{onClick:t[5]||(t[5]=e=>g.reportGet()),color:"medium"},{default:(0,a.k6)((()=>[(0,a.bF)(y,{src:i.reloadOutline},null,8,["src"]),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.eW)("Обновить")])),_:1})])),_:1})]),(0,a.bF)(x,{modelValue:m.searchQuery,"onUpdate:modelValue":t[6]||(t[6]=e=>m.searchQuery=e),placeholder:"Поиск по товару",onIonInput:t[7]||(t[7]=e=>g.reportGet()),debounce:"500"},null,8,["modelValue"]),null==m.report?((0,a.uX)(),(0,a.Wv)(w,{key:0},{default:(0,a.k6)((()=>[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([1,2,3],(e=>(0,a.bF)(I,{key:e},{default:(0,a.k6)((()=>[(0,a.bF)(F,{slot:"start"},{default:(0,a.k6)((()=>[(0,a.bF)(W,{animated:"",style:{width:"50px"}})])),_:1}),(0,a.bF)(C,null,{default:(0,a.k6)((()=>[(0,a.bF)(W,{animated:"",style:{width:"100%"}})])),_:1}),(0,a.bF)(C,{slot:"end",color:"success"},{default:(0,a.k6)((()=>[(0,a.bF)(W,{animated:"",style:{width:"50px"}})])),_:1})])),_:2},1024))),64))])),_:1})):m.report.body.length>0?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",u,[c,(0,a.Lk)("div",null,(0,n.v_)(m.report.head.total_quantity),1),v,(0,a.Lk)("div",null,(0,n.v_)(m.report.head.total_discount),1),p,(0,a.Lk)("div",null,(0,n.v_)(m.report.head.total_sum),1),k,(0,a.Lk)("div",null,(0,n.v_)(m.report.head.total_commission),1),_,(0,a.Lk)("div",null,(0,n.v_)(m.report.head.total_topay),1)]),(0,a.Lk)("div",h,[b,((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(m.report.body,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"table_r"},[(0,a.Lk)("div",null,(0,n.v_)(e.created_at),1),(0,a.Lk)("div",null,(0,n.v_)(e.order_id),1),(0,a.Lk)("div",null,(0,n.v_)(e.entry_text),1),(0,a.Lk)("div",null,(0,n.v_)(e.entry_price),1),(0,a.Lk)("div",null,(0,n.v_)(e.entry_quantity),1),(0,a.Lk)("div",null,(0,n.v_)(e.entry_discount),1),(0,a.Lk)("div",null,(0,n.v_)(e.entry_sum),1),(0,a.Lk)("div",null,(0,n.v_)(e.fee),1),(0,a.Lk)("div",null,(0,n.v_)(e.delivery),1),(0,a.Lk)("div",null,(0,n.v_)(e.payment_type),1),(0,a.Lk)("div",null,[e.invoice_link?((0,a.uX)(),(0,a.CE)("a",{key:0,href:e.invoice_link,target:"_new"},"онлайн чек",8,f)):(0,a.Q3)("",!0)])])))),128))])])):((0,a.uX)(),(0,a.Wv)(w,{key:2},{default:(0,a.k6)((()=>[(0,a.bF)(I,null,{default:(0,a.k6)((()=>[(0,a.eW)(" Нет заказов в данном периоде ")])),_:1})])),_:1}))])}var g=l(972),y=l(5480),F=l(2311),I=l.n(F),L={components:{IonIcon:g.iq,IonLabel:g.he,IonItem:g.uz,IonInput:g.$w,IonList:g.nf,IonAccordion:g.xk,IonAccordionGroup:g.YH,IonText:g.IO,IonSkeletonText:g.ds,IonSearchbar:g.S1,IonChip:g.ZB},props:["store"],setup(){return{calendarOutline:y.RXF,addOutline:y.EKF,closeCircle:y.P0k,pricetagOutline:y.eOv,downloadOutline:y.fPB,reloadOutline:y.QMU,printOutline:y.SfY}},data(){console.log(this.query);const e=new Date,t=new Date(Date.parse(`${e.getFullYear()}-${e.getMonth()+1}-01Z`));return{start_at:t.toISOString().slice(0,10),finish_at:e.toISOString().slice(0,10),searchQuery:"",report:null,today:e}},watch:{store:function(){this.reportGet()}},methods:{async reportGet(){var e;if(null===(e=this.store)||void 0===e||!e.store_id)return this.report=null,void(this.head=null);try{var t;const e={store_id:null===(t=this.store)||void 0===t?void 0:t.store_id,start_at:this.start_at,finish_at:this.finish_at,searchQuery:this.searchQuery},l=await I().post(`${this.$heap.state.hostname}Statistics/sellReportProductGet`,e);this.report=l}catch(n){var l,a;const e=null===n||void 0===n||null===(l=n.responseJSON)||void 0===l||null===(a=l.messages)||void 0===a?void 0:a.error;switch(e){case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break;default:this.$flash("Ошибка получения выписки");break}return this.ledger=[],this.balance=0,!1}},reportPrint(){window.print()},async reportExport(){var e;if(null===(e=this.store)||void 0===e||!e.store_id)return this.report=null,void(this.head=null);try{var t;const e={store_id:null===(t=this.store)||void 0===t?void 0:t.store_id,start_at:this.start_at,finish_at:this.finish_at,searchQuery:this.searchQuery,output:"xlsx"},l=await I().post(`${this.$heap.state.hostname}Statistics/sellReportProductGet`,e),a=this.store.store_name.replace(/[^\wа-яА-Я]/gi,""),n=`${this.$heap.state.hostname}Statistics/download/${l}/sellReport_${a}_${this.start_at}.xlsx`,i=document.createElement("a");i.href=n,i.click()}catch(n){var l,a;const e=null===n||void 0===n||null===(l=n.responseJSON)||void 0===l||null===(a=l.messages)||void 0===a?void 0:a.error;switch(e){case"large_interval":this.$flash("Период должен быть не больше 3 месяцев");break;default:this.$flash("Ошибка получения выписки"),console.log(n);break}return this.ledger=[],this.balance=0,!1}},toLocDate(e){const t=new Date(Date.parse(e)),l={month:"short",day:"numeric"};return t.toLocaleDateString(void 0,l)}},mounted(){this.reportGet()}},w=l(6262);const S=(0,w.A)(L,[["render",m],["__scopeId","data-v-38c26abe"]]);var O=S},7384:function(e,t,l){l.r(t),l.d(t,{default:function(){return h}});var a=l(641),n=l(33);const i={key:0},o={key:1};function r(e,t,l,r,s,d){const u=(0,a.g2)("ion-segment-button"),c=(0,a.g2)("ion-segment"),v=(0,a.g2)("ion-icon"),p=(0,a.g2)("ion-label"),k=(0,a.g2)("ion-item"),_=(0,a.g2)("ion-list"),h=(0,a.g2)("ledger-comp"),b=(0,a.g2)("statistics-seller-report"),f=(0,a.g2)("base-layout");return(0,a.uX)(),(0,a.Wv)(f,{pageDefaultBackLink:"/user","page-title":"Бухгалтерия"},{default:(0,a.k6)((()=>[(0,a.bF)(c,{"swipe-gesture":"true",modelValue:s.activeTab,"onUpdate:modelValue":t[0]||(t[0]=e=>s.activeTab=e),onIonInput:t[1]||(t[1]=t=>e.listTypeChanged(t))},{default:(0,a.k6)((()=>[(0,a.bF)(u,{value:"ledger"},{default:(0,a.k6)((()=>[(0,a.eW)(" Проводки ")])),_:1}),(0,a.bF)(u,{value:"sellerReport"},{default:(0,a.k6)((()=>[(0,a.eW)(" Отчет ")])),_:1})])),_:1},8,["modelValue"]),"ledger"==s.activeTab?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.bF)(k,{button:"",onClick:t[2]||(t[2]=e=>d.itemCreate())},{default:(0,a.k6)((()=>[(0,a.bF)(v,{slot:"start",src:r.addOutline},null,8,["src"]),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.eW)("Добавить проводку")])),_:1})])),_:1})])),_:1}),(0,a.bF)(h,{account:s.ledgerAccount,ref:"ledger"},null,8,["account"])])):(0,a.Q3)("",!0),"sellerReport"==s.activeTab?((0,a.uX)(),(0,a.CE)("div",o,[(0,a.bF)(_,null,{default:(0,a.k6)((()=>[s.pickedStore?((0,a.uX)(),(0,a.Wv)(k,{key:0,button:"",onClick:t[3]||(t[3]=e=>d.storePick()),color:"primary"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{slot:"start",src:r.storefrontOutline},null,8,["src"]),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,n.v_)(s.pickedStore.store_name),1)])),_:1})])),_:1})):((0,a.uX)(),(0,a.Wv)(k,{key:1,button:"",onClick:t[4]||(t[4]=e=>d.storePick()),color:"warning"},{default:(0,a.k6)((()=>[(0,a.bF)(v,{slot:"start",src:r.storefrontOutline},null,8,["src"]),(0,a.bF)(p,null,{default:(0,a.k6)((()=>[(0,a.eW)("Выбрать продавца")])),_:1})])),_:1}))])),_:1}),"sellerReport"==s.activeTab?((0,a.uX)(),(0,a.Wv)(b,{key:0,store:s.pickedStore},null,8,["store"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])),_:1})}var s=l(972),d=l(5480),u=l(8062),c=l(5474),v=l(2715),p={components:{LedgerComp:u.A,IonSegmentButton:s.eP,IonSegment:s.Gp,IonList:s.nf,IonItem:s.uz,IonLabel:s.he,IonIcon:s.iq,StatisticsSellerReport:c.A},setup(){return{addOutline:d.EKF,refreshOutline:d.mVv,storefrontOutline:d.te8}},data(){return{activeTab:"ledger",ledgerAccount:"supplier",pickedStore:null}},computed:{},methods:{itemCreate(){this.$go("/admin/transaction-edit-0")},async storePick(){const e=await s.OZ.create({component:v.A,componentProps:{itemType:"store"},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});e.present(),this.$topic.on("dismissModal",(()=>{e.dismiss()}));const t=await e.onDidDismiss();t.data&&(this.pickedStore=t.data)}},ionViewDidEnter(){this.$refs.ledger.listGet()}},k=l(6262);const _=(0,k.A)(p,[["render",r],["__scopeId","data-v-3813af75"]]);var h=_}}]);
//# sourceMappingURL=1406.831c16ce.js.map