"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[710],{4405:function(e,t,i){var o=i(2008);const r={deliveryCalculate(e){if(!e.locations||!e.locations[0]||!e.locations[0].distance)return null;const t=e.locations[0].distance,i=e.store_time_preparation||0;return r.deliveryTimeCalculate(t,i)},deliveryTimeCalculate(e,t){var i;t=parseInt(null!==(i=t)&&void 0!==i?i:o.Z.getters.settings.delivery.timePreparationDefault);const r=parseInt(o.Z.getters.settings.delivery.timeDelta),s=parseInt(o.Z.getters.settings.delivery.speed),n=5*Math.round(e/s*60/5)+t,a=n>r?n-r:n,l=a+r;return{time:n,timeMin:a,timeMax:l}}};t["Z"]=r},8788:function(e,t,i){i.d(t,{Z:function(){return m}});var o=i(6252),r=i(3577);const s=e=>((0,o.dD)("data-v-27dffeec"),e=e(),(0,o.Cn)(),e),n={class:"slide-title"},a=s((()=>(0,o._)("div",{id:"hcat_widget_grid"},null,-1)));function l(e,t,i,s,l,u){const d=(0,o.up)("ion-img"),c=(0,o.up)("ion-thumbnail"),p=(0,o.up)("swiper-slide"),g=(0,o.up)("swiper");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(g,{id:"hcat_widget_grid","slides-per-view":4.5,"space-between":10},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.groupList,(t=>((0,o.wg)(),(0,o.j4)(p,{key:t.group_id,onClick:()=>e.onClick(t.group_id)},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{style:{width:"70px",height:"70px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{style:{"border-radius":"10px",border:"1px solid #ddd"},src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.150.150.webp`},null,8,["src"])])),_:2},1024),(0,o._)("div",n,(0,r.zw)(t.group_name),1)])),_:2},1032,["onClick"])))),128))])),_:1},8,["slides-per-view"]),a],64)}var u=i(3741),d=i(3181),c=(0,o.aZ)({components:{IonImg:u.Xz,IonThumbnail:u.Bs,Swiper:d.t,SwiperSlide:d.o},props:["groupList","onClick"]}),p=i(3744);const g=(0,p.Z)(c,[["render",l],["__scopeId","data-v-27dffeec"]]);var m=g},8128:function(e,t,i){i.d(t,{Z:function(){return _}});var o=i(6252),r=i(3577);const s={key:0,style:{position:"relative"}},n=["src"],a=["src"];function l(e,t,i,l,u,d){const c=(0,o.up)("ion-icon"),p=(0,o.up)("ion-fab-button"),g=(0,o.up)("ion-fab"),m=(0,o.up)("swiper-slide"),h=(0,o.up)("swiper");return u.expanded?((0,o.wg)(),(0,o.iD)("div",s,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.imageList,(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.image_hash,style:{border:"2px solid var(--ion-color-primary)"}},[(0,o._)("img",{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.1000.1000.webp`},null,8,n)])))),128)),(0,o.Wm)(g,{horizontal:"end",vertical:"top",slot:"fixed"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{color:"light"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{src:l.contract,size:"large",onClick:t[0]||(t[0]=e=>d.minimize())},null,8,["src"])])),_:1})])),_:1})])):((0,o.wg)(),(0,o.j4)(h,{key:1,modules:l.modules,autoplay:{delay:3e3,disableOnInteraction:!1},loop:!0,effect:"fade",style:(0,r.j5)(`height: ${i.imgHeight||"100%"};`)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.imageList,(t=>((0,o.wg)(),(0,o.j4)(m,{key:t.image_hash},{default:(0,o.w5)((()=>[(0,o._)("div",{class:(0,r.C_)(`${i.mode} cropper`),style:(0,r.j5)(`height: ${i.imgHeight+"px"||0};`)},[(0,o._)("img",{style:(0,r.j5)(`min-height: ${i.imgHeight+"px;"||0}`),src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.${4*i.imgHeight||1200}.${4*i.imgHeight||1200}.webp`},null,12,a)],6)])),_:2},1024)))),128))])),_:1},8,["modules","style"]))}var u=i(8903),d=i(3741),c=i(702),p=i(3181),g={components:{Swiper:p.t,SwiperSlide:p.o,IonFab:d.IJ,IonFabButton:d.W4,IonIcon:d.gu},props:["imageList","imgHeight","mode"],setup(){return{modules:[c.pt,c.xW],expand:u.jnR,contract:u.LJB}},data(){return{expanded:!1,vh:0,vw:0}},methods:{maximize(){this.expanded=!0,this.vh=document.getElementsByTagName("ion-content")[0].clientHeight,this.vw=document.getElementsByTagName("ion-content")[0].clientWidth},minimize(){this.expanded=!1,this.vh=document.getElementsByTagName("ion-content")[0].clientHeight,this.vw=document.getElementsByTagName("ion-content")[0].clientWidth}}},m=i(3744);const h=(0,m.Z)(g,[["render",l],["__scopeId","data-v-c36e09b8"]]);var _=h},4710:function(e,t,i){i.r(t),i.d(t,{default:function(){return U}});var o=i(6252),r=i(3577);const s={style:{"background-color":"#1380c1","padding-bottom":"15px"}},n={class:"store-info-container"},a={class:"store-image-slider-container"},l=(0,o._)("div",{class:"overlay",style:{"background-image":"url(/img/store_menu_background_full.png)","background-size":"auto"}},null,-1),u={class:"avatar"},d=["src"],c={key:0,class:"group-fixed-block hidden-block"},p=(0,o._)("h4",{style:{margin:"16px 16px 20px"}},[(0,o._)("b",null,"Онлайн меню")],-1),g={class:"product-container"},m={style:{margin:"0"}},h={class:"product_list_widget_grid"},_=["id"],w={class:"product_list_item_img"},f=["src"],v={class:"product-data"},y={class:"product-title"},b={key:0,style:{color:"var(--ion-color-medium)"}},I={key:1,style:{color:"var(--ion-color-medium)"}},k={class:"product-price"},S={key:0,style:{color:"var(--ion-color-danger)"}},$=(0,o.Uk)("   "),x={style:{color:"var(--ion-color-primary)"}},G={style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},P={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},C=(0,o._)("div",null,[(0,o._)("h6",null,"НУЖНА ДОСТАВКА?"),(0,o._)("h4",null,"ВЫБИРАЙ TEZKEL")],-1),H=(0,o.Uk)("Перейти в приложение");function q(e,t,i,q,z,D){const W=(0,o.up)("ion-icon"),L=(0,o.up)("ion-toolbar"),j=(0,o.up)("image-slider"),Z=(0,o.up)("ion-label"),T=(0,o.up)("ion-segment-button"),O=(0,o.up)("ion-segment"),B=(0,o.up)("group-list"),M=(0,o.up)("ion-col"),Y=(0,o.up)("ion-img"),N=(0,o.up)("ion-row"),E=(0,o.up)("ion-grid"),K=(0,o.up)("swiper-slide"),R=(0,o.up)("swiper"),U=(0,o.up)("ion-button"),V=(0,o.up)("router-link"),F=(0,o.up)("ion-footer"),J=(0,o.up)("ion-content"),A=(0,o.up)("ion-page");return(0,o.wg)(),(0,o.j4)(A,null,{default:(0,o.w5)((()=>[(0,o.Wm)(J,{class:(0,r.C_)("store-menu-page"),scrollEvents:!0,onIonScroll:D.onScroll},{default:(0,o.w5)((()=>[(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[q.mainLogo?((0,o.wg)(),(0,o.j4)(W,{key:0,class:"toolbar_svg_logo",style:{color:"white"},icon:q.mainLogo},null,8,["icon"])):(0,o.kq)("",!0)])),_:1}),(0,o._)("div",s,[(0,o._)("div",n,[(0,o._)("div",a,[(0,o.Wm)(j,{imageList:z.storeItem.images,imgHeight:200,mode:"crop-to-fit"},null,8,["imageList"]),l]),(0,o._)("div",u,[(0,o._)("img",{alt:"Silhouette of a person's head",src:e.$heap.state.hostname+"image/get.php/"+z.storeItem.avatarImage+".200.200.webp"},null,8,d)]),z.storeGroups?((0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(O,{modelValue:z.groupSelectedParentId,"onUpdate:modelValue":t[0]||(t[0]=e=>z.groupSelectedParentId=e),scrollable:"",class:"groups-container"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(z.storeGroups,(e=>((0,o.wg)(),(0,o.j4)(T,{key:e.group_id,value:e.group_id,onClick:t=>D.groupSelectParent(e.group_id,1),ref_for:!0,ref:"group-tab-"+e.group_id},{default:(0,o.w5)((()=>[(0,o.Wm)(Z,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(e.group_name),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1},8,["modelValue"])])):(0,o.kq)("",!0),p,z.storeGroups?((0,o.wg)(),(0,o.j4)(B,{key:1,groupList:z.storeGroups,onClick:e=>{D.groupSelectParent(e,!0)}},null,8,["groupList","onClick"])):(0,o.kq)("",!0)]),(0,o._)("div",g,[z.storeGroups?((0,o.wg)(),(0,o.j4)(R,{key:0,pager:"true",options:q.slideOpts,class:"product-list-slider",onSlideChange:t[1]||(t[1]=e=>D.groupSliderChanged(e)),style:(0,r.j5)(`max-height: ${z.sliderMaxHeight}`)},{default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(z.storeGroups)+" ",1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(z.storeGroups,(t=>((0,o.wg)(),(0,o.j4)(K,{key:t.group_id},{default:(0,o.w5)((()=>[(0,o.Wm)(E,{class:"product-list"},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.children,(t=>((0,o.wg)(),(0,o.j4)(N,{key:t.group_id,ref_for:!0,ref:"group-"+t.group_id,"data-group_id":t.group_id},{default:(0,o.w5)((()=>[(0,o.Wm)(M,{class:"group-title",size:"12"},{default:(0,o.w5)((()=>[(0,o._)("h5",m,(0,r.zw)(t.group_name),1)])),_:2},1024),(0,o.Wm)(M,{size:"12"},{default:(0,o.w5)((()=>[(0,o._)("div",h,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(z.storeProducts[t.group_id],(t=>((0,o.wg)(),(0,o.iD)("div",{key:t.product_id},[(0,o._)("div",{class:(0,r.C_)(t.item_class+" product-item"),id:`product_list_item${t.product_id}`},[(0,o._)("div",w,[(0,o._)("img",{class:"blur-image",src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.200.200.webp`},null,8,f),(0,o.Wm)(Y,{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.200.200.webp`},null,8,["src"])]),(0,o._)("div",v,[(0,o._)("div",y,[(0,o.Uk)((0,r.zw)(t.product_name)+" ",1),"порция"==t.product_unit?((0,o.wg)(),(0,o.iD)("span",b," ("+(0,r.zw)(t.weight_in_gramms)+"г) ",1)):((0,o.wg)(),(0,o.iD)("span",I," ("+(0,r.zw)(t.product_unit)+") ",1))]),(0,o._)("div",k,[t.product_price!=t.product_final_price?((0,o.wg)(),(0,o.iD)("span",S,[(0,o._)("s",null,(0,r.zw)(t.product_price)+(0,r.zw)(e.$heap.state.currencySign),1),$])):(0,o.kq)("",!0),(0,o._)("span",x,[(0,o._)("b",G,(0,r.zw)(t.product_final_price),1),(0,o._)("b",P,(0,r.zw)(e.$heap.state.currencySign),1)])])])],10,_)])))),128))])])),_:2},1024)])),_:2},1032,["data-group_id"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["options","style"])):(0,o.kq)("",!0)])]),(0,o.Wm)(F,{style:{"background-image":"url(/img/bg3.ce15f59d.png)"}},{default:(0,o.w5)((()=>[C,(0,o._)("div",null,[(0,o.Wm)(V,{to:"/catalog"},{default:(0,o.w5)((()=>[(0,o.Wm)(U,null,{default:(0,o.w5)((()=>[H])),_:1})])),_:1})])])),_:1})])),_:1},8,["onIonScroll"])])),_:1})}var z=i(3741),D=i(702),W=i(3181),L=i(8903),j=i(94),Z=i(8128),T=i(8788),O=i(9755),B=i.n(O),M=i(2008),Y=i(4405);const N={slidesPerView:1,pagination:!1,centeredSlides:!1,initialSlide:0,speed:400,watchSlidesProgress:!1,grabCursor:!0,touchStartForcePreventDefault:!0};var E={components:{IonPage:z._i,IonToolbar:z.sr,IonContent:z.W2,IonFooter:z.fr,IonCol:z.wI,IonIcon:z.gu,IonImg:z.Xz,IonRow:z.Nd,IonGrid:z.jY,ImageSlider:Z.Z,IonLabel:z.Q$,IonSegmentButton:z.GO,IonSegment:z.cJ,IonButton:z.YG,Swiper:W.t,SwiperSlide:W.o,GroupList:T.Z},setup(){return{mainLogo:j,search:L.yC4,settingsOutline:L.C$N,rocketOutline:L.G$D,compassOutline:L.gmD,slideOpts:N,slideModules:[D.pt]}},data(){return{storeId:this.$route.params.id,query:this.$route.query,searchRequest:"",storeItem:[],storeProducts:{},storeGroups:null,groupSelectedParentId:-1,offsetModificator:80,sliderMaxHeight:500,itemGetInProgress:!1}},methods:{async itemGet(){if(!this.itemGetInProgress)try{this.itemGetInProgress=!0;const e=await B().post(`${M.Z.state.hostname}Store/itemGet`,{store_id:this.storeId,distance_include:1});this.storeItem=this.itemPrepare(e),console.log(this.storeItem),this.storeId=e.store_id,this.groupTreeGet({store_id:this.storeId}),M.Z.commit("setCurrentStore",this.storeItem),this.itemGetInProgress=!1}catch(i){var e,t;const o=null===i||void 0===i||null===(e=i.responseJSON)||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.error;switch(o){case"notfound":this.$flash("Продавец не найден"),this.$router.push("/catalog/");break}return!1}},itemPrepare(e){e.member_of_groups.group_names&&(e.store_group_names=e.member_of_groups.group_names);try{e.deliveryTime=Y.Z.deliveryTimeCalculate(e.locations[0].distance,e.store_time_preparation)}catch{}return e.avatarImage="",e.avatar.length>0&&(e.avatarImage=e.avatar[0].image_hash),e},async productListGet(e={}){if(e.store_id=this.storeId,e.is_active=1,e.name_query&&""==e.name_query)return void this.groupTreeGet({store_id:this.storeId});e.limit=200;let t={};try{t=await B().post(M.Z.state.hostname+"Product/listGet",e)}catch(o){}this.productListPrepare(t.product_list),this.groupOtherAdd();let i=this;setTimeout((()=>{i.groupSelect()}),0)},productListPrepare(e){for(var t of(this.storeProducts={},e)){var i,o,r;if(this.storeGroups)if(!this.storeProducts[null!==(o=t.group_id)&&void 0!==o?o:0])this.storeProducts[null!==(r=t.group_id)&&void 0!==r?r:0]=[];t.item_class="",t.deleted_at&&(t.item_class="deleted"),1==t.disabled&&(t.item_class="disabled"),1==t.is_counted&&t.product_quantity-t.product_quantity_reserved<1&&(t.item_class="absent"),t.weight_in_gramms=1e3*t.product_weight,this.storeProducts[null!==(i=t.group_id)&&void 0!==i?i:0].push(t)}},async productItemCreate(){try{const e={store_id:this.storeId,product_name:"Новый товар",product_price:1e3,product_promo_price:1e3},t=await B().post(`${M.Z.state.hostname}Product/itemCreate`,e);this.$router.push(`product-edit-${t}`),this.$flash("Добавлен 'Новый товар' в категорию 'Другое'")}catch{this.$flash("Не удалось создать товар")}},async groupTreeGet(e){try{this.storeGroups=await B().get(`${M.Z.state.hostname}Product/groupTreeGet`,{store_id:e.store_id}),this.productListGet()}catch(t){}},groupOtherAdd(){this.storeProducts[0]&&(this.storeGroups[0]={group_id:"other",group_name:"Другое",image_hash:"",children:{0:{group_id:0,group_name:"другое",group_parent_id:0,group_path:"",image_hash:""}}})},groupSelect(){let e=this.query.parent_group_id,t=this.query.sub_group_id;if(t)e:for(let i in this.storeGroups)for(let o in this.storeGroups[i].children)if(o==t){e=i;break e}if(e||(e=Object.keys(this.storeGroups)[0]),this.groupSelectParent(e),t){}},groupSelectParent(e){if(this.groupSelectedParentId==e)return;this.groupSelectedParentId=e;const t=document.querySelector(".product-list-slider").swiper,i=Object.keys(this.storeGroups).indexOf(this.groupSelectedParentId);t.slideTo(i,100,!1)},groupSliderChanged(e){const t=e.activeIndex,i=Object.keys(this.storeGroups)[t];this.groupSelectParent(i,1)},onScroll(e){var t;const i=null===(t=document.querySelector("#hcat_widget_grid"))||void 0===t?void 0:t.getBoundingClientRect().top;i<0?document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block"):document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block hidden-block");var o=document.querySelectorAll(".swiper-slide-active .product-list ion-row");for(var r of o)if(r.getBoundingClientRect().top-this.offsetModificator<=window.innerHeight-window.innerHeight/4&&r.getBoundingClientRect().bottom+this.offsetModificator>=window.innerHeight-window.innerHeight/4&&r.dataset.group_id)break}},ionViewDidEnter(){this.query=this.$route.query,this.itemGet()},ionViewDidLeave(){this.storeItem=[]},watch:{$route(e){this.storeId=e.params.id},groupSelectedParentId(){setTimeout((function(){this.sliderMaxHeight=document.querySelector(".product-list-slider.swiper").style.maxHeight=document.querySelector(".product-list-slider .swiper-slide.swiper-slide-active").scrollHeight+"px"}),0)}}},K=i(3744);const R=(0,K.Z)(E,[["render",q]]);var U=R}}]);
//# sourceMappingURL=710.4aed1850.js.map