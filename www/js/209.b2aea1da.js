"use strict";(self["webpackChunktezkel"]=self["webpackChunktezkel"]||[]).push([[209],{4405:function(e,t,o){var r=o(2008);const i={deliveryCalculate(e){if(!e.locations||!e.locations[0]||!e.locations[0].distance)return null;const t=e.locations[0].distance,o=e.store_time_preparation||0;return i.deliveryTimeCalculate(t,o)},deliveryTimeCalculate(e,t){var o;t=parseInt(null!==(o=t)&&void 0!==o?o:r.Z.getters.settings.delivery.timePreparationDefault);const i=parseInt(r.Z.getters.settings.delivery.timeDelta),s=parseInt(r.Z.getters.settings.delivery.speed),n=5*Math.round(e/s*60/5)+t,l=n>i?n-i:n,u=l+i;return{time:n,timeMin:l,timeMax:u}}};t["Z"]=i},8788:function(e,t,o){o.d(t,{Z:function(){return g}});var r=o(6252),i=o(3577);const s=e=>((0,r.dD)("data-v-27dffeec"),e=e(),(0,r.Cn)(),e),n={class:"slide-title"},l=s((()=>(0,r._)("div",{id:"hcat_widget_grid"},null,-1)));function u(e,t,o,s,u,a){const d=(0,r.up)("ion-img"),c=(0,r.up)("ion-thumbnail"),p=(0,r.up)("swiper-slide"),m=(0,r.up)("swiper");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r.Wm)(m,{id:"hcat_widget_grid","slides-per-view":4.5,"space-between":10},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.groupList,(t=>((0,r.wg)(),(0,r.j4)(p,{key:t.group_id,onClick:()=>e.onClick(t.group_id)},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{style:{width:"70px",height:"70px"}},{default:(0,r.w5)((()=>[(0,r.Wm)(d,{style:{"border-radius":"10px",border:"1px solid #ddd"},src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.150.150.webp`},null,8,["src"])])),_:2},1024),(0,r._)("div",n,(0,i.zw)(t.group_name),1)])),_:2},1032,["onClick"])))),128))])),_:1},8,["slides-per-view"]),l],64)}var a=o(2066),d=o(3181),c=(0,r.aZ)({components:{IonImg:a.Xz,IonThumbnail:a.Bs,Swiper:d.t,SwiperSlide:d.o},props:["groupList","onClick"]}),p=o(3744);const m=(0,p.Z)(c,[["render",u],["__scopeId","data-v-27dffeec"]]);var g=m},5808:function(e,t,o){o.d(t,{Z:function(){return _}});var r=o(6252),i=o(3577);const s={key:0,style:{position:"relative"}},n=["src"],l=["src"];function u(e,t,o,u,a,d){const c=(0,r.up)("ion-icon"),p=(0,r.up)("ion-fab-button"),m=(0,r.up)("ion-fab"),g=(0,r.up)("swiper-slide"),h=(0,r.up)("swiper");return a.expanded?((0,r.wg)(),(0,r.iD)("div",s,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.imageList,(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.image_hash,style:{border:"2px solid var(--ion-color-primary)"}},[(0,r._)("img",{src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.1000.1000.webp`},null,8,n)])))),128)),(0,r.Wm)(m,{horizontal:"end",vertical:"top",slot:"fixed"},{default:(0,r.w5)((()=>[(0,r.Wm)(p,{color:"light"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,{src:u.contract,size:"large",onClick:t[0]||(t[0]=e=>d.minimize())},null,8,["src"])])),_:1})])),_:1})])):((0,r.wg)(),(0,r.j4)(h,{key:1,modules:u.modules,autoplay:{delay:3e3,disableOnInteraction:!1},loop:!0,effect:"fade",style:(0,i.j5)(`height: ${o.imgHeight||"100%"};`)},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.imageList,(t=>((0,r.wg)(),(0,r.j4)(g,{key:t.image_hash},{default:(0,r.w5)((()=>[(0,r._)("div",{class:(0,i.C_)(`${o.mode?o.mode:""} cropper`),style:(0,i.j5)(`height: ${o.imgHeight+"px"||0};`)},[(0,r._)("img",{style:(0,i.j5)(`min-height: ${o.imgHeight+"px;"||0}`),src:`${e.$heap.state.hostname}image/get.php/${t.image_hash}.${4*o.imgHeight||1200}.${4*o.imgHeight||1200}.webp`},null,12,l)],6)])),_:2},1024)))),128))])),_:1},8,["modules","style"]))}var a=o(8903),d=o(2066),c=o(702),p=o(3181),m={components:{Swiper:p.t,SwiperSlide:p.o,IonFab:d.IJ,IonFabButton:d.W4,IonIcon:d.gu},props:["imageList","imgHeight","mode"],setup(){return{modules:[c.pt,c.xW],expand:a.jnR,contract:a.LJB}},data(){return{expanded:!1,vh:0,vw:0}},methods:{maximize(){this.expanded=!0,this.vh=document.getElementsByTagName("ion-content")[0].clientHeight,this.vw=document.getElementsByTagName("ion-content")[0].clientWidth},minimize(){this.expanded=!1,this.vh=document.getElementsByTagName("ion-content")[0].clientHeight,this.vw=document.getElementsByTagName("ion-content")[0].clientWidth}}},g=o(3744);const h=(0,g.Z)(m,[["render",u],["__scopeId","data-v-19102d2e"]]);var _=h},4308:function(e,t,o){o.d(t,{Z:function(){return W}});var r=o(6252),i=o(3577);const s=["id"],n={class:"product_list_item_img"},l={style:{position:"relative",top:"-50%"}},u=["src"],a=(0,r.Uk)(" варианты "),d={style:{height:"5em",overflow:"hidden"}},c={key:0,style:{color:"var(--ion-color-danger)"}},p=(0,r.Uk)("   "),m={style:{color:"var(--ion-color-primary)"}},g={style:{"font-weight":"bold",margin:"0","font-size":"1.4em"}},h={style:{"font-weight":"bold",margin:"0","font-size":"1.2em"}},_=(0,r.Uk)(" / "),w={key:1,style:{color:"var(--ion-color-medium)"}},f={key:2,style:{color:"var(--ion-color-medium)"}};function v(e,t,o,v,y,I){const k=(0,r.up)("cart-add-buttons"),b=(0,r.up)("ion-img"),S=(0,r.up)("ion-chip");return(0,r.wg)(),(0,r.iD)("div",{class:(0,i.C_)(I.item_class),id:`product_list_item${o.productItem.product_id}`},[(0,r._)("div",n,[(0,r._)("div",l,[(0,r.Wm)(k,{buttonLayout:"vertical",productItem:o.productItem},null,8,["productItem"])]),(0,r._)("img",{class:"blur-image",src:`${e.$heap.state.hostname}image/get.php/${o.productItem.image_hash}.200.200.webp`},null,8,u),(0,r.Wm)(b,{onClick:t[0]||(t[0]=t=>e.$router.push(`/catalog/product-${o.productItem.product_id}`)),src:`${e.$heap.state.hostname}image/get.php/${o.productItem.image_hash}.200.200.webp`},null,8,["src"]),I.options?((0,r.wg)(),(0,r.j4)(S,{key:0,style:{position:"absolute",bottom:"0",right:"0"},color:"success"},{default:(0,r.w5)((()=>[a])),_:1})):(0,r.kq)("",!0)]),(0,r._)("div",d,[(0,r._)("div",{style:{color:"black",height:"3em","font-size":"1em",overflow:"hidden","line-height":"1.4em","font-weight":"bold"},onClick:t[1]||(t[1]=t=>e.$router.push(`product-${o.productItem.product_id}`))},(0,i.zw)(o.productItem.product_name),1),o.productItem.product_price!=o.productItem.product_final_price?((0,r.wg)(),(0,r.iD)("span",c,[(0,r._)("s",null,(0,i.zw)(o.productItem.product_price)+(0,i.zw)(e.$heap.state.currencySign),1),p])):(0,r.kq)("",!0),(0,r._)("span",m,[(0,r._)("b",g,(0,i.zw)(o.productItem.product_final_price),1),(0,r._)("b",h,(0,i.zw)(e.$heap.state.currencySign),1)]),_,"порция"==o.productItem.product_unit?((0,r.wg)(),(0,r.iD)("span",w,(0,i.zw)(I.weight_in_gramms)+"г ",1)):((0,r.wg)(),(0,r.iD)("span",f,(0,i.zw)(o.productItem.product_unit),1))])],10,s)}var y=o(2066),I=o(3387),k={components:{IonImg:y.Xz,IonChip:y.hM,CartAddButtons:I.Z},props:["productItem"],computed:{item_class(){return this.productItem.deleted_at?"deleted":1==this.productItem.disabled?"disabled":1==this.productItem.is_counted&&this.productItem.product_quantity-this.productItem.product_quantity_reserved<1?"absent":""},weight_in_gramms(){return 1e3*this.productItem.product_weight},options(){var e;return null!==(e=this.productItem)&&void 0!==e&&e.product_options?this.productItem.product_options.split("~|~"):null}}},b=o(3744);const S=(0,b.Z)(k,[["render",v],["__scopeId","data-v-49ed6cd0"]]);var W=S},3292:function(e,t,o){o.d(t,{Z:function(){return y}});var r=o(6252),i=o(3577);const s=(0,r.Uk)(" ◉ "),n={key:0},l=(0,r.Uk)(" ◉ "),u=(0,r.Uk)("Временно не работает"),a={key:1},d=(0,r.Uk)(" ◉ "),c={key:2},p=(0,r.Uk)(" ◉ "),m=(0,r.Uk)("Закрыт");function g(e,t,o,g,h,_){const w=(0,r.up)("ion-text"),f=(0,r.up)("ion-chip");return 1==o.storeItem.is_opened?((0,r.wg)(),(0,r.j4)(f,{key:0,color:"medium"},{default:(0,r.w5)((()=>[(0,r._)("label",null,[(0,r.Wm)(w,{color:"success"},{default:(0,r.w5)((()=>[s])),_:1}),(0,r.Uk)("Открыт до "+(0,i.zw)(o.storeItem.store_time_closes)+":00",1)])])),_:1})):((0,r.wg)(),(0,r.j4)(f,{key:1,color:"medium"},{default:(0,r.w5)((()=>[0==o.storeItem.is_working?((0,r.wg)(),(0,r.iD)("label",n,[(0,r.Wm)(w,{color:"medium"},{default:(0,r.w5)((()=>[l])),_:1}),u])):o.storeItem.store_next_time_opens>0?((0,r.wg)(),(0,r.iD)("label",a,[(0,r.Wm)(w,{color:"medium"},{default:(0,r.w5)((()=>[d])),_:1}),(0,r.Uk)("Закрыт до "+(0,i.zw)(o.storeItem.store_next_time_opens)+":00",1)])):((0,r.wg)(),(0,r.iD)("label",c,[(0,r.Wm)(w,{color:"medium"},{default:(0,r.w5)((()=>[p])),_:1}),m]))])),_:1}))}var h=o(2066),_=o(8903),w={props:["storeItem"],components:{IonChip:h.hM,IonText:h.yW},setup(){return{ellipse:_.Hpm}}},f=o(3744);const v=(0,f.Z)(w,[["render",g]]);var y=v},5209:function(e,t,o){o.r(t),o.d(t,{default:function(){return B}});var r=o(6252),i=o(3577),s=o(9963);const n=e=>((0,r.dD)("data-v-0bb54b9f"),e=e(),(0,r.Cn)(),e),l={class:"store-info-container"},u={key:0,slot:"start",class:"avatar-container"},a={class:"avatar"},d=["src"],c=(0,r.Uk)("ИНН"),p=(0,r.Uk)("Телефон"),m=(0,r.Uk)("15-20 минут"),g={key:0,class:"group-fixed-block hidden-block"},h=["onClick"],_=n((()=>(0,r._)("h4",{style:{margin:"8px 16px"}},[(0,r._)("b",null,"Категории")],-1))),w=n((()=>(0,r._)("h4",{style:{margin:"8px 16px"}},[(0,r._)("b",null,"Товары")],-1))),f={style:{margin:"0"}},v=(0,r.Uk)(" добавить товар ");function y(e,t,o,n,y,I){var k;const b=(0,r.up)("image-slider"),S=(0,r.up)("ion-text"),W=(0,r.up)("ion-icon"),$=(0,r.up)("router-link"),x=(0,r.up)("ion-item"),z=(0,r.up)("ion-label"),C=(0,r.up)("ion-list"),q=(0,r.up)("ion-accordion"),G=(0,r.up)("ion-accordion-group"),P=(0,r.up)("store-opened-indicator"),D=(0,r.up)("ion-col"),j=(0,r.up)("ion-chip"),H=(0,r.up)("ion-row"),L=(0,r.up)("ion-grid"),Z=(0,r.up)("ion-segment-button"),U=(0,r.up)("ion-segment"),T=(0,r.up)("ion-searchbar"),O=(0,r.up)("group-list"),M=(0,r.up)("product-list"),B=(0,r.up)("swiper-slide"),R=(0,r.up)("swiper"),V=(0,r.up)("base-layout");return(0,r.wg)(),(0,r.j4)(V,{pageDefaultBackLink:"/catalog","page-class":"store-page",contentOnScroll:I.onScroll,"page-title":null!==(k=this.storeItem.store_name)&&void 0!==k?k:"Магазин"},{default:(0,r.w5)((()=>[(0,r._)("div",null,[(0,r._)("div",l,[(0,r.Wm)(b,{imageList:y.storeItem.images,imgHeight:200,mode:"crop-to-fit"},null,8,["imageList"]),(0,r.Wm)(C,{class:"store-info"},{default:(0,r.w5)((()=>[(0,r.Wm)(x,{lines:"none"},{default:(0,r.w5)((()=>[y.storeItem.avatarImage?((0,r.wg)(),(0,r.iD)("div",u,[(0,r._)("div",a,[(0,r._)("img",{alt:"Silhouette of a person's head",src:e.$heap.state.hostname+"image/get.php/"+y.storeItem.avatarImage+".200.200.webp"},null,8,d)])])):(0,r.kq)("",!0),(0,r.Wm)(S,{style:{"font-size":"1.2em"}},{default:(0,r.w5)((()=>[(0,r._)("b",null,(0,i.zw)(y.storeItem.store_name),1)])),_:1}),1==y.storeItem.is_writable?((0,r.wg)(),(0,r.j4)($,{key:1,slot:"end",to:"/catalog/store-edit-"+y.storeItem.store_id},{default:(0,r.w5)((()=>[(0,r.Wm)(W,{icon:n.settingsOutline,style:{"font-size":"24px"}},null,8,["icon"])])),_:1},8,["to"])):(0,r.kq)("",!0)])),_:1}),(0,r.Wm)(G,{style:{width:"100%"}},{default:(0,r.w5)((()=>[(0,r.Wm)(q,null,{default:(0,r.w5)((()=>[(0,r.Wm)(x,{slot:"header",lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(S,{class:"store-description",color:"medium"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(y.storeItem.store_description),1)])),_:1})])),_:1}),(0,r.Wm)(C,{slot:"content"},{default:(0,r.w5)((()=>[(0,r.Wm)(x,{lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(S,null,{default:(0,r.w5)((()=>[(0,r._)("b",null,(0,i.zw)(y.storeItem.store_company_name),1)])),_:1})])),_:1}),(0,r.Wm)(x,{lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(z,{color:"medium"},{default:(0,r.w5)((()=>[c])),_:1}),(0,r.Wm)(z,{color:"medium"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(y.storeItem.store_tax_num),1)])),_:1})])),_:1}),(0,r.Wm)(x,{lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(z,{color:"medium"},{default:(0,r.w5)((()=>[p])),_:1}),(0,r.Wm)(z,{color:"medium"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(y.storeItem.store_phone),1)])),_:1})])),_:1}),(0,r.Wm)(x,{lines:"none"},{default:(0,r.w5)((()=>[(0,r.Wm)(S,{color:"medium"},{default:(0,r.w5)((()=>{var e;return[(0,r.Uk)((0,i.zw)(null===(e=y.storeItem.locations)||void 0===e?void 0:e[0].location_address),1)]})),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,r.Wm)(L,null,{default:(0,r.w5)((()=>[(0,r.Wm)(H,{class:"ion-justify-content-between"},{default:(0,r.w5)((()=>[(0,r.Wm)(D,{size:"auto"},{default:(0,r.w5)((()=>[(0,r.Wm)(P,{storeItem:y.storeItem},null,8,["storeItem"])])),_:1}),(0,r.Wm)(D,{size:"auto"},{default:(0,r.w5)((()=>[(0,r.Wm)(j,{color:"medium",background:"transparent"},{default:(0,r.w5)((()=>[(0,r._)("label",null,(0,i.zw)(y.storeItem.store_group_names),1)])),_:1})])),_:1})])),_:1})])),_:1}),(0,r.Wm)(L,{class:"delivery-variant"},{default:(0,r.w5)((()=>[(0,r.Wm)(H,{class:"ion-justify-content-between ion-align-items-center"},{default:(0,r.w5)((()=>[(0,r.Wm)(D,{size:"auto",class:"delivery-variant-description"},{default:(0,r.w5)((()=>[(0,r._)("label",null,[(0,r._)("b",null,"Доставит "+(0,i.zw)(e.$heap.getters.settings.app_title),1)]),(0,r.Wm)(S,null,{default:(0,r.w5)((()=>[m])),_:1})])),_:1}),(0,r.Wm)(D,{size:"auto",class:"delivery-variant-cost"},{default:(0,r.w5)((()=>{var t;return[(null===(t=e.$heap.getters.settings.delivery)||void 0===t?void 0:t.fee)>0?((0,r.wg)(),(0,r.j4)(S,{key:0},{default:(0,r.w5)((()=>[(0,r._)("b",null,(0,i.zw)(e.$heap.getters.settings.delivery.fee)+"₽",1)])),_:1})):(0,r.kq)("",!0)]})),_:1})])),_:1})])),_:1})])),_:1})]),y.storeGroups?((0,r.wg)(),(0,r.iD)("div",g,[(0,r.Wm)(U,{modelValue:y.groupSelectedParentId,"onUpdate:modelValue":t[0]||(t[0]=e=>y.groupSelectedParentId=e),scrollable:"",class:"groups-container"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(y.storeGroups,(e=>((0,r.wg)(),(0,r.j4)(Z,{key:e.group_id,value:e.group_id,onClick:t=>I.groupSelectParent(e.group_id,1),ref_for:!0,ref:"group-tab-"+e.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(z,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.group_name),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1},8,["modelValue"]),y.storeGroups[y.groupSelectedParentId]?((0,r.wg)(),(0,r.j4)(U,{key:0,color:"light",scrollable:"",class:"sub-groups-container"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(y.storeGroups[y.groupSelectedParentId].children,(e=>(0,r.wy)(((0,r.wg)(),(0,r.iD)("span",{key:e.group_id,ref_for:!0,ref:`group-chip-${e.group_id}`,onClick:t=>I.groupSelectSub(e.group_id)},[(0,r.Wm)(j,{outline:!0,color:"primary"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.group_name),1)])),_:2},1024)],8,h)),[[s.F8,1]]))),128))])),_:1})):(0,r.kq)("",!0)])):(0,r.kq)("",!0),(0,r.Wm)(T,{class:"search-container",modelValue:y.searchRequest,"onUpdate:modelValue":t[1]||(t[1]=e=>y.searchRequest=e),placeholder:"Поиск в этом предприятии",onInput:t[2]||(t[2]=e=>I.productListGet({name_query:e.target.value,name_query_fields:"product_name,product_code"}))},null,8,["modelValue"]),_,y.storeGroups?((0,r.wg)(),(0,r.j4)(O,{key:1,groupList:y.storeGroups,onClick:e=>{I.groupSelectParent(e,!0)}},null,8,["groupList","onClick"])):(0,r.kq)("",!0),w,y.storeGroups?((0,r.wg)(),(0,r.j4)(R,{key:2,pager:"true",options:n.slideOpts,class:"product-list-slider",onSlideChange:t[3]||(t[3]=e=>I.groupSliderChanged(e)),style:(0,i.j5)(`max-height: ${y.sliderMaxHeight}`)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(y.storeGroups)+" ",1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(y.storeGroups,(e=>((0,r.wg)(),(0,r.j4)(B,{key:e.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(L,{class:"product-list"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.children,(e=>((0,r.wg)(),(0,r.j4)(H,{key:e.group_id,ref_for:!0,ref:"group-"+e.group_id,"data-group_id":e.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(D,{class:"group-title",size:"12"},{default:(0,r.w5)((()=>[(0,r._)("h5",f,[(0,r.Uk)((0,i.zw)(e.group_name)+" ",1),1==y.storeItem.is_writable?((0,r.wg)(),(0,r.j4)(j,{key:0,onClick:t=>I.productItemCreate(e.group_id)},{default:(0,r.w5)((()=>[(0,r.Wm)(W,{src:n.addOutline},null,8,["src"]),v])),_:2},1032,["onClick"])):(0,r.kq)("",!0)])])),_:2},1024),(0,r.Wm)(D,{size:"12"},{default:(0,r.w5)((()=>[(0,r.Wm)(M,{productList:y.storeProducts[e.group_id]},null,8,["productList"])])),_:2},1024)])),_:2},1032,["data-group_id"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["options","style"])):(0,r.kq)("",!0)])])),_:1},8,["contentOnScroll","page-title"])}var I=o(2066),k=o(702),b=o(3181),S=o(8903),W=o(5808),$=o(8788);const x={class:"product_list_widget_grid"};function z(e,t,o,i,s,n){const l=(0,r.up)("product-item");return(0,r.wg)(),(0,r.iD)("div",x,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.productList,(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.product_id},[(0,r.Wm)(l,{productItem:e},null,8,["productItem"])])))),128))])}var C=o(4308),q={props:["productList"],components:{ProductItem:C.Z}},G=o(3744);const P=(0,G.Z)(q,[["render",z],["__scopeId","data-v-7707b94a"]]);var D=P,j=o(3292),H=o(9755),L=o.n(H),Z=o(2008),U=o(4405);const T={slidesPerView:1,pagination:!1,centeredSlides:!1,initialSlide:0,speed:400,watchSlidesProgress:!1,grabCursor:!0,touchStartForcePreventDefault:!0};var O={components:{IonText:I.yW,IonCol:I.wI,IonIcon:I.gu,IonRow:I.Nd,IonGrid:I.jY,IonLabel:I.Q$,IonSegmentButton:I.GO,IonSegment:I.cJ,IonChip:I.hM,IonSearchbar:I.VI,IonAccordion:I.We,IonAccordionGroup:I.eh,IonList:I.q_,IonItem:I.Ie,ImageSlider:W.Z,StoreOpenedIndicator:j.Z,Swiper:b.t,SwiperSlide:b.o,GroupList:$.Z,ProductList:D},setup(){return{search:S.yC4,settingsOutline:S.C$N,rocketOutline:S.G$D,compassOutline:S.gmD,addOutline:S.s6O,slideOpts:T,slideModules:[k.pt]}},data(){return{storeId:this.$route.params.id,query:this.$route.query,searchRequest:"",storeItem:[],storeProducts:{},storeGroups:null,groupSelectedParentId:-1,sliderMaxHeight:0,offsetModificator:150,itemGetInProgress:!1}},methods:{async itemGet(){if(!this.itemGetInProgress)try{this.itemGetInProgress=!0;const e=await L().post(`${Z.Z.state.hostname}Store/itemGet`,{store_id:this.storeId,distance_include:1});this.storeItem=this.itemPrepare(e),this.storeId=e.store_id,this.groupTreeGet({store_id:this.storeId}),Z.Z.commit("setCurrentStore",this.storeItem),this.itemGetInProgress=!1}catch(o){var e,t;const r=null===o||void 0===o||null===(e=o.responseJSON)||void 0===e||null===(t=e.messages)||void 0===t?void 0:t.error;switch(r){case"notfound":this.$flash("Продавец не найден"),this.$router.push("/catalog/");break}return!1}},itemPrepare(e){e.member_of_groups.group_names&&(e.store_group_names=e.member_of_groups.group_names);try{e.deliveryTime=U.Z.deliveryTimeCalculate(e.locations[0].distance,e.store_time_preparation)}catch{}return e.avatarImage="",e.avatar.length>0&&(e.avatarImage=e.avatar[0].image_hash),e},async productListGet(e={}){if(e.store_id=this.storeId,e.is_active=1,e.name_query&&""==e.name_query)return void this.groupTreeGet({store_id:this.storeId});e.limit=200;let t={};try{t=await L().post(Z.Z.state.hostname+"Product/listGet",e)}catch(r){}this.productListPrepare(t.product_list),this.groupOtherAdd();let o=this;setTimeout((()=>{o.groupSelect()}),0)},productListPrepare(e){for(var t of(this.storeProducts={},e)){var o,r,i;if(this.storeGroups)if(!this.storeProducts[null!==(r=t.group_id)&&void 0!==r?r:0])this.storeProducts[null!==(i=t.group_id)&&void 0!==i?i:0]=[];this.storeProducts[null!==(o=t.group_id)&&void 0!==o?o:0].push(t)}},async productItemCreate(e){try{const t={store_id:this.storeId,product_name:"Новый товар",product_price:1e3,product_promo_price:1e3},o=await L().post(`${Z.Z.state.hostname}Product/itemCreate`,t);e&&await L().post(`${Z.Z.state.hostname}Product/itemUpdateGroup`,{product_id:o,group_id:e,is_joined:1}),this.$router.push(`/catalog/product-edit-${o}`),this.$flash("Добавлен 'Новый товар'")}catch{this.$flash("Не удалось создать товар")}},async groupTreeGet(e){try{this.storeGroups=await L().get(`${Z.Z.state.hostname}Product/groupTreeGet`,{store_id:e.store_id}),this.productListGet()}catch(t){}},groupOtherAdd(){this.storeProducts[0]&&(this.storeGroups[0]={group_id:"other",group_name:"Другое",image_hash:"",children:{0:{group_id:0,group_name:"другое",group_parent_id:0,group_path:"",image_hash:""}}})},groupSelect(){let e=this.query.parent_group_id,t=this.query.sub_group_id;if(t)e:for(let r in this.storeGroups)for(let o in this.storeGroups[r].children)if(o==t){e=r;break e}e||(e=Object.keys(this.storeGroups)[0]);const o=!1;if(this.groupSelectParent(e,o),t){const e=this;setTimeout((()=>{e.groupSelectSub(t)}),0)}},groupSelectParent(e,t=!1){if(this.groupSelectedParentId==e)return;this.groupSelectedParentId=e;const o=document.querySelector(".product-list-slider").swiper,r=Object.keys(this.storeGroups).indexOf(this.groupSelectedParentId);o.slideTo(r,100,!1);try{if(t){const t=Object.keys(this.storeGroups[e].children)[0],o=this;setTimeout((()=>{o.groupSelectSub(t)}),0)}}catch(i){}},groupSelectSub(e){this.groupSelectedSubId,this.groupSelectedSubId=e,document.querySelectorAll(".groups-container ion-chip").forEach((e=>{e.classList.remove("active-chip")}));try{this.$refs[`group-chip-${e}`][0].$el.classList.add("active-chip")}catch(t){}this.scrollTo(e)},groupSliderChanged(e){const t=e.activeIndex,o=Object.keys(this.storeGroups)[t];this.groupSelectParent(o,1)},scrollTo(e){var t,o;if(null===(t=this.$refs["group-"+e])||void 0===t||!t[0])return;const r=document.querySelector("ion-content.store-page").shadowRoot.querySelector("main").scrollTop,i=this.$refs["group-"+e][0].$el.getBoundingClientRect().top;var s=r+i-this.offsetModificator-window.innerHeight/4,n=Object.keys(null===(o=this.storeGroups[this.groupSelectedParentId])||void 0===o?void 0:o.children)[0]||0;n==e&&(s=r+i-this.offsetModificator),document.querySelector("ion-content.store-page").shadowRoot.querySelector("main").scrollTo({top:s,behavior:"smooth"})},onScroll(e){var t,o;const r=null===(t=document.querySelector(".product-list-slider"))||void 0===t?void 0:t.offsetTop,i=null===(o=document.querySelector(".group-fixed-block"))||void 0===o?void 0:o.offsetHeight;r-i-100<e.detail.scrollTop?document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block"):document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block hidden-block");var s=document.querySelectorAll(".swiper-slide-active .product-list ion-row");for(var n of s)if(n.getBoundingClientRect().top-this.offsetModificator<=window.innerHeight-window.innerHeight/4&&n.getBoundingClientRect().bottom+this.offsetModificator>=window.innerHeight-window.innerHeight/4&&n.dataset.group_id)break}},ionViewDidEnter(){this.query=this.$route.query,this.itemGet()},ionViewDidLeave(){this.storeItem=[]},watch:{$route(e){this.storeId=e.params.id},groupSelectedParentId(){this.sliderMaxHeight=document.querySelector(".product-list-slider.swiper").style.maxHeight=document.querySelector(".product-list-slider .swiper-slide.swiper-slide-active").scrollHeight+"px"}}};const M=(0,G.Z)(O,[["render",y],["__scopeId","data-v-0bb54b9f"]]);var B=M}}]);
//# sourceMappingURL=209.b2aea1da.js.map