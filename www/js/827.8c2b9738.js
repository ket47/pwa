"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[827],{8385:function(e,t,o){o.d(t,{Z:function(){return b}});var i=o(6252),l=o(3577);const a=(0,i.Uk)("Фотографии"),d={key:0,class:"image_grid"},s={key:0,class:"image_controls"};function r(e,t,o,r,u,n){const c=(0,i.up)("ion-label"),m=(0,i.up)("ion-icon"),p=(0,i.up)("ion-item"),_=(0,i.up)("ion-img"),h=(0,i.up)("ion-avatar");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",null,[(0,i.Wm)(p,{lines:"none"},{default:(0,i.w5)((()=>[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[a])),_:1}),u.editMode?((0,i.wg)(),(0,i.j4)(m,{key:0,slot:"end",icon:r.settingsSharp,color:"primary",onClick:t[0]||(t[0]=e=>u.editMode=0)},null,8,["icon"])):((0,i.wg)(),(0,i.j4)(m,{key:1,slot:"end",icon:r.settingsOutline,onClick:t[1]||(t[1]=e=>u.editMode=1)},null,8,["icon"]))])),_:1}),n.imageList?.length?((0,i.wg)(),(0,i.iD)("div",d,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(n.imageList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.image_id},[(0,i.Wm)(h,{onClick:e=>n.imagePreview(t.image_hash),class:(0,l.C_)(t.class)},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".100.100.webp"},null,8,["src"])])),_:2},1032,["onClick","class"]),u.editMode?((0,i.wg)(),(0,i.iD)("div",s,[(0,i.Wm)(m,{icon:r.chevronBackCircleOutline,onClick:e=>n.back(t)},null,8,["icon","onClick"]),n.isAdmin&&1==t.is_disabled?((0,i.wg)(),(0,i.j4)(m,{key:0,icon:r.checkmarkCircle,color:"success",onClick:e=>n.enable(t)},null,8,["icon","onClick"])):(0,i.kq)("",!0),t.deleted_at?((0,i.wg)(),(0,i.j4)(m,{key:1,icon:r.trash,color:"success",onClick:e=>n.restore(t)},null,8,["icon","onClick"])):((0,i.wg)(),(0,i.j4)(m,{key:2,icon:r.trashBin,color:"danger",onClick:e=>n.remove(t)},null,8,["icon","onClick"])),(0,i.Wm)(m,{icon:r.chevronForwardCircleOutline,onClick:e=>n.forward(t)},null,8,["icon","onClick"])])):(0,i.kq)("",!0)])))),128))])):(0,i.kq)("",!0)]),(0,i._)("input",{type:"file",id:"foto_upload",accept:"image/*",onChange:t[2]||(t[2]=e=>n.uploadImage(e)),style:{display:"none"}},null,32)],64)}var u=o(8903);const n=(0,i.Uk)("Просмотр фотографии");function c(e,t,o,l,a,d){const s=(0,i.up)("ion-label"),r=(0,i.up)("ion-icon"),u=(0,i.up)("ion-toolbar"),c=(0,i.up)("ion-header"),m=(0,i.up)("ion-img"),p=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(c,null,{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(s,null,{default:(0,i.w5)((()=>[n])),_:1}),(0,i.Wm)(r,{icon:l.closeOutline,onClick:t[0]||(t[0]=e=>{l.closeModal()}),slot:"end"},null,8,["icon"])])),_:1})])),_:1}),(0,i.Wm)(p,null,{default:(0,i.w5)((()=>[(0,i.Wm)(m,{src:e.$heap.state.hostname+"image/get.php/"+o.image_hash+".1000.1000.webp"},null,8,["src"])])),_:1})],64)}var m=o(3455),p={props:["image_hash"],setup(){const e=function(){m.Fy.dismiss()};return{closeModal:e,closeOutline:u.fID}}},_=o(3744);const h=(0,_.Z)(p,[["render",c]]);var g=h,k=o(9755),w=o.n(k),f=o(9042),y=o(351),W={props:["images","image_holder_id","controller"],setup(){return{settingsOutline:u.C$N,settingsSharp:u.kiF,chevronBackCircleOutline:u.CK0,chevronForwardCircleOutline:u.esm,trashBin:u.UQi,trash:u._Ij,checkmarkCircle:u.I1A}},created(){},data(){return{images_loaded:null,editMode:!1}},computed:{imageList(){let e=this.images_loaded||this.images,t=[];for(let o in e)e[o].deleted_at?(e[o].class=" deleted",this.editMode&&t.push(e[o])):1==e[o].is_disabled?(e[o].class=" disabled",this.editMode&&t.push(e[o])):t.push(e[o]);return t},isAdmin(){return y.Z.isAdmin()}},methods:{async back(e){try{await w().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"up"}),this.load()}catch{}},async forward(e){try{await w().post(this.$heap.state.hostname+"Image/itemUpdateOrder",{image_id:e.image_id,dir:"down"}),this.load()}catch{}},async remove(e){try{await w().post(this.$heap.state.hostname+"Image/itemDelete",{image_id:e.image_id}),this.load()}catch{}},async restore(e){try{await w().post(this.$heap.state.hostname+"Image/itemUnDelete",{image_id:e.image_id}),this.load()}catch{}},async enable(e){try{await w().post(this.$heap.state.hostname+"Image/itemDisable",{image_id:e.image_id,is_disabled:0}),this.load()}catch{}},async load(){const e={image_holder_id:this.image_holder_id,image_holder:this.controller,is_disabled:1,is_deleted:1,is_active:1};this.images_loaded=await w().post(this.$heap.state.hostname+"Image/listGet",e)},async imagePreview(e){const t=await m.Fy.create({component:g,componentProps:{image_hash:e},initialBreakpoint:.5,breakpoints:[0,.5,1]}),o=function(){t.dismiss()};return f.Z.on("dismissModal",o),t.present()},async uploadImage(e){let t=new FormData;t.append("files[]",e.target.files[0]),t.set("image_holder_id",this.image_holder_id);const o={url:this.$heap.state.hostname+this.controller+"/fileUpload",type:"POST",data:t,processData:!1,contentType:!1};try{await w().ajax(o),this.load()}catch(i){if("limit_exeeded"==i?.responseJSON?.messages?.error)return void this.$flash("Уже загружено максимальное количество фото");this.$flash("Не удалось загрузить фото")}},take_photo(){w()("#foto_upload").trigger("click")}}};const I=(0,_.Z)(W,[["render",r],["__scopeId","data-v-9da20430"]]);var b=I},9827:function(e,t,o){o.r(t),o.d(t,{default:function(){return T}});var i=o(6252),l=o(3577);const a=(0,i.Uk)(" Удалено "),d=(0,i.Uk)(" На модерации "),s=(0,i.Uk)(" Не ограниченный остаток "),r=(0,i.Uk)("Основные настройки"),u=(0,i.Uk)("Название"),n=(0,i.Uk)("Описание"),c=(0,i.Uk)("Артикул"),m=(0,i.Uk)("Единица"),p=(0,i.Uk)("Мин. заказ"),_=(0,i.Uk)("Вес единицы (кг)"),h=(0,i.Uk)("Цена"),g=(0,i.Uk)("Цена"),k=(0,i.Uk)("Цена акционная"),w=(0,i.Uk)("Начало акции"),f=(0,i.Uk)("Конец акции"),y=(0,i.Uk)("Слайдер"),W=(0,i.Uk)(" Добавить "),I=(0,i.Uk)("Категории товара"),b=(0,i.Uk)("Добавить в категорию");function U(e,t,o,U,C,G){const V=(0,i.up)("ion-card-content"),v=(0,i.up)("ion-card"),O=(0,i.up)("ion-icon"),D=(0,i.up)("ion-toggle"),L=(0,i.up)("ion-item"),$=(0,i.up)("ion-list"),j=(0,i.up)("ion-label"),M=(0,i.up)("ion-item-divider"),q=(0,i.up)("ion-textarea"),P=(0,i.up)("ion-input"),Z=(0,i.up)("ion-item-group"),F=(0,i.up)("image-tile-comp"),z=(0,i.up)("ion-button"),x=(0,i.up)("base-layout");return(0,i.wg)(),(0,i.j4)(x,{"page-title":C.productItem?.product_name??"Товар","page-default-back-link":"/product-"+this.productId},{default:(0,i.w5)((()=>[G.message?((0,i.wg)(),(0,i.j4)(v,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(V,{class:(0,l.C_)(G.messageClass)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(G.message),1)])),_:1},8,["class"])])),_:1})):(0,i.kq)("",!0),C.productItem?((0,i.wg)(),(0,i.j4)($,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(O,{src:U.trashOutline,color:"primary",slot:"start"},null,8,["src"]),a,(0,i.Wm)(D,{slot:"end",modelValue:C.is_deleted,"onUpdate:modelValue":t[0]||(t[0]=e=>C.is_deleted=e),color:"danger",onIonChange:t[1]||(t[1]=e=>G.itemDelete(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(O,{src:U.searchOutline,color:"primary",slot:"start"},null,8,["src"]),d,(0,i.Wm)(D,{slot:"end",modelValue:C.is_disabled,"onUpdate:modelValue":t[2]||(t[2]=e=>C.is_disabled=e),onIonChange:t[3]||(t[3]=e=>G.itemDisable(e.target.checked?1:0))},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(O,{src:U.pizzaOutline,color:"primary",slot:"start"},null,8,["src"]),s,(0,i.Wm)(D,{slot:"end",modelValue:C.is_produced,"onUpdate:modelValue":t[4]||(t[4]=e=>C.is_produced=e),onIonChange:t[5]||(t[5]=e=>G.save("is_produced",e.target.checked?1:0))},null,8,["modelValue"])])),_:1})])),_:1})):(0,i.kq)("",!0),C.productItem?((0,i.wg)(),(0,i.iD)("form",{key:2,onChange:t[17]||(t[17]=(...e)=>G.saveForm&&G.saveForm(...e))},[(0,i.Wm)($,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(M,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[r])),_:1})])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{position:"stacked",color:"primary"},{default:(0,i.w5)((()=>[u])),_:1}),(0,i.Wm)(q,{modelValue:C.productItem.product_name,"onUpdate:modelValue":t[6]||(t[6]=e=>C.productItem.product_name=e),name:"product_name"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{position:"stacked",color:"primary"},{default:(0,i.w5)((()=>[n])),_:1}),(0,i.Wm)(q,{modelValue:C.productItem.product_description,"onUpdate:modelValue":t[7]||(t[7]=e=>C.productItem.product_description=e),name:"product_description",rows:"6"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[c])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_code,"onUpdate:modelValue":t[8]||(t[8]=e=>C.productItem.product_code=e),name:"product_code",slot:"end"},null,8,["modelValue"])])),_:1}),C.is_produced?(0,i.kq)("",!0):((0,i.wg)(),(0,i.j4)(L,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[(0,i.Uk)("Остаток "+(0,l.zw)(C.productItem.product_unit),1)])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_quantity,"onUpdate:modelValue":t[9]||(t[9]=e=>C.productItem.product_quantity=e),name:"product_quantity",slot:"end"},null,8,["modelValue"])])),_:1})),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[m])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_unit,"onUpdate:modelValue":t[10]||(t[10]=e=>C.productItem.product_unit=e),name:"product_unit",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[p])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_quantity_min,"onUpdate:modelValue":t[11]||(t[11]=e=>C.productItem.product_quantity_min=e),name:"product_quantity_min",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[_])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_weight,"onUpdate:modelValue":t[12]||(t[12]=e=>C.productItem.product_weight=e),name:"product_weight",slot:"end"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,i.Wm)($,{lines:"full"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,null,{default:(0,i.w5)((()=>[(0,i.Wm)(M,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[h])),_:1})])),_:1})])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[g])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_price,"onUpdate:modelValue":t[13]||(t[13]=e=>C.productItem.product_price=e),name:"product_price",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[k])),_:1}),(0,i.Wm)(P,{modelValue:C.productItem.product_promo_price,"onUpdate:modelValue":t[14]||(t[14]=e=>C.productItem.product_promo_price=e),name:"product_promo_price",slot:"end",color:"success"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[w])),_:1}),(0,i.Wm)(P,{type:"date",modelValue:C.productItem.product_promo_start,"onUpdate:modelValue":t[15]||(t[15]=e=>C.productItem.product_promo_start=e),name:"product_promo_start",slot:"end"},null,8,["modelValue"])])),_:1}),(0,i.Wm)(L,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,{color:"primary"},{default:(0,i.w5)((()=>[f])),_:1}),(0,i.Wm)(P,{type:"date",modelValue:C.productItem.product_promo_finish,"onUpdate:modelValue":t[16]||(t[16]=e=>C.productItem.product_promo_finish=e),name:"product_promo_finish",slot:"end"},null,8,["modelValue"])])),_:1})])),_:1})],32)):(0,i.kq)("",!0),C.productItem?((0,i.wg)(),(0,i.j4)($,{key:3},{default:(0,i.w5)((()=>[(0,i.Wm)(M,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[y])),_:1})])),_:1}),(0,i.Wm)(F,{images:C.productItem.images,image_holder_id:C.productItem.product_id,controller:"Product",ref:"productImgs"},null,8,["images","image_holder_id"]),(0,i.Wm)(z,{onClick:t[18]||(t[18]=t=>e.$refs.productImgs.take_photo()),size:"small",expand:"full",color:"medium"},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{src:U.cameraOutline},null,8,["src"]),W])),_:1})])),_:1})):(0,i.kq)("",!0),G.categoryList?((0,i.wg)(),(0,i.j4)($,{key:4},{default:(0,i.w5)((()=>[(0,i.Wm)(M,null,{default:(0,i.w5)((()=>[(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[I])),_:1})])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(G.categoryList,(e=>((0,i.wg)(),(0,i.j4)(L,{key:e.group_id},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{src:U.compassOutline,slot:"start",color:"primary"},null,8,["src"]),(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.group_name),1)])),_:2},1024),(0,i.Wm)(O,{src:U.trashOutline,slot:"end",onClick:t=>G.categoryDelete(e.group_id,e.group_name)},null,8,["src","onClick"])])),_:2},1024)))),128)),(0,i.Wm)(L,{button:"",onClick:t[19]||(t[19]=e=>G.categoryAdd())},{default:(0,i.w5)((()=>[(0,i.Wm)(O,{src:U.addOutline,slot:"start",color:"primary"},null,8,["src"]),(0,i.Wm)(j,null,{default:(0,i.w5)((()=>[b])),_:1})])),_:1})])),_:1})):(0,i.kq)("",!0)])),_:1},8,["page-title","page-default-back-link"])}var C=o(3455),G=o(8903),V=o(8385);const v=(0,i.Uk)("Категории"),O=(0,i.Uk)("Готово");function D(e,t,o,a,d,s){const r=(0,i.up)("ion-title"),u=(0,i.up)("ion-icon"),n=(0,i.up)("ion-toolbar"),c=(0,i.up)("ion-button"),m=(0,i.up)("ion-header"),p=(0,i.up)("ion-img"),_=(0,i.up)("ion-avatar"),h=(0,i.up)("ion-label"),g=(0,i.up)("ion-checkbox"),k=(0,i.up)("ion-item"),w=(0,i.up)("ion-item-divider"),f=(0,i.up)("ion-list"),y=(0,i.up)("ion-content");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i.Wm)(n,null,{default:(0,i.w5)((()=>[(0,i.Wm)(r,null,{default:(0,i.w5)((()=>[v])),_:1}),(0,i.Wm)(u,{slot:"end",onClick:t[0]||(t[0]=e=>{s.closeModal()}),icon:a.closeCircle,size:"large",color:"medium"},null,8,["icon"])])),_:1}),(0,i.Wm)(c,{onClick:t[1]||(t[1]=e=>{s.closeModal()}),color:"medium",expand:"full"},{default:(0,i.w5)((()=>[O])),_:1})])),_:1}),(0,i.Wm)(y,null,{default:(0,i.w5)((()=>[d.groupList?((0,i.wg)(),(0,i.j4)(f,{key:0},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(d.groupList,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.group_id},[t.group_parent_id>0?((0,i.wg)(),(0,i.j4)(k,{key:0},{default:(0,i.w5)((()=>[(0,i.Wm)(_,{slot:"start"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{src:e.$heap.state.hostname+"image/get.php/"+t.image_hash+".50.50.webp"},null,8,["src"])])),_:2},1024),(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.group_name),1)])),_:2},1024),(0,i.Wm)(g,{slot:"end",checked:t.is_marked,onClick:e=>s.mimickChage(e.target,t.group_id)},null,8,["checked","onClick"])])),_:2},1024)):((0,i.wg)(),(0,i.j4)(w,{key:1},{default:(0,i.w5)((()=>[(0,i.Wm)(h,null,{default:(0,i.w5)((()=>[(0,i._)("b",null,(0,l.zw)(t.group_name),1)])),_:2},1024)])),_:2},1024))])))),128))])),_:1})):(0,i.kq)("",!0)])),_:1})],64)}var L=o(9755),$=o.n(L),j={props:["controller","memberId","memberOfIds","memberLimit"],components:[C.nz,C.W2,C.Gu,C.sr],setup(){return{closeCircle:G.XZx}},data(){return{groupList:null,checkedGroupList:[]}},created(){this.listGroupGet(),this.checkedGroupList=this.memberOfIds||[]},methods:{async listGroupGet(){this.groupList=await $().get(this.$heap.state.hostname+this.controller+"/listGroupGet"),this.itemMarkGroups()},itemMarkGroups(){if(this.groupList)try{for(let e of this.groupList)e.is_marked=this.checkedGroupList.includes(e.group_id)?1:0}catch{}},async itemUpdateGroup(e,t){const o={[this.controller.toLowerCase()+"_id"]:this.memberId,is_joined:e,group_id:t};try{await $().post(this.$heap.state.hostname+this.controller+"/itemUpdateGroup",o)}catch(i){this.$flash("Не удалось сохранить изменение")}},mimickChage(e,t){const o=this;setTimeout((()=>{o.groupChanged(e,t)}),0)},async groupChanged(e,t){const o=e.checked?1:0;if(o){if(this.checkedGroupList.length>=this.memberLimit)return this.$flash(`Можно выбрать не больше ${this.memberLimit} категорий`),void(e.checked=0);this.checkedGroupList.push(t)}else this.checkedGroupList=this.checkedGroupList.filter((function(e,o,i){return e!=t}));this.itemUpdateGroup(o,t)},closeModal(){C.Fy.dismiss(this.checkedGroupList)}}},M=o(3744);const q=(0,M.Z)(j,[["render",D]]);var P=q,Z=o(2008),F=o(9042),z={components:{IonInput:C.pK,IonTextarea:C.g2,IonCard:C.PM,IonCardContent:C.FN,IonToggle:C.ho,imageTileComp:V.Z},setup(){return{cameraOutline:G.kuq,trashOutline:G.gtu,searchOutline:G.W6I,personOutline:G.QJ7,addOutline:G.s6O,pizzaOutline:G.fqo,compassOutline:G.gmD}},data(){return{productId:this.$route.params.id,productItem:null,productGroupList:null,is_groups_marked:0,is_deleted:0,is_disabled:0,is_produced:0}},computed:{message(){return this.productItem?.deleted_at?"Товар не активен и будет удален. Вы еще можете отменить удаление":1==this.productItem?.is_disabled?"Товар не активен и находится на рассмотрении у администратора":1==this.productItem?.is_produced?"Товар активен и готов к продаже. Товар произодится вами, например еда":"Товар активен и готов к продаже."},messageClass(){return this.productItem?.deleted_at?"deleted":1==this.productItem?.is_disabled?"disabled":1==this.productItem?.is_produced?"primary":"active"},categoryList(){let e=[];try{let t=this.productItem.member_of_groups.group_ids.split(","),o=this.productItem.member_of_groups.group_names.split(",");for(let i in t)e.push({group_id:t[i],group_name:o[i]})}catch{}return e}},created(){this.listGroupGet(),this.itemGet()},methods:{async itemGet(){try{this.productItem=await $().post(Z.Z.state.hostname+"Product/itemGet",{product_id:this.productId}),this.itemParseFlags(),this.itemMarkGroups()}catch{}},itemParseFlags(){this.is_deleted=null==this.productItem.deleted_at?0:1,this.is_disabled=0==this.productItem.is_disabled?0:1,this.is_produced=0==this.productItem.is_produced?0:1},async itemDelete(e){const t=e?"itemDelete":"itemUnDelete";try{await $().post(Z.Z.state.hostname+"Product/"+t,{product_id:this.productId}),this.productItem.deleted_at=e?1:null}catch{this.itemGet()}},async itemDisable(e){if(this.productItem.is_disabled!=e)try{await $().post(Z.Z.state.hostname+"Product/itemDisable",{product_id:this.productId,is_disabled:e}),this.productItem.is_disabled=e}catch{this.itemGet()}},saveForm(e){const t=e.target.name,o=this.productItem[t];this.save(t,o)},async save(e,t){let o={product_id:this.productId,[e]:t};try{await $().post(Z.Z.state.hostname+"Product/itemUpdate",JSON.stringify(o)),this.productItem[e]=t,this.itemParseFlags()}catch(i){this.$flash("Не удалось сохранить изменение"),this.itemGet()}},categoryDelete(e,t){if(confirm("Исключить товар из категории "+t+"?"))try{this.itemUpdateGroup(0,e)}catch{}},async categoryAdd(){const e=this.productItem?.member_of_groups?.group_ids?.split(",")||[],t=await C.Fy.create({component:P,componentProps:{controller:"Product",memberId:this.productId,memberOfIds:e,memberLimit:1},initialBreakpoint:.75,breakpoints:[.75,1],canDissmiss:!0});t.present(),F.Z.on("dismissModal",(()=>{t.dismiss()})),await t.onDidDismiss(),this.itemGet()},async itemUpdateGroup(e,t){const o={product_id:this.productId,is_joined:e,group_id:t};try{await $().post(Z.Z.state.hostname+"Product/itemUpdateGroup",o)}catch(i){this.$flash("Не удалось сохранить изменение")}this.itemGet()},async listGroupGet(){try{this.productGroupList=await $().get(Z.Z.state.hostname+"Product/listGroupGet"),this.itemMarkGroups()}catch{}}}};const x=(0,M.Z)(z,[["render",U],["__scopeId","data-v-4c7fa0e4"]]);var T=x}}]);
//# sourceMappingURL=827.8c2b9738.js.map