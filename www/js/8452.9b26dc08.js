"use strict";(self["webpackChunkTezkel"]=self["webpackChunkTezkel"]||[]).push([[8452],{8452:function(t,e,o){o.r(e),o.d(e,{default:function(){return _t}});var r=o(6252),i=o(3577);const s={style:{"background-color":"#1380c1","padding-bottom":"15px"}},u={class:"store-info-container"},n={class:"store-image-slider-container"},d=(0,r._)("div",{class:"overlay",style:{"background-image":"url(/img/store_menu_background_full.png)"}},null,-1),a={key:0,class:"avatar"},c=["alt","src"],l={key:1},p={key:2,class:"group-fixed-block hidden-block"},_=(0,r._)("h4",{style:{margin:"16px 16px 20px"}},[(0,r._)("b",null,"Онлайн меню")],-1),m={class:"product-container"},g={style:{margin:"0"}},h={class:"product_list_widget_grid"},w=["onClick"],f=["id"],I={class:"product_list_item_img"},y=["src"],k={class:"product-data"},v={class:"product-title"},b={class:"product-description"},S={key:0},z={class:"product-price"},q={key:0,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},D={key:1,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},$={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},C={key:0,style:{color:"var(--ion-color-light)"}},P={key:1,style:{color:"var(--ion-color-light)"}},G={key:0},x={key:1},W={key:2},L={key:3},M=(0,r._)("div",null,[(0,r._)("h6",null,"НУЖНА ДОСТАВКА?"),(0,r._)("h4",null,"ВЫБИРАЙ TEZKEL")],-1);function H(t,e,o,H,j,U){const T=(0,r.up)("ion-icon"),Y=(0,r.up)("ion-toolbar"),Z=(0,r.up)("image-slider-comp"),O=(0,r.up)("ion-label"),B=(0,r.up)("ion-segment-button"),K=(0,r.up)("ion-segment"),N=(0,r.up)("group-list"),A=(0,r.up)("ion-col"),F=(0,r.up)("ion-img"),R=(0,r.up)("ion-chip"),V=(0,r.up)("ion-row"),E=(0,r.up)("ion-grid"),J=(0,r.up)("swiper-slide"),Q=(0,r.up)("swiper"),X=(0,r.up)("ion-button"),tt=(0,r.up)("router-link"),et=(0,r.up)("ion-footer"),ot=(0,r.up)("ion-content"),rt=(0,r.up)("ion-page");return(0,r.wg)(),(0,r.j4)(rt,null,{default:(0,r.w5)((()=>[(0,r.Wm)(ot,{class:(0,i.C_)("store-menu-page"),scrollEvents:!0,onIonScroll:U.onScroll},{default:(0,r.w5)((()=>[(0,r.Wm)(Y,null,{default:(0,r.w5)((()=>[H.mainLogo?((0,r.wg)(),(0,r.j4)(T,{key:0,class:"toolbar_svg_logo",style:{color:"white"},icon:H.mainLogo},null,8,["icon"])):(0,r.kq)("",!0)])),_:1}),(0,r._)("div",s,[(0,r._)("div",u,[(0,r._)("div",n,[(0,r.Wm)(Z,{imageList:j.storeItem.images,imgHeight:250,mode:"crop-to-fit"},null,8,["imageList"]),d]),j.storeItem.avatarImage?((0,r.wg)(),(0,r.iD)("div",a,[(0,r._)("img",{alt:j.storeItem.store_name,src:t.$heap.state.hostname+"image/get.php/"+j.storeItem.avatarImage+".200.200.webp"},null,8,c)])):((0,r.wg)(),(0,r.iD)("div",l,[(0,r._)("h2",null,(0,i.zw)(j.storeItem.store_name),1)])),j.storeGroups?((0,r.wg)(),(0,r.iD)("div",p,[(0,r.Wm)(K,{modelValue:j.groupSelectedParentId,"onUpdate:modelValue":e[0]||(e[0]=t=>j.groupSelectedParentId=t),scrollable:"",class:"groups-container"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(j.storeGroups,(t=>((0,r.wg)(),(0,r.j4)(B,{key:t.group_id,value:t.group_id,onClick:e=>U.groupSelectParent(t.group_id,1),ref_for:!0,ref:"group-tab-"+t.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(O,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(t.group_name),1)])),_:2},1024)])),_:2},1032,["value","onClick"])))),128))])),_:1},8,["modelValue"])])):(0,r.kq)("",!0),_,j.storeGroups?((0,r.wg)(),(0,r.j4)(N,{key:3,groupList:j.storeGroups,onClick:t=>{U.groupSelectParent(t,!0)}},null,8,["groupList","onClick"])):(0,r.kq)("",!0)]),(0,r._)("div",m,[j.storeGroups?((0,r.wg)(),(0,r.j4)(Q,{key:0,pager:"true",initialSlide:0,speed:400,watchSlidesProgress:!1,grabCursor:!0,touchStartForcePreventDefault:!0,slidesPerView:1.1,pagination:!1,centeredSlides:!1,ref:"productListSlider",class:"product-list-slider",onSlideChange:e[1]||(e[1]=t=>U.groupSliderChanged(t)),style:(0,i.j5)(`max-height: ${j.sliderMaxHeight}`)},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(j.storeGroups)+" ",1),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(j.storeGroups,(e=>((0,r.wg)(),(0,r.j4)(J,{key:e.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(E,{class:"product-list"},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.children,(e=>((0,r.wg)(),(0,r.j4)(V,{key:e.group_id,ref_for:!0,ref:"group-"+e.group_id,"data-group_id":e.group_id},{default:(0,r.w5)((()=>[(0,r.Wm)(A,{class:"group-title",size:"12"},{default:(0,r.w5)((()=>[(0,r._)("h5",g,(0,i.zw)(e.group_name),1)])),_:2},1024),(0,r.Wm)(A,{size:"12"},{default:(0,r.w5)((()=>[(0,r._)("div",h,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(j.storeProducts[e.group_id],(e=>((0,r.wg)(),(0,r.iD)("div",{key:e.product_id,onClick:t=>U.showProductModal(e)},[(0,r._)("div",{class:(0,i.C_)(e.item_class+" product-item"),id:`product_list_item${e.product_id}`},[(0,r._)("div",I,[(0,r._)("img",{class:"blur-image",src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.200.200.webp`},null,8,y),(0,r.Wm)(F,{src:`${t.$heap.state.hostname}image/get.php/${e.image_hash}.200.200.webp`},null,8,["src"])]),(0,r._)("div",k,[(0,r._)("h4",v,(0,i.zw)(e.product_name),1),(0,r._)("p",b,(0,i.zw)(e.product_description),1),e.options?((0,r.wg)(),(0,r.iD)("div",S,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.options,(e=>((0,r.wg)(),(0,r.j4)(R,{key:e.product_id,color:"primary"},{default:(0,r.w5)((()=>[(0,r.Wm)(O,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.product_option),1)])),_:2},1024),(0,r.Uk)(" "),e.product_final_price>0?((0,r.wg)(),(0,r.j4)(O,{key:0},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.product_final_price)+(0,i.zw)(t.$heap.state.currencySign),1)])),_:2},1024)):(0,r.kq)("",!0)])),_:2},1024)))),128))])):(0,r.kq)("",!0),(0,r._)("div",z,[(0,r._)("span",null,[e.product_net_price>0?((0,r.wg)(),(0,r.iD)("b",q,(0,i.zw)(e.product_net_price),1)):((0,r.wg)(),(0,r.iD)("b",D,(0,i.zw)(e.product_final_price),1)),(0,r._)("b",$,(0,i.zw)(t.$heap.state.currencySign),1)]),"порция"==e.product_unit?((0,r.wg)(),(0,r.iD)("span",C," /"+(0,i.zw)(e.weight_in_gramms)+"г ",1)):((0,r.wg)(),(0,r.iD)("span",P,[(0,r.Uk)(" / "),"порция"==e.product_unit?((0,r.wg)(),(0,r.iD)("span",G,(0,i.zw)(e.weight_in_gramms)+"г",1)):"порция мл"==e.product_unit?((0,r.wg)(),(0,r.iD)("span",x,(0,i.zw)(e.weight_in_gramms)+"мл",1)):"кг"==e.product_unit&&e.product_quantity_min<1?((0,r.wg)(),(0,r.iD)("span",W,(0,i.zw)(e.unit_in_gramms)+"г",1)):((0,r.wg)(),(0,r.iD)("span",L,(0,i.zw)(e.product_unit),1))]))])])],10,f)],8,w)))),128))])])),_:2},1024)])),_:2},1032,["data-group_id"])))),128))])),_:2},1024)])),_:2},1024)))),128))])),_:1},8,["style"])):(0,r.kq)("",!0)])]),(0,r.Wm)(et,{style:{"background-image":"url(/img/bg3.ce15f59d.png)"}},{default:(0,r.w5)((()=>[M,(0,r._)("div",null,[(0,r.Wm)(tt,{to:`/catalog/store-${j.storeId}`},{default:(0,r.w5)((()=>[(0,r.Wm)(X,null,{default:(0,r.w5)((()=>[(0,r.Uk)("Перейти в приложение")])),_:1})])),_:1},8,["to"])])])),_:1})])),_:1},8,["onIonScroll"])])),_:1})}o(7658);var j=o(4929),U=o(702),T=o(3181),Y=o(8903),Z=o(94),O=o(4846),B=o(62),K=o(9755),N=o.n(K),A=o(2008),F=o(4405);const R=["alt","src"],V={key:0},E={class:"product-price ion-text-right"},J={key:0,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},Q={key:1,style:{"font-weight":"bold",margin:"5px","font-size":"1.8em"}},X={style:{"font-weight":"bold",margin:"0","font-size":"1.5em"}},tt={key:0,style:{color:"var(--ion-color-medium)"}},et={key:1,style:{color:"var(--ion-color-medium)"}},ot={key:0},rt={key:1},it={key:2},st={key:3};function ut(t,e,o,s,u,n){const d=(0,r.up)("ion-card-title"),a=(0,r.up)("ion-card-header"),c=(0,r.up)("ion-label"),l=(0,r.up)("ion-chip"),p=(0,r.up)("ion-card-content"),_=(0,r.up)("ion-card"),m=(0,r.up)("ion-icon"),g=(0,r.up)("ion-button");return(0,r.wg)(),(0,r.iD)(r.HY,null,[(0,r._)("div",{class:(0,i.C_)(n.item_class)},[(0,r.Wm)(_,{class:"ion-text-center"},{default:(0,r.w5)((()=>[(0,r._)("img",{class:"product_item_img",alt:o.productItem.product_name,src:`${t.$heap.state.hostname}image/get.php/${o.productItem.image_hash}.380.380.webp`},null,8,R),(0,r.Wm)(a,{class:"ion-text-left"},{default:(0,r.w5)((()=>[(0,r.Wm)(d,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(o.productItem.product_name),1)])),_:1})])),_:1}),(0,r.Wm)(p,{class:"ion-text-left"},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(o.productItem.product_description)+" ",1),(0,r._)("div",null,[o.productItem.options?((0,r.wg)(),(0,r.iD)("div",V,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(o.productItem.options,(e=>((0,r.wg)(),(0,r.j4)(l,{key:e.product_id,color:"primary"},{default:(0,r.w5)((()=>[(0,r.Wm)(c,null,{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.product_option),1)])),_:2},1024),(0,r.Uk)(" "),e.product_final_price>0?((0,r.wg)(),(0,r.j4)(c,{key:0},{default:(0,r.w5)((()=>[(0,r.Uk)((0,i.zw)(e.product_final_price)+(0,i.zw)(t.$heap.state.currencySign),1)])),_:2},1024)):(0,r.kq)("",!0)])),_:2},1024)))),128))])):(0,r.kq)("",!0),(0,r._)("div",E,[(0,r._)("span",null,[o.productItem.product_net_price>0?((0,r.wg)(),(0,r.iD)("b",J,(0,i.zw)(o.productItem.product_net_price),1)):((0,r.wg)(),(0,r.iD)("b",Q,(0,i.zw)(o.productItem.product_final_price),1)),(0,r._)("b",X,(0,i.zw)(t.$heap.state.currencySign),1)]),"порция"==o.productItem.product_unit?((0,r.wg)(),(0,r.iD)("span",tt," / "+(0,i.zw)(o.productItem.weight_in_gramms)+"г ",1)):((0,r.wg)(),(0,r.iD)("span",et,[(0,r.Uk)(" / "),"порция"==o.productItem.product_unit?((0,r.wg)(),(0,r.iD)("span",ot,(0,i.zw)(o.productItem.weight_in_gramms)+"г",1)):"порция мл"==o.productItem.product_unit?((0,r.wg)(),(0,r.iD)("span",rt,(0,i.zw)(o.productItem.weight_in_gramms)+"мл",1)):"кг"==o.productItem.product_unit&&o.productItem.product_quantity_min<1?((0,r.wg)(),(0,r.iD)("span",it,(0,i.zw)(o.productItem.unit_in_gramms)+"г",1)):((0,r.wg)(),(0,r.iD)("span",st,(0,i.zw)(o.productItem.product_unit),1))]))])])])),_:1})])),_:1})],2),(0,r.Wm)(g,{fill:"clear",expand:"block",onClick:e[0]||(e[0]=t=>{n.closeModal()}),color:"light",size:"large"},{default:(0,r.w5)((()=>[(0,r.Wm)(m,{slot:"icon-only",icon:s.closeOutline},null,8,["icon"])])),_:1})],64)}var nt={components:{IonIcon:j.gu,IonChip:j.hM,IonCard:j.PM,IonCardContent:j.FN,IonCardTitle:j.Dq,IonCardHeader:j.Zi,IonLabel:j.Q$,IonButton:j.YG},props:["productItem"],setup(){return{layersOutline:Y.Y1P,closeOutline:Y.fID}},computed:{item_class(){return this.productItem.deleted_at?"deleted":this.productItem.product_final_price!=this.productItem.product_price?"promo":1==this.productItem.is_disabled?"disabled":1!=this.productItem.is_counted||this.productItem.product_quantity-this.productItem.product_quantity_reserved>0?"":"absent"},discount(){return Math.round(this.productItem.product_final_price/this.productItem.product_price*100-100)},weight_in_gramms(){return 1e3*this.productItem.product_weight},unit_in_gramms(){return Math.round(1e3*this.productItem.product_quantity_min)},product_price(){return"кг"==this.productItem.product_unit&&this.productItem.product_quantity_min<1?Math.round(this.productItem.product_price*this.productItem.product_quantity_min):this.productItem.product_price},product_final_price(){return"кг"==this.productItem.product_unit&&this.productItem.product_quantity_min<1?Math.round(this.productItem.product_final_price*this.productItem.product_quantity_min):this.productItem.product_final_price}},methods:{closeModal(){j.Fy.dismiss()}}},dt=o(3744);const at=(0,dt.Z)(nt,[["render",ut],["__scopeId","data-v-088db628"]]);var ct=at,lt={components:{IonPage:j._i,IonToolbar:j.sr,IonContent:j.W2,IonFooter:j.fr,IonCol:j.wI,IonIcon:j.gu,IonImg:j.Xz,IonRow:j.Nd,IonGrid:j.jY,ImageSliderComp:O.Z,IonLabel:j.Q$,IonSegmentButton:j.GO,IonSegment:j.cJ,IonButton:j.YG,Swiper:T.t,SwiperSlide:T.o,GroupList:B.Z,IonChip:j.hM},setup(){return{mainLogo:Z,search:Y.yC4,settingsOutline:Y.C$N,rocketOutline:Y.G$D,compassOutline:Y.gmD,slideModules:[U.pt]}},data(){return{storeId:this.$route.params.id,query:this.$route.query,searchRequest:"",storeItem:[],storeProducts:{},storeGroups:null,groupSelectedParentId:-1,offsetModificator:80,sliderMaxHeight:500,can_reload_at:0}},computed:{weight_in_gramms(){return 1e3*this.productItem.product_weight},unit_in_gramms(){return Math.round(1e3*this.productItem.product_quantity_min)}},methods:{async itemGet(){const t=Date.now();if(!(this.can_reload_at>t)){this.can_reload_at=t+1e4;try{const t=await N().post(`${A.Z.state.hostname}Store/itemGet`,{store_id:this.storeId,distance_include:1});this.storeItem=this.itemPrepare(t),this.storeId=t.store_id,this.groupTreeGet({store_id:this.storeId}),A.Z.commit("setCurrentStore",this.storeItem)}catch(r){var e,o;const t=null===r||void 0===r||null===(e=r.responseJSON)||void 0===e||null===(o=e.messages)||void 0===o?void 0:o.error;switch(t){case"notfound":this.$flash("Продавец не найден"),this.$go("/catalog");break}return!1}}},itemPrepare(t){t.member_of_groups.group_names&&(t.store_group_names=t.member_of_groups.group_names);try{t.deliveryTime=F.Z.deliveryTimeCalculate(t.locations[0].distance,t.store_time_preparation)}catch{}return t.avatarImage="",t.avatar.length>0&&(t.avatarImage=t.avatar[0].image_hash),t},async productListGet(t={}){if(t.store_id=this.storeId,t.is_active=1,t.name_query&&""==t.name_query)return void this.groupTreeGet({store_id:this.storeId});t.limit=200;let e={};try{e=await N().post(A.Z.state.hostname+"Product/listGet",t)}catch(r){}this.productListPrepare(e.product_list),this.groupOtherAdd();let o=this;setTimeout((()=>{o.groupSelect()}),0)},productListPrepare(t){for(var e of(this.storeProducts={},t)){var o,r,i;if(this.storeGroups)if(!this.storeProducts[null!==(r=e.group_id)&&void 0!==r?r:0])this.storeProducts[null!==(i=e.group_id)&&void 0!==i?i:0]=[];e.item_class="",e.deleted_at&&(e.item_class="deleted"),1==e.is_disabled&&(e.item_class="disabled"),1!=e.is_counted||e.product_quantity-e.product_quantity_reserved>0||(e.item_class="absent"),e.weight_in_gramms=1e3*e.product_weight,e.unit_in_gramms=Math.round(1e3*e.product_quantity_min),this.storeProducts[null!==(o=e.group_id)&&void 0!==o?o:0].push(e)}},async groupTreeGet(t){try{const e=await N().get(`${A.Z.state.hostname}Product/groupTreeGet`,{store_id:t.store_id});let o=[];for(let t in e)o[e[t].order]=e[t];this.storeGroups=o,this.productListGet()}catch(e){}},groupOtherAdd(){this.storeProducts[0]&&this.storeGroups.push({group_id:"other",group_name:"Другое",image_hash:"",children:{0:{group_id:0,group_name:"другое",group_parent_id:0,group_path:"",image_hash:""}}})},groupSelect(){if(this.groupSelectedParentId>-1)return;let t=this.query.parent_group_id,e=this.query.sub_group_id;if(e)t:for(let i in this.storeGroups)for(let o in this.storeGroups[i].children)if(o==e){t=i;break t}var o;t||(t=null===(o=this.storeGroups[0])||void 0===o?void 0:o.group_id);const r=!1;this.groupSelectParent(t,r)},groupSelectParent(t){if(this.groupSelectedParentId==t)return;if(this.groupSelectedParentId=t,void 0==this.$refs.productListSlider)return;const e=this.$refs.productListSlider.$el.swiper,o=this.storeGroups.findIndex((e=>e.group_id==t));o>=0&&(e.slideTo(o,100,!1),this.groupSliderAdjustHeight())},groupSliderChanged(t){const e=t.activeIndex,o=this.storeGroups[e].group_id;this.groupSelectParent(o,1)},groupSliderAdjustHeight(){var t;const e=null===(t=this.$refs.productListSlider.$el.querySelector(".swiper-slide-active"))||void 0===t?void 0:t.scrollHeight;this.$refs.productListSlider.$el.style.maxHeight=e>0?e+"px":""},onScroll(t){var e;const o=null===(e=document.querySelector("#hcat_widget_grid"))||void 0===e?void 0:e.getBoundingClientRect().top;o<0?document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block"):document.querySelector(".group-fixed-block")&&(document.querySelector(".group-fixed-block").className="group-fixed-block hidden-block");var r=document.querySelectorAll(".swiper-slide-active .product-list ion-row");for(var i of r)if(i.getBoundingClientRect().top-this.offsetModificator<=window.innerHeight-window.innerHeight/4&&i.getBoundingClientRect().bottom+this.offsetModificator>=window.innerHeight-window.innerHeight/4&&i.dataset.group_id)break},async showProductModal(t){const e=await j.Fy.create({component:ct,id:"product-modal",componentProps:{productItem:t},handleBehavior:"cycle",canDissmiss:!0});e.present(),this.$topic.on("dismissModal",(()=>e.dismiss()));const o=await e.onDidDismiss();this.$emit("react",o.data)}},mounted(){this.query=this.$route.query,this.itemGet()},watch:{$route(t){this.storeId=t.params.id}}};const pt=(0,dt.Z)(lt,[["render",H]]);var _t=pt}}]);
//# sourceMappingURL=8452.9b26dc08.js.map