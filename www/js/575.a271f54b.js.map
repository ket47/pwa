{"version":3,"file":"js/575.a271f54b.js","mappings":"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","sources":["webpack://tezkel-delivery/./src/components/ProductItem.vue","webpack://tezkel-delivery/./src/components/ProductItem.vue?ef20","webpack://tezkel-delivery/./src/components/StoreOpenedIndicator.vue","webpack://tezkel-delivery/./src/components/StoreOpenedIndicator.vue?c683","webpack://tezkel-delivery/./src/views/SearchView.vue","webpack://tezkel-delivery/./src/views/SearchView.vue?6e85","webpack://tezkel-delivery/./src/scripts/Utils.js"],"sourcesContent":["<style scoped>\r\n.product_item{\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n.absent{\r\n    filter:grayscale(1);\r\n    opacity: 0.5;\r\n}\r\n.incart .product_list_item_img{\r\n    border: 2px solid var(--ion-color-primary);\r\n}\r\n.product_list_item_img{\r\n    border-radius: 10px;\r\n    border: 2px solid var(--ion-color-light);\r\n    width:155px;\r\n    height:155px;\r\n    overflow:hidden;\r\n    align-items: center;\r\n    justify-content: center;\r\n    display:flex;\r\n}\r\n.deleted .product_list_item_img{\r\n    border: 4px solid red;\r\n}\r\n.disabled .product_list_item_img{\r\n    border: 4px solid #666;\r\n}\r\n</style>\r\n<template>\r\n    <div :class=\"item_class\" :id=\"`product_list_item${productItem.product_id}`\"\r\n        >\r\n        <div class=\"product_list_item_img\">\r\n            <div style=\"position:relative;top:-50%;\">\r\n                <cart-add-buttons buttonLayout=\"vertical\" :productItem=\"productItem\"></cart-add-buttons>\r\n            </div>\r\n            <ion-img @click=\"$router.push(`product-${productItem.product_id}`)\" :src=\"`${$heap.state.hostname}image/get.php/${productItem.image_hash}.200.200.webp`\"/>\r\n        </div>\r\n        <div style=\"height:3.5em;overflow:hidden\">\r\n            <span v-if=\"productItem.product_price!=productItem.product_final_price\" style=\"color:var(--ion-color-danger)\">\r\n                <s>{{productItem.product_price}}{{$heap.state.currencySign}}</s>&nbsp;&nbsp;\r\n            </span>\r\n            <span style=\"color:var(--ion-color-primary)\">\r\n                {{productItem.product_final_price}}{{$heap.state.currencySign}}\r\n            </span> / \r\n            <span style=\"color:var(--ion-color-medium)\">\r\n                {{productItem.product_unit}}\r\n            </span>\r\n            <div style=\"color:black;\" @click=\"$router.push(`product-${productItem.product_id}`)\">{{ productItem.product_name }}</div>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport {\r\n  IonImg,\r\n}                       from '@ionic/vue'\r\nimport CartAddButtons from '@/components/CartAddButtons';\r\nexport default {\r\n    components:{\r\n    IonImg,\r\n    CartAddButtons\r\n    },\r\n    props:['productItem'],\r\n    computed:{\r\n        item_class(){\r\n            if(this.productItem.deleted_at){\r\n                return 'deleted'\r\n            }\r\n            if(this.productItem.disabled==1){\r\n                return 'disabled'\r\n            }\r\n            if(this.productItem.is_counted==1 && (this.productItem.product_quantity-this.productItem.product_quantity_reserved)<1){\r\n                return 'absent'\r\n            }\r\n            return ''\r\n        }\r\n    }\r\n}\r\n</script>","import { render } from \"./ProductItem.vue?vue&type=template&id=e818e01a&scoped=true\"\nimport script from \"./ProductItem.vue?vue&type=script&lang=js\"\nexport * from \"./ProductItem.vue?vue&type=script&lang=js\"\n\nimport \"./ProductItem.vue?vue&type=style&index=0&id=e818e01a&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-e818e01a\"]])\n\nexport default __exports__","<template>\r\n    <ion-chip slot=\"end\" v-if=\"storeItem.is_opened==1\" color=\"success\">Открыт до {{ storeItem.store_time_closes }}:00</ion-chip>\r\n    <ion-chip slot=\"end\" v-else color=\"danger\">\r\n        <span v-if=\"storeItem.is_working==0\">Временно не работает</span>\r\n        <span v-else-if=\"storeItem.store_next_time_opens>0\">Закрыт до {{ storeItem.store_next_time_opens }}:00</span>\r\n        <span v-else>Закрыт</span>\r\n    </ion-chip>\r\n</template>\r\n<script>\r\nimport {\r\n    IonChip\r\n} from '@ionic/vue'\r\nexport default {\r\n    props:['storeItem'],\r\n    components:{\r\n        IonChip\r\n    }\r\n}\r\n</script>","import { render } from \"./StoreOpenedIndicator.vue?vue&type=template&id=46c07de6\"\nimport script from \"./StoreOpenedIndicator.vue?vue&type=script&lang=js\"\nexport * from \"./StoreOpenedIndicator.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","<style scoped>\r\n.search-container {\r\n  visibility: visible;\r\n  margin: 1em 0;\r\n  color: black;\r\n  --border-radius: 10px;\r\n}\r\n\r\n.product_list_widget_grid {\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr 1fr;\r\n}\r\n\r\n</style>\r\n<template>\r\n  <base-layout page-title=\"Поиск товаров\" pageDefaultBackLink=\"/home\">\r\n    <ion-searchbar class=\"search-container\" v-model=\"query\" @input=\"delayedListGet()\" placeholder=\"начните искать\"></ion-searchbar>\r\n    <div v-if=\"found\" style=\"background-color:var(--ion-color-light-tint);padding:10px\">\r\n      <ion-title>Найденные товары</ion-title>\r\n      <ion-list v-for=\"store in found.product_matches\" :key=\"store.store_id\" style=\"border-radius:10px;margin-top:30px;\">\r\n          <ion-item detail button @click=\"$router.push(`store-${store.store_id}`)\" lines=\"full\">\r\n            <ion-thumbnail slot=\"start\">\r\n              <ion-img style=\"border-radius:10px\" :src=\"`${$heap.state.hostname}image/get.php/${store.image_hash}.150.150.webp`\"/>\r\n            </ion-thumbnail>\r\n            <p style=\"font-size:1.1em\">{{store?.store_name}}</p>\r\n            <ion-note slot=\"helper\">{{store.store_description}}</ion-note>\r\n          </ion-item>\r\n          <div>\r\n            <store-opened-indicator storeItem=\"store\"/>\r\n          </div>\r\n          <div style=\"margin:10px;display:grid;grid-template-columns:repeat(auto-fit, 160px)\">\r\n            <div v-for=\"productItem in store.matches\" :key=\"productItem.product_id\">                \r\n              <product-item :productItem=\"productItem\" :storeName=\"store.store_name\"/>\r\n            </div>\r\n          </div>\r\n      </ion-list>\r\n    </div>\r\n    <div v-else>\r\n      Ничего не найдено\r\n    </div>\r\n  </base-layout>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  IonSearchbar,\r\n  IonTitle,\r\n  IonImg,\r\n  IonThumbnail,\r\n  IonChip,\r\n  IonNote,\r\n  IonItem,\r\n  IonList,\r\n}                       from '@ionic/vue'\r\nimport jQuery           from 'jquery'\r\nimport Utils            from '@/scripts/Utils.js'\r\nimport ProductItem      from '@/components/ProductItem.vue'\r\nimport StoreOpenedIndicator from '@/components/StoreOpenedIndicator.vue';\r\n\r\nexport default  {\r\n  components:{\r\n  StoreOpenedIndicator,\r\n  IonSearchbar,\r\n  IonTitle,\r\n  IonImg,\r\n  IonThumbnail,\r\n  IonChip,\r\n  IonNote,\r\n  IonItem,\r\n  IonList,\r\n  ProductItem\r\n  },\r\n  data(){\r\n    return {\r\n      query:this.$route.query.q||'',\r\n      found:null\r\n    }\r\n  },\r\n  ionViewDidEnter(){\r\n    this.delayedListGet()\r\n  },\r\n  created(){\r\n    this.delayedListGet()\r\n    let self=this;\r\n    this.$topic.on('userGet',user=>{\r\n      //self.delayedListGet()//repeated loadings\r\n    })\r\n  },\r\n  methods:{\r\n    async listGet(){\r\n      const request={\r\n        query:this.query,\r\n        in_products:1,\r\n        in_stores:0,\r\n        location_id:this.locMainGet()\r\n      }\r\n      if(!request.location_id){\r\n        return\r\n      }\r\n      try{\r\n        const found=await jQuery.get(this.$heap.state.hostname+'Search/listGet',request)\r\n        this.found=this.storeListCalculate(found)\r\n      }catch{\r\n        this.found='void'\r\n      }\r\n    },\r\n    storeListCalculate(found){\r\n      for(let i in found.product_matches){\r\n        found.product_matches[i].deliveryTime=Utils.deliveryTimeCalculate(found.product_matches[i].distance,found.product_matches[i].store_time_preparation)\r\n      }\r\n      return found\r\n    },\r\n    locMainGet(){\r\n      return this.$heap.state.user.location_main?this.$heap.state.user.location_main.location_id:null\r\n    },\r\n    delayedListGet(){\r\n      clearTimeout(this.clock)\r\n      const self=this;\r\n      this.clock=setTimeout(()=>{self.listGet()},200)\r\n    },\r\n  }\r\n}\r\n</script>","import { render } from \"./SearchView.vue?vue&type=template&id=0dbc6992&scoped=true\"\nimport script from \"./SearchView.vue?vue&type=script&lang=js\"\nexport * from \"./SearchView.vue?vue&type=script&lang=js\"\n\nimport \"./SearchView.vue?vue&type=style&index=0&id=0dbc6992&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-0dbc6992\"]])\n\nexport default __exports__","import heap from '@/heap';\r\nconst Utils={\r\n    deliveryCalculate(Store){\r\n        if( !Store.locations || !Store.locations[0] || !Store.locations[0].distance){\r\n            return null;\r\n        }\r\n        const distance=Store.locations[0].distance;\r\n        const preparation=Store.store_time_preparation||0;\r\n        return Utils.deliveryTimeCalculate(distance,preparation);\r\n    },\r\n    deliveryTimeCalculate(distance,preparation){\r\n        preparation=parseInt(preparation??heap.getters.settings.delivery.timePreparationDefault)\r\n        const delta=parseInt(heap.getters.settings.delivery.timeDelta)\r\n        const speed=parseInt(heap.getters.settings.delivery.speed)\r\n        const time=Math.round(distance/speed*60/5)*5+preparation\r\n        const timeMin=time>delta?time-delta:time\r\n        const timeMax=timeMin+delta\r\n        return {time,timeMin,timeMax}\r\n    }\r\n  };\r\n  export default Utils;"],"names":["class","style","item_class","id","productItem","product_id","buttonLayout","$router","push","src","$heap","state","hostname","image_hash","product_price","product_final_price","currencySign","product_unit","product_name","components","IonImg","CartAddButtons","props","computed","this","deleted_at","disabled","is_counted","product_quantity","product_quantity_reserved","__exports__","render","storeItem","is_opened","slot","color","store_time_closes","is_working","store_next_time_opens","IonChip","pageDefaultBackLink","query","delayedListGet","placeholder","found","product_matches","store","key","store_id","detail","button","lines","store_name","store_description","matches","storeName","StoreOpenedIndicator","IonSearchbar","IonTitle","IonThumbnail","IonNote","IonItem","IonList","ProductItem","data","$route","q","ionViewDidEnter","created","$topic","on","user","methods","async","request","in_products","in_stores","location_id","locMainGet","storeListCalculate","i","deliveryTime","Utils","distance","store_time_preparation","location_main","clearTimeout","clock","self","setTimeout","listGet","deliveryCalculate","Store","locations","preparation","deliveryTimeCalculate","parseInt","heap","delta","speed","time","Math","round","timeMin","timeMax"],"sourceRoot":""}