{"version":3,"file":"js/384.6d25e82f.js","mappings":"iMAGuE,a,WAGxB,c,WAGF,gB,qCA6CFA,MAAA,kF,GAC1BA,MAAA,6C,WAEU,e,GAAuB,OAAI,mB,yVAxDpD,QA4Dc,GA5DD,yBAAuB,QAAQ,aAAW,UAAvD,C,kBACM,IAUc,EAVd,QAUc,GAVD,gBAAc,O,WAAgB,EAAAC,U,qCAAA,EAAAA,UAAS,GAAG,YAAS,eAAE,EAAAC,gBAAgBC,KAAlF,C,kBACI,IAEqB,CAFkB,EAAAC,qBAAA,WAAvC,QAEqB,G,MAFDC,MAAM,QAA1B,C,kBAA2D,IAE3D,M,QAFA,gBAGA,QAEqB,GAFDA,MAAM,UAAQ,C,kBAAC,IAEnC,M,OACA,QAEqB,GAFDA,MAAM,QAAM,C,kBAAC,IAEjC,M,cATJ,kBAWgB,EAAAC,YAAA,WAAhB,QAsBW,W,kBArBF,IAAkC,gBAAvC,QAoBM,mBApBe,EAAAC,mBAATC,K,WAAZ,QAoBM,OApBmCC,IAAKD,EAAME,SAAW,QAAK,GAAE,EAAAC,UAAUH,IAAhF,EACI,QAGW,GAHDI,OAAA,GAAOC,MAAM,QAAvB,C,kBACI,IAA2C,EAA3C,QAA2C,GAAjCC,KAAK,QAASC,KAAMP,EAAMO,MAApC,kBACA,QAA+D,Q,kBAApD,IAAoB,mBAAlBP,EAAMQ,YAAY,MAAE,QAAER,EAAME,UAAQ,M,KAAjD,S,KAFJ,OAIA,QAcW,GAdDG,MAAM,QAAM,C,kBAClB,IASW,EATX,QASW,Q,kBARP,IAMY,EANZ,QAMY,Q,kBALR,IAAyF,EAAzF,QAAyF,GAA/EI,MAAM,UAAQ,C,kBAAC,IAAyB,mBAAvBT,EAAMU,kBAAe,QAAI,EAAAC,MAAMC,MAAMC,cAAY,M,KAA5E,MACgCb,EAAMc,qBAAA,WAAtC,QAGW,G,MAHDL,MAAM,WAAhB,C,kBACI,IAA8C,EAA9C,QAA8C,GAAnCF,KAAM,EAAAQ,kBAAgB,kBACjC,QAAgE,GAArDN,MAAM,QAAM,C,kBAAC,IAA4B,mBAA1BT,EAAMc,oBAAkB,M,KAAlD,S,KAFJ,0B,KAFJ,OAOA,QAA+C,Q,kBAArC,IAA0B,mBAAxBd,EAAMgB,kBAAgB,M,KAAlC,S,KARJ,MAUgChB,EAAMiB,aAAA,WAAtC,QAEgB,G,MAFDX,KAAK,OAApB,C,kBACI,IAAqH,EAArH,QAAqH,GAA5Gd,MAAA,yBAA6B0B,IAAG,GAAK,EAAAP,MAAMC,MAAMO,yBAAyBnB,EAAMiB,2BAAzF,mB,KADJ,0B,KAXJ,OALJ,iB,QADJ,eAuBgB,EAAAG,UAAA,WAAhB,QAiBW,W,kBAhBF,IAAgC,gBAArC,QAeM,mBAfe,EAAAC,iBAATrB,K,WAAZ,QAeM,OAfiCC,IAAKD,EAAME,SAAW,QAAK,GAAE,EAAAC,UAAUH,IAA9E,EAEA,QAGW,GAHDI,OAAA,GAAOC,MAAM,QAAvB,C,kBACI,IAA8C,EAA9C,QAA8C,GAApCC,KAAK,QAASC,KAAM,EAAAe,eAA9B,kBACA,QAA2C,Q,kBAAhC,IAAoB,mBAAlBtB,EAAMQ,YAAU,M,KAA7B,S,KAFJ,OAIA,QAQW,GARDH,MAAM,QAAM,C,kBAClB,IAMW,EANX,QAMW,Q,kBALP,IAGY,EAHZ,QAGY,Q,kBAFR,IAAyF,EAAzF,QAAyF,GAA/EI,MAAM,UAAQ,C,kBAAC,IAAyB,mBAAvBT,EAAMU,kBAAe,QAAI,EAAAC,MAAMC,MAAMC,cAAY,M,KAA5E,MACgCb,EAAMuB,cAAA,WAAtC,QAAmF,G,MAAzEd,MAAM,WAAhB,C,kBAAmD,IAAqB,mBAAnBT,EAAMuB,aAAW,M,KAAtE,0B,KAFJ,OAIA,QAA+C,Q,kBAArC,IAA0B,mBAAxBvB,EAAMgB,kBAAgB,M,KAAlC,S,KALJ,S,KADJ,OANA,iB,QADJ,eAkBY,EAAAlB,WAAc,EAAAsB,SAA1B,iBAA0B,WAA1B,QAKM,MALN,EAKM,EAJF,OAGM,MAHN,EAGM,EAFF,QAA0D,GAA/Cb,KAAM,EAAAiB,gBAAiBC,KAAK,SAAvC,kBACA,QAAkC,Q,kBAAvB,IAAW,M,MAAY,U,uFCnCjCC,MAAM,e,GAkBNA,MAAM,e,GAONA,MAAM,e,WAaoB,c,WASD,c,WAYqB,mB,sTAtE3C,EAAAC,YAAA,WAAhB,QAwEW,W,kBAvEP,IAOW,EAPX,QAOW,GAPDtB,MAAM,QAAM,C,kBAClB,IAEa,EAFb,QAEa,GAFDC,KAAK,SAAO,C,kBACpB,IAA0D,EAA1D,QAA0D,GAA/CC,KAAM,EAAAqB,gBAAiBpC,MAAA,sBAAlC,oB,OAEJ,QAEY,Q,kBADR,IAA0E,EAA1E,QAA0E,GAAhEiB,MAAM,WAAS,C,kBAAC,IAAO,UAAP,WAAO,QAAE,EAAAE,MAAMC,MAAMiB,KAAKC,WAAS,M,yBAIrE,QAMW,GANDzB,MAAM,QAAM,C,kBAClB,IAIM,EAJN,OAIM,MAJN,EAIM,EAHF,QAEW,GAFDI,MAAM,WAAS,C,kBACrB,IAA+C,EAA/C,QAA+C,Q,kBAArC,IAA0B,mBAAxB,EAAAkB,WAAWJ,aAAW,M,2BAK9C,QAQW,GARDlB,MAAM,QAAM,C,kBAClB,IAEa,EAFb,QAEa,GAFDC,KAAK,SAAO,C,kBACpB,IAA6D,EAA7D,QAA6D,GAAlDC,KAAM,EAAAwB,kBAAmBvC,MAAA,sBAApC,oB,OAEJ,QAGW,Q,kBAFP,IAA+D,EAA/D,QAA+D,GAApDiB,MAAM,WAAS,C,kBAAC,IAAwB,mBAAtB,EAAAkB,UAAUnB,YAAU,M,OACjD,QAAmD,Q,kBAAzC,IAA8B,mBAA5B,EAAAmB,UAAUX,kBAAgB,M,wBAI9B,EAAAgB,2BAAA,WAAhB,QAMW,G,MAN+B3B,MAAM,QAAhD,C,kBACI,IAIM,EAJN,OAIM,MAJN,EAIM,EAHF,QAEW,GAFDI,MAAM,WAAS,C,kBACrB,IAAiD,EAAjD,QAAiD,Q,kBAAvC,IAA4B,mBAA1B,EAAAuB,0BAAwB,M,6BAHhD,WAOA,QAMW,G,MANM3B,MAAM,QAAvB,C,kBACI,IAIM,EAJN,OAIM,MAJN,EAIM,EAHF,QAEW,GAFDI,MAAM,WAAS,C,kBACrB,IAAoE,EAApE,QAAoE,GAAjDwB,SAAA,GAASzC,MAAA,oB,kBAMxB,EAAA0C,MAAA,WAAhB,QAQW,W,kBAPP,IAEa,EAFb,QAEa,GAFD5B,KAAK,SAAO,C,kBACpB,IAAuD,EAAvD,QAAuD,GAA5CC,KAAM,EAAA4B,YAAa3C,MAAA,sBAA9B,oB,OAEJ,QAGW,Q,kBAFP,IAAiD,EAAjD,QAAiD,GAAtCiB,MAAM,WAAS,C,kBAAC,IAAU,M,OACrC,QAAoD,Q,kBAA1C,IAA+B,mBAA7B,EAAAyB,IAAIE,yBAAuB,M,2BAN/C,WASA,QASW,W,kBARP,IAEa,EAFb,QAEa,GAFD9B,KAAK,SAAO,C,kBACpB,IAAuD,EAAvD,QAAuD,GAA5CC,KAAM,EAAA4B,YAAa3C,MAAA,sBAA9B,oB,OAEJ,QAIY,Q,kBAHR,IAA+C,EAA/C,QAA+C,GAArCiB,MAAM,WAAS,C,kBAAC,IAAU,M,OACpC,QAAmE,GAAhDwB,SAAA,GAASzC,MAAA,iBAC5B,QAAmE,GAAhDyC,SAAA,GAASzC,MAAA,mB,gBAId,EAAA0C,MAAA,WAAtB,QAOiB,W,kBANb,IAIW,EAJX,QAIW,Q,kBAHP,IAEW,EAFX,QAEW,Q,kBAFD,IACA,UADA,WACA,QAAE,EAAAA,IAAIG,oBAAkB,M,gBAGtC,QAA+E,GAAlE,QAAK,eAAE,EAAAC,iBAAiBC,OAAO,QAA5C,C,kBAAmD,IAAe,M,iBANtE,kB,QAhEJ,eAmGJ,OACIC,MAAM,CAAC,aACPC,WAAW,CACXC,QADW,KAEXC,aAFW,KAGXC,SAHW,KAIXC,UAJW,KAKXC,gBALW,KAMXC,QANW,KAOXC,QAPW,KAQXC,QARW,KASXC,SATW,KAUXC,QAVW,KAWXC,UAXW,KAYXC,QAAO,MAEPC,QACI,MAAO,CACHvB,kBADG,MAEHH,gBAFG,MAGHO,YAAW,QAGnBoB,OACI,MAAO,CACHrB,IAAI,OAGZsB,UACIC,KAAKC,UAETC,SAAS,CACL3B,2BACI,OAAIyB,KAAKvB,KAAK0B,sBAGPC,KAAKC,MAAML,KAAKvB,KAAK0B,sBAAsB,KAAM,KAF7C,MAKnBG,QAAQ,CACJC,eACI,IACI,IAAI9B,QAAU+B,EAAA,iBAAqBR,KAAK9B,UAAUzB,UAClDgC,EAAIE,wBAAwBF,EAAIE,wBAAwB8B,MAAM,KAAKC,UAAUC,KAAK,KAClFX,KAAKvB,IAAIA,EACTmC,QAAQC,IAAIb,KAAKvB,KACnB,MAAMqC,GACJF,QAAQC,IAAIC,GACZ,MAAMC,EAAQD,EAAIE,cAAcC,UAAUC,MAC1C,GAAY,YAATH,EAEC,YADAf,KAAKmB,OAAO,sBAGhB,GAAY,YAATJ,EAEC,YADAf,KAAKmB,OAAO,8BAKxBZ,sBACI,MAAMa,EAAWC,EAAA,0BACjB,UACUb,EAAA,mBAAuBR,KAAK9B,UAAUzB,SAAS2E,GACrDpB,KAAKsB,QAAQC,KAAK,SAASvB,KAAK9B,UAAUzB,UAE5C,MAAMqE,GACJ,MAAMC,EAAQD,EAAIE,cAAcC,UAAUC,MAC9B,YAATH,GACCf,KAAKmB,OAAO,sBAEJ,YAATJ,GACCf,KAAKmB,OAAO,4BAEJ,gBAATJ,GAAoC,QAATA,GAC1Bf,KAAKmB,OAAO,+BAGpBK,EAAA,UAAc,mB,UCpL1B,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAAS,GAAQ,CAAC,YAAY,qBAEzF,QFqFA,GACIzC,WAAY,CACZ0C,WADY,KAEZC,iBAFY,KAGZ/B,QAHY,KAIZD,UAJY,KAKZD,QALY,KAMZD,SANY,KAOZD,QAPY,KAQZP,QARY,KASZM,QATY,KAUZD,QAVY,KAWZsC,OAXY,KAYZC,aAAY,MAEZhC,QACE,MAAO,CAAE9B,gBAAF,MAAkBO,kBAAlB,MAAoCwD,YAApC,MAAgDC,WAAhD,EAA2DlE,cAA3D,MAAyEmE,cAAzE,MAAuF1E,iBAAgB,QAEhHwC,OACI,MAAO,CACHnC,QAAQ,KACRtB,UAAU,KACVL,UAAU,KACVG,mBAAmB,KACnB8F,MAAM,OAGd/B,SAAS,CACL5D,oBACI,IAAI,IAAIC,KAASyD,KAAK3D,UAClB,OAAOE,EAAM2F,WACT,IAAK,WACD3F,EAAMO,KAAKqF,EACX,MACJ,IAAK,QACD5F,EAAMO,KAAK,MACX,MACJ,IAAK,UACDP,EAAMO,KAAK,MACX,MACJ,IAAK,WACDP,EAAMO,KAAK,MACX,MAGZ,OAAOkD,KAAK3D,WAEhBuB,kBACI,IAAI,IAAIrB,KAASyD,KAAKrC,QACbpB,EAAMgB,mBACPhB,EAAMgB,iBAAiB,IAE3BhB,EAAMgB,iBAAiBhB,EAAMgB,iBAAiBkD,MAAM,KAAKC,UAAUC,KAAK,KACpEpE,EAAM6F,SACN7F,EAAMuB,YAAYsC,KAAKC,MAAM9D,EAAM6F,SAAS,KAAM,KAElD7F,EAAMuB,YAAY,GAG1B,OAAOkC,KAAKrC,UAGpB0E,UACI,IAAIC,EAAKtC,KACTwB,EAAA,KAAS,uBAAsB,WAC3Bc,EAAKC,2BAETD,EAAKC,yBAETjC,QAAQ,CACJiC,wBACI,MAAMpG,EAAwC,SAArBkF,EAAA,iBAA6B,EAAE,EACrDrB,KAAK7D,qBAAqBA,IAG7B6D,KAAK7D,mBAAmBA,EACI,GAAzB6D,KAAK7D,mBACJ6D,KAAKhE,UAAU,SAEfgE,KAAKhE,UAAU,SAGvBuE,eAAeiC,GAEX,GADAxC,KAAKyC,WAAWD,GACF,QAAVA,EAEA,YADAxC,KAAK0C,cAGT,IAAIC,EAAiB,kBACP,UAAVH,IACAG,EAAiB,oBAErB3C,KAAK3D,gBAAgBmE,EAAA,eAAmBmC,GACxC3C,KAAKrC,QAAQ,MAEjB1B,gBAAgB2G,GACZ,MAAMJ,EAASI,EAAEC,OAAOzG,MACxB4D,KAAK8C,SAASN,IAElBjC,oBACI,IACI,MAAMa,EAAWC,EAAA,0BACjBrB,KAAKrC,cAAc6C,EAAA,iBAAqBY,GACxCpB,KAAK3D,UAAU,KACjB,MAAMyE,GACJ,MAAMC,EAAQD,EAAIE,cAAcC,UAAUC,MAC9B,YAATH,IACCM,EAAA,iBAAoB,WACpBrB,KAAKuC,2BAIjBE,WAAWD,GACPO,aAAa/C,KAAKiC,OAClB,MAAMK,EAAKtC,KACLgD,EAAQ,KACD,QAAVR,GAA8B,UAAVA,IACnBxC,KAAKiC,MAAMgB,YAAW,KAClBX,EAAKQ,SAASN,KAChBQ,KAGVE,kBACIlD,KAAKuC,wBACc,UAAhBvC,KAAKhE,UACJgE,KAAK8C,SAAS,UAEd9C,KAAKhE,UAAU,UAGvBmH,kBACIJ,aAAa/C,KAAKiC,QAEtB1B,gBAAgBhE,GACZ,GAAIA,EAAM6G,eAAgB,CACtB,MAAMC,QAAc,YAAuB,CACvCC,UAAWC,EACXC,eAAe,CAACtF,UAAU3B,GAC1BkH,kBAAmB,GACnBC,YAAa,CAAC,EAAG,GAAK,OAEpBC,EAAU,WACZN,EAAMO,WAGV,OADApC,EAAA,KAAS,eAAemC,GACjBN,EAAMQ,UAEjB7D,KAAK8D,SAASvH,EAAME,WAExBqH,SAASrH,GACLsH,EAAA,OAAa,SAAQtH,QG/OjC,MAAM,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASuH,KAEpE","sources":["webpack://Tezkel/./src/views/OrderList.vue","webpack://Tezkel/./src/components/CourierJobPreview.vue","webpack://Tezkel/./src/components/CourierJobPreview.vue?8e41","webpack://Tezkel/./src/views/OrderList.vue?4c42"],"sourcesContent":["<template>\r\n  <base-layout page-default-back-link=\"/home\" page-title=\"Заказы\">\r\n        <ion-segment swipe-gesture=\"true\" v-model=\"orderType\" @ionChange=\"listTypeChanged($event)\">\r\n            <ion-segment-button value=\"jobs\" v-if=\"courierJobsInclude\">\r\n                Задания\r\n            </ion-segment-button>\r\n            <ion-segment-button value=\"active\">\r\n                Активные\r\n            </ion-segment-button>\r\n            <ion-segment-button value=\"done\">\r\n                Исполненые\r\n            </ion-segment-button>\r\n        </ion-segment>\r\n        <ion-list v-if=\"orderList\">\r\n            <div v-for=\"order in orderListComputed\" :key=\"order.order_id\" @click=\"itemClick(order)\">\r\n                <ion-item detail lines=\"none\">\r\n                    <ion-icon slot=\"start\" :icon=\"order.icon\"/>\r\n                    <ion-label>{{order.store_name}} #{{order.order_id}}</ion-label>\r\n                </ion-item>\r\n                <ion-item lines=\"full\">\r\n                    <ion-text>\r\n                        <ion-label>\r\n                            <ion-chip color=\"medium\">{{order.order_sum_total}}{{$heap.state.currencySign}}</ion-chip>\r\n                            <ion-chip color=\"primary\" v-if=\"order.stage_current_name\">\r\n                                <ion-icon :icon=\"checkmarkOutline\"></ion-icon>\r\n                                <ion-label color=\"dark\">{{order.stage_current_name}}</ion-label>\r\n                            </ion-chip>\r\n                        </ion-label>\r\n                        <ion-note>{{order.location_address}}</ion-note>\r\n                    </ion-text>\r\n                    <ion-thumbnail slot=\"end\" v-if=\"order.image_hash\">\r\n                        <ion-img style=\"border-radius:10px;\" :src=\"`${$heap.state.hostname}image/get.php/${order.image_hash}.150.150.webp`\"/>\r\n                    </ion-thumbnail>\r\n                </ion-item>\r\n            </div>\r\n        </ion-list>\r\n        <ion-list v-if=\"jobList\">\r\n            <div v-for=\"order in jobListComputed\" :key=\"order.order_id\" @click=\"itemClick(order)\">\r\n\r\n            <ion-item detail lines=\"none\">\r\n                <ion-icon slot=\"start\" :icon=\"rocketOutline\"/>\r\n                <ion-label>{{order.store_name}}</ion-label>\r\n            </ion-item>\r\n            <ion-item lines=\"full\">\r\n                <ion-text>\r\n                    <ion-label>\r\n                        <ion-chip color=\"medium\">{{order.order_sum_total}}{{$heap.state.currencySign}}</ion-chip>\r\n                        <ion-chip color=\"primary\" v-if=\"order.distance_km\">{{order.distance_km}}</ion-chip>\r\n                    </ion-label>\r\n                    <ion-note>{{order.location_address}}</ion-note>\r\n                </ion-text>\r\n            </ion-item>\r\n            </div>\r\n        </ion-list>\r\n        <div v-if=\"!orderList && !jobList\" style=\"display:flex;align-items:center;justify-content:center;height:100%\">\r\n            <div style=\"width:max-content;text-align:center\">\r\n                <ion-icon :icon=\"sparklesOutline\" size=\"large\"></ion-icon>\r\n                <ion-label>Заказов нет</ion-label><br>\r\n            </div>\r\n        </div>\r\n\r\n  </base-layout>\r\n</template>\r\n<script>\r\nimport { \r\n    modalController,\r\n    IonSegment,\r\n    IonSegmentButton,\r\n    IonIcon,\r\n    IonAvatar,\r\n    IonText,\r\n    IonLabel,\r\n    IonItem,\r\n    IonList,\r\n    IonChip,\r\n    IonNote,\r\n    IonImg,\r\n    IonThumbnail,\r\n}                   from '@ionic/vue';\r\nimport {\r\n    storefrontOutline,\r\n    sparklesOutline,\r\n    timeOutline,\r\n    rocketOutline,\r\n    ribbonOutline,\r\n    checkmarkOutline,\r\n}                   from 'ionicons/icons';\r\nimport ordersIcon   from \"@/assets/icons/orders.svg\";\r\nimport Order        from '@/scripts/Order.js';\r\nimport User         from '@/scripts/User.js';\r\nimport Topic        from '@/scripts/Topic.js';\r\nimport router       from '@/router';\r\nimport CourierJobPreview    from '@/components/CourierJobPreview.vue';\r\n\r\nexport default {\r\n    components: {\r\n    IonSegment,\r\n    IonSegmentButton,\r\n    IonIcon,\r\n    IonAvatar,\r\n    IonText,\r\n    IonLabel,\r\n    IonItem,\r\n    IonList,\r\n    IonChip,\r\n    IonNote,\r\n    IonImg,\r\n    IonThumbnail,\r\n    },\r\n    setup() {\r\n      return { sparklesOutline,storefrontOutline,timeOutline,ordersIcon,rocketOutline,ribbonOutline,checkmarkOutline, };\r\n    },\r\n    data(){\r\n        return {\r\n            jobList:null,\r\n            orderList:null,\r\n            orderType:null,\r\n            courierJobsInclude:null,\r\n            clock:null\r\n        };\r\n    },\r\n    computed:{\r\n        orderListComputed(){\r\n            for(let order of this.orderList){\r\n                switch(order.user_role){\r\n                    case 'customer':\r\n                        order.icon=ordersIcon\r\n                        break;\r\n                    case 'admin':\r\n                        order.icon=ribbonOutline\r\n                        break;\r\n                    case 'courier':\r\n                        order.icon=rocketOutline\r\n                        break;\r\n                    case 'supplier':\r\n                        order.icon=storefrontOutline\r\n                        break;\r\n                }\r\n            }\r\n            return this.orderList;\r\n        },\r\n        jobListComputed(){\r\n            for(let order of this.jobList){\r\n                if( !order.location_address ){\r\n                    order.location_address='';\r\n                }\r\n                order.location_address=order.location_address.split(',').reverse().join(',');\r\n                if( order.distance ){\r\n                    order.distance_km=Math.round(order.distance/1000)+'км';\r\n                } else {\r\n                    order.distance_km='';\r\n                }\r\n            }\r\n            return this.jobList;\r\n        }\r\n    },\r\n    created(){\r\n        let self=this;\r\n        Topic.on('courierStatusChange',function(){\r\n            self.courierReadinessCheck();\r\n        });\r\n        self.courierReadinessCheck();\r\n    },\r\n    methods:{\r\n        courierReadinessCheck(){\r\n            const courierJobsInclude=User.courier.status=='ready'?1:0;\r\n            if(this.courierJobsInclude===courierJobsInclude){\r\n                return\r\n            }\r\n            this.courierJobsInclude=courierJobsInclude\r\n            if(this.courierJobsInclude==0){\r\n                this.orderType='active';\r\n            } else {\r\n                this.orderType='jobs';\r\n            }\r\n        },\r\n        async listLoad(listType){\r\n            this.autoReload(listType);\r\n            if( listType=='jobs' ){\r\n                this.listJobLoad();\r\n                return;\r\n            }\r\n            let order_group_type='customer_finish';\r\n            if( listType=='active' ){\r\n                order_group_type='!customer_finish';\r\n            }\r\n            this.orderList=await Order.api.listLoad(order_group_type);\r\n            this.jobList=null;\r\n        },\r\n        listTypeChanged(e){\r\n            const listType=e.target.value;\r\n            this.listLoad(listType);\r\n        },\r\n        async listJobLoad(){\r\n            try{\r\n                const courier_id=User.courier?.data?.courier_id;\r\n                this.jobList=await Order.api.listJobGet(courier_id);\r\n                this.orderList=null;\r\n            } catch(err){\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='notready'){\r\n                    User.courier.status='notready';\r\n                    this.courierReadinessCheck();\r\n                }\r\n            }\r\n        },\r\n        autoReload(listType){\r\n            clearTimeout(this.clock);\r\n            const self=this;\r\n            const timeout=1000*60*2;\r\n            if(listType=='jobs' || listType=='active'){\r\n                this.clock=setTimeout(()=>{\r\n                    self.listLoad(listType);\r\n                },timeout);\r\n            }\r\n        },\r\n        ionViewDidEnter() {\r\n            this.courierReadinessCheck();\r\n            if(this.orderType=='active'){\r\n                this.listLoad('active');\r\n            } else {\r\n                this.orderType='active'\r\n            }\r\n        },\r\n        ionViewDidLeave() {\r\n            clearTimeout(this.clock);\r\n        },\r\n        async itemClick(order){\r\n            if( order.is_courier_job ){\r\n                const modal = await modalController.create({\r\n                    component: CourierJobPreview,\r\n                    componentProps:{orderData:order},\r\n                    initialBreakpoint: 0.5,\r\n                    breakpoints: [0, 0.5, 0.75]\r\n                    });\r\n                const dismissFn=function(){\r\n                    modal.dismiss();\r\n                };\r\n                Topic.on('dismissModal',dismissFn);\r\n                return modal.present();\r\n            }\r\n            this.itemOpen(order.order_id);\r\n        },\r\n        itemOpen(order_id){\r\n            router.push(`order-${order_id}`);\r\n        }\r\n    }\r\n}\r\n</script>","<style scoped>\r\n    ion-icon{\r\n        font-size:40px;\r\n        color:var(--ion-color-medium);\r\n    }\r\n    .center_chip{\r\n        text-align:center;\r\n        width: 100%;\r\n    }\r\n</style>\r\n<template>\r\n    <ion-list v-if=\"orderData\">\r\n        <ion-item lines=\"none\">\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"locationOutline\" style=\"font-size:30px\"/>\r\n            </ion-avatar>\r\n            <ion-label>\r\n                <ion-text color=\"primary\">Курьер {{$heap.state.user.user_name}}</ion-text>\r\n            </ion-label>            \r\n        </ion-item>\r\n\r\n        <ion-item lines=\"none\">\r\n            <div class=\"center_chip\">\r\n                <ion-chip color=\"success\">\r\n                    <ion-text>{{orderData?.distance_km}}</ion-text>\r\n                </ion-chip>\r\n            </div>      \r\n        </ion-item>\r\n\r\n        <ion-item lines=\"none\">\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"storefrontOutline\" style=\"font-size:30px;\"/>\r\n            </ion-avatar>\r\n            <ion-text>\r\n                <ion-label color=\"primary\">{{orderData.store_name}}</ion-label>\r\n                <ion-note>{{orderData.location_address}}</ion-note>\r\n            </ion-text>\r\n        </ion-item>\r\n\r\n        <ion-item v-if=\"start_finish_distance_km\" lines=\"none\">\r\n            <div class=\"center_chip\">\r\n                <ion-chip color=\"success\">\r\n                    <ion-text>{{start_finish_distance_km}}</ion-text>\r\n                </ion-chip>\r\n            </div>      \r\n        </ion-item>\r\n        <ion-item v-else lines=\"none\">\r\n            <div class=\"center_chip\">\r\n                <ion-chip color=\"success\">\r\n                    <ion-skeleton-text animated style=\"width: 100%\"></ion-skeleton-text>\r\n                </ion-chip>\r\n            </div>      \r\n        </ion-item>\r\n\r\n\r\n        <ion-item v-if=\"job\">\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"flagOutline\" style=\"font-size:30px;\"/>\r\n            </ion-avatar>\r\n            <ion-text>\r\n                <ion-label color=\"primary\">Покупатель</ion-label>\r\n                <ion-note>{{job.finish_location_address}}</ion-note>\r\n            </ion-text>           \r\n        </ion-item>\r\n        <ion-item v-else>\r\n            <ion-avatar slot=\"start\">\r\n                <ion-icon :icon=\"flagOutline\" style=\"font-size:30px;\"/>\r\n            </ion-avatar>\r\n            <ion-label>\r\n                <ion-text color=\"primary\">Покупатель</ion-text>\r\n                <ion-skeleton-text animated style=\"width: 60%\"></ion-skeleton-text>\r\n                <ion-skeleton-text animated style=\"width: 80%\"></ion-skeleton-text>\r\n            </ion-label>           \r\n        </ion-item>\r\n\r\n        <ion-item-group v-if=\"job\">\r\n            <ion-item>\r\n                <ion-text>\r\n                    Бонус {{job.order_sum_delivery}}\r\n                </ion-text>\r\n            </ion-item>\r\n            <ion-button @click=\"deliveryStart()\" expand=\"full\">Начать доставку</ion-button>\r\n        </ion-item-group>\r\n    </ion-list>\r\n</template>\r\n<script>\r\nimport { \r\n    IonList,\r\n    IonItemGroup,\r\n    IonTitle,\r\n    IonButton,\r\n    IonSkeletonText,\r\n    IonNote,\r\n    IonChip,\r\n    IonItem,\r\n    IonLabel,\r\n    IonText,\r\n    IonAvatar,\r\n    IonIcon,\r\n}                   from '@ionic/vue';\r\nimport {\r\n    storefrontOutline,\r\n    locationOutline,\r\n    flagOutline\r\n    }               from 'ionicons/icons';\r\nimport User         from '@/scripts/User.js';\r\nimport Order        from '@/scripts/Order.js';\r\nimport Topic        from '@/scripts/Topic.js';\r\n\r\n\r\nexport default({\r\n    props:['orderData'],\r\n    components:{\r\n    IonList,\r\n    IonItemGroup,\r\n    IonTitle,\r\n    IonButton,\r\n    IonSkeletonText,\r\n    IonNote,\r\n    IonChip,\r\n    IonItem,\r\n    IonLabel,\r\n    IonText,\r\n    IonAvatar,\r\n    IonIcon,\r\n    },\r\n    setup() {\r\n        return { \r\n            storefrontOutline,\r\n            locationOutline,\r\n            flagOutline \r\n            }\r\n    },\r\n    data(){\r\n        return {\r\n            job:null\r\n        };\r\n    },\r\n    mounted(){\r\n        this.jobGet()\r\n    },\r\n    computed:{\r\n        start_finish_distance_km(){\r\n            if(!this.job?.start_finish_distance){\r\n                return '-';\r\n            }\r\n            return Math.round(this.job?.start_finish_distance/1000)+'км';\r\n        }\r\n    },\r\n    methods:{\r\n        async jobGet(){\r\n            try{\r\n                let job=await Order.api.itemJobGet(this.orderData.order_id);\r\n                job.finish_location_address=job.finish_location_address.split(',').reverse().join(',');\r\n                this.job=job;\r\n                console.log(this.job)\r\n            } catch(err){\r\n                console.log(err)\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='notfound'){\r\n                    this.$flash(\"Задание не найдено\");\r\n                    return\r\n                }\r\n                if(message=='notready'){\r\n                    this.$flash(\"Смена курьера не открыта\");\r\n                    return\r\n                }\r\n            }\r\n        },\r\n        async deliveryStart(){\r\n            const courier_id=User.courier?.data?.courier_id;\r\n            try{\r\n                await Order.api.itemJobStart(this.orderData.order_id,courier_id);\r\n                this.$router.push('order-'+this.orderData.order_id);\r\n\r\n            } catch(err){\r\n                const message=err.responseJSON?.messages?.error;\r\n                if(message=='notfound'){\r\n                    this.$flash(\"Задание не найдено\");\r\n                }\r\n                if(message=='notready'){\r\n                    this.$flash(\"Смена курьера не открыта\");\r\n                }\r\n                if(message=='notsearching' || message=='idle'){\r\n                    this.$flash(\"Заданию уже назначен курьер\");\r\n                }\r\n            }\r\n            Topic.publish('dismissModal');\r\n        }\r\n    }\r\n})\r\n</script>\r\n","import { render } from \"./CourierJobPreview.vue?vue&type=template&id=270793c6&scoped=true\"\nimport script from \"./CourierJobPreview.vue?vue&type=script&lang=js\"\nexport * from \"./CourierJobPreview.vue?vue&type=script&lang=js\"\n\nimport \"./CourierJobPreview.vue?vue&type=style&index=0&id=270793c6&scoped=true&lang=css\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-270793c6\"]])\n\nexport default __exports__","import { render } from \"./OrderList.vue?vue&type=template&id=3ff51c74\"\nimport script from \"./OrderList.vue?vue&type=script&lang=js\"\nexport * from \"./OrderList.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"W:\\\\Ionic\\\\Tezkel\\\\blank\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["style","orderType","listTypeChanged","$event","courierJobsInclude","value","orderList","orderListComputed","order","key","order_id","itemClick","detail","lines","slot","icon","store_name","color","order_sum_total","$heap","state","currencySign","stage_current_name","checkmarkOutline","location_address","image_hash","src","hostname","jobList","jobListComputed","rocketOutline","distance_km","sparklesOutline","size","class","orderData","locationOutline","user","user_name","storefrontOutline","start_finish_distance_km","animated","job","flagOutline","finish_location_address","order_sum_delivery","deliveryStart","expand","props","components","IonList","IonItemGroup","IonTitle","IonButton","IonSkeletonText","IonNote","IonChip","IonItem","IonLabel","IonText","IonAvatar","IonIcon","setup","data","mounted","this","jobGet","computed","start_finish_distance","Math","round","methods","async","Order","split","reverse","join","console","log","err","message","responseJSON","messages","error","$flash","courier_id","User","$router","push","Topic","__exports__","IonSegment","IonSegmentButton","IonImg","IonThumbnail","timeOutline","ordersIcon","ribbonOutline","clock","user_role","orders","distance","created","self","courierReadinessCheck","listType","autoReload","listJobLoad","order_group_type","e","target","listLoad","clearTimeout","timeout","setTimeout","ionViewDidEnter","ionViewDidLeave","is_courier_job","modal","component","CourierJobPreview","componentProps","initialBreakpoint","breakpoints","dismissFn","dismiss","present","itemOpen","router","render"],"sourceRoot":""}